;/*FB_PKG_DELIM*/

__d("EncryptedBackupTaskFailureFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5725");b=d("FalcoLoggerInternal").create("encrypted_backup_task_failure",a);e=b;g["default"]=e}),98);
__d("EncryptedBackupTaskIssuedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5726");b=d("FalcoLoggerInternal").create("encrypted_backup_task_issued",a);e=b;g["default"]=e}),98);
__d("LSEBPayloadSerializerError",[],(function(a,b,c,d,e,f){a=Object.freeze({INVALID_BACKUP_OPERATION:-7,INVALID_CONTENT_TYPE:-6,INVALID_PAYLOAD_FORMAT:-5,CQL_DB_ERROR:-4,REQUIRED_COLUMN_NOT_PRESENT_ON_CLIENT:-3,DEPRECATED_SPROC:-2,UNKNOWN_ERROR:-1,NOT_AN_ERROR:0,BACKUP_NOT_FOUND:1,REQUIRED_TABLE_NOT_FOUND:2,NATIVE_OP_NOT_FOUND:3,BACKUP_UPLOAD_KILLSWITCHED:4,TASK_ID_NOT_FOUND:5,NOT_IMPLEMENTED:6,NOT_SUPPORTED_ON_WEB:7,DUPLICATE_TASK:8,CLIENT_STATE_NOT_LOADED:9,RECOVERY_CODE_NOT_FOUND:10,EPOCH_KEYS_NOT_FOUND:11,DEVICE_PAYLOAD_NOT_CREATED:12,NULL_DEVICE_PAYLOAD:13,EPOCH_PAYLOAD_NOT_CREATED:14,NULL_EPOCH_PAYLOAD:15,VIRTUAL_DEVICE_PAYLOAD_NOT_CREATED:16,NULL_VIRTUAL_DEVICE_PAYLOAD:17,DEVICE_METADATA_NOT_FOUND:18,NO_MATCHING_DEVICE_PUBLIC_KEY:19,NULL_MAILBOX_ROOT_KEY:20,NULL_ENCRYPTION_VERSION:21,NULL_OCMF_KEY:22,NULL_EPOCH_KEYS:23,NULL_DEVICE_ID:24,OPE_KEY_DERIVATION_FAILED:25,MESSAGE_KEY_DERIVATION_FAILED:26,NULL_MAILBOX_ROOT_KEY_V2:27,ECHO_DOCUMENT_ENCODING_FAILED:30,ECHO_PAYLOAD_CREATION_DISABLED:31,ECHO_DOCUMENT_ENCODING_SKIPPED:32,MESSAGE_PAYLOAD_ENCRYPTION_FAILED:40,SERVER_THREAD_ID_NOT_FOUND_FOR_JID:52,UNKNOWN_PROTOBUF_TYPE:60,SUPPLEMENTARY_DATA_KEY_UNEXPECTED:61,PROTOBUF_ENCRYPTION_FAILED:62,PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE:63,PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE:64,SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE:65,SUPPLEMENTAL_ENCRYPTION_FAILED:66,PROTOBUF_CONTEXT_ROW_NOT_FOUND:67,PROTOBUF_FORMATTING_FAILED:68,SUPPLEMENTAL_FORMATTING_FAILED:69,PROTOBUF_ALREADY_DELETED:70,PROTOBUF_NOT_FOUND_IN_DELETED_MESSAGES_TABLE:71,DELETION_PROTOBUF_IS_NULL:72,PROTOBUF_PAYLOAD_IN_CONTEXT_ROW_IS_NOT_FOUND:73,PROTOBUF_ENCRYPTION_FAILED_RETRYABLE:74,VALUE_SECRET_REF_INVALID:75,MINOS_ENCRYPTION_RESULT_NULL:76,SUPPLEMENTAL_OTID_NOT_SET_IN_CONTEXT_TABLE:77,SNAPSHOT_NOT_FOUND_FAILURE:78,THREAD_PK_NOT_FOUND_FOR_JID:100,MESSAGE_DECRYPTION_FAILED:101,EPOCH_KEY_FETCH_FAILED:102,TOO_MANY_OPEN_EPOCHS:103,MESSAGE_RANGE_PREPARE_FAILURE:104,ECHO_DOCUMENT_RESTORE_FAILED:105,MISMATCH_POINT_QUERY_MESSAGE_AND_RANGE_LENGTH:106,INITIAL_THREADS_FETCH_FOR_RESTORE_FAILED:107,MISSING_SUPPLEMENTAL_KEY_CIPHERTEXT:108,SUPPLEMENTAL_KEY_DECRYPTION_FAILURE:109,DEVICE_ID_MISMATCH:110,RESTORE_TO_TAM_INFO:111,MISSING_SERVER_THREAD_KEY:112,EB_ADD_DEVICE_FOUND_NO_LOCAL_THREADS:113,EB_MORE_THREADS_IN_MAPPING_TABLE:114,RESTORE_INTEGRITY_CHECK_FAILED:115,RESTORE_TOP_LEVEL_PROTOBUF_NULL:116,DECRYPT_MINOS_PROTOBUF_FAILURE:117,MESSAGE_PK_NOT_FOUND_IN_CLIENT_MESSAGES:200,OTID_NOT_FOUND_IN_ACT_MESSAGES:201,THREAD_ID_NOT_FOUND_IN_ACT_THREADS:202,THREAD_PK_NOT_FOUND_IN_CLIENT_THREADS:203,FAILED_TO_GET_THREAD_SORT_KEY:204,MEDIA_INFO_INVALID:205,REVERB_DB_NOT_ENABLED_FOR_INSTAMADILLO:206,SKIPPED_EB_DISABLED:300,SKIPPED_THREAD_NOT_ELIGIBLE:301,SKIPPED_MESSAGE_NOT_ELIGIBLE:302,NO_EPOCHS_FOUND:400,LATEST_EPOCH_QUERY_BY_ID_FAILED:401,FOUND_EPOCH_WITH_NULL_ROOT_KEY:402,FOUND_EPOCH_WITH_NULL_ANON_ID:403,NO_RECOVERY_CODE:501,NO_ERROR:601,ERROR_GENERAL:602,UNKNOWN:603,ONBOARDING_MATERIAL_DERIVATION_FAILURE:604,NULL_DEVICE_HMAC:605,MISSING_LATEST_EPOCH_AT_ONBOARDING:606,NO_THREADS_TO_COMPARE:701,START_SORT_KEY_FAILURE:702,END_SORT_KEY_FAILURE:703,LOOPING_UPLOAD_PAYLOAD_NOT_FOUND:704,NULL_ECHO_IDENTIFIERS:705,ECHO_TIMESTAMP_CONVERSION_FAILED:706,ECHO_PROTOBUF_THREAD_ID_MISMATCH:707,ECHO_PROTOBUF_TIMESTAMP_MISMATCH:708,ECHO_PROTOBUF_OTID_MISMATCH:709,NULL_ECHO_DOCUMENT:710,INVALID_PROTOBUF_BACKUP_ACTION:711,EMPTY_ENCODED_ECHO_DOCUMENT:712,LOOPING_UPLOAD_TASK_QUEUE_FULL:713,ECHO_DOCUMENT_ENCODING_UNKNOWN_ENCODING_ERROR:750,ECHO_DOCUMENT_ENCODING_MESSAGE_PK_NOT_FOUND_ERROR:751,ECHO_DOCUMENT_ENCODING_DISK_WRITE_CHECK_FAILED:752,ECHO_DOCUMENT_ENCODING_THREAD_TRANSPORT_ID_FETCH_FAILED:753,ECHO_DOCUMENT_ENCODING_FILE_WRITE_FAILED:754,ECHO_DOCUMENT_ENCODING_DISK_WRITE_DISABLED:755,ECHO_DOCUMENT_ENCODING_SHOULD_NOT_PERSIST:756,MISSING_SUPPLEMENTAL_DATA:757,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_REPLY_PROXY_ERROR:758,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_EDIT_MESSAGE_QUERY_ERROR:759,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_EDIT_MESSAGE_ERROR:760,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_RECEIPTS_ERROR:761,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_REACTIONS_ERROR:762,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_VISUAL_MESSAGE_ACTIONS_ERROR:763,ECHO_DOCUMENT_ENCODING_MESSAGE_FIELDS_POLLS_ERROR:764,READ_CLIENT_STATE_FROM_MAIN_DB_ERROR:801,NOT_SUPPORTED_ON_MAIN_DB:802,SKIP_MPS_WRITE_DUE_TO_HIGHER_TIMESTAMP_AVAILABILITY:851,MESSAGE_ALREADY_DELETED:852});f["default"]=a}),66);
__d("MpsFutureProofKey",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({WCEPlaintextPayloadFutureProofPlaceholder:0,WCEPlaintextPayloadFutureProofNoPlaceholder:1,WCEPlaintextPayloadFutureProofIgnore:2});f.WCEPlaintextPayloadFutureProof=a}),66);
__d("WAAbPropsHelpers",["WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=86400,m=600,n=604800;function a(a){return a==null?l:Math.max(m,Math.min(n,a))}function o(a){var b=[];Object.keys(a).forEach(function(c){var d=a[c],e=d[0];d[1];d=d[2];if(typeof e!=="number")return;b.push({configName:c,configCode:e,configDefault:d})});return b}function b(a,b){a=a[b][0];return typeof a==="number"?a:null}function p(a,b){switch(typeof b){case"boolean":return a==="1";case"number":return parseFloat(a);case"string":return a;default:d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["parseValue: unsure how to read ",""])),a);return null}}function c(a,b){var c=new Map();b.forEach(function(a){var b=a.configCode,d=a.configValue;a=a.configExpoKey;c.set(b,{configValue:d,configExpoKey:a})});var d={},e={};o(a).forEach(function(a){var b=a.configName,f=a.configCode;a=a.configDefault;var g=c.get(f);if(g==null)return;var h=g.configValue;g=g.configExpoKey;h=p(h,a);h!=null&&(d[b]=h);e[f]=g!=null?g:null});return{values:d,expoKeys:e}}function e(a,b,c){var e=babelHelpers["extends"]({},b,a),f={};Object.keys(e).forEach(function(a){if(c[a]==null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdatePropValues: deleting config ",""])),a);return}f[a]=e[a]});return f}function f(a,b,c){var e=babelHelpers["extends"]({},b,a),f={};a=o(c).map(function(a){return a.configCode});var g=new Set(a),h=new Set();Object.keys(e).forEach(function(a){a=parseInt(a,10);var c=b?b[a]:null;!g.has(a)?(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateExpoKeys: deleting config_expo_key ",""])),a),c!=null&&c.trim()&&h.add(c)):(e[a]!==c&&(d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["maybeUpdateExpoKeys: config_expo_key "," changed"])),a),c!=null&&c.trim()&&h.add(c)),f[a]=e[a])});return{propExpoKeys:f,expoKeysToDelete:h}}function q(a,b){if(b==null)return;var c=b;a.forEach(function(a){c["delete"](a)});if(c.size===0)return;return{internalExpoKeys:c,expoKeyStr:Array.from(c).join(",")}}g.maybeUpdateRefresh=a;g.asAbList=o;g.asAbCode=b;g.parseAbProps=c;g.maybeUpdatePropValues=e;g.maybeUpdateExpoKeys=f;g.maybeUpdateInternalExpoKeys=q}),98);
__d("WAAbProps",["WAAbPropsHelpers","err"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function i(a){if(h)return h;else throw c("err")("abProps::"+a+" called before startAbProps")}function a(a,b){h==null&&(h={config:b,db:a})}function b(){return i("getHash").db.getHash()}function e(){return i("getRefreshSecs").db.getRefreshSecs().then(function(a){return d("WAAbPropsHelpers").maybeUpdateRefresh(a)})}function f(){return i("getConfig").config}function j(){return i("getAbProps").db.getAbProps()}function k(a){return i("getAbProps").db.setAbProps(a)}g.startAbProps=a;g.getHash=b;g.getRefreshSecs=e;g.getConfig=f;g.getAbProps=j;g.setAbProps=k}),98);
__d("WAAppData",[],(function(a,b,c,d,e,f){"use strict";a=1;b=2;f.EPOCH_STATUS_OPEN=a;f.EPOCH_STATUS_CLOSE=b}),66);
__d("WAArmadilloICDC.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.name="ICDCIdentityList";a.internalSpec={seq:[1,(c=d("WAProtoConst")).TYPES.INT32],timestamp:[2,c.TYPES.INT64],devices:[3,c.FLAGS.REPEATED|c.TYPES.BYTES],signingDeviceIndex:[4,c.TYPES.INT32]};b.name="SignedICDCIdentityList";b.internalSpec={details:[1,c.TYPES.BYTES],signature:[2,c.TYPES.BYTES]};g.ICDCIdentityListSpec=a;g.SignedICDCIdentityListSpec=b}),98);
__d("WAArrayChunk",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c,d){c===void 0&&(c=!1);var e=0,f=[];while(e<a.length){var g=[],h=0;while(e<a.length){var i=a[e],j=d?d(i):1;if(!c&&h===0||h+j<=b)h+=j,g.push(i),e++;else{c&&j>b&&e++;break}}g.length>0&&f.push(g)}return f}f.chunk=a}),66);
__d("WACryptoPkcs7",["WACryptoDependencies","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=new Uint8Array(1);do d("WACryptoDependencies").getCrypto().getRandomValues(b);while(b[0]===0);h(a,b[0])}function b(a){var b=new Uint8Array(1);d("WACryptoDependencies").getCrypto().getRandomValues(b);h(a,(b[0]&15)+1)}function h(a,b){for(var c=0;c<b;c++)a.writeUint8(b)}function e(a){if(a.length===0)throw c("err")("unpadPkcs7 given empty bytes");var b=a[a.length-1];if(b>a.length)throw c("err")("unpadPkcs7 given "+a.length+" bytes, but pad is "+b);return new Uint8Array(a.buffer,a.byteOffset,a.length-b)}g.writeRandomPad=a;g.writeRandomPadMax16=b;g.writePad=h;g.unpadPkcs7=e}),98);
__d("WAMsgTransport.pb",["WACommon.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={NOOP:0,UPSERT:1,DELETE:2,UPSERT_AND_DELETE:3};b={};c={};e={};f={};var i={},j={},k={},l={},m={},n={},o={};b.name="MessageTransport";b.internalSpec={payload:[1,(h=d("WAProtoConst")).TYPES.MESSAGE,c],protocol:[2,h.TYPES.MESSAGE,e]};c.name="MessageTransport$Payload";c.internalSpec={applicationPayload:[1,h.TYPES.MESSAGE,d("WACommon.pb").SubProtocolSpec],futureProof:[3,h.TYPES.ENUM,d("WACommon.pb").FUTURE_PROOF_BEHAVIOR]};e.name="MessageTransport$Protocol";e.internalSpec={integral:[1,h.TYPES.MESSAGE,m],ancillary:[2,h.TYPES.MESSAGE,f]};f.name="MessageTransport$Protocol$Ancillary";f.internalSpec={skdm:[2,h.TYPES.MESSAGE,l],deviceListMetadata:[3,h.TYPES.MESSAGE,o],icdc:[4,h.TYPES.MESSAGE,j],backupDirective:[5,h.TYPES.MESSAGE,i]};i.name="MessageTransport$Protocol$Ancillary$BackupDirective";i.internalSpec={messageId:[1,h.TYPES.STRING],actionType:[2,h.TYPES.ENUM,a],supplementalKey:[3,h.TYPES.STRING]};j.name="MessageTransport$Protocol$Ancillary$ICDCParticipantDevices";j.internalSpec={senderIdentity:[1,h.TYPES.MESSAGE,k],recipientIdentities:[2,h.FLAGS.REPEATED|h.TYPES.MESSAGE,k],recipientUserJids:[3,h.FLAGS.REPEATED|h.TYPES.STRING]};k.name="MessageTransport$Protocol$Ancillary$ICDCParticipantDevices$ICDCIdentityListDescription";k.internalSpec={seq:[1,h.TYPES.INT32],signingDevice:[2,h.TYPES.BYTES],unknownDevices:[3,h.FLAGS.REPEATED|h.TYPES.BYTES],unknownDeviceIds:[4,h.FLAGS.REPEATED|h.TYPES.INT32]};l.name="MessageTransport$Protocol$Ancillary$SenderKeyDistributionMessage";l.internalSpec={groupId:[1,h.TYPES.STRING],axolotlSenderKeyDistributionMessage:[2,h.TYPES.BYTES]};m.name="MessageTransport$Protocol$Integral";m.internalSpec={padding:[1,h.TYPES.BYTES],dsm:[2,h.TYPES.MESSAGE,n]};n.name="MessageTransport$Protocol$Integral$DeviceSentMessage";n.internalSpec={destinationJid:[1,h.TYPES.STRING],phash:[2,h.TYPES.STRING]};o.name="DeviceListMetadata";o.internalSpec={senderKeyHash:[1,h.TYPES.BYTES],senderTimestamp:[2,h.TYPES.UINT64],recipientKeyHash:[8,h.TYPES.BYTES],recipientTimestamp:[9,h.TYPES.UINT64]};g.MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE=a;g.MessageTransportSpec=b;g.MessageTransport$PayloadSpec=c;g.MessageTransport$ProtocolSpec=e;g.MessageTransport$Protocol$AncillarySpec=f;g.MessageTransport$Protocol$Ancillary$BackupDirectiveSpec=i;g.MessageTransport$Protocol$Ancillary$ICDCParticipantDevicesSpec=j;g.MessageTransport$Protocol$Ancillary$ICDCParticipantDevices$ICDCIdentityListDescriptionSpec=k;g.MessageTransport$Protocol$Ancillary$SenderKeyDistributionMessageSpec=l;g.MessageTransport$Protocol$IntegralSpec=m;g.MessageTransport$Protocol$Integral$DeviceSentMessageSpec=n;g.DeviceListMetadataSpec=o}),98);
__d("WAAsMessageTransport",["WABinary","WACryptoPkcs7","WAJids","WAMsgTransport.pb"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.type){case"text":return{actionType:d("WAMsgTransport.pb").MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE.UPSERT,messageId:a.externalId,supplementalKey:null};case"media":return{actionType:d("WAMsgTransport.pb").MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE.UPSERT,messageId:a.externalId,supplementalKey:null};case"reaction":return{actionType:d("WAMsgTransport.pb").MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE.UPSERT,messageId:a.originalMsgExternalId,supplementalKey:"reaction:"+d("WAJids").extractChatId__DANGEROUS(a.chatJid)};case"edit":return{actionType:d("WAMsgTransport.pb").MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE.UPSERT,messageId:a.originalMsgExternalId,supplementalKey:"edit:"+d("WAJids").extractChatId__DANGEROUS(a.chatJid)+":"+(a.timestamp*1e3).toString()}}}function b(a,b,c,e,f,g){g===void 0&&(g=2);var h;b!=null&&(h={destinationJid:b});var i;a!=null&&(i={applicationPayload:{payload:a,version:g}});b=new(d("WABinary").Binary)();d("WACryptoPkcs7").writeRandomPadMax16(b);return{payload:i,protocol:{integral:{padding:b.readBuffer(),dsm:h},ancillary:{skdm:c==null?void 0:c,icdc:e==null?void 0:e,backupDirective:f==null?void 0:{actionType:f.actionType,messageId:f.messageId,supplementalKey:f.supplementalKey}}}}}g.backupDirectiveActionType=d("WAMsgTransport.pb").MESSAGE_TRANSPORT_PROTOCOL_ANCILLARY_BACKUP_DIRECTIVE_ACTION_TYPE;g.constructBackupDirective=a;g.asMessageTransport=b}),98);
__d("WABuildMpsPayload",["MpsFutureProofKey","MpsTypes","WAArmadilloBackupMessage.pb","WAArmadilloMiTransportAdminMessage.pb","WAArmadilloTransportEvent.pb","WAGlobals","WAJids","WALogger","WATimeUtils","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b){var c=d("WAJids").extractUserId(b.senderJid);d("MpsTypes").toThreadId(b.threadId);var e;b.hideDecryptionFailure!=null&&(e=b.hideDecryptionFailure?d("MpsFutureProofKey").WCEPlaintextPayloadFutureProof.WCEPlaintextPayloadFutureProofNoPlaceholder:d("MpsFutureProofKey").WCEPlaintextPayloadFutureProof.WCEPlaintextPayloadFutureProofPlaceholder);a=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,babelHelpers["extends"]({},a,{metadata:{frankingMetadata:{frankingTag:b.frankingTag,reportingTag:b.reportingTag},messageId:b.externalId,payloadVersion:2,senderId:c,futureProofBehavior:e,timestampMs:b.timestampMs}})).readBuffer();return a}function l(a,b){var c=d("WAJids").extractUserId(b.senderJid),e=d("MpsTypes").toThreadId(b.threadId),f=b.millisServerTs!=null?b.millisServerTs:b.serverTs*1e3+d("WAGlobals").getDependencies().extractMsFromStanzaId(b.externalId);a=k(a,{senderJid:b.senderJid,externalId:b.externalId,frankingTag:b.frankingTag,reportingTag:b.reportingTag,hideDecryptionFailure:b.hideDecryptionFailure,threadId:b.threadId,timestampMs:d("MpsTypes").toTimestamp(f)});return{messageId:d("MpsTypes").toMessageId(b.externalId),payload:d("MpsTypes").toBytes(a),senderId:c,threadId:e,timestampMs:d("MpsTypes").toTimestamp(f)}}function a(a,b,c){try{var e={};switch(c.type){case"message":e={encryptedTransportMessage:c.applicationPayload};break;case"ciphertext":e={encryptedTransportEvent:{payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloTransportEvent.pb").TransportEventSpec,{placeholder:{type:d("WAArmadilloTransportEvent.pb").TransportEvent$Placeholder$Type.DECRYPTION_FAILURE}}).readBuffer(),version:3}};break;case"unavailable":e={encryptedTransportEvent:{payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloTransportEvent.pb").TransportEventSpec,{placeholder:{type:d("WAArmadilloTransportEvent.pb").TransportEvent$Placeholder$Type.DECRYPTION_FAILURE}}).readBuffer(),version:3}};break;default:c.type}return l(e,{senderJid:d("WAJids").extractUserJid(b.from),externalId:a.stanzaId,serverTs:a.serverTs,frankingTag:a.frankingTag,reportingTag:a.reportingTag,hideDecryptionFailure:a.hideDecryptionFailure,threadId:b.chat})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["buildMpsMessagePayload: ",""])),a);return null}}function b(a,b,c){if(c.payload==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["buildMpsAppdataPayload: No appdata payload"])));return null}try{return l({encryptedTransportMessage:c.payload},{senderJid:d("WAJids").extractUserJid(a.from),externalId:a.stanzaId,serverTs:b,threadId:d("WAJids").extractUserJid(a.from)})}catch(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["buildMpsAppdataPayload: ",""])),a);return null}}function c(a,b,c,e,f){c={payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupMembershipAddModeChanged:{mode:c}}).readBuffer(),version:3};return l({miTransportAdminMessage:c},{serverTs:e!=null?e:d("WATimeUtils").unixTime(),externalId:f,hideDecryptionFailure:!1,senderJid:b,threadId:a})}function e(a,b,c,e,f,g){c={payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupAdminChanged:{targetUserId:c.map(d("WAJids").extractUserId),action:e}}).readBuffer(),version:3};return l({miTransportAdminMessage:c},{serverTs:f!=null?f:d("WATimeUtils").unixTime(),externalId:g,hideDecryptionFailure:!1,senderJid:b,threadId:a})}function f(a,b,c,e,f,g){c={payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupParticipantChanged:{targetUserId:c.map(d("WAJids").extractUserId),action:e}}).readBuffer(),version:3};return l({miTransportAdminMessage:c},{serverTs:f!=null?f:d("WATimeUtils").unixTime(),externalId:g,hideDecryptionFailure:!1,senderJid:b,threadId:a})}function m(a,b,c,e,f){c={payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloMiTransportAdminMessage.pb").MiTransportAdminMessageSpec,{groupNameChanged:{groupName:c}}).readBuffer(),version:3};return l({miTransportAdminMessage:c},{serverTs:e!=null?e:d("WATimeUtils").unixTime(),externalId:f,hideDecryptionFailure:!1,senderJid:b,threadId:a})}function n(a,b,c){var e={payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloTransportEvent.pb").TransportEventSpec,{event:{icdcAlert:{type:d("WAArmadilloTransportEvent.pb").TransportEvent$Event$IcdcAlert$Type.DETECTED}}}).readBuffer(),version:3};return l({encryptedTransportEvent:e},{serverTs:b!=null?b:d("WATimeUtils").unixTime(),externalId:c,hideDecryptionFailure:!1,senderJid:a,threadId:a})}function o(a,b,c,e,f,g){e={payload:d("encodeProtobuf").encodeProtobuf(d("WAArmadilloTransportEvent.pb").TransportEventSpec,{event:{deviceChange:{type:e,devicePlatform:f,deviceModel:g}}}).readBuffer(),version:3};return l({encryptedTransportEvent:e},{serverTs:b!=null?b:d("WATimeUtils").unixTime(),externalId:c,hideDecryptionFailure:!1,senderJid:a,threadId:a})}g.buildBackupProtobufBytes=k;g.buildMpsMessage=l;g.buildMpsMessageFromIncomingMessage=a;g.buildMpsAppdataPayload=b;g.buildMpsGroupMemberAddType=c;g.buildMpsGroupAdminChangedMsg=e;g.buildMpsGroupParticipantsChanged=f;g.buildMpsGroupNameChangedMsg=m;g.buildMpsIcdcAdminMessage=n;g.buildMpsDeviceChangeAdminMessage=o}),98);
__d("WAConvertRegistrationIdMixin",["WAParsableXmlNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("WAParsableXmlNode").convertBytesToUint(a.registrationElementValue,4)}g.registrationIdMixin=a}),98);
__d("WAConvertSignedPreKeyMixin",["WAParsableXmlNode"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{id:d("WAParsableXmlNode").convertBytesToUint(a.skeyIdKeyIDMixin.elementValue,3),pubkey:a.skeyValueKeyDataMixin.elementValue,signature:a.skeySignatureElementValue}}g.convertSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInPreKeysIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInPreKeysIQErrorFallbackClientMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",400,499);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackClientMixin=a}),98);
__d("WASmaxInPreKeysIQErrorNoValidJIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorNoValidJIDMixin=a}),98);
__d("WASmaxInPreKeysRequestErrorsFetch",["WAResultOrError","WASmaxInPreKeysIQErrorBadRequestMixin","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorNoValidJIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:b.value});var c=d("WASmaxInPreKeysIQErrorNoValidJIDMixin").parseIQErrorNoValidJIDMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorNoValidJID",value:c.value});var e=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorBadRequest","IQErrorNoValidJID","IQErrorFallbackClient"],[b,c,e])}g.parseRequestErrorsFetch=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetch","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetch").parseRequestErrorsFetch(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetch:b.value}))}g.parseFetchKeyBundlesResponseRequestError=a}),98);
__d("WASmaxInPreKeysIQErrorFallbackServerMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");if(!b.success)return b;a=d("WASmaxParseUtils").attrIntRange(a,"code",500,599);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorFallbackServerMixin=a}),98);
__d("WASmaxInPreKeysIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInPreKeysServerErrors",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackServerMixin","WASmaxInPreKeysIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:b.value});var c=d("WASmaxInPreKeysIQErrorFallbackServerMixin").parseIQErrorFallbackServerMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackServer",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorServiceUnavailable","IQErrorFallbackServer"],[b,c])}g.parseServerErrors=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchKeyBundlesResponseServerError=a}),98);
__d("WASmaxInPreKeysEnums",["WAJids"],(function(a,b,c,d,e,f,g){b={validators:[(a=d("WAJids")).validateDeviceJid,a.validateDeviceJid],typeName:"DeviceJid|DeviceJid"};c={validators:[a.validateDeviceJid,a.validateDeviceJid,a.validateInteropDeviceJid,a.validateInteropDeviceJid],typeName:"DeviceJid|DeviceJid|InteropDeviceJid|InteropDeviceJid"};e={validators:[a.validateDeviceJid,a.validateDomainJid],typeName:"DeviceJid|DomainJid"};f={validators:[a.validateUserJid,a.validateUserJid],typeName:"UserJid|UserJid"};g.DEVICEJID_DEVICEJID=b;g.DEVICEJID_DEVICEJID_INTEROPDEVICEJID_INTEROPDEVICEJID=c;g.DEVICEJID_DOMAINJID=e;g.USERJID_USERJID=f}),98);
__d("WASmaxInPreKeysIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInPreKeysResponsePaddingMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"iq");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"padding");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytesRange(b.value,0,524288);return!a.success?a:d("WAResultOrError").makeResult({paddingElementValue:a.value})}g.parseResponsePaddingMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").attrIntRange(b.value,"code",500,599);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchKeyBundlesUserErrorFallbackMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(b.value,"text");if(!a.success)return a;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,b.value,"code",500);return!b.success?b:d("WAResultOrError").makeResult({errorText:a.value,errorCode:b.value})}g.parseFetchKeyBundlesUserErrorMixin=a}),98);
__d("WASmaxInPreKeysDeviceIdentityMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"device-identity");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytes(a.value);return!a.success?a:d("WAResultOrError").makeResult({deviceIdentityElementValue:a.value})}g.parseDeviceIdentityMixin=a}),98);
__d("WASmaxInPreKeysKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInPreKeysIdentityKeyMixin",["WASmaxInPreKeysKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInPreKeysKeyTypeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"type");if(!a.success)return a;a=d("WASmaxParseUtils").contentLiteralBytes(a.value,new Uint8Array([5]));return!a.success?a:d("WAResultOrError").makeResult({typeElementValue:a.value})}g.parseKeyTypeMixin=a}),98);
__d("WASmaxInPreKeysKeyIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxParseUtils").contentBytesRange(a,3,3);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}g.parseKeyIDMixin=a}),98);
__d("WASmaxInPreKeysPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"key");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!a.success)return a;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;a=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:d("WAResultOrError").makeResult({keyIdKeyIDMixin:b.value,keyValueKeyDataMixin:a.value})}g.parsePreKeyMixin=a}),98);
__d("WASmaxInPreKeysRegistrationIDMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"registration");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,4,4);return!a.success?a:d("WAResultOrError").makeResult({registrationElementValue:a.value})}g.parseRegistrationIDMixin=a}),98);
__d("WASmaxInPreKeysSignedPreKeyMixin",["WAResultOrError","WASmaxInPreKeysKeyDataMixin","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"skey");if(!a.success)return a;var b=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"id");if(!b.success)return b;var c=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"value");if(!c.success)return c;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"signature");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,64,64);if(!a.success)return a;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(b.value);if(!b.success)return b;c=d("WASmaxInPreKeysKeyDataMixin").parseKeyDataMixin(c.value);return!c.success?c:d("WAResultOrError").makeResult({skeySignatureElementValue:a.value,skeyIdKeyIDMixin:b.value,skeyValueKeyDataMixin:c.value})}g.parseSignedPreKeyMixin=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin",["WAResultOrError","WASmaxInPreKeysDeviceIdentityMixin","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysPreKeyMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"t",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,a,"is_cloud_api","true");if(!c.success)return c;var e=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a),g=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!g.success)return g;var h=d("WASmaxInPreKeysPreKeyMixin").parsePreKeyMixin(a),i=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!i.success)return i;a=d("WASmaxInPreKeysDeviceIdentityMixin").parseDeviceIdentityMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({t:b.value,isCloudApi:c.value},e.value,{keyTypeMixin:f.success?f.value:null},g.value,{preKeyMixin:h.success?h.value:null},i.value,{deviceIdentityMixin:a.success?a.value:null}))}g.parseFetchKeyBundlesUserSuccessMixin=a}),98);
__d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup",["WAResultOrError","WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin","WASmaxInPreKeysFetchKeyBundlesUserErrorMixin","WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysFetchKeyBundlesUserSuccessMixin").parseFetchKeyBundlesUserSuccessMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserSuccess",value:b.value});var c=d("WASmaxInPreKeysFetchKeyBundlesUserErrorMixin").parseFetchKeyBundlesUserErrorMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserError",value:c.value});var e=d("WASmaxInPreKeysFetchKeyBundlesUserErrorFallbackMixin").parseFetchKeyBundlesUserErrorFallbackMixin(a);return e.success?d("WAResultOrError").makeResult({name:"FetchKeyBundlesUserErrorFallback",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UserSuccess","UserError","UserErrorFallback"],[b,c,e])}g.parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup=a}),98);
__d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess",["WAResultOrError","WASmaxInPreKeysEnums","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysResponsePaddingMixin","WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseJid").attrJidEnum(a,"jid",d("WASmaxInPreKeysEnums").DEVICEJID_DEVICEJID);if(!b.success)return b;a=d("WASmaxInPreKeysUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup").parseUserFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({jid:b.value,userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup:a.value})}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!c.success)return c;b=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!b.success)return b;a=d("WASmaxInPreKeysResponsePaddingMixin").parseResponsePaddingMixin(a);c=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"user",0,1e5,h);return!c.success?c:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{responsePaddingMixin:a.success?a.value:null,listUser:c.value}))}g.parseFetchKeyBundlesResponseSuccessListUser=h;g.parseFetchKeyBundlesResponseSuccess=a}),98);
__d("WASmaxAttrs",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b==null)return d("WAWap").DROP_ATTR;else return a(b)}function b(a,b){if(b)return a;else return d("WAWap").DROP_ATTR}g.OPTIONAL=a;g.OPTIONAL_LITERAL=b}),98);
__d("WASmaxChildren",["WADeepEquals"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(b==null)return null;else return a(b)}function b(a,b){if(b==null)return null;else if(b)return a()}function c(a,b){if(b)for(var c=1;c<b.length;c++)if(!d("WADeepEquals").deepEqual(b[c],b[0]))throw new Error("expected all homogeneous children to be equal, but they were not");c=h(a,b,0,Infinity);return c}function e(a,b){return i(a,b,0,Infinity)}function h(a,b,c,d){if(b==null){if(c>0)throw new Error("expected at least "+c+" children, but none provided");return[]}var e=b.length;if(e<c)throw new Error("expected at least "+c+" children, but found "+e);else if(e>d)throw new Error("expected at most "+d+" children, but found "+e);return b.map(function(b){return a(b)})}function i(a,b,c,d){if(b===0){if(c>0)throw new Error("expected at least "+c+" children, but none provided");return[]}if(b<c)throw new Error("expected at least "+c+" children, but found "+b);else if(b>d)throw new Error("expected at most "+d+" children, but found "+b);c=[];for(d=0;d<b;d++)c.push(a());return c}g.OPTIONAL_CHILD=a;g.HAS_OPTIONAL_CHILD=b;g.HOMOGENEOUS_CHILD=c;g.HOMOGENEOUS_CHILD_COUNT=e;g.REPEATED_CHILD=h;g.REPEATED_CHILD_COUNT=i}),98);
__d("WASmaxOutPreKeysClientRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),xmlns:"encrypt",to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientRequestMixin=a}),98);
__d("WASmaxOutPreKeysFetchKeyBundlesRequest",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.userJid;a=a.hasUserReasonIdentity;b=d("WASmaxJsx").smax("user",{jid:d("WAWap").JID(b),reason:d("WASmaxAttrs").OPTIONAL_LITERAL("identity",a)});return b}function a(a){a=a.userArgs;a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxJsx").smax("key",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,1e5))));return a}g.makeFetchKeyBundlesRequestKeyUser=h;g.makeFetchKeyBundlesRequest=a}),98);
__d("WASmaxParsingFailure",[],(function(a,b,c,d,e,f){"use strict";a=function(a){function b(b){var c;c=a.call(this,"SmaxParsingFailure: "+b)||this;c.name="SmaxParsingFailure";c.reason=b;return c}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.toString=function(){return"SmaxParsingFailure: "+this.reason};return b}(babelHelpers.wrapNativeSuper(Error));f.SmaxParsingFailure=a}),66);
__d("WASmaxRpcUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=Object.keys(b).map(function(a){var c=a==="Request"?"<request>":'<response name="'+a+'">';return"Tried "+c+", but failed with "+b[a].error+"."}).join(" ");return'Failed to parse incoming stanza of <rpc name="'+a+'">. '+c}f.errorMessageRpcParsing=a}),66);
__d("WASmaxPreKeysFetchKeyBundlesRPC",["WAComms","WASmaxInPreKeysFetchKeyBundlesResponseRequestError","WASmaxInPreKeysFetchKeyBundlesResponseServerError","WASmaxInPreKeysFetchKeyBundlesResponseSuccess","WASmaxOutPreKeysFetchKeyBundlesRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a,b){a=d("WASmaxOutPreKeysFetchKeyBundlesRequest").makeFetchKeyBundlesRequest(a);b=await d("WAComms").sendSmaxStanza(a,b);var c=d("WASmaxInPreKeysFetchKeyBundlesResponseSuccess").parseFetchKeyBundlesResponseSuccess(b,a);if(c.success)return{name:"FetchKeyBundlesResponseSuccess",value:c.value};var e=d("WASmaxInPreKeysFetchKeyBundlesResponseRequestError").parseFetchKeyBundlesResponseRequestError(b,a);if(e.success)return{name:"FetchKeyBundlesResponseRequestError",value:e.value};b=d("WASmaxInPreKeysFetchKeyBundlesResponseServerError").parseFetchKeyBundlesResponseServerError(b,a);if(b.success)return{name:"FetchKeyBundlesResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchKeyBundles",{Success:c,RequestError:e,ServerError:b}))}g.sendFetchKeyBundlesRPC=a}),98);
__d("WAFetchPreKeyBundlesProtocol",["WAConvertRegistrationIdMixin","WAConvertSignedPreKeyMixin","WAParsableXmlNode","WAResultOrError","WASignalKeys","WASmaxPreKeysFetchKeyBundlesRPC","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=d("WATagsLogger").TAGS(["fetchPreKeyBundlesProtocol"]);async function a(a){l.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start fetching prekey of ","..."])),a.join(", "));a=await d("WASmaxPreKeysFetchKeyBundlesRPC").sendFetchKeyBundlesRPC({userArgs:a.map(function(a){return{userJid:a,hasUserReasonIdentity:!1}})});switch(a.name){case"FetchKeyBundlesResponseSuccess":l.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetched prekey successfully"])));var b=new Map();a.value.listUser.map(function(a){var c=a.userFetchKeyBundlesSuccessOrFetchKeyBundlesErrorOrFetchKeyBundlesErrorFallbackMixinGroup;c.name==="FetchKeyBundlesUserSuccess"&&b.set(a.jid,m(c.value))});return d("WAResultOrError").makeResult(b);case"FetchKeyBundlesResponseServerError":var c=a.value.errorServerErrors.name;l.WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ServerError: ",""])),c);return d("WAResultOrError").makeError({type:"server-error",payload:c});case"FetchKeyBundlesResponseRequestError":c=a.value.errorRequestErrorsFetch.name;l.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["RequestError: ",""])),c);return d("WAResultOrError").makeError({type:"request-error",payload:c})}}function m(a){var b=d("WAConvertRegistrationIdMixin").registrationIdMixin(a),c=d("WASignalKeys").serializeIdentity(a.elementValue),e=d("WAConvertSignedPreKeyMixin").convertSignedPreKeyMixin(a),f=a.preKeyMixin?n(a.preKeyMixin):null;a=d("WATimeUtils").castToUnixTime(a.t||0);return{keys:{regId:b,identity:c,oneTimeKey:f,signedKey:{id:e.id,signature:e.signature,publicKey:d("WASignalKeys").serializeIdentity(e.pubkey)}},timestamp:a}}function n(a){return{id:d("WAParsableXmlNode").convertBytesToUint(a.keyIdKeyIDMixin.elementValue,3),publicKey:d("WASignalKeys").serializeIdentity(a.keyValueKeyDataMixin.elementValue)}}g.fetchPreKeyBundlesProtocol=a}),98);
__d("WABulkRequestKeys",["WAFetchPreKeyBundlesProtocol","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){a=await d("WAFetchPreKeyBundlesProtocol").fetchPreKeyBundlesProtocol(a);return!a.success?d("WAResultOrError").makeError("errRequestKeysParsingFailed"):d("WAResultOrError").makeResult(a.value)}g.bulkRequestKeys=a}),98);
__d("WALock",["Promise","WAResolvable","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return{lock:function(c,e){var f=new(d("WAResolvable").Resolvable)(),g=c.map(function(a){return[a,new(d("WAResolvable").Resolvable)()]});(i||(i=b("Promise"))).all(g.map(function(b){var c=b[0],d=b[1];return a.enqueue(c,function(){d.resolve();return f.promise})}))["catch"](function(){d("WATagsLogger").TAGS(["WALock"]).ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Lock failed for ",""])),c)});return i.all(g.map(function(a){a[0];a=a[1];return a.promise})).then(function(){return e()})["finally"](function(){f.resolve()})},wait:function(b){return a.wait(b)}}}g.makeLock=a}),98);
__d("WALockMap",["WALock","WAPromiseQueue"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a===void 0&&(a=-1);a=new(d("WAPromiseQueue").PromiseQueueMap)(a);return d("WALock").makeLock(a)}g.makeLockMap=a}),98);
__d("WACryptoLibraryConfig",[],(function(a,b,c,d,e,f){"use strict";var g={signalFutureMessagesMax:2e3,S508658PreventOldSessionLookupAndPromote:!1,S508658AutoAcknowledgeStaleSessions:!1};function a(){return g}function b(a){g=a}f.getCryptoLibraryConfig=a;f.setCryptoLibraryConfig=b}),66);
__d("WASignalSessions",["WABinary","WACryptoLibraryConfig","WASignalKeys","WASignalOther","err"],(function(a,b,c,d,e,f,g){"use strict";var h=3;function a(a){if(!d("WACryptoLibraryConfig").getCryptoLibraryConfig().S508658AutoAcknowledgeStaleSessions)return a;return a.initialExchangeInfo==null?a:o(a.local,a.remote,a.rootKey,a.recvChains,a.sendChain,null,a.prevSendChainHighestIndex,a.prevSessions,a.aliceBaseKey)}function b(a,b){return i(a,0,b,[])}function i(a,b,c,d){return{ratchetPubKey:a,nextMsgIndex:b,chainKey:c,unusedMsgKeys:d}}function e(a,b){return j(a,0,b)}function j(a,b,c){return{ratchetKey:a,nextMsgIndex:b,chainKey:c}}function k(a,b,c){return{remoteOneTimeId:a,remoteSignedId:b,localOneTimePubKey:c}}function f(a,b){return o(a.local,a.remote,a.rootKey,a.recvChains,a.sendChain,a.initialExchangeInfo,a.prevSendChainHighestIndex,b,a.aliceBaseKey)}function l(a,b,c){return o(a.local,a.remote,a.rootKey,b,c,a.initialExchangeInfo,a.prevSendChainHighestIndex,a.prevSessions,a.aliceBaseKey)}function m(a,b,c,d){c===void 0&&(c=a.sendChain);return o(a.local,a.remote,d,b,c,null,Math.max(a.sendChain.nextMsgIndex-1,0),a.prevSessions,a.aliceBaseKey)}function n(a,b,c,d,e,f,g){return o(a,b,c,d,e,f,0,[],g)}function o(a,b,c,d,e,f,g,h,i){return{local:a,remote:b,rootKey:c,sendChain:e,recvChains:d,initialExchangeInfo:f,prevSendChainHighestIndex:g,prevSessions:h,aliceBaseKey:i}}function p(a,b){b=new(d("WABinary").Binary)(b);var c=d("WASignalOther").readBytes(b,32),e=d("WASignalOther").readBytes(b,32);b=d("WASignalOther").readBytes(b,16);return q(a,c,e,b)}function q(a,b,c,d){return{index:a,cipherKey:b,macKey:c,iv:d}}function r(a){return{senderRatchetKey:a.ratchetPubKey,chainKey:{index:a.nextMsgIndex,key:a.chainKey},messageKeys:a.unusedMsgKeys}}function s(a){var b=a.ratchetKey;return{senderRatchetKey:b.serializedPubKey,senderRatchetKeyPrivate:b.privateKey,chainKey:{index:a.nextMsgIndex,key:a.chainKey}}}function t(a){var b=a.local,c=a.remote,d=a.initialExchangeInfo,e=void 0;if(d){var f=d.remoteOneTimeId;e={preKeyId:f!=null?f:void 0,signedPreKeyId:d.remoteSignedId,baseKey:d.localOneTimePubKey}}return{currentSession:{sessionVersion:h,localIdentityPublic:b.pubKey,remoteIdentityPublic:c.pubKey,rootKey:a.rootKey,previousCounter:a.prevSendChainHighestIndex,senderChain:s(a.sendChain),receiverChains:a.recvChains.map(r),pendingPreKey:e,remoteRegistrationId:c.regId,localRegistrationId:b.regId,aliceBaseKey:a.aliceBaseKey},previousSessions:a.prevSessions}}function u(a){var b=a.local,c=a.remote,e=a.sendChain,f=a.initialExchangeInfo,g=void 0;if(f){var i=f.remoteOneTimeId;g={preKeyId:i!=null?i:void 0,signedPreKeyId:f.remoteSignedId,baseKey:d("WASignalOther").toBuffer(f.localOneTimePubKey)}}return{sessionVersion:h,localIdentityPublic:d("WASignalOther").toBuffer(b.pubKey),remoteIdentityPublic:d("WASignalOther").toBuffer(c.pubKey),rootKey:d("WASignalOther").toBuffer(a.rootKey),previousCounter:a.prevSendChainHighestIndex,senderChain:{senderRatchetKey:d("WASignalOther").toBuffer(e.ratchetKey.serializedPubKey),senderRatchetKeyPrivate:d("WASignalOther").toBuffer(e.ratchetKey.privateKey),chainKey:{index:e.nextMsgIndex,key:d("WASignalOther").toBuffer(e.chainKey)},messageKeys:[]},receiverChains:a.recvChains.map(function(a){return{senderRatchetKey:d("WASignalOther").toBuffer(a.ratchetPubKey),chainKey:{index:a.nextMsgIndex,key:d("WASignalOther").toBuffer(a.chainKey)},messageKeys:a.unusedMsgKeys.map(function(a){return{index:a.index,cipherKey:d("WASignalOther").toBuffer(a.cipherKey),macKey:d("WASignalOther").toBuffer(a.macKey),iv:d("WASignalOther").toBuffer(a.iv)}})}}),pendingPreKey:g,remoteRegistrationId:c.regId,localRegistrationId:b.regId,aliceBaseKey:a.aliceBaseKey==null?void 0:d("WASignalOther").toBuffer(a.aliceBaseKey)}}function v(a){var b=B(a.currentSession,"currentSession");return x(b,a.previousSessions)}function w(a){return x(a,[])}function x(a,b){var e=B(a.sessionVersion,"sessionVersion");if(e!==h)throw c("err")("Signal: bad session version "+e);e=B(a.senderChain,"senderChain");var f=B(e.chainKey,"senderChain.chainKey");e=j(d("WASignalKeys").makeSerializedKeyPairFrom(A(e.senderRatchetKeyPrivate,32,"senderRatchetKeyPrivate"),z(e.senderRatchetKey,"senderRatchetKey")),B(f.index,"senderChain.chainKey.index"),A(f.key,32,"senderChain.chainKey.key"));f=B(a.receiverChains,"receiverChains").map(function(a){var b=B(a.chainKey,"receiverChains[].chainKey");return i(z(a.senderRatchetKey,"receiverChains[].senderRatchetKey"),B(b.index,"receiverChains[].chainKey.index"),A(b.key,32,"receiverChains[].chainKey.key"),y(a.messageKeys))});var g={regId:d("WASignalOther").castRegistrationId(B(a.localRegistrationId,"localRegistrationId")),pubKey:z(a.localIdentityPublic,"localIdentityPublic")},l={regId:d("WASignalOther").castRegistrationId(B(a.remoteRegistrationId,"remoteRegistrationId")),pubKey:z(a.remoteIdentityPublic,"remoteIdentityPublic")},m=a.pendingPreKey,n=null;if(m){var p=m.preKeyId;n=k(p!=null?d("WASignalKeys").castToPreKeyId(p):null,d("WASignalKeys").castToSignedPreKeyId(B(m.signedPreKeyId,"pendingPreKey.signedPreKeyId")),z(m.baseKey,"pendingPreKey.baseKey"))}p=a.aliceBaseKey==null?null:z(a.aliceBaseKey,"aliceBaseKey");return o(g,l,A(a.rootKey,32,"rootKey"),f,e,n,a.previousCounter||0,b,p)}function y(a){return a.map(function(a){return{index:B(a.index,"messageKeys[].index"),cipherKey:A(a.cipherKey,32,"messageKeys[].cipherKey"),macKey:A(a.macKey,32,"messageKeys[].macKey"),iv:A(a.iv,16,"messageKeys[].iv")}})}function z(a,b){return d("WASignalKeys").castToSerializedPubKey(new Uint8Array(B(a,b)))}function A(a,b,c){return d("WASignalOther").toBytes(B(a,c),b)}function B(a,b){if(a==null)throw c("err")("Signal: protobuf is missing "+b);return a}g.FORMAT_VERSION=h;g.maybeClearPendingPreKey=a;g.makeFreshRecvChain=b;g.makeRecvChain=i;g.makeFreshSendChain=e;g.makeSendChain=j;g.makeInitialExchangeInfo=k;g.setPrevSessions=f;g.updateChains=l;g.ratchetSession=m;g.makeFreshSession=n;g.makeSession=o;g.splitMsgKey=p;g.serializeSession=t;g.detachSession=u;g.parseSessionFromRecord=v;g.parseSession=w;g._parseSession=x;g.bytesOrThrow=A;g.definedOrThrow=B}),98);
__d("WASignalWhisperTextProtocol.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={};a.internalSpec={ratchetKey:[1,(d=d("WAProtoConst")).TYPES.BYTES],counter:[2,d.TYPES.UINT32],previousCounter:[3,d.TYPES.UINT32],ciphertext:[4,d.TYPES.BYTES]};b.internalSpec={registrationId:[5,d.TYPES.UINT32],preKeyId:[1,d.TYPES.UINT32],signedPreKeyId:[6,d.TYPES.UINT32],baseKey:[2,d.TYPES.BYTES],identityKey:[3,d.TYPES.BYTES],message:[4,d.TYPES.BYTES]};c.internalSpec={id:[1,d.TYPES.UINT32],baseKey:[2,d.TYPES.BYTES],ratchetKey:[3,d.TYPES.BYTES],identityKey:[4,d.TYPES.BYTES],baseKeySignature:[5,d.TYPES.BYTES]};e.internalSpec={id:[1,d.TYPES.UINT32],iteration:[2,d.TYPES.UINT32],ciphertext:[3,d.TYPES.BYTES]};f.internalSpec={id:[1,d.TYPES.UINT32],iteration:[2,d.TYPES.UINT32],chainKey:[3,d.TYPES.BYTES],signingKey:[4,d.TYPES.BYTES]};h.internalSpec={generation:[1,d.TYPES.UINT32],signature:[2,d.TYPES.BYTES]};g.SignalMessageSpec=a;g.PreKeySignalMessageSpec=b;g.KeyExchangeMessageSpec=c;g.SenderKeyMessageSpec=e;g.SenderKeyDistributionMessageSpec=f;g.DeviceConsistencyCodeMessageSpec=h}),98);
__d("WASignalGroupSession",["WASignalKeys","WASignalSessions"],(function(a,b,c,d,e,f,g){"use strict";var h=5,i=3;function j(a){var b=d("WASignalSessions").definedOrThrow(a.senderSigningKey,"senderSigningKey"),c=d("WASignalSessions").definedOrThrow(a.senderMessageKeys,"senderMessageKeys"),e=d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey");return{senderSigningKeyPublic:r(b["public"],"public"),senderSigningKeyPrivate:b["private"]?d("WASignalSessions").bytesOrThrow(b["private"],32,"private"):void 0,senderKeyId:d("WASignalSessions").definedOrThrow(a.senderKeyId,"senderKeyId"),unusedMsgKeys:c.map(function(a){return k(d("WASignalSessions").definedOrThrow(a.iteration,"iteration"),d("WASignalSessions").bytesOrThrow(a.seed,50,"seed"))}),senderKeyChainKey:l(d("WASignalSessions").definedOrThrow(e.iteration,"iteration"),d("WASignalSessions").bytesOrThrow(e.seed,32,"seed"))}}function a(a,b,c,d,e){return{senderSigningKeyPublic:a,senderSigningKeyPrivate:b,senderKeyChainKey:c,senderKeyId:d,unusedMsgKeys:e==null?[]:e}}function b(a,b){var c=a.senderKeyStates.findIndex(function(a){return a.senderKeyId===b.senderKeyId});return{senderKeyStates:a.senderKeyStates.map(function(a,d){return d===c?b:a})}}function c(a,b){a=a.senderKeyStates.slice(a.senderKeyStates.length>h-1?1:0);a.push(b);return{senderKeyStates:a}}function e(a){return{senderKeyStates:[a]}}function k(a,b){return{iteration:a,seed:b}}function l(a,b){return{nextMsgIndex:a,chainKey:b}}function f(a){a=d("WASignalSessions").definedOrThrow(a.senderKeyStates,"senderKeyStates");return m(a)}function m(a){return n(a)}function n(a){a=a.map(function(a){return j(a)});return{senderKeyStates:a}}function o(a,b){var c=a.senderKeyStates.findIndex(function(a){return a.senderKeyId===b});return c===-1?void 0:a.senderKeyStates[c]}function p(a){return{senderKeyStates:a.senderKeyStates.map(function(a){return q(a)})}}function q(a){return{senderKeyId:a.senderKeyId,senderChainKey:{iteration:a.senderKeyChainKey.nextMsgIndex,seed:a.senderKeyChainKey.chainKey},senderSigningKey:{"public":a.senderSigningKeyPublic,"private":a.senderSigningKeyPrivate},senderMessageKeys:a.unusedMsgKeys.map(function(a){var b=a.iteration;a=a.seed;return{iteration:b,seed:a}})}}function r(a,b){return d("WASignalKeys").castToSerializedPubKey(new Uint8Array(d("WASignalSessions").definedOrThrow(a,b)))}function s(a){return a}g.FORMAT_VERSION=i;g.makeSenderKeyState=a;g.updateSessionWithUpdatedSenderKeyState=b;g.updateSessionWithNewSenderKeyState=c;g.makeNewSenderKeySession=e;g.makeSenderKeyMsgKey=k;g.makeSenderKeyChainKey=l;g.parseSessionFromRecord=f;g._parseSession=m;g.makeSenderKeySessionFromRecord=n;g.findSenderKeyState=o;g.serializeSession=p;g.serializeSenderKeyState=q;g.convertFromRawToSenderKeyState=s}),98);
__d("WASignalWhitepaper",["WABinary","WACryptoDependencies","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions"],(function(a,b,c,d,e,f,g){"use strict";var h=new Uint8Array(32);h.fill(255);var i=new Uint8Array([1]),j=new Uint8Array([2]);async function a(a,b,c){var e,f=a.regId;a=a.staticKeyPair;var g=b.identity,i=b.signedKey.publicKey,j=c.privateKey,k=a.privateKey;e=(e=b.oneTimeKey)==null?void 0:e.publicKey;k=d("WABinary").Binary.build(h,n(k,i),n(j,g),n(j,i),e&&n(j,e)).readByteArrayView();i=await m(k,"WhisperText");j=i[0];e=i[1];k=b.ratchetKey;i=d("WASignalSessions").makeFreshRecvChain(k,e);e=d("WASignalKeys").makeSerializedKeyPair();j=await l(j,e,k);k=d("WASignalSessions").makeInitialExchangeInfo(b.oneTimeKey==null?null:b.oneTimeKey.id,b.signedKey.id,d("WASignalKeys").serializePubKey(c));return d("WASignalSessions").makeFreshSession({regId:f,pubKey:d("WASignalKeys").serializePubKey(a)},{regId:b.regId,pubKey:g},j.rootKey,[i],d("WASignalSessions").makeFreshSendChain(e,j.chainKey),k,d("WASignalKeys").serializePubKey(c))}async function b(a,b,c,e){var f,g=a.regId;a=a.staticKeyPair;var i=a.privateKey,j=e.signed.privateKey,k=c,l=b.pubKey;f=(f=e.oneTime)==null?void 0:f.privateKey;l=d("WABinary").Binary.build(h,o(l,j),o(k,i),o(k,j),f&&o(k,f)).readByteArrayView();i=await m(l,"WhisperText");j=i[0];k=i[1];f=e.ratchet;l=d("WASignalSessions").makeFreshSendChain(f,k);return d("WASignalSessions").makeSession({regId:g,pubKey:d("WASignalKeys").serializePubKey(a)},b,j,[],l,null,0,[],c)}function c(a){a=d("WASignalGroupSession").makeSenderKeyState(d("WASignalKeys").serializePubKey(a),a.privateKey,d("WASignalGroupSession").makeSenderKeyChainKey(0,d("WASignalKeys").makeRawSenderKey()),d("WASignalOther").makeSenderKeyId(),[]);return Promise.resolve(d("WASignalGroupSession").makeNewSenderKeySession(a))}function e(a,b,c,e,f){c=d("WASignalGroupSession").makeSenderKeyState(c,void 0,d("WASignalGroupSession").makeSenderKeyChainKey(b,e),a,[]);f?b=d("WASignalGroupSession").updateSessionWithNewSenderKeyState(f,c):b=d("WASignalGroupSession").makeNewSenderKeySession(c);return Promise.resolve(b)}async function f(a,b){var c=await d("WASignalOther").makeCryptoKey(b,"hmac-sha256");b=function(a){return d("WACryptoDependencies").getCrypto().subtle.sign({name:"HMAC",hash:"SHA-256"},c,a)};var e=b(i).then(function(a){return d("WASignalOther").hkdf(new Uint8Array(a),null,"WhisperMessageKeys",80)}).then(function(b){return d("WASignalSessions").splitMsgKey(a,b)});b=b(j).then(function(a){return d("WASignalOther").toBytes(a,32)});return Promise.all([b,e])}async function k(a,b){var c=await d("WASignalOther").makeCryptoKey(b,"hmac-sha256");b=function(a){return d("WACryptoDependencies").getCrypto().subtle.sign({name:"HMAC",hash:"SHA-256"},c,a)};var e=b(i).then(function(a){return d("WASignalOther").hkdf(new Uint8Array(a),null,"WhisperGroup",50)}).then(function(b){return d("WASignalGroupSession").makeSenderKeyMsgKey(a,b)});b=b(j).then(function(a){return d("WASignalOther").toBytes(a,32)});return Promise.all([b,e])}async function l(a,b,c){b=b.privateKey;c=c;b=d("WASignalKeys").ecdh(b,c);c=await m(new Uint8Array(b),"WhisperRatchet",a);b=c[0];a=c[1];return{rootKey:b,chainKey:a}}async function m(a,b,c){c===void 0&&(c=null);a=await d("WASignalOther").hkdf(a,c,b,64);return[d("WASignalOther").sliceBytes(a,0,32),d("WASignalOther").sliceBytes(a,32,32)]}function n(a,b){return new Uint8Array(d("WASignalKeys").ecdh(a,b))}function o(a,b){return n(b,a)}g.initiateSessionOutgoing=a;g.initiateSessionIncoming=b;g.initiateSenderKeySessionOutgoing=c;g.initiateSenderKeySessionIncoming=e;g.deriveMsgKey=f;g.deriveSenderKeyMsgKey=k;g.calculateRatchet=l}),98);
__d("WASignalCipher",["WABinary","WACryptoDependencies","WACryptoLibraryConfig","WACryptoUtils","WALogger","WAResultOrError","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WASignalWhitepaper","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=40,l=8,m=2e3;async function a(a,b){var c=a.sendChain,e=await d("WASignalWhitepaper").deriveMsgKey(c.nextMsgIndex,c.chainKey),f=e[0];e=e[1];var g=await u(e),h=g.cipherKey;g=g.macKey;h=await d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-CBC",iv:e.iv},h,b);b=new(d("WABinary").Binary)();b.writeByteArray(a.local.pubKey);b.writeByteArray(a.remote.pubKey);var i=b.size();b.writeUint8(r(d("WASignalSessions").FORMAT_VERSION,d("WASignalSessions").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SignalMessageSpec,{ratchetKey:c.ratchetKey.serializedPubKey,counter:e.index,previousCounter:a.prevSendChainHighestIndex,ciphertext:h},b);h=b.readByteArrayView();b=await t(g,h);g=h.subarray(i);h=d("WABinary").Binary.build(g,new Uint8Array(b,0,l)).readByteArrayView();i=a.initialExchangeInfo;if(i!=null){g=new(d("WABinary").Binary)();g.writeUint8(r(d("WASignalSessions").FORMAT_VERSION,d("WASignalSessions").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,{registrationId:a.local.regId,preKeyId:(b=i.remoteOneTimeId)!=null?b:void 0,signedPreKeyId:i.remoteSignedId,baseKey:i.localOneTimePubKey,identityKey:a.local.pubKey,message:h},g);b="pkmsg";i=g.readByteArrayView()}else b="msg",i=h;g=d("WASignalSessions").makeSendChain(c.ratchetKey,e.index+1,f);h=d("WASignalSessions").updateChains(a,a.recvChains,g);return[h,{type:b,ciphertext:i}]}async function b(a,b){if(a==null)return d("WAResultOrError").makeError("errSignalNoSession");var c=await o(a,b);if(c.success){var e=c.value,f=e[0];e=e[1];return d("WAResultOrError").makeResult({newSessionInfo:null,updatedSession:f,plaintext:e})}else{f=a.prevSessions;e=c;for(c=0;!e.success&&c<f.length;c++){var g=d("WASignalSessions").maybeClearPendingPreKey(d("WASignalSessions").parseSession(f[c])),h=await o(g,b);if(h.success){h=h.value;var i=h[0];h=h[1];i=d("WASignalSessions").setPrevSessions(i,[d("WASignalSessions").detachSession(a)].concat(f.slice(0,c),f.slice(c+1)));var j=!a||!d("WACryptoUtils").serializedPubKeysEqual(i.remote.pubKey,a.remote.pubKey)?i.remote.pubKey:null;e=d("WAResultOrError").makeResult({newSessionInfo:{newIdentity:j,baseSession:g,usedPreKey:null},updatedSession:i,plaintext:h})}}return e}}function c(a,b){if(a==null)return d("WAResultOrError").makeResult(null);a=a;if(v(a,b))return d("WAResultOrError").makeResult(a);var c=a.prevSessions;for(var e=0;e<c.length;e++){var f=d("WASignalSessions").parseSession(c[e]);if(v(f,b))return d("WACryptoLibraryConfig").getCryptoLibraryConfig().S508658PreventOldSessionLookupAndPromote===!0?d("WAResultOrError").makeError("errSignalInvalidMsg"):d("WAResultOrError").makeResult(d("WASignalSessions").setPrevSessions(f,[d("WASignalSessions").detachSession(a)].concat(c.slice(0,e),c.slice(e+1))))}return d("WAResultOrError").makeResult(null)}async function e(a,b,c,e){var f=e.localSignedPreKey;if(f==null)return d("WAResultOrError").makeError("errSignalInvalidSignedPreKey");f=d("WASignalSignatures").deserializeSignedPreKey(f);if(f==null)return d("WAResultOrError").makeError("errSignalSignedPreKeyDeserialization");if(f.id!==c.localSignedPreKeyId)return d("WAResultOrError").makeError("errSignalSignedPreKeyIdMismatch");var g=null;if(c.localOneTimeKeyId!=null){e=e.localOneTimeKey;if(e==null)return d("WAResultOrError").makeError("errSignalInvalidOneTimeKey");g=d("WASignalKeys").deserializePreKey(e);if(g==null)return d("WAResultOrError").makeError("errSignalOneTimeKeyDeserialization");if(g.id!==c.localOneTimeKeyId)return d("WAResultOrError").makeError("errSignalOneTimeKeyMismatch")}a=await d("WASignalWhitepaper").initiateSessionIncoming(a,c.remote,c.sessionBaseKey,{signed:f.keyPair,oneTime:(e=g)==null?void 0:e.keyPair,ratchet:d("WASignalKeys").toSerializedKeyPair(f.keyPair)});g=a.remote.pubKey;e=!b||!d("WACryptoUtils").serializedPubKeysEqual(g,b.remote.pubKey)?g:null;b&&!e&&(a=d("WASignalSessions").setPrevSessions(a,[d("WASignalSessions").detachSession(b)].concat(b.prevSessions.slice(0,k-1))));f=await o(a,c);if(!f.success)return f;g=f.value;b=g[0];c=g[1];return d("WAResultOrError").makeResult({newIdentity:e,baseSession:a,updatedSession:b,plaintext:c})}function n(a){var b,c,e=null;try{var f=q(a,d("WASignalSessions").FORMAT_VERSION,l);if(!f.success)return f;f=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SignalMessageSpec,f.value);var g=f.ratchetKey;e=f.counter;c=f.ciphertext;if(g==null||e==null||c==null)return d("WAResultOrError").makeError("errSignalDeserializeInvalidProtoFormat");b=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(g))}catch(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["deserializeMsg error ",""])),a);return d("WAResultOrError").makeError("errSignalDeserializeRatchetKeyBadFormat")}f={ratchetPubKey:b,counter:e,ciphertext:new Uint8Array(c),versionContentMac:a};return d("WAResultOrError").makeResult(f)}function f(a){a=q(a,d("WASignalSessions").FORMAT_VERSION,0);if(!a.success)return a;var b,c,e,f,g;try{a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").PreKeySignalMessageSpec,a.value);var h=a.registrationId,j=a.preKeyId,k=a.signedPreKeyId,l=a.baseKey,m=a.identityKey;a=a.message;if(h==null||k==null||l==null||m==null||a==null)return d("WAResultOrError").makeError("errSignalDeserializePkInvalidProtoFormat");f=d("WASignalKeys").castToSerializedPubKey(new Uint8Array(l));b={regId:d("WASignalOther").castRegistrationId(h),pubKey:d("WASignalKeys").castToSerializedPubKey(new Uint8Array(m))};e=j!=null?d("WASignalKeys").castToPreKeyId(j):null;c=d("WASignalKeys").castToSignedPreKeyId(k);g=new Uint8Array(a)}catch(a){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["deserializePkMsg error ",""])),a);return d("WAResultOrError").makeError("errSignalDeserializePkKeyBadFormat")}l=n(g);return!l.success?l:d("WAResultOrError").makeResult(babelHelpers.extends({},l.value,{remote:b,sessionBaseKey:f,localSignedPreKeyId:c,localOneTimeKeyId:e}))}async function o(a,b){var c=b.ratchetPubKey,e=b.counter,f=b.ciphertext;b=b.versionContentMac;var g=a.recvChains,h=a.recvChains.findIndex(function(a){return d("WACryptoUtils").serializedPubKeysEqual(a.ratchetPubKey,c)});if(h===-1){var i=await d("WASignalWhitepaper").calculateRatchet(a.rootKey,a.sendChain.ratchetKey,c),k=d("WASignalSessions").makeFreshRecvChain(c,i.chainKey);k=await p(k,e);if(!k.success)return k;k=k.value;var m=d("WASignalKeys").makeSerializedKeyPair();i=await d("WASignalWhitepaper").calculateRatchet(i.rootKey,m,c);var n=g.slice(-4);n.push(k.updatedChain);k=k.msgKey;n=d("WASignalSessions").ratchetSession(a,n,d("WASignalSessions").makeFreshSendChain(m,i.chainKey),i.rootKey)}else{m=await p(g[h],e);if(!m.success)return m;i=m.value;e=g.slice();e[h]=i.updatedChain;k=i.msgKey;n=d("WASignalSessions").updateChains(a,e,a.sendChain)}m=await u(k);g=m.cipherKey;i=m.macKey;e=d("WABinary").Binary.build(a.remote.pubKey,a.local.pubKey,b.subarray(0,-l)).readByteArrayView();m=await t(i,e);a=b.subarray(-l);i=!d("WACryptoUtils").uint8ArraysEqual(new Uint8Array(m,0,l),a);e=null;try{e=await d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-CBC",iv:k.iv},g,f)}catch(a){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["decryptMsgFromSession error ",""])),a)}if(i&&e==null)return h===-1?d("WAResultOrError").makeError("errInvalidMacInvalidCipherKeyNewChain"):d("WAResultOrError").makeError("errInvalidMacInvalidCipherKey");if(i)return d("WAResultOrError").makeError("errInvalidMacWithDecryptedPlaintext");return e==null?d("WAResultOrError").makeError("errUnknownInvalidCipherKey"):d("WAResultOrError").makeResult([n,e])}async function p(a,b){var c=b-a.nextMsgIndex,e=d("WACryptoLibraryConfig").getCryptoLibraryConfig().signalFutureMessagesMax;if(c>e)return d("WAResultOrError").makeError("errSignalTooManyMessagesInFuture");e=a.unusedMsgKeys;if(c<0){var f=e.findIndex(function(a){return a.index===b});return f===-1?d("WAResultOrError").makeError("errDuplicateMsg"):d("WAResultOrError").makeResult({msgKey:e[f],updatedChain:d("WASignalSessions").makeRecvChain(a.ratchetPubKey,a.nextMsgIndex,a.chainKey,s(e,f))})}f=a.nextMsgIndex;var g=await d("WASignalWhitepaper").deriveMsgKey(f,a.chainKey),h=g[0];g=g[1];var i=null;if(c>0){c=c+e.length-m;c>0?(i=e.slice(c),c-=e.length):i=e.slice();for(f=f+1;f<=b;f++){c>0?c--:i.push(g);var j=await d("WASignalWhitepaper").deriveMsgKey(f,h);h=j[0];g=j[1]}}return d("WAResultOrError").makeResult({msgKey:g,updatedChain:d("WASignalSessions").makeRecvChain(a.ratchetPubKey,b+1,h,i||e)})}function q(a,b,c){if(a.length<1)return d("WAResultOrError").makeError("errSignalEmptyVersionContentSuffix");var e=a[0]>>>4;if(e!==b)return e<b?d("WAResultOrError").makeError("errSignalLegacyMsg"):d("WAResultOrError").makeError("errSignalInvalidVersion");e=a.length-c;return e<1?d("WAResultOrError").makeError("errSignalContentExceededExpectedLength"):d("WAResultOrError").makeResult(a.subarray(1,e))}function r(a,b){return(a<<4|b)&255}function s(a,b){var c=[];for(var d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c}function t(a,b){return d("WACryptoDependencies").getCrypto().subtle.sign(d("WASignalOther").HMAC_SHA256,a,b)}function u(a){return Promise.all([d("WASignalOther").makeCryptoKey(a.cipherKey,"aes-cbc"),d("WASignalOther").makeCryptoKey(a.macKey,"hmac-sha256")]).then(function(a){var b=a[0];a=a[1];return{cipherKey:b,macKey:a}})}function v(a,b){a=a.aliceBaseKey;return!a?!1:d("WACryptoUtils").serializedPubKeysEqual(a,b)}g.MAX_UNUSED_KEYS=m;g.encryptMsg=a;g.decryptMsg=b;g.findMatchingSession=c;g.decryptPkMsgWithNewSession=e;g.deserializeMsg=n;g.deserializePkMsg=f;g.decryptMsgFromSession=o;g.readContent=q;g.versionByte=r}),98);
__d("WASignalGroupCipher",["WABinary","WACryptoDependencies","WACryptoLibraryConfig","WALogger","WAResultOrError","WASignalCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSessions","WASignalSignatures","WASignalWhisperTextProtocol.pb","WASignalWhitepaper","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=64;async function a(a,b){a=k(a);if(!a.success)return a;a=a.value;var c=a.senderKeyId,e=a.iteration,f=a.signingKeyPublic;a=a.chainKey;c=await d("WASignalWhitepaper").initiateSenderKeySessionIncoming(c,e,f,a,b);return d("WAResultOrError").makeResult(c)}function b(a){a=d("WASignalGroupSession").serializeSenderKeyState(a);var b=new(d("WABinary").Binary)();b.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyDistributionMessageSpec,{id:a.senderKeyId,iteration:d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey").iteration,chainKey:d("WASignalSessions").definedOrThrow(a.senderChainKey,"senderChainKey").seed,signingKey:d("WASignalSessions").definedOrThrow(a.senderSigningKey,"senderSigningKey").public},b);return b.readByteArrayView()}async function c(a,b){if(!a.senderKeyStates||a.senderKeyStates.length===0)return d("WAResultOrError").makeError("errSignalNoSession");var c=a.senderKeyStates[a.senderKeyStates.length-1],e=await d("WASignalWhitepaper").deriveSenderKeyMsgKey(c.senderKeyChainKey.nextMsgIndex,c.senderKeyChainKey.chainKey),f=e[0];e=e[1];var g=await l(e.seed),h=g[0];g=g[1];g=await d("WACryptoDependencies").getCrypto().subtle.encrypt({name:"AES-CBC",iv:g},h,b);h=new(d("WABinary").Binary)();d("encodeProtobuf").encodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyMessageSpec,{id:c.senderKeyId,iteration:e.iteration,ciphertext:g},h);b=new(d("WABinary").Binary)();b.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));b.writeBinary(h);g=d("WASignalKeys").makeKeyPairFromSerialized(d("WASignalSessions").definedOrThrow(c.senderSigningKeyPrivate,"senderSigningKeyPrivate"),c.senderSigningKeyPublic);g=d("WASignalSignatures").signSenderKeyMessage(g,b.readByteArrayView());b=new(d("WABinary").Binary)();b.writeUint8(d("WASignalCipher").versionByte(d("WASignalGroupSession").FORMAT_VERSION,d("WASignalGroupSession").FORMAT_VERSION));b.writeBinary(h);b.writeByteArray(g);h=d("WASignalGroupSession").makeSenderKeyChainKey(e.iteration+1,f);g=d("WASignalGroupSession").updateSessionWithUpdatedSenderKeyState(a,d("WASignalGroupSession").makeSenderKeyState(c.senderSigningKeyPublic,c.senderSigningKeyPrivate,h,c.senderKeyId,c.unusedMsgKeys));return d("WAResultOrError").makeResult([g,b.readByteArrayView()])}async function e(a,b){var c=b.senderKeyMessageId,e=b.iteration,f=b.ciphertext;b=b.versionContentMac;c=d("WASignalGroupSession").findSenderKeyState(a,c);if(c==null)return d("WAResultOrError").makeError("errSignalNoSession");var g=c.senderSigningKeyPublic;b=m(b,g);if(!b)return d("WAResultOrError").makeError("errSignalInvalidKey");g=await n(c,e);if(!g.success)return g;b=g.value;c=b.msgKey;e=d("WASignalGroupSession").updateSessionWithUpdatedSenderKeyState(a,b.updatedSenderKeyState);g=await l(c.seed);a=g[0];b=g[1];c=await d("WACryptoDependencies").getCrypto().subtle.decrypt({name:"AES-CBC",iv:b},a,f);return d("WAResultOrError").makeResult([e,c])}function k(a){var b,c,e,f;try{a=d("WASignalCipher").readContent(a,d("WASignalGroupSession").FORMAT_VERSION,0);if(!a.success)return a;a=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyDistributionMessageSpec,a.value);b=a.id;c=a.iteration;var g=d("WASignalSessions").bytesOrThrow(a.signingKey,33,"signingKey");e=d("WASignalKeys").castToSerializedPubKey(g);f=d("WASignalSessions").bytesOrThrow(a.chainKey,32,"chainKey");if(b==null||c==null)return d("WAResultOrError").makeError("errSignalGrpInvalidProtoFormat")}catch(a){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["deserializeSenderKeyDistributionMsg error ",""])),a);return d("WAResultOrError").makeError("errSignalGrpInvalidKeyFormat")}return d("WAResultOrError").makeResult({senderKeyId:b,iteration:c,signingKeyPublic:e,chainKey:f})}function f(a){if(a.length<1)return d("WAResultOrError").makeError("errSignalGrpVersionContentEmpty");var b=a[0]>>>4;if(b!==d("WASignalGroupSession").FORMAT_VERSION)return b<d("WASignalGroupSession").FORMAT_VERSION?d("WAResultOrError").makeError("errSignalLegacyMsg"):d("WAResultOrError").makeError("errSignalInvalidVersion");if(a.length<1+j)return d("WAResultOrError").makeError("errSignalGrpInvalidVersionContentLength");var c,e,f;try{b=a.subarray(1,-j);b=d("decodeProtobuf").decodeProtobuf(d("WASignalWhisperTextProtocol.pb").SenderKeyMessageSpec,b);c=b.id;e=b.iteration;f=b.ciphertext;if(c==null||e==null||f==null)return d("WAResultOrError").makeError("errSignalGrpSenderKeyInvalidProtoFormat")}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Exception caught during SenderKeyMessageSpec Proto: ",""])),a);return d("WAResultOrError").makeError("errSignalGrpSenderKeyProtoError")}return d("WAResultOrError").makeResult({senderKeyMessageId:c,iteration:e,ciphertext:new Uint8Array(f),versionContentMac:a})}async function l(a){a=new(d("WABinary").Binary)(a);var b=d("WASignalOther").readBytes(a,16);a=d("WASignalOther").readBytes(a,32);return[await d("WASignalOther").makeCryptoKey(a,"aes-cbc"),b]}function m(a,b){var c=a.subarray(a.length-j);a=a.subarray(0,a.length-j);return d("WASignalSignatures").verifyMsgSignalVariant(b,a,d("WASignalOther").toBytes(d("WASignalOther").toBuffer(c),64))}async function n(a,b){var c=a,e=b-c.senderKeyChainKey.nextMsgIndex,f=d("WACryptoLibraryConfig").getCryptoLibraryConfig().signalFutureMessagesMax;if(e>f)return d("WAResultOrError").makeError("errSignalGrpTooManyMessagesInFuture");f=a.unusedMsgKeys||[];if(e<0){var g=f.findIndex(function(a){return a.iteration===b});return g===-1?d("WAResultOrError").makeError("errDuplicateMsg"):d("WAResultOrError").makeResult({msgKey:f[g],updatedSenderKeyState:d("WASignalGroupSession").makeSenderKeyState(c.senderSigningKeyPublic,c.senderSigningKeyPrivate,c.senderKeyChainKey,c.senderKeyId,o(f,g))})}g=c.senderKeyChainKey.nextMsgIndex;var h=await d("WASignalWhitepaper").deriveSenderKeyMsgKey(g,c.senderKeyChainKey.chainKey),i=h[0];h=h[1];var j=null;if(e>0){e=e+f.length-d("WASignalCipher").MAX_UNUSED_KEYS;e>0?(j=f.slice(e),e-=f.length):j=f.slice();for(g=g+1;g<=b;g++){e>0?e--:j.push(h);var k=await d("WASignalWhitepaper").deriveSenderKeyMsgKey(g,i);i=k[0];h=k[1]}}return d("WAResultOrError").makeResult({msgKey:h,updatedSenderKeyState:d("WASignalGroupSession").makeSenderKeyState(c.senderSigningKeyPublic,c.senderSigningKeyPrivate,d("WASignalGroupSession").makeSenderKeyChainKey(b+1,i),a.senderKeyId,j||f)})}function o(a,b){var c=[];for(var d=0;d<a.length;d++)d!==b&&c.push(a[d]);return c}g.processSenderKeyDistributionMsg=a;g.createSenderKeyDistributionProto=b;g.encryptSenderKeyMsgWithSession=c;g.decryptSenderKeyMsgFromSession=e;g.deserializeSenderKeyMsg=f}),98);
__d("WACryptoLibrary",["WACryptoUtils","WAJids","WALockMap","WALogger","WAResultOrError","WASignalCipher","WASignalGroupCipher","WASignalGroupSession","WASignalKeys","WASignalOther","WASignalSignatures","WASignalWhitepaper"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WALockMap").makeLockMap(60*1e3),k=[],l=300;function m(a){k.push(a),k.length>=l&&k.shift()}function a(a){a(k),k=[]}async function n(a,b){m("createOutgoingSession");b=t(b);var c=b.signedKey;c=await d("WASignalSignatures").verifyMsgSignalVariant(b.identity,c.publicKey,c.signature);d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getSessionForRecipient pkmsg signature verification result: ",""])),c);if(!c){m("createOutgoingSession: errSignalInvalidKey");return d("WAResultOrError").makeError("errSignalInvalidKey")}c=await d("WASignalWhitepaper").initiateSessionOutgoing(a,b,d("WASignalKeys").makeKeyPair());return d("WAResultOrError").makeResult(c)}async function b(a,b,c,d,e){a=a.handleNewSession;m("establishOutgoingSession");b=await n(b,d);if(!b.success)return b;d=b.value;return a(c,d,d.remote.pubKey,null,e)}function c(a,b,c,e){var f=a.loadSession,g=a.handleNewSession;m("encryptContent");return j.lock([d("WAJids").extractUserJid(b)],async function(){var a=null;do{var h=await f(b,"cryptoLibraryEncryptContent");if(h==null){m("encryptContent: errSignalInvalidKey");return d("WAResultOrError").makeError("errSignalInvalidKey")}if(e!=null&&!d("WACryptoUtils").uint8ArraysEqual(e,h.remote.pubKey)){m("encryptContent: identity-mismatch");return d("WAResultOrError").makeError("identity-mismatch")}h=await d("WASignalCipher").encryptMsg(h,c);var i=h[0];h=h[1];var j=await g(b,i,i.remote.pubKey);j.success?a=d("WAResultOrError").makeResult(babelHelpers.extends({},h,{baseKey:i.aliceBaseKey})):j.error}while(a==null);return a})}function e(a,b,c,e,f){var g=a.loadSession,h=a.handleNewSession,i=a.loadSignedPreKey,k=a.loadOneTimePreKey;m("decryptContent");return j.lock([d("WAJids").extractUserJid(c)],async function(){var a=!1,j=await g(c,"decryptContent");if(e.type==="pkmsg"){var l=d("WASignalCipher").deserializePkMsg(e.ciphertext);if(!l.success){m("decryptContent: errCryptoDeserialization");return d("WAResultOrError").makeError("errCryptoDeserialization")}l=l.value;l=await o({loadSignedPreKey:i,loadOneTimePreKey:k},b,l,j);if(!l.success)return l;l=l.value}else{e.type;var n=d("WASignalCipher").deserializeMsg(e.ciphertext);if(!n.success){m("decryptContent: errCryptoDeserialization");return d("WAResultOrError").makeError("errCryptoDeserialization")}n=n.value;j=await d("WASignalCipher").decryptMsg(j,n);if(!j.success)return j;l=j.value}n=l;j=n.newSessionInfo;j&&(j.newIdentity!=null||j.usedPreKey!=null)&&await h(c,j.baseSession,j.newIdentity,j.usedPreKey);if(!a){n=j==null?void 0:j.baseSession.remote.pubKey;await f(new Uint8Array(l.plaintext),n);a=!0}await h(c,l.updatedSession,l.updatedSession.remote.pubKey);return d("WAResultOrError").makeResult()})}async function o(a,b,c,e){var f=a.loadSignedPreKey;a=a.loadOneTimePreKey;m("decryptPkMsg");var g=d("WASignalCipher").findMatchingSession(e,c.sessionBaseKey);if(!g.success)return g;g=g.value;if(g){g=await d("WASignalCipher").decryptMsgFromSession(g,c);if(!g.success)return g;g=g.value;var h=g[0];g=g[1];return d("WAResultOrError").makeResult({newSessionInfo:null,updatedSession:h,plaintext:g})}else{h=c.localOneTimeKeyId;g=await f(c.localSignedPreKeyId);f=h==null?null:await a(h);a=await d("WASignalCipher").decryptPkMsgWithNewSession(b,e,c,{localSignedPreKey:g,localOneTimeKey:f});if(!a.success)return a;b=a.value;e=b.newIdentity;c=b.baseSession;g=b.updatedSession;f=b.plaintext;return d("WAResultOrError").makeResult({newSessionInfo:{newIdentity:e,baseSession:c,usedPreKey:h},updatedSession:g,plaintext:f})}}function f(b,c,e,f){var g=b.loadSenderKeySession,a=b.saveSenderKeySession;m("encryptGroupContent");return j.lock([c,d("WAJids").extractUserJid(e)],async function(){do{var b=await g(c,e);if(!b.success)return d("WAResultOrError").makeError(b.error);b=b.value;var h=await d("WASignalGroupCipher").encryptSenderKeyMsgWithSession(b,f);if(h.success){h=h.value;var i=h[0];h=h[1];await a(c,e,i);i=b.senderKeyStates[b.senderKeyStates.length-1];b=d("WAResultOrError").makeResult({ciphertext:{ciphertext:h,type:"skmsg"},senderKeyId:i.senderKeyId,senderKeyDistributionProto:d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(i))})}else{m("encryptGroupContent: sender-key-no-session");return d("WAResultOrError").makeError("sender-key-no-session")}}while(b==null);return b})}function p(b,c,e,f,g){var h=b.loadSenderKeySession,a=b.saveSenderKeySession;m("decryptGroupContent");return j.lock([c,d("WAJids").extractUserJid(e)],async function(){var b=!1,j=await h(c,e);if(!j.success){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[WACryptoLibrary] Unable to load sender key session for group during decryptGroupContent: ",", author: ",""])),c,e);return d("WAResultOrError").makeError(j.error)}var k=d("WASignalGroupCipher").deserializeSenderKeyMsg(f);if(!k.success){m("decryptGroupContent: errCryptoDeserialization");return d("WAResultOrError").makeError("errCryptoDeserialization")}j=j.value;j=await d("WASignalGroupCipher").decryptSenderKeyMsgFromSession(j,k.value);if(!j.success)return j;k=j.value;j=k[0];k=k[1];b||(await g(new Uint8Array(k)),b=!0);await a(c,e,j);return d("WAResultOrError").makeResult()})}function q(b,c,e,f){var g=b.loadSenderKeySession,a=b.saveSenderKeySession;m("saveSenderKeySession");return j.lock([c,d("WAJids").extractUserJid(e)],async function(){var b=null;if(g){var h=await g(c,e);b=h.success?h.value:null}h=await d("WASignalGroupCipher").processSenderKeyDistributionMsg(f,b);if(!h.success)return h;b=h.value;await a(c,e,b);return d("WAResultOrError").makeResult()})}function r(b,c,e,f){var a=b.saveSenderKeySession;m("rotateGroupSenderKey");return j.lock([c,d("WAJids").extractUserJid(e)],async function(){var b=await d("WASignalWhitepaper").initiateSenderKeySessionOutgoing(f),g=b.senderKeyStates[0].senderKeyId;await a(c,e,b);return{senderKeyId:g}})}async function s(a,b,c){var e=a.loadSenderKeySession;a=a.saveSenderKeySession;m("createSenderKeyDistributionMsg");var f=await e(b,c),g=f.error;if(!f.success&&g==="errLoadSenderKeySession"){g=await d("WASignalKeys").makeKeyPair();await r({saveSenderKeySession:a},b,c,g);f=await e(b,c)}if(f.success){a=f.value.senderKeyStates.slice(-1);if(a.length>0)return d("WAResultOrError").makeResult(d("WASignalGroupCipher").createSenderKeyDistributionProto(d("WASignalGroupSession").convertFromRawToSenderKeyState(a[0])))}m("createSenderKeyDistributionMsg: errGetSenderKeyProto");return d("WAResultOrError").makeError("errGetSenderKeyProto")}function t(a){var b=a.regId,c=a.identity,e=a.signedKey;a=a.oneTimeKey;m("sanitizeInitialSessionInfo");var f=d("WASignalKeys").castToSerializedPubKey(e.publicKey);return{regId:d("WASignalOther").castRegistrationId(b),identity:d("WASignalKeys").castToSerializedPubKey(c),signedKey:{id:d("WASignalKeys").castToSignedPreKeyId(e.id),publicKey:f,signature:d("WASignalOther").ensureSize(e.signature,64)},oneTimeKey:a&&{id:d("WASignalKeys").castToPreKeyId(a.id),publicKey:d("WASignalKeys").castToSerializedPubKey(a.publicKey)},ratchetKey:f}}g.publishLogs=a;g.createOutgoingSession=n;g.establishOutgoingSession=b;g.encryptContent=c;g.decryptContent=e;g.encryptGroupContent=f;g.decryptGroupContent=p;g.saveSenderKeySession=q;g.rotateGroupSenderKey=r;g.createSenderKeyDistributionMsg=s}),98);
__d("WACryptoManager",["WABridge","WACryptoLibrary","WACryptoUtils","WAGlobals","WAJids","WALogger","WALoggerTag","WANullthrows","WAOdsEnums","WAPromiseQueue","WAResultOrError","WASignalCipher","WASignalGroupSession","WASignalKeys","WASignalLocalStorageProtocol.pb","WASignalOther","WASignalSessions","WASignalSignatures","WATagsLogger","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t=d("WATagsLogger").TAGS([c("WALoggerTag").CryptoManager]),u={type:"default"};function a(a){return{flush:function(){return a.storage.savePendingToDatabase().then(function(){})}}}function b(a){return{regInfo:a.regInfo,network:a.network,storage:a.storage}}async function v(a,b,c,e,f){e=await e(b,f);if(e!=null&&c.type!=="requestNewSession"){f=e;if(c.type==="default")return d("WAResultOrError").makeResult(f);else if(f.aliceBaseKey!=null&&c.session.baseKey!=null){c.type;if(!d("WACryptoUtils").uint8ArraysEqual(c.session.baseKey,f.aliceBaseKey))return d("WAResultOrError").makeResult(f)}}if(c.type==="useSession")e=c.session.keys;else{c.type;f=await a.network.requestKeys(b);if(!f.success)return f;e=f.value.keys;c.type==="compareTSAndUseSession"&&c.session.timestamp>=f.value.timestamp&&(e=c.session.keys)}b=await d("WACryptoLibrary").createOutgoingSession(a.regInfo,e);return!b.success?b:d("WAResultOrError").makeResult(b.value)}function e(a,b,c,e){return d("WACryptoLibrary").establishOutgoingSession({handleNewSession:a.storage.handleNewSession},a.regInfo,b,c,e)}async function w(a,b){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Establish outgoing sessions"])));var c=await a.storage.loadSessions(b);b=b.filter(function(a){return!c.has(a)});if(b.length===0){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[sessions] No need to establish outgoing sessions"])));return c}d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Missing sessions: ",". Requesting keys"])),b.length);b=await a.network.bulkRequestKeys(b);if(!b.success){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[sessions] fail during key requesting"])));return c}if(d("WAGlobals").getConfig().useLongSessionDrop())for(var e of c.entries()){var f=e[0],g=e[1];g.sendChain.nextMsgIndex>=d("WAGlobals").getConfig().sessionDropIfTooOld()&&(d("WALogger").DEV(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Removing session "," due to ratchet key"])),f),c.delete(f),d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.WA_LONG_SESSION_DROP,key:"decryption"}))}g=b.value;d("WALogger").DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Received keys ",""])),g.size);var o=new(d("WAPromiseQueue").PromiseQueue)();g.forEach(function(e,b){o.enqueue(function(){return d("WACryptoLibrary").createOutgoingSession(a.regInfo,e.keys).then(function(a){a.success===!1?d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[sessions] Failed to create a session"]))):c.set(b,a.value)})})});await o.wait();return c}async function f(a,b){var e=Array.from(b.keys());d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] sendWrittenMsg bulkEncryptContent"])));e=await w(a,e);var f=new Map();d("WALogger").DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] start encryption"])));return Promise.all(Array.from(e.entries()).map(async function(e){var g=e[0];e=e[1];e=await d("WASignalCipher").encryptMsg(e,c("WANullthrows")((e=b.get(g))==null?void 0:e.plaintext));var h=e[0];e=e[1];f.set(g,babelHelpers.extends({},e,{baseKey:null}));return a.storage.handleNewSession(g,h,h.remote.pubKey)})).then(function(){return d("WAResultOrError").makeResult(f)})}function x(a,b,c,e,f){return d("WACryptoLibrary").encryptContent({loadSession:function(b){return v(a,b,e,a.storage.loadSession,"cryptoManagerEncryptContent").then(function(a){if(a.success===!0)return a.value;else return null})},handleNewSession:a.storage.handleNewSession},b,c,f)}function y(a,b,c,e){return d("WACryptoLibrary").decryptContent({loadSession:a.storage.loadSession,handleNewSession:a.storage.handleNewSession,loadSignedPreKey:a.storage.loadSignedPreKey,loadOneTimePreKey:a.storage.loadOneTimePreKey},a.regInfo,b,c,e)}async function z(a,b){a=await a.storage.loadSession(b,"getParticipantInfo");return a==null?void 0:a.remote}async function A(a){var b,e=await a.storage.getLastPreKeyGenerationId();b=((b=e==null?void 0:e.lastPreKeyId)!=null?b:0)+1;b=d("WASignalKeys").makePreKeys(b,1)[0];a=await a.storage.saveOneTimePreKey({keyId:b.plainObject.id,encoded:b.record});if(a.success)return b.plainObject;throw c("err")("Cannot save one time prekey: "+a.error+", LastPreKeyId: "+((b=e==null?void 0:e.lastPreKeyId)!=null?b:0))}async function B(a,b){b===void 0&&(b=d("WAGlobals").getConfig().maxPrekeysToUpload());var c=await a.storage.getLastPreKeyGenerationId();c=d("WASignalKeys").makePreKeys(((c=c==null?void 0:c.lastPreKeyId)!=null?c:0)+1,b);return a.storage.savePreKeysGeneration(c.map(function(a){var b=a.plainObject;a=a.record;return{keyId:b.id,encoded:a}}))}function C(a){return a.storage.loadLatestSignedPreKey().then(function(b){if(b.success===!1){var e,f,g;t.TAGS([c("WALoggerTag").SignedPrekey]).ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate signed prekey ",""])),b==null||(e=b.payload)==null?void 0:e.toString());throw c("err")("Failed to generate signed prekey: "+((f=b==null||(g=b.payload)==null?void 0:g.message)!=null?f:""))}f=b.value;f=d("WASignalSignatures").deserializeSignedPreKey(f);if(f==null){t.TAGS([c("WALoggerTag").SignedPrekey]).ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize signed prekey: ",""])),b);throw c("err")("failed to deserialize signed prekey")}return D(a,f.id+1)})}function D(a,b){var e=d("WASignalSignatures").makeSignedPreKey(b,d("WATimeUtils").unixTimeMs(),a.regInfo.staticKeyPair);b=d("WASignalSignatures").serializeSignedPreKeyForPrivateStorage(e);return a.storage.saveSignedPreKeyIfNew(e.id,b).then(function(a){if(a.type==="success")return d("WAResultOrError").makeResult(e);else{a.type;return d("WAResultOrError").makeResult(a.key)}}).then(function(a){if(!a.success){var b,d;t.TAGS([c("WALoggerTag").SignedPrekey]).ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate signed prekey with id: ",""])),a);throw c("err")("Unexpected error when generateSignedPreKeyWithId: "+((b=a==null||(d=a.payload)==null?void 0:d.message)!=null?b:a.error))}return a.value})}function E(a,b,c,e){return d("WACryptoLibrary").encryptGroupContent({loadSenderKeySession:a.storage.loadSenderKeySession,saveSenderKeySession:a.storage.saveSenderKeySession},b,c,e)}function F(a,b,c,e,f){return d("WACryptoLibrary").decryptGroupContent({loadSenderKeySession:a.storage.loadSenderKeySession,saveSenderKeySession:a.storage.saveSenderKeySession},b,c,e,f)}function G(a,b,c,e){return d("WACryptoLibrary").saveSenderKeySession({saveSenderKeySession:a.storage.saveSenderKeySession},b,c,e)}async function H(a,b,c){var e=await A(a);return d("WACryptoLibrary").rotateGroupSenderKey({saveSenderKeySession:a.storage.saveSenderKeySession},b,c,e.keyPair)}function I(a){return Promise.resolve().then(function(){return{regId:d("WASignalOther").makeRegistrationId(a),staticKeyPair:d("WASignalKeys").makeKeyPair(),authKeyPair:d("WASignalKeys").makeKeyPair()}})}function J(a){return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").RecordStructureSpec,d("WASignalSessions").serializeSession(a))}function K(a){return d("WASignalOther").decodeSignalProto(d("WASignalLocalStorageProtocol.pb").RecordStructureSpec,a,d("WASignalSessions").parseSessionFromRecord)}function L(a){return d("WASignalOther").encodeSignalProto(d("WASignalLocalStorageProtocol.pb").SenderKeyRecordStructureSpec,d("WASignalGroupSession").serializeSession(a))}function M(a){return d("WASignalOther").decodeSignalProto(d("WASignalLocalStorageProtocol.pb").SenderKeyRecordStructureSpec,a,d("WASignalGroupSession").parseSessionFromRecord)}function N(a){return a}function O(a,b){return a+"|"+b}function P(a){a=a.split("|");if(a.length!==2)throw c("err")("Incorrect ComplexSenderKey");return{groupId:d("WAJids").unsafeCoerceToGroupJid(a[0]),deviceId:d("WAJids").unsafeCoerceToDeviceJid(a[1])}}g.DEFAULT_SESSION_REQUEST=u;g.cryptoManagerFlushable=a;g.initCryptoManager=b;g.getSessionForRecipient=v;g.establishOutgoingSession=e;g.ensureSessionsExists=w;g.bulkEncryptContent=f;g.encryptContent=x;g.decryptContent=y;g.getParticipantInfo=z;g.generateOneTimePreKey=A;g.generatePreKeys=B;g.generateSignedPreKey=C;g.generateSignedPreKeyWithId=D;g.encryptGroupContent=E;g.decryptGroupContent=F;g.saveSenderKeySession=G;g.rotateGroupSenderKey=H;g.generateRegistrationInfo=I;g.encodeSession=J;g.decodeSession=K;g.encodeSenderKeySession=L;g.decodeSenderKeySession=M;g.castToPreKeyGenerationId=N;g.encodeSenderKey=O;g.decodeSenderKey=P}),98);
__d("WADbSignal",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}function b(a,b,c){return a+"_"+b+"_"+c}c={abProps:"abProps",authKeyPair:"authKeyPair",cat:"cat",certificateChain:"certificateChain",clockSkew:"clockSkew",deviceId:"deviceId",deviceUUID:"deviceUUID",edgeInfo:"edgeInfo",fbid:"fbid",identityKeyPair:"identityKeyPair",lastPrekeyGenerationId:"lastPrekeyGenerationId",lastPrekeyId:"lastPrekeyId",lastSessionDeviceWasLinkedTo:"lastSessionDeviceWasLinkedTo",lastSignedPrekeyId:"lastSignedPrekeyId",regId:"regId",registrationVersion:"registrationVersion",deviceRegUnixTime:"deviceRegUnixTime"};({msgrDeviceId:"msgrDeviceId"});d={registrationHistory:"registrationHistory"};f.unsafeCoerceToSenderKeySessionId=a;f.buildSenderKeySessionId=b;f.MetaKeysEnum=c;f.PlainTextMetaKeysEnum=d}),66);
__d("WAHandleFailureUtils",["FBLogger","ODS","WABridge","WAOdsEnums","getErrorSafe","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("MAWClearSignalAndTempStores").__setRef("WAHandleFailureUtils");e={GENERIC_FAILURE:"400",NOT_AUTHORIZED:"401",TEMP_BANNED:"402",BANNED:"403",CAT_EXPIRED:"413",CAT_INVALID:"414",NOT_FOUND:"415",CAT_SESSION_INVALID:"418",INTERNAL_ERROR:"500",SERVER_UNAVAILABLE:"503"};function j(){return new Promise(function(a,b){i.onReady(function(d){c("promiseDone")(d.clearSignalAndTempStores(),function(){return a()},function(a){a=c("getErrorSafe")(a);c("FBLogger")("wmi").catching(a).mustfix("Failed to clear signal and temp stores");b(a)})})})}function a(){return j().then(function(){d("WABridge").getBridge().fireAndForget("event","logout",{})})}async function b(){await j(),(h||(h=d("ODS"))).bumpEntityKey(3185,d("WAOdsEnums").Entity.WA_REREGISTRATION,"reregister_phone"),d("WABridge").getBridge().fireAndForget("event","reregisterDevice",{})}g.FAILURE_CODES=e;g.clearRegistrationAndTempData=j;g.deregisterPhone=a;g.reregisterPhone=b}),98);
__d("WASignalDB",["BrowserLockManager","QPLFlow","WAHandleFailureUtils","WAHex","WAIDBTypes","WALogger","WAResolvable","Worm","WormEAR","WormIDbDriver","WormIDbUtils","err","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i={identity:{primaryKey:"deviceJid",indexes:{userJid:{fields:["userJid"],unique:!1}}},contacts:{primaryKey:"contactJid",indexes:{}},session:{indexes:{},primaryKey:"id"},senderKeySessions:{primaryKey:"id",indexes:{groupJid:{fields:["groupJid"],unique:!1},userJid:{fields:["userJid"],unique:!1}}},prekey:{indexes:{},primaryKey:"keyId"},prekeyGeneration:{indexes:{},primaryKey:"generationId"},signedPrekey:{indexes:{},primaryKey:"keyId"},meta:{indexes:{},primaryKey:"key"},plaintextMeta:{indexes:{},primaryKey:"key",secure:!1},icdcFails:{indexes:{},primaryKey:"contactJid"},personalSenderKeyStatuses:{indexes:{},primaryKey:"groupJid"}},j,k=new(d("WAResolvable").Resolvable)();async function a(a,b,e,f,g,m){var n=m!=null?d("QPLFlow").startQPLFlow(m,{timeoutInMs:c("justknobx")._("3415"),annotations:{string:{operationType:"initDb"}}}):null;try{await l(async function(){var c=d("WAHex").parseHex(b),h="signalDb";c=new(d("WormEAR").WormEAR)(i,h,c);h=new(d("Worm").WormDatabase)(new(d("WormIDbDriver").WormIDbDriver)(a,h,i,c,g,{blockingErrorThreshold:e,onBlockingError:f,safeToDeleteStores:new Set(["stanzaQueue","danglingQueue","migration"]),onTransactionError:function(b){if(b instanceof d("WormEAR").DecryptionError){b=b;if(b.store==="icdcFails")return;void d("WormIDbUtils").promisifyIDbRequest(d("WAIDBTypes").idb().deleteDatabase(a)).then(function(){return d("WAHandleFailureUtils").reregisterPhone()})}}}),m);j=h;await h.init({eventFlow:n});k.resolve(h);n==null||n.endSuccess()})}catch(a){n==null||n.endFail("error");d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[WORM] Error performing initDb: ",""])),a);throw a}}function b(){if(j==null)throw c("err")("Signal Db v3 is not initialized");return j}function e(){return k.promise}function f(a){return"Signal - "+a}function l(a){return c("BrowserLockManager")!=null?c("BrowserLockManager").request("wajs_make_signal_v3_db",a):a()}g.makeSignalDb=a;g.getDb=b;g.getDbPromise=e;g.signalOp=f}),98);
__d("WABulkSaveSignalDataApi",["WACryptoManager","WADbSignal","WAJids","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a){var b=a.dhashUpdate,c=a.icdcUpdate,e=a.identityRemove,f=a.identityUpdate,g=a.preKeyRemove,j=a.senderKeySessionUpdate,k=a.sessionRemove,l=a.sessionUpdate,m=a.lastSyncTsUpdate,n=l.map(function(a){var b=a.id;a=a.updated;return{id:b,session:d("WACryptoManager").encodeSession(a)}}),o=[];j.forEach(function(a){var b=a.author,c=a.groupId;a=a.updated;var e=d("WAJids").extractUserJid(b);b=d("WAJids").extractDeviceId(b);var f=d("WADbSignal").buildSenderKeySessionId(c,e,b);o.push({deviceId:b,groupJid:c,id:f,record:d("WACryptoManager").encodeSenderKeySession(a),userJid:e})});await d("WASignalDB").getDb().runInTransaction(["contacts","identity","prekey","senderKeySessions","session"],"readwrite",function(a){var d=a.stores,j=d.session,l=d.identity,p=d.senderKeySessions;d=d.prekey;return Promise.all([j.bulkDelete(k),l.bulkDelete(e),j.bulkPut(n),p.bulkPut(o),i(a.stores,f),h(a.stores,c,f,b,m),d.bulkDelete(g.map(function(a){a=a.id;return a}))])},d("WASignalDB").signalOp("bulkSaveSignalData"))};async function h(a,b,c,e,f){var g=new Set();for(c of c)g.add(d("WAJids").extractUserJid(c.id));c=Array.from(g);for(var h of b)g.add(h.id);h=await a.contacts.bulkGet(Array.from(g));g=new Map();for(h of h){if(h==null)continue;g.set(h.contactJid,h)}for(h of c){c=g.get(h);c==null?(c={contactJid:h,dhash:null},g.set(h,c)):c.dhash=null}for(c of b){h=g.get(c.id);h==null?(h={contactJid:c.id,dhash:null,icdcInfo:c.icdc},g.set(c.id,h)):h.icdcInfo=c.icdc}for(b of e){h=g.get(b.id);h==null?(h={contactJid:b.id,dhash:b.dhash},g.set(b.id,h)):h.dhash=b.dhash}for(c of f){e=g.get(c.id);e==null?(e={contactJid:c.id,dhash:null,lastSyncTs:c.lastSyncTs},g.set(c.id,e)):e.lastSyncTs=c.lastSyncTs}return a.contacts.bulkPut(Array.from(g.values()))}async function i(a,b){if(b.length===0)return;b=b.map(function(a){var b=a.id;a=a.identity;return{deviceJid:b,identity:a,userJid:d("WAJids").extractUserJid(b)}});await a.identity.bulkPut(b)}g.bulkSaveSignalData=a}),98);
__d("WAIdentityUtils",["WABinary","WACryptoDependencies","WASignalOther"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.length===33&&a[0]===5;return b?a.slice(1):a}function i(a,b){for(var c=0;c<a.length&&c<b.length;++c)if(a[c]!==b[c])return a[c]-b[c];return a.length-b.length}function a(a){a=a.map(function(a){return h(a)});var b=new(d("WABinary").Binary)();a.sort(i).forEach(function(a){return b.writeByteArray(a)});a=d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",b.readByteArrayView());return a.then(function(a){a=new Uint8Array(a);return d("WASignalOther").sliceBytes(a,0,10)})}g.removeKeyTypeIfNeeded=h;g.computeIdentitiesHash=a}),98);
__d("WAICDCUtils",["WAArmadilloICDC.pb","WABase64","WABinary","WACryptoDependencies","WACryptoEd25519","WACryptoUtils","WAIdentityUtils","WALogger","WASignalKeys","WASignalOther","WASignalSignatures","WATimeUtils","decodeProtobuf","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;function a(a,b,c,e){if(a!==e.details.seq){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched sequence between XML node and byte structure"])));return null}if(c!==e.details.timestamp){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched timestamp between XML node and byte structure"])));return null}if(e.details.signingDeviceIndex==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Received ICDC has mismatched missed signingDeviceIndex"])));return null}var f=e.details.signingDeviceIndex;return{dirty:b,sequence:a,timestamp:c,signingDeviceIndex:f,devices:e.details.devices.map(function(a){return new Uint8Array(a)})}}function b(a){return a.signingDeviceIndex<0||a.signingDeviceIndex>=a.devices.length}function e(a){a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,a);var b=a.signature;a=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,a.details);return{signature:b,details:a}}function f(a){return a.map(function(a){return d("WASignalKeys").serializeIdentity(new Uint8Array(d("WABase64").decodeB64UrlSafe(a)))})}function m(a,b,e,f,g){var h=d("WAIdentityUtils").removeKeyTypeIfNeeded(a.publicKey);e=e.map(function(a){return d("WAIdentityUtils").removeKeyTypeIfNeeded(a)});var i=e.findIndex(function(a){return d("WACryptoUtils").uint8ArraysEqual(a,h)});if(i===-1){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["signingDeviceIndex not found. This should never happen. ",". caller: ",""])),f,g);throw c("err")("signingDeviceIndex not found")}f=b==null?1:b+1;g=d("WATimeUtils").unixTime();g<0&&d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["ICDC timestamp is negative. time: ",", closkSkew: ",""])),Date.now(),d("WATimeUtils").getClockSkew());b={seq:f,timestamp:g,devices:e,signingDeviceIndex:i};f=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").ICDCIdentityListSpec,b).readBuffer();g=n(a,d("WABinary").Binary.build(f).readByteArrayView());e={details:f,signature:g};i=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloICDC.pb").SignedICDCIdentityListSpec,e).readBuffer();return{icdcInfo:b,encodedSignedICDC:i}}function n(a,b){var c=d("WASignalOther").makeBytes(64);d("WACryptoDependencies").getCrypto().getRandomValues(c);var e=new Uint8Array(64);d("WACryptoEd25519").hashSha512(e,b,b.length);e=d("WASignalSignatures").makeSignature(a,b,c);return d("WABinary").Binary.build(e).readBuffer()}var o=4*d("WATimeUtils").HOUR_SECONDS;function p(a){return a==null?!0:!d("WATimeUtils").happenedWithin(a,o)}g.validateAndPrepareICDCFromNotification=a;g.isICDCIndexInvalid=b;g.decodeICDCInfo=e;g.base64DeviceIdentitiesToSerializedPubKeys=f;g.computeICDCInfoForUpload=m;g.isLastSyncTsExpired=p}),98);
__d("WAComputeAndUploadICDCInfo",["WABase64","WADeprecatedSendIq","WADeprecatedWapParser","WAGetDevices","WAGlobals","WAICDCUtils","WAIdentityUtils","WALogger","WAPromiseBackoffs","WAWap"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=new(c("WADeprecatedWapParser"))("parseUploadICDCInfoResponse",function(a){a.assertTag("iq"),a.assertFromServer(),a.assertAttr("type","result")}),m=0;a=async function(a,b){a=b.reason;var c=b.caller;b=b.sequence;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["computeAndUploadICDCInfo called ",""])),b);var e;try{e=await d("WAGlobals").getWaOneQueue().enqueue(async function(a){a=a.cryptoManager;var b=await a.storage.loadIdentities(d("WAGlobals").getMyUserJid());a=a.regInfo;return{regInfo:a,identities:Array.from(b.values())}},{operationType:"icdc_load_identities",flush:!1,afterInit:!0})}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Loading identities fails with error: ",""])),a.toString())}if(e==null)return;var f=e,g=f.regInfo;f=f.identities;g=d("WAICDCUtils").computeICDCInfoForUpload(g.staticKeyPair,b,f,a,c);var n=g.icdcInfo;b=g.encodedSignedICDC;a=await d("WAIdentityUtils").computeIdentitiesHash(f);c=d("WAWap").wap("iq",{id:d("WAWap").generateId(),to:d("WAWap").S_WHATSAPP_NET,type:"set",xmlns:"fbid:devices"},d("WAWap").wap("icdc",{ihash:d("WAWap").CUSTOM_STRING(d("WABase64").encodeB64(a)),seq:d("WAWap").INT(n.seq),ts:d("WAWap").INT(n.timestamp)},b));g=await d("WADeprecatedSendIq").deprecatedSendIq(c,l);g.success?(m=0,await d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.saveICDC(d("WAGlobals").getMyUserJid(),{sequence:n.seq,timestamp:n.timestamp,devices:n.devices,signingDeviceIndex:n.signingDeviceIndex,dirty:!1})},{operationType:"save_icdc",flush:!0,afterInit:!0})):(m+=1,g.errorCode===406||g.errorCode===500?setTimeout(function(){d("WAGetDevices").getDevices(null,{ignoreDhash:!0,reason:"compute-Upload-icdc",users:new Set().add(d("WAGlobals").getMyUserJid())}).catch(function(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed getting devices ",""])),a.toString())})},d("WAPromiseBackoffs").getDelay(m,{jitter:.1,max:3e4,algo:{type:"fibonacci",first:1e3,second:1e3}})):d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Cannot update ICDC for user, because of "," server response"])),g.errorCode))};g.computeAndUploadICDCInfo=a}),98);
__d("WAGetDevices",["WADevicesState","WALogger","WAPushSafeTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b){a=d("WAPushSafeTypes").unsafeNotNullable(b);b=a.users;var c=a.reason;a=a.ignoreDhash;a=a===void 0?!1:a;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["fetchAndSaveDevices: ",""])),c);a&&d("WADevicesState").getDevicesState().reset(Array.from(b));await d("WADevicesState").getDevicesState().waitForUserDevices(Array.from(b),"getDevices job: "+c,a)}g.getDevices=a}),98);
__d("WAFetchAndSaveDevices",["WAComputeAndUploadICDCInfo","WAGlobals","WAICDCUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i;async function a(a){if(a.length===0)return;var b=[];await d("WAGlobals").getWaOneQueue().enqueue(function(c){var e=c.cryptoManager;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Update user devices signal and DB"])));return Promise.all(a.map(function(a){var c;b.push({contactJid:a.jid,dhash:a.dhash,lastSyncTs:a.lastSyncTs,icdcInfo:(c=a.icdcInfo)!=null?c:void 0});return e.storage.updateUserDevicesInfo([a])}))},{operationType:"get_devices",flush:!0,afterInit:!0});var c=d("WAGlobals").getMyUserJid(),e=a.find(function(a){return a.jid===c});if(e!=null){e=e.icdcInfo;if(e==null||d("WAICDCUtils").isICDCIndexInvalid(e)||e!=null&&e.dirty){var f;e==null?f="empty":e.dirty?f="dirty":f="invalidIndex";d("WAComputeAndUploadICDCInfo").computeAndUploadICDCInfo(null,{reason:f,caller:"get_devices",sequence:e==null?void 0:e.sequence}).catch(function(a){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["computeAndSaveICDC: ",""])),a)})}}}g.updateUsersDevicesSignalAndDB=a}),98);
__d("WAHandleFbDeviceChangeNotificationProtocol",["WAICDCUtils","WAResultOrError","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.dhash}function b(a){var b;b=((b=a.iCDCDirtyMixin)==null?void 0:b.dirty)==="true";var c=d("WATimeUtils").castToUnixTime(a.ts),e=a.seq;a=d("WAICDCUtils").decodeICDCInfo(a.elementValue);e=d("WAICDCUtils").validateAndPrepareICDCFromNotification(e,b,c,a);return e==null?d("WAResultOrError").makeError("icdc-validation-failure"):d("WAResultOrError").makeResult(e)}g.parseDhash=a;g.parseICDCFromServer=b}),98);
__d("WALoadContactsApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["contacts"],"readonly",function(b){return b.stores.contacts.bulkGet(a).then(function(a){return new Map(a.filter(Boolean).map(function(a){return[a.contactJid,{contactJid:a.contactJid,dhash:a.dhash,icdcFails:a.icdcFails,icdcInfo:a.icdcInfo,lastSyncTs:a.lastSyncTs}]}))})},d("WASignalDB").signalOp("loadContacts"))};g.loadContacts=a}),98);
__d("WARPCAbortController",["Promise"],(function(a,b,c,d,e,f){"use strict";var g,h="rpc-timeout";function a(a,c){var d,e=new(g||(g=b("Promise")))(function(a,b){d=setTimeout(function(){b(h)},c)});return g.race([a,e])["finally"](function(){clearTimeout(d)})}f.RPC_TIMEOUT=h;f.rpcAbortController=a}),66);
__d("WASmaxInDevicesIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","error");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQErrorResponseMixin=a}),98);
__d("WASmaxInDevicesIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",400);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorBadRequestMixin=a}),98);
__d("WASmaxInDevicesNonRetryableIQErrorMixin",["WASmaxInDevicesIQErrorBadRequestMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxInDevicesIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(a);return!b.success?b:b}g.parseNonRetryableIQErrorMixin=a}),98);
__d("WASmaxInDevicesIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",500);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorInternalServerErrorMixin=a}),98);
__d("WASmaxInDevicesIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","service-unavailable");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",503);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorServiceUnavailableMixin=a}),98);
__d("WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup",["WAResultOrError","WASmaxInDevicesIQErrorInternalServerErrorMixin","WASmaxInDevicesIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorInternalServerError",value:b.value});var c=d("WASmaxInDevicesIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorInternalServerError","IQErrorServiceUnavailable"],[b,c])}g.parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup=a}),98);
__d("WASmaxInDevicesRetryableIQErrorMixin",["WAResultOrError","WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"backoff",0,86400);if(!b.success)return b;a=d("WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup").parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup(a);return!a.success?a:d("WAResultOrError").makeResult({backoff:b.value,iQErrorInternalServerErrorOrServiceUnavailableMixinGroup:a.value})}g.parseRetryableIQErrorMixin=a}),98);
__d("WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup",["WAResultOrError","WASmaxInDevicesNonRetryableIQErrorMixin","WASmaxInDevicesRetryableIQErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesRetryableIQErrorMixin").parseRetryableIQErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"RetryableIQError",value:b.value});var c=d("WASmaxInDevicesNonRetryableIQErrorMixin").parseNonRetryableIQErrorMixin(a);return c.success?d("WAResultOrError").makeResult({name:"NonRetryableIQError",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RetryableIQError","NonRetryableIQError"],[b,c])}g.parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup=a}),98);
__d("WASmaxInDevicesFetchResponseError",["WAResultOrError","WASmaxInDevicesIQErrorResponseMixin","WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInDevicesIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:b.value}))}g.parseFetchResponseError=a}),98);
__d("WASmaxInDevicesIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInDevicesFetchNonRetryableUserErrorMixin",["WASmaxInDevicesIQErrorItemNotFoundMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxInDevicesIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);return!b.success?b:b}g.parseFetchNonRetryableUserErrorMixin=a}),98);
__d("WASmaxInDevicesFetchRetryableUserErrorMixin",["WAResultOrError","WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxInDevicesIQErrorInternalServerErrorOrServiceUnavailableMixinGroup").parseIQErrorInternalServerErrorOrServiceUnavailableMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({iQErrorInternalServerErrorOrServiceUnavailableMixinGroup:b.value})}g.parseFetchRetryableUserErrorMixin=a}),98);
__d("WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup",["WAResultOrError","WASmaxInDevicesFetchNonRetryableUserErrorMixin","WASmaxInDevicesFetchRetryableUserErrorMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesFetchRetryableUserErrorMixin").parseFetchRetryableUserErrorMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchRetryableUserError",value:b.value});var c=d("WASmaxInDevicesFetchNonRetryableUserErrorMixin").parseFetchNonRetryableUserErrorMixin(a);return c.success?d("WAResultOrError").makeResult({name:"FetchNonRetryableUserError",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["RetryableUserError","NonRetryableUserError"],[b,c])}g.parseFetchOrFetchNonRetryableUserErrorMixinGroup=a}),98);
__d("WASmaxInDevicesFetchUserResponseFailureMixin",["WAResultOrError","WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!b.success)return b;a=d("WASmaxParseJid").attrUserJid(a,"jid");if(!a.success)return a;b=d("WASmaxInDevicesFetchOrFetchNonRetryableUserErrorMixinGroup").parseFetchOrFetchNonRetryableUserErrorMixinGroup(b.value);return!b.success?b:d("WAResultOrError").makeResult({jid:a.value,errorFetchOrFetchNonRetryableUserErrorMixinGroup:b.value})}g.parseFetchUserResponseFailureMixin=a}),98);
__d("WASmaxInDevicesDeviceModelInfoMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"platform");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"model");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function a(a){var b=d("WASmaxParseUtils").optionalChildWithTag(a,"platform",h);if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(a,"model",i);return!a.success?a:d("WAResultOrError").makeResult({platform:b.value,model:a.value})}g.parseDeviceModelInfoPlatform=h;g.parseDeviceModelInfoModel=i;g.parseDeviceModelInfoMixin=a}),98);
__d("WASmaxInDevicesDhashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrString(a,"dhash");return!a.success?a:d("WAResultOrError").makeResult({dhash:a.value})}g.parseDhashMixin=a}),98);
__d("WASmaxInDevicesKeyDataMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").contentBytesRange(a,32,32);return!a.success?a:d("WAResultOrError").makeResult({elementValue:a.value})}g.parseKeyDataMixin=a}),98);
__d("WASmaxInDevicesIdentityKeyMixin",["WASmaxInDevicesKeyDataMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"identity");if(!a.success)return a;a=d("WASmaxInDevicesKeyDataMixin").parseKeyDataMixin(a.value);return!a.success?a:a}g.parseIdentityKeyMixin=a}),98);
__d("WASmaxInDevicesDeviceListMixin",["WAResultOrError","WASmaxInDevicesDeviceModelInfoMixin","WASmaxInDevicesDhashMixin","WASmaxInDevicesIdentityKeyMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"device");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"id",1,999);if(!b.success)return b;var c=d("WASmaxInDevicesIdentityKeyMixin").parseIdentityKeyMixin(a);if(!c.success)return c;a=d("WASmaxInDevicesDeviceModelInfoMixin").parseDeviceModelInfoMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({id:b.value},c.value,{deviceModelInfoMixin:a.success?a.value:null}))}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDhashMixin").parseDhashMixin(a);a=d("WASmaxParseUtils").mapChildrenWithTag(a,"device",0,25,h);return!a.success?a:d("WAResultOrError").makeResult({dhashMixin:b.success?b.value:null,device:a.value})}g.parseDeviceListDevice=h;g.parseDeviceListMixin=a}),98);
__d("WASmaxInDevicesICDCDirtyMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"dirty","true");return!b.success?b:d("WAResultOrError").makeResult({dirty:b.value})}g.parseICDCDirtyMixin=a}),98);
__d("WASmaxInDevicesICDCSeqMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").attrIntRange(a,"seq",0,2147483647);return!a.success?a:d("WAResultOrError").makeResult({seq:a.value})}g.parseICDCSeqMixin=a}),98);
__d("WASmaxInDevicesICDCSignedListMixin",["WAResultOrError","WASmaxInDevicesICDCSeqMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"ts",0,void 0);if(!b.success)return b;var c=d("WASmaxParseUtils").contentBytesRange(a,1,40072);if(!c.success)return c;a=d("WASmaxInDevicesICDCSeqMixin").parseICDCSeqMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({ts:b.value,elementValue:c.value},a.value))}g.parseICDCSignedListMixin=a}),98);
__d("WASmaxInDevicesICDCFromServerMixin",["WAResultOrError","WASmaxInDevicesICDCDirtyMixin","WASmaxInDevicesICDCSignedListMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCSignedListMixin").parseICDCSignedListMixin(a);if(!b.success)return b;a=d("WASmaxInDevicesICDCDirtyMixin").parseICDCDirtyMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,{iCDCDirtyMixin:a.success?a.value:null}))}g.parseICDCFromServerMixin=a}),98);
__d("WASmaxInDevicesFetchUserResponseSuccessMixin",["WAResultOrError","WASmaxInDevicesDeviceListMixin","WASmaxInDevicesICDCFromServerMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"devices");if(!b.success)return b;b=d("WASmaxInDevicesDeviceListMixin").parseDeviceListMixin(a);return!b.success?b:b}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"icdc");if(!b.success)return b;b=d("WASmaxInDevicesICDCFromServerMixin").parseICDCFromServerMixin(a);return!b.success?b:b}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"devices",h);if(!b.success)return b;var c=d("WASmaxParseUtils").optionalChildWithTag(a,"icdc",i);if(!c.success)return c;a=d("WASmaxParseJid").attrUserJid(a,"jid");return!a.success?a:d("WAResultOrError").makeResult({jid:a.value,devices:b.value,icdc:c.value})}g.parseFetchUserResponseSuccessDevices=h;g.parseFetchUserResponseSuccessIcdc=i;g.parseFetchUserResponseSuccessMixin=a}),98);
__d("WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup",["WAResultOrError","WASmaxInDevicesFetchUserResponseFailureMixin","WASmaxInDevicesFetchUserResponseSuccessMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInDevicesFetchUserResponseFailureMixin").parseFetchUserResponseFailureMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"FetchUserResponseFailure",value:b.value});var c=d("WASmaxInDevicesFetchUserResponseSuccessMixin").parseFetchUserResponseSuccessMixin(a);return c.success?d("WAResultOrError").makeResult({name:"FetchUserResponseSuccess",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["UserResponseFailure","UserResponseSuccess"],[b,c])}g.parseUserResponseFetchFailureOrFetchSuccessMixinGroup=a}),98);
__d("WASmaxInDevicesFetchUserResponseMixin",["WAResultOrError","WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxInDevicesUserResponseFetchFailureOrFetchSuccessMixinGroup").parseUserResponseFetchFailureOrFetchSuccessMixinGroup(a);return!b.success?b:d("WAResultOrError").makeResult({userResponseFetchFailureOrFetchSuccessMixinGroup:b.value})}g.parseFetchUserResponseMixin=a}),98);
__d("WASmaxInDevicesIQResultResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",c.value);if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!b.success)return b;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");return!c.success?c:d("WAResultOrError").makeResult({type:c.value})}g.parseIQResultResponseMixin=a}),98);
__d("WASmaxInDevicesFetchResponseSuccess",["WAResultOrError","WASmaxInDevicesFetchUserResponseMixin","WASmaxInDevicesIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"user");if(!b.success)return b;b=d("WASmaxInDevicesFetchUserResponseMixin").parseFetchUserResponseMixin(a);return!b.success?b:b}function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"users");if(!c.success)return c;a=d("WASmaxInDevicesIQResultResponseMixin").parseIQResultResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxParseUtils").mapChildrenWithTag(c.value,"user",0,25,h);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{usersUser:b.value}))}g.parseFetchResponseSuccessUsersUser=h;g.parseFetchResponseSuccess=a}),98);
__d("WASmaxOutDevicesBaseIQGetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQGetRequestMixin=a}),98);
__d("WASmaxOutDevicesDhashMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyDhash;a=d("WASmaxJsx").smax("smax$any",{dhash:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDhashMixin=a}),98);
__d("WASmaxOutDevicesICDCSeqMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anySeq;a=d("WASmaxJsx").smax("smax$any",{seq:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeICDCSeqMixin=a}),98);
__d("WASmaxOutDevicesFetchRequest",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutDevicesBaseIQGetRequestMixin","WASmaxOutDevicesDhashMixin","WASmaxOutDevicesICDCSeqMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.userJid,c=a.dhashMixinArgs;a=a.iCDCSeqMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutDevicesICDCSeqMixin").mergeICDCSeqMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutDevicesDhashMixin").mergeDhashMixin,d("WASmaxJsx").smax("user",{jid:d("WAWap").USER_JID(b)}),c),a);return b}function a(a){a=a.userArgs;a=d("WASmaxOutDevicesBaseIQGetRequestMixin").mergeBaseIQGetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"fbid:devices"},d("WASmaxJsx").smax("users",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,25))));return a}g.makeFetchRequestUsersUser=h;g.makeFetchRequest=a}),98);
__d("WASmaxDevicesFetchRPC",["WAComms","WASmaxInDevicesFetchResponseError","WASmaxInDevicesFetchResponseSuccess","WASmaxOutDevicesFetchRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a,b){a=d("WASmaxOutDevicesFetchRequest").makeFetchRequest(a);b=await d("WAComms").sendSmaxStanza(a,b);var c=d("WASmaxInDevicesFetchResponseSuccess").parseFetchResponseSuccess(b,a);if(c.success)return{name:"FetchResponseSuccess",value:c.value};b=d("WASmaxInDevicesFetchResponseError").parseFetchResponseError(b,a);if(b.success)return{name:"FetchResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Fetch",{Success:c,Error:b}))}g.sendFetchRPC=a}),98);
__d("WAFetchFbDevicesProtocolV2",["WAArrayChunk","WAHandleFbDeviceChangeNotificationProtocol","WAJids","WALoadContactsApi","WARPCAbortController","WASignalKeys","WASmaxDevicesFetchRPC","WATagsLogger","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=25,k=1e4,l=d("WATagsLogger").TAGS(["wa-devices-protocol"]);async function a(a,b){if(a.length===0)return new Map();var c=await m(a,b);b=d("WAArrayChunk").chunk(a.map(function(a){var b=c.get(a);b=b!=null?{anyDhash:b}:null;return{userJid:a,dhashMixinArgs:b}}),j);var e=new Map();await Promise.allSettled(b.map(function(a){return n(e,a)}));return e}async function m(a,b){if(b)return new Map();b=await d("WALoadContactsApi").loadContacts(a);var c=new Map();b.forEach(function(a){a&&a.dhash!=null&&c.set(a.contactJid,a.dhash)});return c}async function n(a,b){try{var e=new Set(b.map(function(a){return a.userJid}));b=await d("WARPCAbortController").rpcAbortController(d("WASmaxDevicesFetchRPC").sendFetchRPC({userArgs:b}),k);if(b.name==="FetchResponseError")throw c("err")("Failed to fetch user devices");b.value.usersUser.map(function(b){b=b.userResponseFetchFailureOrFetchSuccessMixinGroup;if(b.name==="FetchUserResponseFailure")return;b=b.value;var c=b.jid,f=b.devices;b=b.icdc;e.delete(c);a.set(c,{newState:o(c,f,b,d("WATimeUtils").unixTime()),stateIsUpToDate:!1})});e.forEach(function(b){a.set(b,{stateIsUpToDate:!0})})}catch(a){if(a===d("WARPCAbortController").RPC_TIMEOUT){l.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Timeout for fetchAndSaveDevices"])));return}l.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["",""])),a)}}function o(a,b,c,e){e===void 0&&(e=null);var f=[],g=null;if(b){f=b.device.map(function(a){var b;return{id:d("WAJids").interpretAsDeviceId(a.id),identity:d("WASignalKeys").serializeIdentity(a.elementValue),platform:(b=a.deviceModelInfoMixin)==null||(b=b.platform)==null?void 0:b.elementValue,model:(b=a.deviceModelInfoMixin)==null||(b=b.model)==null?void 0:b.elementValue}});g=(b=b.dhashMixin)==null?void 0:b.dhash}b=null;if(c){c=d("WAHandleFbDeviceChangeNotificationProtocol").parseICDCFromServer(c);b=c.success?c.value:null}return{jid:a,devices:f,lastSyncTs:d("WATimeUtils").unixTime(),dhash:g,icdcInfo:b,notificationTs:e}}g.fetchFbDevicesProtocol=a}),98);
__d("WADevicesState",["WAFetchAndSaveDevices","WAFetchFbDevicesProtocolV2","WAPREList","WAPREMetrics","WAResolvable","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=3e4,m=1e3*60*60,n=d("WATagsLogger").TAGS(["WADevicesState"]);b=function(){function a(){this.$1=new Map()}var b=a.prototype;b.$2=function(a){var b=this;setTimeout(function(){a.forEach(function(a){var c=a[0];a=a[1];a.resolveWasCalled()||(a.resolve(d("WAResultOrError").makeError()),b.$1.get(c)===a&&b.$1.delete(c))})},l);setTimeout(function(){a.forEach(function(a){var c=a[0];a=a[1];b.$1.get(c)===a&&b.$1.delete(c)})},m)};b.waitForUserDevices=async function(a,b,c){var e=this;c===void 0&&(c=!1);var f=[],g=[];c===!0&&a.forEach(function(a){e.$1.delete(a)});a.forEach(function(a){var b=e.$1.get(a);if(b==null){var c=new(d("WAResolvable").Resolvable)();f.push([a,c]);e.$1.set(a,c)}else g.push([a,b.promise])});this.$2(f);n.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["getDevices called for users ",", reason: ",""])),Array.from(a),b);var l=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.GET_DEVICES,{string:{reason:b}});l.addPoint("fetch_start");var m=await d("WAFetchFbDevicesProtocolV2").fetchFbDevicesProtocol(f.map(function(a){a=a[0];return a}),c).catch(function(a){l.addPoint("fetch_fail");n.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["fetchFBDevicesProtocol failed: ",""])),a);return new Map()});l.addPoint("fetch_end");var o=!0;n.DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["getDevices -> update devices signal"])));l.addPoint("signal_update_start");await d("WAFetchAndSaveDevices").updateUsersDevicesSignalAndDB(Array.from(m.values()).map(function(a){return a.newState}).filter(Boolean)).catch(function(a){o=!1,n.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["updateDevicesSignalAndDB failed: ",""])),a)});l.addPoint("signal_update_end");f.forEach(function(a){var b=a[0];a=a[1];if(!o){a.resolve(d("WAResultOrError").makeError());e.$1.delete(b);return}m.has(b)?a.resolve(d("WAResultOrError").makeResult()):(a.resolve(d("WAResultOrError").makeError()),e.$1.delete(b))});l.endSuccess();await Promise.allSettled(g.map(function(a){a[0];a=a[1];return a}))};b.reset=function(a){var b=this;a.forEach(function(a){return b.$1.delete(a)})};return a}();var o=new b();function a(){return o}g.DeviceStateClassV2=b;g.getDevicesState=a}),98);
__d("WAComputeICDC",["WAGetDevices","WAICDCUtils","WAIdentityUtils","WAJids","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=d("WATagsLogger").TAGS(["WAComputeICDC"]);async function a(a,b,c,e){var f=new Set(),g=[].concat(a);a=a.find(function(a){return a.user===b});if(a==null){a=await e.cryptoManager.storage.loadIdentities(b);a=a.get(c);if(a==null){l.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Sender does not have identity"])));return}g.push({user:b,devicesInfo:[{identity:a,jid:c}]})}a=void 0;var m=[],n=[];await Promise.all(g.map(async function(c){var g=await Promise.all([e.cryptoManager.storage.loadICDC(c.user),e.cryptoManager.storage.loadLastSyncTs(c.user)]),h=g[0];g=g[1];d("WAICDCUtils").isLastSyncTsExpired(g)&&f.add(c.user);g=new Set();if(h==null)f.add(c.user);else if(d("WAICDCUtils").isICDCIndexInvalid(h))f.add(c.user),l.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ICDC has invalid index"]))),h=null;else for(var j of h.devices)g.add(j.toString());j=[];var k=[];for(var o of c.devicesInfo){var p=d("WAJids").extractDeviceId(o.jid),q=d("WAIdentityUtils").removeKeyTypeIfNeeded(o.identity);g.has(q.toString())||(j.push(p),k.push(q.buffer))}p={unknownDevices:k,unknownDeviceIds:j};h!=null&&(p.seq=h.sequence,p.signingDevice=h.devices[h.signingDeviceIndex].buffer);c.user===b?a=p:(m.push(p),n.push(c.user))}));f.size>0&&(l.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Triggering getDevices for users with missing or incorrect icdc info."]))),d("WAGetDevices").getDevices(null,{ignoreDhash:!0,reason:"missing-icdc-info",users:f}).catch(function(a){l.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Error during get devices for users with missing icdc info: ",""])),a)}));return{senderIdentity:a,recipientIdentities:m,recipientUserJids:n}}g.computeICDC=a}),98);
__d("WAMultiDevice.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={};a.name="MultiDevice";a.internalSpec={payload:[1,(d=d("WAProtoConst")).TYPES.MESSAGE,c],metadata:[2,d.TYPES.MESSAGE,b]};b.name="MultiDevice$Metadata";b.internalSpec={};c.name="MultiDevice$Payload";c.internalSpec={applicationData:[1,d.TYPES.MESSAGE,e],signal:[2,d.TYPES.MESSAGE,m],__oneofs__:{payload:["applicationData","signal"]}};e.name="MultiDevice$ApplicationData";e.internalSpec={appStateSyncKeyShare:[1,d.TYPES.MESSAGE,h],appStateSyncKeyRequest:[2,d.TYPES.MESSAGE,f],__oneofs__:{applicationData:["appStateSyncKeyShare","appStateSyncKeyRequest"]}};f.name="MultiDevice$ApplicationData$AppStateSyncKeyRequestMessage";f.internalSpec={keyIds:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,l]};h.name="MultiDevice$ApplicationData$AppStateSyncKeyShareMessage";h.internalSpec={keys:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,i]};i.name="MultiDevice$ApplicationData$AppStateSyncKey";i.internalSpec={keyId:[1,d.TYPES.MESSAGE,l],keyData:[2,d.TYPES.MESSAGE,j]};j.name="MultiDevice$ApplicationData$AppStateSyncKey$AppStateSyncKeyData";j.internalSpec={keyData:[1,d.TYPES.BYTES],fingerprint:[2,d.TYPES.MESSAGE,k],timestamp:[3,d.TYPES.INT64]};k.name="MultiDevice$ApplicationData$AppStateSyncKey$AppStateSyncKeyData$AppStateSyncKeyFingerprint";k.internalSpec={rawId:[1,d.TYPES.UINT32],currentIndex:[2,d.TYPES.UINT32],deviceIndexes:[3,d.FLAGS.REPEATED|d.FLAGS.PACKED|d.TYPES.UINT32]};l.name="MultiDevice$ApplicationData$AppStateSyncKeyId";l.internalSpec={keyId:[1,d.TYPES.BYTES]};m.name="MultiDevice$Signal";m.internalSpec={};g.MultiDeviceSpec=a;g.MultiDevice$MetadataSpec=b;g.MultiDevice$PayloadSpec=c;g.MultiDevice$ApplicationDataSpec=e;g.MultiDevice$ApplicationData$AppStateSyncKeyRequestMessageSpec=f;g.MultiDevice$ApplicationData$AppStateSyncKeyShareMessageSpec=h;g.MultiDevice$ApplicationData$AppStateSyncKeySpec=i;g.MultiDevice$ApplicationData$AppStateSyncKey$AppStateSyncKeyDataSpec=j;g.MultiDevice$ApplicationData$AppStateSyncKey$AppStateSyncKeyData$AppStateSyncKeyFingerprintSpec=k;g.MultiDevice$ApplicationData$AppStateSyncKeyIdSpec=l;g.MultiDevice$SignalSpec=m}),98);
__d("WAParseAppStateSyncKeyRequest",["WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];for(a of a.keyIds)a.keyId!=null&&b.push(d("WASyncdKeyTypes").toSyncKeyId(a.keyId));return{keyIds:b}}g.parseAppStateSyncKeyRequest=a}),98);
__d("WASyncdKeyManagementUtils",["WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return new DataView(d("WASyncdKeyTypes").fromSyncKeyId(a)).getUint16(0)}function h(a){return new DataView(d("WASyncdKeyTypes").fromSyncKeyId(a)).getUint32(2)}function b(a){return h(a)+1}g.getKeyDeviceId=a;g.getKeyEpoch=h;g.generateNewKeyEpoch=b}),98);
__d("WAParseAppStateSyncKeyShare",["WALogger","WALongInt","WASyncdKeyManagementUtils","WASyncdKeyTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=[],c=[];for(a of a.keys){var d=i(a);d!=null&&(d.type==="orphan"?c.push(d.keyId):(d.type,b.push(d.keyData)))}return{keys:b,orphanKeys:c}}function i(a){var b,c,e,f,g,i;if(((b=a.keyId)==null?void 0:b.keyId)==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Key missing keyId"])));return null}b=d("WASyncdKeyTypes").toSyncKeyId(a.keyId.keyId);c=(c=a.keyData)==null?void 0:c.keyData;e=d("WALongInt").maybeNumberOrThrowIfTooLarge((e=a.keyData)==null?void 0:e.timestamp);f=(f=a.keyData)==null||(f=f.fingerprint)==null?void 0:f.currentIndex;g=(g=a.keyData)==null||(g=g.fingerprint)==null?void 0:g.deviceIndexes;i=(i=a.keyData)==null||(i=i.fingerprint)==null?void 0:i.rawId;return a.keyData==null||c==null||e==null||f==null||g==null||i==null?{keyId:b,type:"orphan"}:{keyData:{fingerprint:{currentIndex:f,deviceIndexes:g,rawId:i},keyData:d("WASyncdKeyTypes").toSyncKeyData(c),keyEpoch:d("WASyncdKeyManagementUtils").getKeyEpoch(b),keyId:b,timestamp:e},type:"key"}}g.parseAppStateSyncKeyShare=a}),98);
__d("WAConvertAppData",["WAAppData","WAArmadilloApplication.pb","WAJids","WALogger","WAMultiDevice.pb","WAParseAppStateSyncKeyRequest","WAParseAppStateSyncKeyShare","WAStanzaUtils","WASyncdKeyTypes","WATimeUtils","decodeProtobuf","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u;function v(a){a=d("WAJids").interpretAndValidateJid(a);if(a.jidType==="msgrUser")return a.userJid;else if(a.jidType==="group")return a.groupJid;else{a.jidType;throw c("err")("Incorrect jid type: "+a.jidType)}}function w(a){a=d("WAJids").interpretAndValidateJid(a);if(a.jidType==="msgrUser")return a.userJid;else if(a.jidType==="msgrDevice")return d("WAJids").extractUserJid(a.deviceJid);else{a.jidType;throw c("err")("Incorrect jid type: "+a.jidType)}}function x(a){return a!=null?typeof a==="number"&&a>d("WATimeUtils").MAX_INT?d("WATimeUtils").castMilliSecondsToUnixTime(a):d("WATimeUtils").castLongIntToUnixTime(a):void 0}function y(a){return a==null?void 0:{lastMessageTimestamp:x(a.lastMessageTimestamp),lastSystemMessageTimestamp:x(a.lastSystemMessageTimestamp),messages:a.messages==null?[]:a.messages.map(function(a){return{key:a.key==null?void 0:{fromMe:a.key.fromMe,id:a.key.id},ts:x(a.timestamp)}})}}function z(a,b){var c=a.chatId;if(c==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Missing chatId in chat action: ",""])),a);return null}if(a.chatArchive!=null){var e=a.chatArchive;e=y(e.messageRange);return{chatJid:v(c),messageRange:e,ts:b,type:"chat_archive"}}else if(a.chatDelete!=null){e=a.chatDelete;e=y(e.messageRange);return{chatJid:v(c),messageRange:e,ts:b,type:"chat_delete"}}else if(a.chatRead!=null){e=a.chatRead;var f=y(e.messageRange);return{chatJid:v(c),messageRange:f,read:e.read,ts:b,type:"chat_read"}}else{d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata sync action type: ",""])),a);return null}}function A(a){var b=a.key,c=b==null?void 0:b.remoteJid,e=b==null?void 0:b.id,f=b==null?void 0:b.fromMe;if(b==null||c==null||f==null||e==null){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Missing messageKey in message action: ",""])),a);return null}var g=v(c),h=d("WAJids").interpretAsGroupJid(g)!=null;if(h&&!f){if((b==null?void 0:b.participant)==null){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["No participant in messageKey in message action when it is group chat and message is not fromMe: ",""])),a);return null}h=w(b.participant)}else f?h=d("WAJids").AUTHOR_ME:h=w(c);b={author:h,chat:g,externalId:d("WAStanzaUtils").toStanzaId(e)};if(a.messageDelete!=null)return{protocolMsgId:b,type:"delete_for_me"};else{d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata sync action type: ",""])),a);return null}}function B(a){var b=[];for(a of a){var c=x(a.actionTimestamp);if(a.chatAction!=null){c=z(a.chatAction,c);c!=null&&b.push({chatAction:c})}else if(a.messageAction!=null){c=A(a.messageAction);c!=null&&b.push({messageAction:c})}else d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata sync action type: ",""])),a)}return b}function C(a){var b=a.anonId,c=a.id,e=a.rootKey;a=a.status;if(a==null||c==null||b==null||e==null){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["missing keys in EncryptedBackupsSecretsEpoch"])));return null}var f;if(a===d("WAArmadilloApplication.pb").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_OPEN)f=d("WAAppData").EPOCH_STATUS_OPEN;else if(a===d("WAArmadilloApplication.pb").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_CLOSE)f=d("WAAppData").EPOCH_STATUS_CLOSE;else{d("WALogger").WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["status in EncryptedBackupsSecretsEpoch has invalid value"])));return null}return{anonId:b,id:c,rootKey:e,status:f}}function D(a){var b=a.backupId,c=a.epoch,e=a.mailboxRootKey,f=a.obliviousValidationToken,g=a.serverDataId;a=a.tempOcmfClientState;if(b==null||g==null||a==null||e==null||f==null){d("WALogger").WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["missing keys in EncryptedBackupsSecrets"])));return null}return{backupId:b,epoch:c.map(C).reduce(function(a,b){if(b!=null)return a.concat([b]);else return a},[]),mailboxRootKey:e,obliviousValidationToken:f,serverDataId:g,tempOcmfClientState:a}}function E(a){var b;if(((b=a.applicationData)==null||(b=b.metadataSync)==null?void 0:b.actions)!=null){return{actions:B((b=a.applicationData)==null||(b=b.metadataSync)==null?void 0:b.actions),type:"meta_sync"}}else if(((b=a.signal)==null?void 0:b.encryptedBackupsSecrets)!=null){b=D(a.signal.encryptedBackupsSecrets);return b==null?null:{encryptedBackupsSecrets:b,type:"backups_secrets"}}else{d("WALogger").WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata type: ",""])),a);return null}}function F(a){var b;if(((b=a.applicationData)==null?void 0:b.appStateSyncKeyShare)!=null){return{syncKeyShare:d("WAParseAppStateSyncKeyShare").parseAppStateSyncKeyShare((b=a.applicationData)==null?void 0:b.appStateSyncKeyShare),type:"sync_key_share"}}else if(((b=a.applicationData)==null?void 0:b.appStateSyncKeyRequest)!=null){return{syncKeyRequest:d("WAParseAppStateSyncKeyRequest").parseAppStateSyncKeyRequest((b=a.applicationData)==null?void 0:b.appStateSyncKeyRequest),type:"sync_key_request"}}else{d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata type: ",""])),a);return null}}function a(a){if(a.subprotocolType==="armadillo"){var b=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAArmadilloApplication.pb").ArmadilloSpec,a.payload);if(b.payload==null)throw c("err")("Appdata contains unparseable armadillo data.");return E(b.payload)}else if(a.subprotocolType==="multiDevice"){b=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMultiDevice.pb").MultiDeviceSpec,a.payload);if(b.payload==null)throw c("err")("Appdata contains unparseable armadillo data.");return F(b.payload)}else throw c("err")("Appdata contains unexpected message application: "+a.subprotocolType)}function G(a){return a==null?void 0:{lastMessageTimestamp:a.lastMessageTimestamp,lastSystemMessageTimestamp:a.lastSystemMessageTimestamp,messages:a.messages.map(function(a){return{key:a.key==null?void 0:{fromMe:a.key.fromMe,id:a.key.id},timestamp:a.ts}})}}function H(a){switch(a.type){case"meta_sync":return{payload:{applicationData:P(a)}};case"backups_secrets":return{payload:{signal:{encryptedBackupsSecrets:N(a.encryptedBackupsSecrets)}}};default:a.type;d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata type: ",""])),a.type);return{}}}function I(a){return{keyId:d("WASyncdKeyTypes").fromSyncKeyId(a)}}function J(a){return{keyData:{fingerprint:{currentIndex:a.fingerprint.currentIndex,deviceIndexes:a.fingerprint.deviceIndexes,rawId:a.fingerprint.rawId},keyData:d("WASyncdKeyTypes").fromSyncKeyData(a.keyData),timestamp:a.timestamp},keyId:I(a.keyId)}}function K(a){var b=a.keys.map(J);a=a.orphanKeys==null?[]:a.orphanKeys.map(function(a){return{keyId:I(a)}});b.push.apply(b,a);return{keys:b}}function L(a){return{keyIds:a.keyIds.map(I)}}function M(a){switch(a.type){case"sync_key_share":return{payload:{applicationData:{appStateSyncKeyShare:K(a.syncKeyShare)}}};case"sync_key_request":return{payload:{applicationData:{appStateSyncKeyRequest:L(a.syncKeyRequest)}}};default:a.type;d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata type: ",""])),a.type);return{}}}function b(a){var b;switch(a.type){case"meta_sync":case"backups_secrets":var c=d("encodeProtobuf").encodeProtobuf(d("WAArmadilloApplication.pb").ArmadilloSpec,H(a));b={armadillo:{payload:c.readByteArrayView(),version:1}};break;case"sync_key_share":case"sync_key_request":c=d("encodeProtobuf").encodeProtobuf(d("WAMultiDevice.pb").MultiDeviceSpec,M(a));b={multiDevice:{payload:c.readByteArrayView(),version:1}};break;default:a.type,d("WALogger").WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Unknown appdata type: ",""])),a.type),b={}}return{payload:{subProtocol:b}}}function N(a){return{backupId:a.backupId,epoch:a.epoch.map(O),mailboxRootKey:a.mailboxRootKey,obliviousValidationToken:a.obliviousValidationToken,serverDataId:a.serverDataId,tempOcmfClientState:a.tempOcmfClientState}}function O(a){var b;a.status===d("WAAppData").EPOCH_STATUS_OPEN?b=d("WAArmadilloApplication.pb").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_OPEN:a.status===d("WAAppData").EPOCH_STATUS_CLOSE&&(b=d("WAArmadilloApplication.pb").ARMADILLO_SIGNAL_ENCRYPTED_BACKUPS_SECRETS_EPOCH_EPOCH_STATUS.ES_CLOSE);return{anonId:a.anonId,id:a.id,rootKey:a.rootKey,status:b}}function P(a){return{metadataSync:{actions:a.actions.map(function(a){if(a.chatAction)return{actionTimestamp:a.chatAction.ts,chatAction:Q(a.chatAction)};else return{messageAction:R(a.messageAction)}})}}}function Q(a){var b=G(a.messageRange),c=a.chatJid;switch(a.type){case"chat_archive":return{chatArchive:{archived:a.archived,messageRange:b},chatId:c};case"chat_delete":return{chatDelete:{messageRange:b},chatId:c};default:a.type;return{chatId:c,chatRead:{messageRange:b,read:a.read}}}}function R(a){if(a.type==="delete_for_me"){var b=a.protocolMsgId.chat,e=d("WAJids").interpretAsGroupJid(b)!=null;return{key:{fromMe:d("WAJids").isAuthorMe(a.protocolMsgId.author),id:a.protocolMsgId.externalId,participant:!d("WAJids").isAuthorMe(a.protocolMsgId.author)&&e?a.protocolMsgId.author:void 0,remoteJid:b},messageDelete:{}}}else throw c("err")("No other available type")}function e(a){if(a.type!=="meta_sync")return[];a=a.actions.map(function(a){var b=a.chatAction;a=a.messageAction;return(a=a==null?void 0:a.protocolMsgId.chat)!=null?a:b==null?void 0:b.chatJid}).filter(Boolean);return Array.from(new Set(a))}g.parseArmadilloAppData=E;g.parseMultiDeviceAppData=F;g.parseAppData=a;g.convertArmadilloAppData=H;g.convertMultiDeviceAppData=M;g.convertAppData=b;g.getChatJidForAppData=e}),98);
__d("WADbPersonalSenderKeyStatusTxns",["WASignalDB","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=["groupJid","senderKeyTs"],i=["groupJid","senderKeyTs"],j={hasSenderKey:new Set(),rotateSenderKey:!0,senderKeyId:null,senderKeyTs:d("WATimeUtils").castToUnixTime(0)};a=function(a){return d("WASignalDB").getDb().runInTransaction(["personalSenderKeyStatuses"],"readwrite",function(b){return b.stores.personalSenderKeyStatuses.bulkPut(a.map(function(a){return babelHelpers.extends({},j,{groupJid:a})}))},d("WASignalDB").signalOp("bulkPutNewPersonalSenderKeyStatus"))};b=function(a,b,c){return d("WASignalDB").getDb().runInTransaction(["personalSenderKeyStatuses"],"readwrite",async function(d){var e=await d.stores.personalSenderKeyStatuses.get(a);await d.stores.personalSenderKeyStatuses.bulkPut([babelHelpers.extends({},e||j,{groupJid:a,rotateSenderKey:!1,senderKeyId:b,senderKeyTs:c})])},d("WASignalDB").signalOp("markSenderKeyAsRotated"))};c=function(a){return d("WASignalDB").getDb().runInTransaction(["personalSenderKeyStatuses"],"readwrite",async function(b){var c=await b.stores.personalSenderKeyStatuses.get(a);if(c!=null){c.groupJid;var d=c.senderKeyTs;c=babelHelpers.objectWithoutPropertiesLoose(c,h);return babelHelpers.extends({},c,{ts:d})}c=babelHelpers.extends({},j,{groupJid:a});await b.stores.personalSenderKeyStatuses.bulkPut([c]);c.groupJid;d=c.senderKeyTs;b=babelHelpers.objectWithoutPropertiesLoose(c,i);return babelHelpers.extends({},b,{ts:d})},"Signal - getSenderKeyStatus")};e=function(a){return d("WASignalDB").getDb().runInTransaction(["personalSenderKeyStatuses"],"readwrite",async function(b){var c=await b.stores.personalSenderKeyStatuses.bulkGet(a);await b.stores.personalSenderKeyStatuses.bulkPut(c.filter(function(a){return a!=null}).map(function(a){return babelHelpers.extends({},a,{rotateSenderKey:!0})}))},d("WASignalDB").signalOp("bulkSetRotateSenderKeyToTrue"))};f=function(a){return d("WASignalDB").getDb().runInTransaction(["personalSenderKeyStatuses"],"readwrite",function(b){return b.stores.personalSenderKeyStatuses.bulkDelete(a)},d("WASignalDB").signalOp("deletePersonalSenderKeyStatus"))};g.bulkPutNewPersonalSenderKeyStatus=a;g.markSenderKeyAsRotated=b;g.getSenderKeyStatus=c;g.bulkSetRotateSenderKeyToTrue=e;g.deletePersonalSenderKeyStatus=f}),98);
__d("WACreateGroup",["WADbPersonalSenderKeyStatusTxns","WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a){await d("WAGlobals").getDependencies().createGroups(a),await d("WADbPersonalSenderKeyStatusTxns").bulkPutNewPersonalSenderKeyStatus(a.map(function(a){return a.groupToCreate.jid}))};g.createGroups=a}),98);
__d("WAGetPrekeyIdsInRange",["WASignalKeys"],(function(a,b,c,d,e,f,g){"use strict";var h=16777215;function i(a){return a}function a(a,b){var c=[];a=i(a);var e=i(b);if(a<=e)for(var f=a;f<=b;f++)c.push(d("WASignalKeys").castToPreKeyId(f));else{for(b=a;b<h;b++)c.push(d("WASignalKeys").castToPreKeyId(b));for(f=1;f<=e;f++)c.push(d("WASignalKeys").castToPreKeyId(f))}return c}g.PRE_KEY_MAX_ID=h;g.getPrekeyIdsInRange=a}),98);
__d("WADeletePreKeyGenerationsApi",["WAGetPrekeyIdsInRange","WALogger","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){return d("WASignalDB").getDb().runInTransaction(["prekey","prekeyGeneration"],"readwrite",async function(b){var c=await b.stores.prekeyGeneration.bulkGet(a),e=[];for(c of c){if(c==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Attempting to delete non-existent prekey generation"])));continue}for(var f of d("WAGetPrekeyIdsInRange").getPrekeyIdsInRange(c.startingId,c.endingId))e.push(f)}await Promise.all([b.stores.prekeyGeneration.bulkDelete(a),b.stores.prekey.bulkDelete(e)])},d("WASignalDB").signalOp("deletePreKeyGenerations"))};g.deletePreKeyGenerations=a}),98);
__d("WAGetLastPreKeyGenerationIdApi",["WADbSignal","WASignalDB","err"],(function(a,b,c,d,e,f,g){"use strict";a=async function(){var a=await d("WASignalDB").getDb().runInTransaction(["meta"],"readonly",function(a){return Promise.all([a.stores.meta.get(d("WADbSignal").MetaKeysEnum.lastPrekeyId).then(function(a){return a==null?void 0:a.value.lastPrekeyId}),a.stores.meta.get(d("WADbSignal").MetaKeysEnum.lastPrekeyGenerationId).then(function(a){return a==null?void 0:a.value.lastPrekeyGenerationId})])},d("WASignalDB").signalOp("getLastPreKeyGenerationId")),b=a[0];a=a[1];if(b==null&&a!=null||b!=null&&a==null)throw c("err")("Last prekey id and Last prekey generation id should both be non-null");return b!=null&&a!=null?{lastGenerationId:a,lastPreKeyId:b}:null};g.getLastPreKeyGenerationId=a}),98);
__d("WAGetPreKeyGenerationsTimestampsApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return d("WASignalDB").getDb().runInTransaction(["prekeyGeneration"],"readonly",async function(a){a=await a.stores.prekeyGeneration.readAll();return a.map(function(a){return{id:a.generationId,timestamp:a.createdTs}})},d("WASignalDB").signalOp("getPreKeyGenerationsTimestamps"))};g.getPreKeyGenerationsTimestamps=a}),98);
__d("WALoadICDCApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["contacts"],"readonly",function(b){return b.stores.contacts.bulkGet([a]).then(function(a){a=a.filter(Boolean).length>0?a[0]:null;return(a=a==null?void 0:a.icdcInfo)!=null?a:null})},d("WASignalDB").signalOp("loadICDC"))};g.loadICDC=a}),98);
__d("WALoadIdentitiesApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["identity"],"readonly",async function(b){b=await b.stores.identity.readIndex("userJid",[a]);return new Map(b.filter(Boolean).map(function(a){return[a.deviceJid,a.identity]}))},d("WASignalDB").signalOp("loadIdentities"))};b=function(a){return d("WASignalDB").getDb().runInTransaction(["identity"],"readonly",async function(b){var c=await Promise.all(a.map(function(a){return b.stores.identity.readIndex("userJid",[a])})),d=new Map();for(c of c)for(var e of c){if(e==null)continue;var f=d.get(e.userJid);f==null&&(f=new Map());f.set(e.deviceJid,e.identity);d.set(e.userJid,f)}return d},d("WASignalDB").signalOp("bulkLoadIdentities"))};g.loadIdentities=a;g.bulkLoadIdentities=b}),98);
__d("WALoadLastSyncTsApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["contacts"],"readonly",function(b){return b.stores.contacts.bulkGet([a]).then(function(a){a=a.filter(Boolean).length>0?a[0]:null;return(a=a==null?void 0:a.lastSyncTs)!=null?a:null})},d("WASignalDB").signalOp("loadLastSyncTs"))};g.loadLastSyncTs=a}),98);
__d("WADbMetaTxns",["WADbSignal","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.meta.bulkGet([d("WADbSignal").MetaKeysEnum.lastSignedPrekeyId,d("WADbSignal").MetaKeysEnum.identityKeyPair]).then(function(a){var b=a[0];a=a[1];b=b==null?void 0:b.value.lastSignedPrekeyId;a=a==null?void 0:a.value.identityKeyPair;return{identityPair:a,keyId:b}})}b=function(a){return d("WASignalDB").getDb().runInTransaction(["meta"],"readwrite",async function(b){await b.stores.meta.bulkPut([{key:d("WADbSignal").MetaKeysEnum.cat,value:{cat:a}}]);return a},d("WASignalDB").signalOp("saveCAT"))};g.maybeGetLastSignedPrekeyIdAndIdentity=a;g.saveCAT=b}),98);
__d("WADbSignedPrekeyTxns",["WADbMetaTxns","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){var b=await d("WADbMetaTxns").maybeGetLastSignedPrekeyIdAndIdentity(a),c=b.identityPair;b=b.keyId;if(b==null)if(c==null)return d("WAResultOrError").makeError("missing-last-signed-prekey-id-and-registration");else return d("WAResultOrError").makeError("missing-last-signed-prekey-id");c=await a.signedPrekey.get(b);return c==null?d("WAResultOrError").makeError("missing-last-signed-prekey"):d("WAResultOrError").makeResult(c.encoded)}g.getLatestSignedPreKey=a}),98);
__d("WALoadLatestSignedPreKeyApi",["WADbSignedPrekeyTxns","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return d("WASignalDB").getDb().runInTransaction(["meta","signedPrekey"],"readonly",function(a){return d("WADbSignedPrekeyTxns").getLatestSignedPreKey(a.stores)},d("WASignalDB").signalOp("loadLatestSignedPreKey"))};g.loadLatestSignedPreKey=a}),98);
__d("WALoadOneTimePreKeyApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["prekey"],"readonly",function(b){return b.stores.prekey.get(a).then(function(a){return a==null?void 0:a.encoded})},d("WASignalDB").signalOp("loadOneTimePreKey"))};g.loadOneTimePreKey=a}),98);
__d("WADbPrekeyTxns",["WAGetPrekeyIdsInRange","err"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){b=await a.prekeyGeneration.get(b);if(b==null)throw c("err")("Expected a prekey generation row");b=d("WAGetPrekeyIdsInRange").getPrekeyIdsInRange(b.startingId,b.endingId);a=await a.prekey.bulkGet(b);return a.filter(Boolean).map(function(a){return a.encoded})}g.getPrekeysForGeneration=a}),98);
__d("WALoadPreKeysApi",["WADbPrekeyTxns","WADbSignal","WADbSignedPrekeyTxns","WALoggerTag","WASignalDB","WASignalSignatures","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("WATagsLogger").TAGS([c("WALoggerTag").SignedPrekey]);a=function(a){return d("WASignalDB").getDb().runInTransaction(["identity","meta","prekey","prekeyGeneration","signedPrekey"],"readonly",async function(b){var e=await d("WADbSignedPrekeyTxns").getLatestSignedPreKey(b.stores);if(!e.success){var f;k.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to get latest signed prekey"])));throw(f=e.error)!=null?f:c("err")("Failed to get latest signed prekey")}var g=d("WASignalSignatures").deserializeSignedPreKey(e.value);if(g==null){k.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize signed prekey"])));throw c("err")("Failed to deserialize signed prekey")}f=a!=null?a:await b.stores.meta.get(d("WADbSignal").MetaKeysEnum.lastPrekeyGenerationId).then(function(a){return a==null?void 0:a.value.lastPrekeyGenerationId});if(f==null){k.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["No last prekey generation id"])));throw c("err")("No last prekey generation id")}return d("WADbPrekeyTxns").getPrekeysForGeneration(b.stores,f).then(function(a){return{preKeys:a,signedPreKey:g}})},d("WASignalDB").signalOp("loadPreKeys"))};g.loadPreKeys=a}),98);
__d("WALoadSenderKeySessionApi",["WACryptoManager","WADbSignal","WAJids","WAResultOrError","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b){var c=d("WAJids").extractUserJid(b);b=d("WAJids").extractDeviceId(b);var e=d("WADbSignal").buildSenderKeySessionId(a,c,b);return d("WASignalDB").getDb().runInTransaction(["senderKeySessions"],"readonly",async function(a){a=await a.stores.senderKeySessions.get(e);if(a==null)return d("WAResultOrError").makeError("errLoadSenderKeySession");a=d("WACryptoManager").decodeSenderKeySession(a.record);return d("WAResultOrError").makeResult(a)},d("WASignalDB").signalOp("loadSenderKeySession"))};g.loadSenderKeySession=a}),98);
__d("WALoadSignedPreKeyApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["signedPrekey"],"readonly",function(b){return b.stores.signedPrekey.get(a).then(function(a){return a==null?void 0:a.encoded})},d("WASignalDB").signalOp("loadSignedPreKey"))};g.loadSignedPreKey=a}),98);
__d("WASaveOneTimePreKeyApi",["WADbSignal","WAResultOrError","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["meta","prekey"],"readwrite",async function(b){var c=await b.stores.meta.get(d("WADbSignal").MetaKeysEnum.lastPrekeyId);c=c==null?void 0:c.value.lastPrekeyId;if(c==null)return d("WAResultOrError").makeError("missing_last_prekey");await Promise.all([b.stores.prekey.bulkPut([babelHelpers.extends({},a,{isDeleted:!1})]),b.stores.meta.bulkPut([{key:d("WADbSignal").MetaKeysEnum.lastPrekeyId,value:{lastPrekeyId:a.keyId}}])]);return d("WAResultOrError").makeResult()},d("WASignalDB").signalOp("saveOneTimePreKey"))};g.saveOneTimePreKey=a}),98);
__d("WASavePreKeysGenerationApi",["WACryptoManager","WADbSignal","WAResultOrError","WASignalDB","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a){if(a.length===0)throw c("err")("Keys provided to savePreKeysGeneration cannot be empty");var b=await d("WASignalDB").getDb().runInTransaction(["meta","prekey","prekeyGeneration"],"readwrite",async function(b){var c=await b.stores.meta.get(d("WADbSignal").MetaKeysEnum.lastPrekeyGenerationId);c=d("WACryptoManager").castToPreKeyGenerationId(((c=c==null?void 0:c.value.lastPrekeyGenerationId)!=null?c:0)+1);var e=a[0].keyId,f=a[a.length-1].keyId,g=a.map(function(a){return babelHelpers.extends({},a,{isDeleted:!1})});await Promise.all([b.stores.prekey.bulkPut(g),b.stores.meta.bulkPut([{key:d("WADbSignal").MetaKeysEnum.lastPrekeyId,value:{lastPrekeyId:f}},{key:d("WADbSignal").MetaKeysEnum.lastPrekeyGenerationId,value:{lastPrekeyGenerationId:c}}]),b.stores.prekeyGeneration.bulkPut([{createdTs:d("WATimeUtils").unixTime(),endingId:f,generationId:c,startingId:e}])]);return d("WAResultOrError").makeResult(c)},d("WASignalDB").signalOp("savePreKeysGeneration"));return b};g.savePreKeysGeneration=a}),98);
__d("WASaveSignedPreKeyIfNewApi",["WADbSignal","WASignalDB","WASignalSignatures"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b){return d("WASignalDB").getDb().runInTransaction(["meta","signedPrekey"],"readwrite",async function(c){var e=await c.stores.signedPrekey.get(a);if(e!=null){e=d("WASignalSignatures").deserializeSignedPreKey(e.encoded);if(e!=null)return{key:e,type:"duplicate"}}await Promise.all([c.stores.signedPrekey.bulkPut([{encoded:b,keyId:a}]),c.stores.meta.bulkPut([{key:d("WADbSignal").MetaKeysEnum.lastSignedPrekeyId,value:{lastSignedPrekeyId:a}}])]);return{type:"success"}},d("WASignalDB").signalOp("saveSignedPreKeyIfNew"))};g.saveSignedPreKeyIfNew=a}),98);
__d("WASessionApi",["WACryptoManager","WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().store("session").get(a).then(function(a){return a==null?null:d("WACryptoManager").decodeSession(a.session)})};b=function(a){return d("WASignalDB").getDb().store("session").bulkGet(a).then(h)};function h(a){var b=new Map();for(a of a){if(a==null)continue;var c=d("WACryptoManager").decodeSession(a.session);b.set(a.id,c)}return b}g.loadSession=a;g.bulkLoadSession=b}),98);
__d("WACryptoDbCallbacks",["WABulkSaveSignalDataApi","WADeletePreKeyGenerationsApi","WAGetLastPreKeyGenerationIdApi","WAGetPreKeyGenerationsTimestampsApi","WALoadICDCApi","WALoadIdentitiesApi","WALoadLastSyncTsApi","WALoadLatestSignedPreKeyApi","WALoadOneTimePreKeyApi","WALoadPreKeysApi","WALoadSenderKeySessionApi","WALoadSignedPreKeyApi","WASaveOneTimePreKeyApi","WASavePreKeysGenerationApi","WASaveSignedPreKeyIfNewApi","WASessionApi"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return{bulkLoadIdentities:d("WALoadIdentitiesApi").bulkLoadIdentities,bulkSaveSignalData:d("WABulkSaveSignalDataApi").bulkSaveSignalData,deletePreKeyGenerations:d("WADeletePreKeyGenerationsApi").deletePreKeyGenerations,getLastPreKeyGenerationId:d("WAGetLastPreKeyGenerationIdApi").getLastPreKeyGenerationId,getPreKeyGenerationsTimestamps:d("WAGetPreKeyGenerationsTimestampsApi").getPreKeyGenerationsTimestamps,loadICDC:d("WALoadICDCApi").loadICDC,loadIdentities:d("WALoadIdentitiesApi").loadIdentities,loadLastSyncTs:d("WALoadLastSyncTsApi").loadLastSyncTs,loadLatestSignedPreKey:d("WALoadLatestSignedPreKeyApi").loadLatestSignedPreKey,loadOneTimePreKey:d("WALoadOneTimePreKeyApi").loadOneTimePreKey,loadPreKeys:d("WALoadPreKeysApi").loadPreKeys,loadSenderKeySession:d("WALoadSenderKeySessionApi").loadSenderKeySession,loadSession:d("WASessionApi").loadSession,loadSessions:d("WASessionApi").bulkLoadSession,loadSignedPreKey:d("WALoadSignedPreKeyApi").loadSignedPreKey,saveOneTimePreKey:d("WASaveOneTimePreKeyApi").saveOneTimePreKey,savePreKeysGeneration:d("WASavePreKeysGenerationApi").savePreKeysGeneration,saveSignedPreKeyIfNew:d("WASaveSignedPreKeyIfNewApi").saveSignedPreKeyIfNew}};g.getCryptoDbCallbacks=a}),98);
__d("WAMPSFlushable",["MpsTypes","WebMps","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=new Map(),this.$3=new Set()}var b=a.prototype;b.enqueue=function(a,b,c){if(a==null)return;this.$1.push(a);this.$2.set(a.messageId,b);this.$3.add(c)};b.flush=async function(a,b,e,f,g){if(this.$1.length===0)return;a=this.$1;b=Array.from(this.$3).join(", ");f=this.$2;this.$1=[];this.$2=new Map();this.$3=new Set();try{var h=await d("WebMps").mps().saveNewMessages(a.map(function(a){return{directive:null,message:a,insertionSource:d("MpsTypes").InsertionSource.Receive}}),{source:b});f.forEach(function(a,b){a(h.get(b))})}catch(a){var i=c("getErrorSafe")(a);e==null||e.addPoint("mps_persistance_fail");f.forEach(function(a){a(i)})}};return a}();b=new a();g.MPSFlushable=a;g.mpsFlushable=b}),98);
__d("WASignalEntityStoreV2",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["NOT_PERSISTED","PERSIST_IN_PROGRESS","PERSISTED"]);a=function(){function a(){this.$1=new Map()}var b=a.prototype;b.TEST_ONLY_LOAD_FROM_MEMORY=function(a){return this.$2(a)};b.$2=function(a){a=this.$1.get(a);return a!=null?{entity:a.entity,deleted:a.deleted}:null};b.load=async function(a,b){var c=this.$2(a);if(c!=null&&c.deleted)return null;if(c!=null&&c.entity!=null)return c.entity;c=await b(a);this.$3(a,c);return c};b.bulkLoad=async function(a,b){var c=[],d=new Map();for(a of a){var e=this.$2(a);if(e==null){c.push(a);continue}if(e.deleted)continue;e.entity!=null?d.set(a,e.entity):c.push(a)}e=await b(c);for(a of e.entries()){b=a[0];c=a[1];d.set(b,c);this.$3(b,c)}return d};b.$3=function(a,b){this.$1.set(a,{entity:b,status:g.PERSISTED,deleted:!1})};b.store=function(a,b){this.$1.set(a,{entity:b,status:g.NOT_PERSISTED,deleted:!1})};b.remove=function(a){this.$1.set(a,{entity:null,status:g.NOT_PERSISTED,deleted:!0})};b.pureSnapshot=function(){var a=[],b=Array.from(this.$1.entries()).filter(function(a){a[0];a=a[1];return a.status===g.NOT_PERSISTED}).filter(function(b){var c=b[0];b=b[1];b.deleted&&a.push({id:c});return!b.deleted}).filter(function(a){a[0];a=a[1];return a.entity!=null}).map(function(a){var b=a[0];a=a[1];return{id:b,cachedEntity:a.entity}});return{update:b,remove:a}};b.snapshot=function(){var a=this,b=this.pureSnapshot();b.remove.forEach(function(b){b=b.id;b=a.$1.get(b);b&&(b.status=g.PERSIST_IN_PROGRESS)});b.update.forEach(function(b){b=b.id;b=a.$1.get(b);b&&(b.status=g.PERSIST_IN_PROGRESS)});return b};b.markSnapshotAsCommitted=function(){this.$1.forEach(function(a){a.status===g.PERSIST_IN_PROGRESS&&(a.status=g.PERSISTED)})};b.markSnapshotAsFailed=function(){this.$1.forEach(function(a){a.status===g.PERSIST_IN_PROGRESS&&(a.status=g.NOT_PERSISTED)})};b.clear=function(){this.$1=new Map()};return a}();f.PersistStatus=g;f.SignalEntityStore=a}),66);
__d("WASignalIdentityStore",["WAJids","WALogger","WASignalEntityStoreV2"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){this.$1=new Map(),this.$2=new(d("WASignalEntityStoreV2").SignalEntityStore)()}var b=a.prototype;b.bulkLoadIdentities=async function(a){var b=this,c=async function(){var a=d[0],c=d[1];await b.loadIdentitiesByUser(a,function(){return Promise.resolve(c)})};for(var d of a)await c();return a};b.loadIdentitiesByUser=async function(a,b){var c=this.$1.get(a);if(c==null){var e=this.$3(a,await b(a));b=Array.from(e.keys());this.$1.set(a,new Set(b));return this.$2.bulkLoad(b,function(){return Promise.resolve(e)})}else return this.$2.bulkLoad(Array.from(c),function(a){a.length>0&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[WASignalIdentityStore] This should never happen."])));return Promise.resolve(new Map())})};b.$3=function(a,b){b=new Map(b);var c=this.$2.pureSnapshot(),e=c.remove;c=c.update;for(e of e){var f=e.id;b.delete(f)}for(f of c){e=f.id;c=f.cachedEntity;c!=null&&d("WAJids").extractUserJid(e)===a&&b.set(e,c)}return b};b.store=function(a,b){this.$2.store(a,b);b=d("WAJids").extractUserJid(a);b=this.$1.get(b);b!=null&&b.add(a)};b.remove=function(a){this.$2.remove(a);var b=d("WAJids").extractUserJid(a);b=this.$1.get(b);b!=null&&b.delete(a)};b.clear=function(){this.$2.clear(),this.$1=new Map()};b.load=function(a,b){return this.$2.load(a,b)};b.bulkLoad=function(a,b){return this.$2.bulkLoad(a,b)};b.snapshot=function(){return this.$2.snapshot()};b.pureSnapshot=function(){return this.pureSnapshot()};b.markSnapshotAsCommitted=function(){this.$2.markSnapshotAsCommitted()};b.markSnapshotAsFailed=function(){this.$2.markSnapshotAsFailed()};return a}();g.SignalIdentityStore=a}),98);
__d("WAInMemorySignalStore",["MAWMpsGating","WAArmadilloTransportEvent.pb","WABuildMpsPayload","WACryptoManager","WACryptoUtils","WAGlobals","WAIdentityUtils","WAJids","WAMPSFlushable","WAProtocolQueue","WAResultOrError","WASignalEntityStoreV2","WASignalIdentityStore","WATagsLogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t=d("WATagsLogger").TAGS(["CryptoManager","InMemorySignalStore"]);a=function(){function a(a,b){var c=this;this.loadSession=function(a,b){return c.$1.load(a,function(a){return c.$9.loadSession(a,b)})};this.loadSessions=function(a){return c.$1.bulkLoad(a,function(a){return c.$9.loadSessions(a).then(function(a){return new Map(Array.from(a.entries()).map(function(a){return[a[0],a[1]]}))})}).then(function(a){return new Map(Array.from(a.entries()).map(function(a){return[a[0],a[1]]}))})};this.loadSignedPreKey=function(a){return c.$7.load(a,function(){return c.$9.loadSignedPreKey(a)})};this.bulkLoadIdentities=function(a){var b=new Map();return Promise.all(a.map(function(a){return c.loadIdentities(a).then(function(c){b.set(a,c)})})).then(function(){return b})};this.loadIdentities=function(a){return c.$5.loadIdentitiesByUser(a,function(){return c.$9.loadIdentities(a)})};this.saveIdentity=function(a,b){return Promise.resolve(c.storeIdentity(a,b))};this.loadOneTimePreKey=function(a){return c.$6.load(a,function(){return c.$9.loadOneTimePreKey(a)})};this.saveSenderKeySession=function(a,b,d){c.storeSenderKeySession(a,b,d);return Promise.resolve()};this.saveSignedPreKeyIfNew=function(a,b){return c.$9.saveSignedPreKeyIfNew(a,b)};this.loadSenderKeySession=async function(a,b){var e=await c.$8.load(d("WACryptoManager").encodeSenderKey(a,b),async function(){var d=await c.$9.loadSenderKeySession(a,b);return d.success?d.value:null});return e==null?d("WAResultOrError").makeError("errLoadSenderKeySession"):d("WAResultOrError").makeResult(e)};this.handleNewSession=function(a,b,e,f,g){c.storeSession(a,b);e!=null&&c.storeIdentity(a,e);f!=null&&c.removeOneTimePreKey(f);return Promise.resolve(d("WAResultOrError").makeResult())};this.saveICDC=function(a,b){c.$3.store(a,b);return Promise.resolve()};this.loadICDC=function(a){return c.$3.load(a,function(){return c.$9.loadICDC(a)})};this.saveLastSyncTs=function(a,b){c.$4.store(a,b);return Promise.resolve()};this.loadLastSyncTs=function(a){return c.$4.load(a,function(){return c.$9.loadLastSyncTs(a)})};this.saveDhash=function(a,b){c.$2.store(a,b);return Promise.resolve()};this.getLastPreKeyGenerationId=function(){return c.$9.getLastPreKeyGenerationId()};this.savePreKeysGeneration=function(a){return c.$9.savePreKeysGeneration(a)};this.getPreKeyGenerationsTimestamps=function(){return c.$9.getPreKeyGenerationsTimestamps()};this.deletePreKeyGenerations=function(a){return c.$9.deletePreKeyGenerations(a)};this.saveOneTimePreKey=function(a){return c.$9.saveOneTimePreKey(a)};this.loadPreKeys=function(a){return c.$9.loadPreKeys(a)};this.loadLatestSignedPreKey=function(){return c.$9.loadLatestSignedPreKey()};this.$9=a;this.$10=b;this.$5=new(d("WASignalIdentityStore").SignalIdentityStore)();this.$1=new((a=d("WASignalEntityStoreV2")).SignalEntityStore)();this.$2=new a.SignalEntityStore();this.$3=new a.SignalEntityStore();this.$4=new a.SignalEntityStore();this.$6=new a.SignalEntityStore();this.$7=new a.SignalEntityStore();this.$8=new a.SignalEntityStore()}var b=a.prototype;b.storeSession=function(a,b){this.$1.store(a,b)};b.storeIdentity=function(a,b){if(!b)return;this.$5.store(a,b)};b.removeOneTimePreKey=function(a){this.$6.remove(a)};b.storeSenderKeySession=function(a,b,c){this.$8.store(d("WACryptoManager").encodeSenderKey(a,b),c)};b.updateUserDevicesInfo=function(a){var b=this;return Promise.all(a.map(async function(a){var c=await b.loadIdentities(a.jid),e=a.devices,f=a.jid,g=a.notificationTs,o=a.dhash,p=a.icdcInfo,q=a.lastSyncTs;t.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Update user devices: userJid: ","; new identities: ","; previous identities: ","}"])),f,e.map(function(b){b=b.id;return d("WAJids").toDeviceJid(a.jid,b)}).join(","),Array.from(c.keys()).join(","));var r=new Set(c.keys()),s=[],u=[];for(var v of e){var w=v.id,x=v.identity,y=v.model,z=v.platform;w=d("WAJids").toDeviceJid(a.jid,w);var A=c.get(w);if(d("WAGlobals").getMyDeviceJid()===w){var B=d("WACryptoUtils").uint8ArraysEqual(d("WAIdentityUtils").removeKeyTypeIfNeeded(b.$10.staticKeyPair.publicKey),d("WAIdentityUtils").removeKeyTypeIfNeeded(x));B||t.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Receiving an identity for my device but it is different from original one"])))}r.delete(w);if(A==null)u.push({instruction:"identityAdded",jid:d("WAJids").extractUserJid(w),type:"instruction",device:w,identity:x,model:y,platform:z,notificationTs:g,priority:d("WAProtocolQueue").WAProtocolQueuePriorityLow});else if(!d("WACryptoUtils").uint8ArraysEqual(A,x)){if(d("WAJids").extractUserJid(w)!==f){t.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Device notification of one user cannot remove session the other one"])));continue}s.push(w);t.DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Removing session dur to identity mismatch: ",""])),w);u.push({instruction:"identityChanged",jid:d("WAJids").extractUserJid(w),type:"instruction",device:w,identity:x,model:y,platform:z,notificationTs:g,priority:d("WAProtocolQueue").WAProtocolQueuePriorityLow})}}B=[];for(A of r){if(d("WAJids").extractUserJid(A)!==f){t.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Device notification of one user cannot remove identity the other one "])));continue}B.push(A);d("WAGlobals").getMyDeviceJid()===A&&t.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Removing my device identity. This should not happen"])));t.DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Removing old identity: ",""])),A);u.push({instruction:"identityRemoved",jid:d("WAJids").extractUserJid(A),type:"instruction",device:A,notificationTs:g,priority:d("WAProtocolQueue").WAProtocolQueuePriorityLow})}return Promise.all([o!=null?b.saveDhash(f,o):Promise.resolve(),q!=null?b.saveLastSyncTs(f,q):Promise.resolve(),p!=null?b.saveICDC(f,p):Promise.resolve()].concat(Array.from(B).map(function(a){return b.deleteIdentity(a)}),[B.concat(s).map(function(a){return b.$11(a)})],e.map(function(c){var a=c.id;c=c.identity;return b.saveIdentity(d("WAJids").toDeviceJid(f,a),c)}))).then(function(){return u})})).then(function(a){a=a.flat();a.forEach(function(a){var b;switch(a.instruction){case"identityAdded":b=d("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.ADDED;break;case"identityChanged":b=d("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.REPLACED;break;case"identityRemoved":b=d("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.REMOVED;break;default:return}if(d("MAWMpsGating").isFullMpsEnabled()||d("MAWMpsGating").isMpsWaAdminMsgsEnabled()){var c,e=d("WAGlobals").getDependencies().generateExternalId();d("WAMPSFlushable").mpsFlushable.enqueue(d("WABuildMpsPayload").buildMpsDeviceChangeAdminMessage(a.jid,(c=a.notificationTs)!=null?c:d("WATimeUtils").unixTime(),e,b,a.platform,a.model),function(a){if(a!=null){t.ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Failed to save device change admin message: ",""])),a);return}},"handle_device_change")}d("MAWMpsGating").isFullMpsEnabled()||d("WAProtocolQueue").pqFlushable.enqueue(a)});d("MAWMpsGating").isFullMpsEnabled()&&d("WAGlobals").getDependencies().recordDeviceChangeHistory(a.map(function(a){var b;if(a.device==null)return null;var c=a.device;switch(a.instruction){case"identityAdded":return{jid:a.jid,deviceChangeType:d("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.ADDED,platform:a.platform,model:a.model,device:c,identity:a.identity,ts:(b=a.notificationTs)!=null?b:d("WATimeUtils").unixTime()};case"identityChanged":return{jid:a.jid,deviceChangeType:d("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.REPLACED,platform:a.platform,model:a.model,device:c,identity:a.identity,ts:(b=a.notificationTs)!=null?b:d("WATimeUtils").unixTime()};case"identityRemoved":return{jid:a.jid,deviceChangeType:d("WAArmadilloTransportEvent.pb").TransportEvent$Event$DeviceChange$Type.REMOVED,device:c,ts:(b=a.notificationTs)!=null?b:d("WATimeUtils").unixTime()};default:return null}}).filter(Boolean)).catch(function(a){t.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Failed to record device change history: ",""])),a)})}).then(function(){})};b.savePendingToDatabase=function(){var a=this,b=this.$12();if(b==null)return Promise.resolve();t.DEV(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Snapshot: ",""])),b);t.LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Snapshot save: start"])));return this.$9.bulkSaveSignalData(b).then(function(){t.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Snapshot save: end"]))),a.$13()},function(b){a.$14();return Promise.reject(b)})};b.clear=function(){this.$1.clear(),this.$5.clear(),this.$6.clear(),this.$7.clear(),this.$8.clear(),this.$2.clear(),this.$3.clear()};b.deleteIdentity=function(a){this.$5.remove(a);return Promise.resolve()};b.$11=function(a){this.$1.remove(a);return Promise.resolve()};b.$13=function(){this.$1.markSnapshotAsCommitted(),this.$2.markSnapshotAsCommitted(),this.$3.markSnapshotAsCommitted(),this.$4.markSnapshotAsCommitted(),this.$5.markSnapshotAsCommitted(),this.$6.markSnapshotAsCommitted(),this.$7.markSnapshotAsCommitted(),this.$8.markSnapshotAsCommitted()};b.$14=function(){this.$1.markSnapshotAsFailed(),this.$2.markSnapshotAsFailed(),this.$3.markSnapshotAsFailed(),this.$4.markSnapshotAsFailed(),this.$5.markSnapshotAsFailed(),this.$6.markSnapshotAsFailed(),this.$7.markSnapshotAsFailed(),this.$8.markSnapshotAsFailed()};b.$12=function(){var a=this.$1.snapshot(),b=[],c=a.remove.map(function(a){return a.id});a.update.forEach(function(c){var a=c.id;c=c.cachedEntity;if(c==null)return;b.push({id:a,updated:c})});var e=[];this.$8.snapshot().update.forEach(function(a){var b=d("WACryptoManager").decodeSenderKey(a.id),c=b.groupId;b=b.deviceId;a.cachedEntity!=null&&c&&b&&e.push({groupId:c,author:b,updated:a.cachedEntity})});a=this.$5.snapshot();var f=a.remove.map(function(a){return a.id}),g=[];a.update.forEach(function(b){var a=b.id;b=b.cachedEntity;if(b==null)return;g.push({id:a,identity:b})});a=this.$6.snapshot().remove;var h=this.$2.snapshot(),i=[];for(h of h.update){var j=h.cachedEntity,k=h.id;j!=null&&i.push({id:k,dhash:j})}k=this.$4.snapshot();j=[];for(h of k.update){k=h.cachedEntity;var l=h.id;k!=null&&j.push({id:l,lastSyncTs:k})}l=this.$3.snapshot();k=[];for(h of l.update){l=h.cachedEntity;var m=h.id;l!=null&&k.push({id:m,icdc:l})}return b.length===0&&c.length===0&&g.length===0&&e.length===0&&a.length===0&&k.length===0&&i.length===0&&j.length===0&&f.length===0?null:{dhashUpdate:i,icdcUpdate:k,identityRemove:f,identityUpdate:g,preKeyRemove:a,senderKeySessionUpdate:e,sessionRemove:c,sessionUpdate:b,lastSyncTsUpdate:j}};b.warmCache=async function(a){var b=this;a=a.map(d("WAJids").interpretAsUserJid).filter(Boolean);a=await this.$9.bulkLoadIdentities(a).then(function(a){return b.$5.bulkLoadIdentities(a)});a=Array.from(a.values()).reduce(function(a,b){return a.concat(Array.from(b.keys()))},[]);await this.loadSessions(a)};return a}();g.InMemorySignalStoreImpl=a}),98);
__d("WARequestKeysBatcher",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h={delayMs:50,maxSize:100};function a(a,b){b=b===void 0?h:b;var c=b.delayMs,e=b.maxSize,f=null;function g(b){f&&f.args===b&&(f=null);return a(b)}return function(a){if(f!=null)f.args.push(a);else{var b=[a],h=new(d("WAResolvable").Resolvable)();a=h.promise.then(g);var i=function(){return void h.resolve(b)},j=setTimeout(i,c);f={args:b,batchPromise:a,run:i,timer:j}}a=f;i=a.args;j=a.batchPromise;var k=i.length-1;if(i.length>=e){clearTimeout((a=f)==null?void 0:a.timer);f.run();f=null}return j.then(function(a){return a[k]})}}g.makeSimpleBatcher=a}),98);
__d("WARequestKeys",["WABulkRequestKeys","WAPromiseManagement","WARequestKeysBatcher","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";a=d("WARequestKeysBatcher").makeSimpleBatcher(async function(a){var b=await d("WABulkRequestKeys").bulkRequestKeys(a);return b.success===!1?a.map(function(){return b}):a.map(function(a){a=b.value.get(a);return a?d("WAResultOrError").makeResult(a):d("WAResultOrError").makeError("errRequestKeysNoKeys")})});b=d("WAPromiseManagement").cacheWhilePending(function(a){return a},a);g.requestKeys=b}),98);
__d("WACryptoManagerUtils",["WABulkRequestKeys","WACryptoDbCallbacks","WACryptoManager","WAGlobals","WAHandleFailureUtils","WAInMemorySignalStore","WALogger","WALoggerTag","WAPREList","WAPREMetrics","WARequestKeys","WAResultOrError","WASignalKeys","WASignalSignatures","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p=d("WATagsLogger").TAGS([c("WALoggerTag").SignedPrekey]);function a(a){var b=new(d("WAInMemorySignalStore").InMemorySignalStoreImpl)(d("WACryptoDbCallbacks").getCryptoDbCallbacks(),a),c=q();return{manager:d("WACryptoManager").initCryptoManager({regInfo:a,storage:b,network:c}),storage:b}}function q(){return{requestKeys:d("WARequestKeys").requestKeys,bulkRequestKeys:d("WABulkRequestKeys").bulkRequestKeys}}function b(a,b,c,e){var f=null;return d("WACryptoManager").decryptContent(e.cryptoManager,b,{ciphertext:c,type:a},function(a,b){f={plaintext:a,remoteIdentity:b};return Promise.resolve()}).then(function(a){if(a.success)return d("WAResultOrError").makeResult(f);else return a}).catch(function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["DecryptMsg runtime error: ",""])),a);throw a})}function e(a,b,c,e){var f=null;return d("WACryptoManager").decryptGroupContent(e.cryptoManager,a,b,c,function(a){f={plaintext:a};return Promise.resolve()}).then(function(a){if(a.success)return d("WAResultOrError").makeResult(f);else return a}).catch(function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["DecryptMsg runtime error: ",""])),a);throw a})}function f(a,b){return d("WACryptoManager").getParticipantInfo(b,a)}function r(a){return a.storage.getPreKeyGenerationsTimestamps()}function s(a,b){return b.storage.deletePreKeyGenerations(a)}function t(a,b,c,e){return d("WACryptoManager").saveSenderKeySession(e.cryptoManager,a,b,c)}async function u(a){var b=await a.storage.loadLatestSignedPreKey();if(b.success===!1){p.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Missing signed prekey: ",", triggering reregistration"])),b.error);await d("WAHandleFailureUtils").reregisterPhone();throw c("err")("No signed prekey: "+b.error)}b=d("WASignalSignatures").deserializeSignedPreKey(b.value);if(b==null){p.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Cannot deserialize signed prekey"])));throw c("err")("Cannot deserialize signed prekey")}var e=await d("WACryptoManager").generateOneTimePreKey(a);if(e==null){d("WATagsLogger").TAGS([c("WALoggerTag").OneTimePrekey]).ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate one time prekey"])));throw c("err")("Cannot generate one time prekey")}a=a.regInfo;var f=a.regId;a=a.staticKeyPair;return Promise.resolve({regId:f,keyType:d("WASignalKeys").KEY_TYPE,publicKey:a.publicKey,signedPreKey:b,preKey:e})}function v(a,b,c){var e=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"group",jid:a},bool:{useLongSessionDrop:d("WAGlobals").getConfig().useLongSessionDrop()}},void 0);return d("WACryptoManager").encryptGroupContent(c.cryptoManager,a,d("WAGlobals").getMyDeviceJid(),b).then(function(a){a.success?e.endSuccess():(d("WATagsLogger").TAGS(["EncryptGroupContent"]).ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to encrypt group content: ",""])),a.error),e.endFail(a.error));return a}).catch(function(a){d("WATagsLogger").TAGS(["EncryptGroupContent"]).ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Runtime excpetion when encrypting group content: ",""])),a);e.endFail("runtime-exception");return d("WAResultOrError").makeError("runtime-exception")})}function w(a,b,c,e,f,g){var h=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"1:1",jid:c},string_array:{node_types:e,message_types:f,media_types:g},bool:{useLongSessionDrop:d("WAGlobals").getConfig().useLongSessionDrop()}},void 0);return d("WACryptoManager").bulkEncryptContent(b.cryptoManager,a).then(function(a){if(a.success)h.endSuccess();else{var b=a.error;switch(b){case"missing":case"mismatch":case"runtime-exception":break;default:break}h.endFail(b)}return a})}function x(a,b,c,e,f,g){var h=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.MESSAGE_ENCRYPTION,{string:{chat:"1:1",jid:g},bool:{useLongSessionDrop:d("WAGlobals").getConfig().useLongSessionDrop()}},void 0);return d("WACryptoManager").encryptContent(c.cryptoManager,a,b,e||d("WACryptoManager").DEFAULT_SESSION_REQUEST,f).then(function(a){if(a.success)h.endSuccess();else{var b=a.error;switch(b){case"identity-mismatch":case"errSignalInvalidKey":break;default:break}h.endFail(b)}return a})}function y(a,b){return d("WACryptoManager").bulkEncryptContent(b.cryptoManager,a).then(function(a){if(a.success===!1){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[SendMessage] Fail encrypt messages"])));return new Map()}return a.value})}async function z(a,b){a=await d("WACryptoManager").ensureSessionsExists(b.cryptoManager,a);await Promise.all(Array.from(a.entries()).map(function(a){var c=a[0];a=a[1];return b.cryptoManager.storage.handleNewSession(c,a,a.remote.pubKey)}))}g.createCryptoManager=a;g.decryptMsg=b;g.decryptGroupMsg=e;g.getParticipantInfo=f;g.getPreKeyGenerationsTimestamps=r;g.deletePreKeyGenerations=s;g.saveSenderKeySession=t;g.getSignalInfoForRetry=u;g.encryptGroupContentWithMetrics=v;g.bulkEncryptMsgWithMetrics=w;g.encryptMsgWithMetrics=x;g.bulkEncrypt=y;g.bulkPreEstablishOutgoingSession=z}),98);
__d("WADbTransactor",["MAWDexie","MAWIndexedDb","MAWTransactionMode","WAExceededStorageQuota","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=Object.keys(a),f=e.some(function(b){return a[b]===d("MAWTransactionMode").READWRITE})?d("MAWTransactionMode").READWRITE:d("MAWTransactionMode").READONLY;return function(){for(var a=arguments.length,g=new Array(a),i=0;i<a;i++)g[i]=arguments[i];return d("MAWIndexedDb").getSignalDB(b).then(function(a){return h(f,e,function(){return c(a.stores).apply(void 0,g)})}).then(function(a){return a}).catch(function(a){throw j(a,b)})}}function h(a,b,e){if(c("MAWDexie").currentTransaction!=null)throw c("err")("protocolDB transactor %s cannot be called within another transaction");return d("MAWIndexedDb").getSignalDB().then(function(c){return c.transact(a,b,e)})}function i(a){if(a instanceof Error)return a;else if(typeof a==="string")return c("err")(a);else return null}async function b(a,b,c,e){var f=a+"_"+e,g=await d("MAWIndexedDb").getDB(f);return g.transact(b,[a],function(){return c(g.stores[a])}).then(function(a){return a}).catch(function(a){throw j(a,f)})}function j(a,b){var e;d("WAExceededStorageQuota").checkQuotaExceededError(a);a=i(a);if(!a)return c("err")("[unknown error] Error performing %s transaction "+b);a.message="["+((e=a==null?void 0:a.toString())!=null?e:"unknown error")+"] Error performing %s transaction "+b;return a}g.makeSignalTransactor=a;g.persistedQueueTransactor=b}),98);
__d("WAMapUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return new Map(Array.from(a.entries()).map(function(a){return[a[0],b(a[1],a[0])]}))}f.mapValues=a}),66);
__d("WAProtocolMediaType",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case"image":case"sticker":case"gif":case"video":case"ptt":case"audio":case"document":case"product":return a;case"xma-image":return"document";default:return null}}f.castToProtocolMediaType=a}),66);
__d("WAEncNode",["WAAsMessageTransport","WACryptoManagerUtils","WAGlobals","WALogger","WAMapUtils","WAMsgTransport.pb","WANullthrows","WAProtocolMediaType","encodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,e,f){var g=new Set(),i=new Set(),m=new Set(),n=d("WAMapUtils").mapValues(a,function(a,b){var c=a.params;a=a.icdc;var d;g.add(c.type);switch(c.type){case"message":d=j({messageBytes:c.messageBytes,to:b,icdc:a,chat:c.chat,backupDirective:c.backupDirective,applicationPayloadVersion:c.applicationPayloadVersion});i.add(c.messageType.type);c.messageType.mediaType!=null&&m.add(c.messageType.mediaType);break;case"appdata":d=k({messageBytes:c.messageBytes});break;default:c.type,d=l({skdm:c.skdm,icdc:a})}return{plaintext:d}});return d("WACryptoManagerUtils").bulkEncryptMsgWithMetrics(n,b,e,Array.from(g),Array.from(i),Array.from(m)).then(function(b){if(!b.success){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to encrypt message: ",""])),b.error);return null}return d("WAMapUtils").mapValues(b.value,function(b,e){var g,h=b.type,i=b.ciphertext;b=b.baseKey;g=c("WANullthrows")((g=a.get(e))==null?void 0:g.params);var j=g.type==="message"&&g.messageType.type==="media"?d("WAProtocolMediaType").castToProtocolMediaType(g.messageType.mediaType):null;return{encType:"device",to:e,v:((e=g.messageBytes)==null?void 0:e.version)==="v2"?"2":"3",type:h,mediaType:j,count:f,ciphertext:i,baseKey:b}})})}function b(a,b,c,e,f,g,h,m){var n;switch(b.type){case"message":n=j({messageBytes:b.messageBytes,to:a,icdc:h,chat:b.chat,backupDirective:m,applicationPayloadVersion:b.applicationPayloadVersion});break;case"appdata":n=k({messageBytes:b.messageBytes});break;default:b.type,n=l({skdm:b.skdm,icdc:h})}m=d("WACryptoManagerUtils").encryptMsgWithMetrics(a,n,c,f,g,b==null?void 0:b.chat);return m.then(function(c){var f;if(!c.success){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg failed to encrypt message: ",""])),c.error);return null}var g=b.type==="message"&&b.messageType.type==="media"?d("WAProtocolMediaType").castToProtocolMediaType(b.messageType.mediaType):null,h=c.value,j=h.type;h=h.ciphertext;return{encType:"device",to:a,v:((f=b.messageBytes)==null?void 0:f.version)==="v2"?"2":"3",type:j,mediaType:g,count:e,ciphertext:h,baseKey:c.value.baseKey}})}function j(a){var b=a.messageBytes,c=a.to,e=a.icdc,f=a.chat,g=a.backupDirective;a=a.applicationPayloadVersion;if(b.version==="v3"){var h=null;d("WAGlobals").isPeerDevice(c)&&(h=f);f=d("WAAsMessageTransport").asMessageTransport(b.bytes,h,null,e,g,a);return d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,f).readByteArrayView()}else if(d("WAGlobals").isPeerDevice(c))return b.bytesForPeer;else return b.bytes}function k(a){a=a.messageBytes;if(a.version==="v3"){a=d("WAAsMessageTransport").asMessageTransport(a.bytes);return d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,a).readByteArrayView()}else throw c("err")("Plaintext v2 not supported yet")}function l(a){var b=a.skdm;a=a.icdc;b=d("WAAsMessageTransport").asMessageTransport(null,null,b,a);return d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,b).readByteArrayView()}g.getEncNodes=a;g.getEncNode=b}),98);
__d("WAPhash",["Promise","WABase64","WABinary","WACryptoDependencies","WALogger","WASortedLists"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Calculate pHash -- Start"])));a=d("WASortedLists").sortAndDedupe(a);var c=new(d("WABinary").Binary)();for(var e=0;e<a.length;e++)c.writeString(a[e]);return(j||(j=b("Promise"))).resolve(d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",c.readByteArrayView()).then(function(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Calculate pHash -- end"])));a=new Uint8Array(a,0,6);return"2:"+d("WABase64").encodeB64(a)}))}g.calculatePHash=a}),98);
__d("WAEncUserMsg",["WAComputeICDC","WAEncNode","WAGlobals","WAJids","WAPhash","WATagsLogger","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r=d("WATagsLogger").TAGS(["WAEncUserMsg"]);async function a(a,b,e,f){r.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- START"])));a.length===0&&r.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- no recipient"])));r.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- ICDC"])));var g=a.flatMap(function(a){return a.devicesInfo}).map(function(a){return a.jid});u(a)&&r.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- OTHER_RECIPENT_DEVICE_EMPTY"])));var m;b.type==="message"&&!c("gkx")("3176")&&(m=await v(a,e,f));return Promise.all([s(g,b,e,m,f),d("WAPhash").calculatePHash(g.concat(d("WAGlobals").getMyDeviceJid()))]).then(function(a){var b=a[0];a=a[1];r.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptUserMsg -- user message -- DONE"])));return{participants:b,phash:a}})}function b(a,b,c){return s(a,b,c)}function s(a,b,c,d,e){return t(a,b,c,d,e).then(function(a){if(a.length===0){r.WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- getParticipantNodes -- EMPTY NODE"])));e==null||e.addPoint("getParticipantNodes_empty_node");return}return a})}function e(a,b,c,e,f,g){return d("WAEncNode").getEncNode(a,b,c,e,f,g)}function t(a,b,c,e,f){var g=!1;r.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- encrypt -- getParticipantNodes -- START"])));(b.type!=="message"||d("WAJids").interpretAsGroupJid(b.chat)!=null)&&(g=!0);a=d("WAEncNode").getEncNodes(new Map(a.map(function(a){return[a,{params:b,icdc:e}]})),c).then(function(a){if(a==null){r.WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- encrypt - getParticipantNodes -- EMPTY DEVICE JIDS"])));f==null||f.addPoint("getParticipantNodes_empty_device_jids");return[]}b.type==="message"&&(g=g||Array.from(a.keys()).some(function(a){return d("WAJids").extractUserJid(a)===b.chat}));return Array.from(a==null?void 0:a.values())});return a.then(function(a){if(g)return a;else{r.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- getParticipantNodes -- receiverEncypted -- FALSE"])));f==null||f.addPoint("getParticipantNodes_receiverEncypted_false");return[]}}).then(function(a){return a.filter(Boolean)})}function u(a){return a.filter(function(a){return a.user!==d("WAGlobals").getMyUserJid()}).flatMap(function(a){return a.devicesInfo}).length===0}async function v(a,b,c){var e;try{c==null||c.addPoint("icdc_start"),e=await d("WAComputeICDC").computeICDC(a,d("WAGlobals").getMyUserJid(),d("WAGlobals").getMyDeviceJid(),b),c==null||c.addPoint("icdc_end",{bool:{isICDCEmpty:e==null}})}catch(a){c==null||c.addPoint("icdc-error"),r.ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["WAEncUserMsg -- ICDC calc error: ",""])),a)}return e}g.encryptUserMsg=a;g.encryptGroupFanoutMsg=b;g.encryptDeviceJidMessage=e}),98);
__d("WAGetUserDevices",[],(function(a,b,c,d,e,f){"use strict";async function a(a,b){b=await b.storage.bulkLoadIdentities(a);return Array.from(b).flatMap(function(a){a=a[1];return Array.from(a.keys())})}f.getUserDevices=a}),66);
__d("WAEncGroupMsg",["WAAsMessageTransport","WABridge","WACryptoManager","WACryptoManagerUtils","WADbPersonalSenderKeyStatusTxns","WAEncUserMsg","WAGetUserDevices","WAGlobals","WAHex","WAMsgTransport.pb","WAOdsEnums","WAPhash","WAPromiseQueue","WAProtocolMediaType","WAResultOrError","WASortedLists","WATagsLogger","WATimeUtils","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o=d("WATagsLogger").TAGS(["WAEncGroupMsg"]),p=30*d("WATimeUtils").DAY_SECONDS,q=new(d("WAPromiseQueue").PromiseQueue)();async function r(a,b,c){var e=a.senderKeyId;if(e==null||a.rotateSenderKey||!d("WATimeUtils").happenedWithin(a.ts,p))return d("WAResultOrError").makeError("sender-key-invalid");c=await c.cryptoManager.storage.loadSenderKeySession(b,d("WAGlobals").getMyDeviceJid());if(c.success===!1||c.value.senderKeyStates.length===0)return d("WAResultOrError").makeError("sender-key-missing");b=c.value.senderKeyStates.at(-1);if(b==null)return d("WAResultOrError").makeError("sender-key-missing");return b.senderKeyId!==a.senderKeyId?d("WAResultOrError").makeError("sender-key-id-mismatch"):d("WAResultOrError").makeResult({senderKeyId:e})}async function s(a,b){b=await d("WACryptoManager").rotateGroupSenderKey(b.cryptoManager,a,d("WAGlobals").getMyDeviceJid());await d("WADbPersonalSenderKeyStatusTxns").markSenderKeyAsRotated(a,b.senderKeyId,d("WATimeUtils").unixTime());return{senderKeyId:b.senderKeyId}}function t(a,b,c,e){return q.enqueue(async function(){var f=await d("WADbPersonalSenderKeyStatusTxns").getSenderKeyStatus(a),g=await r(f,a,c),i=await d("WAGetUserDevices").getUserDevices(b,c.cryptoManager),j=new Set(i);if(g.success===!1){o.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Rotating sender key for group "," because ",""])),a,g.error);d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.GROUP_SKS_INVALID,key:g.error});e.addPoint("sender_key_rotation_start");var k=await s(a,c);e.addPoint("sender_key_rotation_end");return{senderKeyId:k.senderKeyId,needsSenderKey:j,groupParticipants:new Set(i)}}else{((k=f.hasSenderKey)!=null?k:[]).forEach(function(a){return j.delete(a)});e.addPoint("no_sk_rotation",{int:{noRotationNeedsSK:j.size}});return{senderKeyId:g.value.senderKeyId,needsSenderKey:j,groupParticipants:new Set(i)}}})}async function a(a,b,c,e,f,g,h){h.addPoint("enc_group_start");var p=await t(a,b.map(function(a){return a.user}),f,h),q=p.senderKeyId,r=p.needsSenderKey;p=p.groupParticipants;o.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Finish rotate participant info"])));h.addPoint("rotated_participant_info");var s=null,v,w;b=b.flatMap(function(a){return a.devicesInfo}).map(function(a){return a.jid});p.delete(d("WAGlobals").getMyDeviceJid());var x=!d("WASortedLists").areEqual(d("WASortedLists").asSortedSet(p),d("WASortedLists").sortAndDedupe(b)),y=e.type==="text"&&e.isRevoked,z=e.type==="media"?d("WAProtocolMediaType").castToProtocolMediaType(e.mediaType):null;if(x||y){x=await d("WAEncUserMsg").encryptGroupFanoutMsg(b,{type:"message",messageBytes:c,messageType:e,chat:a,backupDirective:g},f);x&&!(e.type==="text"&&e.isInvisible===!0)&&(v=x,w={encType:"group",to:a,v:c.version==="v3"?"3":"2",type:"skmsg",mediaType:z,ciphertext:null});o.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Finish group fanout msg"])));h.addPoint("finish_group_fanout_msg")}else{if(c.version==="v3"){y=d("WAAsMessageTransport").asMessageTransport(c.bytes);g=d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,y).readByteArrayView()}else g=c.bytes;x=await d("WACryptoManagerUtils").encryptGroupContentWithMetrics(a,g,f);o.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Finish encrypt group content"])));h.addPoint("finish_encrypt_group_content");if(x.success){o.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Encrypt success"])));y=x.value;q!==y.senderKeyId&&p.forEach(function(a){return r.add(a)});if(r.size>0){g={groupId:a,axolotlSenderKeyDistributionMessage:d("WAHex").bytesToBuffer(y.senderKeyDistributionProto)};o.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["start key distribution"])));x=b.filter(function(a){return r.has(a)});q=await u(x,g,f);o.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["end key distribution"])));h.addPoint("finish_skdm_enc_node");q.length>0&&(v=q,s={group:a,senderKeyId:y.senderKeyId,knowsSenderKey:new Set(x)})}w={encType:"group",to:a,v:c.version==="v2"?"2":"3",type:y.ciphertext.type,mediaType:z,ciphertext:y.ciphertext.ciphertext};e.type==="text"&&e.isInvisible===!0&&(w={encType:"group",to:a,v:c.version==="v2"?"2":"3",type:"skmsg",mediaType:null,ciphertext:null})}}p=await d("WAPhash").calculatePHash(b.concat(d("WAGlobals").getMyDeviceJid()));h.addPoint("phash_finish");return{phash:p,participants:v,encNode:w,senderKeyDistributionInfo:s}}function u(a,b,c){b=d("WAAsMessageTransport").asMessageTransport(null,null,b,null);var e=d("encodeProtobuf").encodeProtobuf(d("WAMsgTransport.pb").MessageTransportSpec,b).readByteArrayView();return d("WACryptoManagerUtils").bulkEncrypt(new Map(a.map(function(a){return[a,{plaintext:e}]})),c).then(function(a){var b=[];a.forEach(function(a,c){b.push({encType:"device",to:c,v:"3",type:a.type,ciphertext:a.ciphertext,mediaType:null,count:null,baseKey:null})});return b})}g.encryptGroupMsg=a}),98);
__d("WAGetKeysForUpload",["WALoggerTag","WAResultOrError","WASignalKeys","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("WATagsLogger").TAGS([c("WALoggerTag").PrekeyGenerateAndUpload,c("WALoggerTag").SignedPrekey]);function a(a,b){return a.storage.loadPreKeys(b).then(function(b){var c=b.preKeys;b=b.signedPreKey;var e=[];c.forEach(function(a){a=d("WASignalKeys").deserializePreKey(a);a==null?i.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to deserialize prekey received from the db"]))):e.push(a)});return d("WAResultOrError").makeResult({regInfo:a.regInfo,keyType:d("WASignalKeys").KEY_TYPE,preKeys:e,signedPreKey:b})})}g.getKeysForUpload=a}),98);
__d("WAMakeSignedPreKeyMixin",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={idElementValue:d("WAWap").BIG_ENDIAN_CONTENT(a.id,3)},c={anyElementValue:a.keyPair.publicKey};a=a.signature;return{keyIDMixinArgs:b,keyDataMixinArgs:c,signatureElementValue:a}}g.makeSignedPreKeyMixin=a}),98);
__d("WARandomJitter",[],(function(a,b,c,d,e,f){"use strict";function a(){return Math.round(Math.random()*500-250)}f.getRandomJitter=a}),66);
__d("WARetryUtils",["WARandomJitter"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a)return{algo:{backoff:{first:1,second:1,type:"fibonacci"},toMs:function(a){return(1+a)*1e3+d("WARandomJitter").getRandomJitter()},type:"adjust"},relativeDelay:!0,max:6e5};else return{algo:{type:"adjust",backoff:{type:"fibonacci",first:1,second:1},toMs:function(a){return(9+a)*1e3}},max:62e4}}g.fibonacciBackoff=a}),98);
__d("WASmaxInPreKeysSetVnameFailureBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","bad-request");return!b.success?b:d("WAResultOrError").makeResult({text:b.value})}g.parseSetVnameFailureBadRequestMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureFallbackMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"text");return!b.success?b:d("WAResultOrError").makeResult({text:b.value})}g.parseSetVnameFailureFallbackMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","internal-server-error");return!b.success?b:d("WAResultOrError").makeResult({text:b.value})}g.parseSetVnameFailureInternalServerErrorMixin=a}),98);
__d("WASmaxInPreKeysSetVnameFailureNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"violation");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!a.success)return a;var c=d("WASmaxParseUtils").attrString(b.value,"reason");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrInt,b.value,"max");if(!e.success)return e;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrInt,b.value,"length");return!b.success?b:d("WAResultOrError").makeResult({text:a.value,violationReason:c.value,violationMax:e.value,violationLength:b.value})}g.parseSetVnameFailureNotAcceptableMixin=a}),98);
__d("WASmaxInPreKeysVnameFailures",["WAResultOrError","WASmaxInPreKeysSetVnameFailureBadRequestMixin","WASmaxInPreKeysSetVnameFailureFallbackMixin","WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin","WASmaxInPreKeysSetVnameFailureNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysSetVnameFailureNotAcceptableMixin").parseSetVnameFailureNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"SetVnameFailureNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysSetVnameFailureBadRequestMixin").parseSetVnameFailureBadRequestMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"SetVnameFailureBadRequest",value:c.value});var e=d("WASmaxInPreKeysSetVnameFailureInternalServerErrorMixin").parseSetVnameFailureInternalServerErrorMixin(a);if(e.success)return d("WAResultOrError").makeResult({name:"SetVnameFailureInternalServerError",value:e.value});var f=d("WASmaxInPreKeysSetVnameFailureFallbackMixin").parseSetVnameFailureFallbackMixin(a);return f.success?d("WAResultOrError").makeResult({name:"SetVnameFailureFallback",value:f.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["VnameFailureNotAcceptable","VnameFailureBadRequest","VnameFailureInternalServerError","VnameFailureFallback"],[b,c,e,f])}g.parseVnameFailures=a}),98);
__d("WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysVnameFailures","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;var e=d("WASmaxParseUtils").flattenedChildWithTag(c.value,"error");if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(c.value,"text");if(!f.success)return f;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,c.value,"code",207);if(!c.success)return c;var g=d("WASmaxParseUtils").attrIntRange(e.value,"code",400,599);if(!g.success)return g;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysVnameFailures").parseVnameFailures(e.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({errorText:f.value,errorCode:c.value,errorErrorCode:g.value},a.value,{errorErrorVnameFailures:b.value}))}g.parseSetResponsePreKeySuccessVnameFailure=a}),98);
__d("WASmaxInPreKeysIQErrorNotAcceptableMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"field");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"name");if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"reason");return!a.success?a:d("WAResultOrError").makeResult({name:b.value,reason:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"field",h);if(!b.success)return b;var c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","not-acceptable");if(!c.success)return c;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",406);return!a.success?a:d("WAResultOrError").makeResult({text:c.value,code:a.value,field:b.value})}g.parseIQErrorNotAcceptableField=h;g.parseIQErrorNotAcceptableMixin=a}),98);
__d("WASmaxInPreKeysRequestErrors",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return c.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorNotAcceptable","IQErrorFallbackClient"],[b,c])}g.parseRequestErrors=a}),98);
__d("WASmaxInPreKeysSetResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrors").parseRequestErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrors:b.value}))}g.parseSetResponseRequestError=a}),98);
__d("WASmaxInPreKeysSetResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseSetResponseServerError=a}),98);
__d("WASmaxInPreKeysSetResponseSuccess",["WASmaxInPreKeysIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseSetResponseSuccess=a}),98);
__d("WASmaxOutPreKeysKeyDataMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyElementValue;a=d("WASmaxJsx").smax("smax$any",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeKeyDataMixin=a}),98);
__d("WASmaxOutPreKeysIdentityKeyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysKeyDataMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutPreKeysKeyDataMixin").mergeKeyDataMixin(d("WASmaxJsx").smax("identity",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIdentityKeyMixin=a}),98);
__d("WASmaxOutPreKeysKeyTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("type",null,new Uint8Array([5])));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeKeyTypeMixin=a}),98);
__d("WASmaxOutPreKeysKeyIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.idElementValue;a=d("WASmaxJsx").smax("id",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeKeyIDMixin=a}),98);
__d("WASmaxOutPreKeysPreKeyListMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysKeyDataMixin","WASmaxOutPreKeysKeyIDMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.keyIDMixinArgs;a=a.keyDataMixinArgs;b=d("WASmaxJsx").smax("key",null,d("WASmaxOutPreKeysKeyIDMixin").mergeKeyIDMixin(d("WASmaxJsx").smax("id",null),b),d("WASmaxOutPreKeysKeyDataMixin").mergeKeyDataMixin(d("WASmaxJsx").smax("value",null),a));return b}function i(a){a=a.keyArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("list",null,d("WASmaxChildren").REPEATED_CHILD(h,a,0,2e4)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makePreKeyListListKey=h;g.mergePreKeyListMixin=a}),98);
__d("WASmaxOutPreKeysRegistrationIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.registrationElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("registration",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRegistrationIDMixin=a}),98);
__d("WASmaxOutPreKeysRequestPaddingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.paddingElementValue;a=d("WASmaxJsx").smax("iq",null,d("WASmaxJsx").smax("padding",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRequestPaddingMixin=a}),98);
__d("WASmaxOutPreKeysSignedPreKeyMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysKeyDataMixin","WASmaxOutPreKeysKeyIDMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.keyIDMixinArgs,e=a.keyDataMixinArgs;a=a.signatureElementValue;c=(b=d("WASmaxJsx")).smax("smax$any",null,b.smax("skey",null,d("WASmaxOutPreKeysKeyIDMixin").mergeKeyIDMixin(b.smax("id",null),c),d("WASmaxOutPreKeysKeyDataMixin").mergeKeyDataMixin(b.smax("value",null),e),b.smax("signature",null,a)));return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSignedPreKeyMixin=a}),98);
__d("WASmaxOutPreKeysVerifiedNameMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.verifiedNameElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("verified_name",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeVerifiedNameMixin=a}),98);
__d("WASmaxOutPreKeysIdentityKeyBundleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutPreKeysIdentityKeyMixin","WASmaxOutPreKeysKeyTypeMixin","WASmaxOutPreKeysPreKeyListMixin","WASmaxOutPreKeysRegistrationIDMixin","WASmaxOutPreKeysRequestPaddingMixin","WASmaxOutPreKeysSignedPreKeyMixin","WASmaxOutPreKeysVerifiedNameMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.verifiedNameMixinArgs,c=a.requestPaddingMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutPreKeysRequestPaddingMixin").mergeRequestPaddingMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutPreKeysVerifiedNameMixin").mergeVerifiedNameMixin,d("WASmaxOutPreKeysKeyTypeMixin").mergeKeyTypeMixin(d("WASmaxOutPreKeysSignedPreKeyMixin").mergeSignedPreKeyMixin(d("WASmaxOutPreKeysPreKeyListMixin").mergePreKeyListMixin(d("WASmaxOutPreKeysIdentityKeyMixin").mergeIdentityKeyMixin(d("WASmaxOutPreKeysRegistrationIDMixin").mergeRegistrationIDMixin(d("WASmaxJsx").smax("iq",null),a),a),a),a)),b),c);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIdentityKeyBundleMixin=a}),98);
__d("WASmaxOutPreKeysSetRequest",["WASmaxJsx","WASmaxOutPreKeysClientRequestMixin","WASmaxOutPreKeysIdentityKeyBundleMixin"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxOutPreKeysIdentityKeyBundleMixin").mergeIdentityKeyBundleMixin(d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"set"})),a);return a}g.makeSetRequest=a}),98);
__d("WASmaxPreKeysSetRPC",["WAComms","WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure","WASmaxInPreKeysSetResponseRequestError","WASmaxInPreKeysSetResponseServerError","WASmaxInPreKeysSetResponseSuccess","WASmaxOutPreKeysSetRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a,b){a=d("WASmaxOutPreKeysSetRequest").makeSetRequest(a);b=await d("WAComms").sendSmaxStanza(a,b);var c=d("WASmaxInPreKeysSetResponseSuccess").parseSetResponseSuccess(b,a);if(c.success)return{name:"SetResponseSuccess",value:c.value};var e=d("WASmaxInPreKeysSetResponsePreKeySuccessVnameFailure").parseSetResponsePreKeySuccessVnameFailure(b,a);if(e.success)return{name:"SetResponsePreKeySuccessVnameFailure",value:e.value};var f=d("WASmaxInPreKeysSetResponseRequestError").parseSetResponseRequestError(b,a);if(f.success)return{name:"SetResponseRequestError",value:f.value};b=d("WASmaxInPreKeysSetResponseServerError").parseSetResponseServerError(b,a);if(b.success)return{name:"SetResponseServerError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Set",{Success:c,PreKeySuccessVnameFailure:e,RequestError:f,ServerError:b}))}g.sendSetRPC=a}),98);
__d("WAGenerateAndUploadPreKeysProtocol",["WACryptoManager","WAGetKeysForUpload","WAGlobals","WAMakeSignedPreKeyMixin","WAPromiseRetryLoop","WAResultOrError","WARetryUtils","WASmaxPreKeysSetRPC","WATagsLogger","WAWap"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=d("WATagsLogger").TAGS(["generateAndUploadPreKeysProtocol"]);async function a(){var a=await d("WAGlobals").getWaOneQueue().enqueue(async function(a){a=a.cryptoManager;var b=await d("WACryptoManager").generatePreKeys(a);if(!b.success)return b;m.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["About to upload pre keys"]))).devConsole("generation "+b.value);return d("WAGetKeysForUpload").getKeysForUpload(a,b.value)},{operationType:"generate_prekeys",flush:!0,afterInit:!0});a=a.value;var b=a.regInfo,c=a.preKeys;a=a.signedPreKey;var e=babelHelpers.extends({registrationElementValue:d("WAWap").BIG_ENDIAN_CONTENT(b.regId),anyElementValue:b.staticKeyPair.publicKey,keyArgs:c.map(n)},d("WAMakeSignedPreKeyMixin").makeSignedPreKeyMixin(a));b=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"uploadKeys",timer:d("WARetryUtils").fibonacciBackoff(!1),code:async function(a){m.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Attempt to upload keys"])));var b=await d("WASmaxPreKeysSetRPC").sendSetRPC(e);switch(b.name){case"SetResponseSuccess":m.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Keys are successfully uploaded"])));a(d("WAResultOrError").makeResult({preKeys:c}));return;case"SetResponseRequestError":m.WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Got Malformed upload keys IQ on upload pre keys attempt"])));a(d("WAResultOrError").makeError("request-error"));return;default:b.name,m.WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Got unexpected error: ",", will retry after backoff"])),b.name)}}});b.start();return b.promise()}function n(a){var b={idElementValue:d("WAWap").BIG_ENDIAN_CONTENT(a.id,3)};a={anyElementValue:a.keyPair.publicKey};return{keyIDMixinArgs:b,keyDataMixinArgs:a}}g.generateAndUploadPreKeysProtocol=a}),98);
__d("WAGenerateAndUploadPreKeys",["WABridge","WAGenerateAndUploadPreKeysProtocol","WALoggerTag","WAOdsEnums","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WATagsLogger").TAGS([c("WALoggerTag").PrekeyGenerateAndUpload,c("WALoggerTag").SignedPrekey]);function a(a,b){a=b.reason;j.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["About to generate and upload pre keys with reason: ",""])),a);return d("WAGenerateAndUploadPreKeysProtocol").generateAndUploadPreKeysProtocol().then(function(a){if(a.success){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_UPLOAD,key:"success",amount:a.value.preKeys.length},!0);return}var b=a.error;if(b==="request-error"){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_UPLOAD,key:"malformed"},!0);throw c("err")("Malformed upload keys IQ")}b;j.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate and upload prekeys with error ",": ","}"])),b,(b=a.payload)==null?void 0:b.message)})}g.generateAndUploadPreKeys=a}),98);
__d("WAGetMetaApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return d("WASignalDB").getDb().runInTransaction(["meta"],"readonly",function(a){return a.stores.meta.bulkGet(["certificateChain","deviceId","identityKeyPair","abProps","edgeInfo","clockSkew","authKeyPair"]).then(function(a){var b,c,d,e,f,g,h,i=a[0],j=a[1],k=a[2],l=a[3],m=a[4],n=a[5];a=a[6];return{abProps:l==null||(b=l.value)==null?void 0:b.abProps,authKeyPair:a==null||(c=a.value)==null?void 0:c.authKeyPair,certificateChain:i==null||(d=i.value)==null?void 0:d.certificateChain,clockSkew:n==null||(e=n.value)==null?void 0:e.clockSkew,deviceId:j==null||(f=j.value)==null?void 0:f.deviceId,edgeInfo:m==null||(g=m.value)==null?void 0:g.edgeInfo,identityKeyPair:k==null||(h=k.value)==null?void 0:h.identityKeyPair}})},d("WASignalDB").signalOp("getMeta"))};g.getMeta=a}),98);
__d("WAGetCurrentUserDeviceInfoApi",["WAGetMetaApi","WASignalKeys"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return d("WAGetMetaApi").getMeta().then(function(a){var b=a==null?void 0:a.deviceId;a=a==null?void 0:a.identityKeyPair;if(b==null||a==null)return null;a=d("WASignalKeys").serializePubKey(a);return{deviceId:b,identityKey:a}})};b=function(){return d("WAGetMetaApi").getMeta().then(function(a){return(a==null?void 0:a.deviceId)==null?null:{deviceId:a==null?void 0:a.deviceId}})};g.getCurrentUserDeviceInfo=a;g.getCurrentUserDeviceId=b}),98);
__d("WAGetDeviceIdentityMixin",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a!=null?{deviceIdentityElementValue:a}:null}f.getDeviceIdentityMixin=a}),66);
__d("WAGroupInviteUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.toInviteCode=a}),66);
__d("WAGroupParserUtils",["WAGroupInviteUtils","WAJids","WALogger","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i={superadmin:"superadmin",admin:"admin",participant:"participant",nonparticipant:"nonparticipant"};function j(a){if(!a.hasAttr("error"))throw c("err")("Expected participant node to have error attr");var b=a.attrInt("error"),e=a.attrUserJid("jid");switch(b){case 401:return{errorCode:b,text:"not-authorized",user:e};case 403:a=a.child("add_request");return{errorCode:b,text:"request-code",code:d("WAGroupInviteUtils").toInviteCode(a.attrString("code")),expiration:a.attrTime("expiration"),user:e};case 404:return{errorCode:b,text:"not-found",user:e};case 406:return{errorCode:b,text:"enterprise-not-allowed",user:e};case 408:return{errorCode:b,text:"temporarily-blocked",user:e};case 409:return{errorCode:b,text:"conflict",user:e};case 500:return{errorCode:b,text:"resource-constraint",user:e};default:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["received unknown participant error code: ",""])),b);return{errorCode:-1,text:"unknown",user:e}}}function k(a,b){a.assertTag("participant");var c="participant";switch(b){case"add":case"demote":c="participant";break;case"promote":c="admin";break;case"remove":c="nonparticipant";break}b=a.attrUserJid("jid");if(a.hasAttr("error")){var e=j(a);return d("WAResultOrError").makeError(e)}else{e=a.attrEnumOrDefault("type",i,c);c=a.maybeAttrString("addressable")!=="false";return d("WAResultOrError").makeResult({user:b,type:e,addressable:c})}}function a(a){a.assertTag("group");var b,c=a.attrString("id");c.includes("@")?b=a.attrGroupJid("id"):b=d("WAJids").toGroupJid(c);return{jid:b,creator:a.maybeAttrUserJid("creator")||void 0,creationTs:a.attrTime("creation"),subject:{content:a.maybeAttrString("subject")||void 0,user:a.maybeAttrUserJid("s_o")||void 0,ts:a.hasAttr("s_t")?a.attrTime("s_t"):void 0},description:m(a)||void 0,participantVersion:a.maybeAttrString("p_v_id")||void 0,participants:a.mapChildrenWithTag("participant",function(a){return k(a)}),memberAddMode:l(a)||void 0}}function l(a){if(a.hasChild("member_add_mode")){a=a.child("member_add_mode");if(a.hasContent()){a=a.contentString();if(a==="admin_add"||a==="all_member_add")return a}}return null}function m(a){if(a.hasChild("description")){a=a.child("description");if(a.hasChild("body")){var b=a.child("body");if(b.hasContent())return{id:a.attrString("id"),ts:a.attrTime("t"),content:b.contentString(),user:b.maybeAttrUserJid("participant")||void 0}}}return null}g.PARTICIPANT_TYPES=i;g.parseProtocolGroupParticipantNode=k;g.parseGroupNode=a}),98);
__d("WALoadReceiptApi",["MAWTransactionMode","WADbTransactor","WAMsg","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";a=d("WADbTransactor").makeSignalTransactor({receipts:d("MAWTransactionMode").READONLY},"loadReceipt",function(a){return function(b){var c=d("WAMsg").craftWAMsgIdString(b);return a.receipts.get({waMsgId:c}).then(function(a){var c;return a==null?d("WAResultOrError").makeError("missing-receipt"):d("WAResultOrError").makeResult({id:b,permittedIdentitiesPerDevice:(c=a.permittedIdentitiesPerDevice)!=null?c:new Map(),recipientDevices:a.recipientDevices})})}});g.loadReceipt=a}),98);
__d("WAMarkSenderKeyAsSentApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,c){return d("WASignalDB").getDb().runInTransaction(["personalSenderKeyStatuses"],"readwrite",async function(d){var e=await d.stores.personalSenderKeyStatuses.get(a);if(e==null)return;if(e.senderKeyId!==b)return;c.forEach(function(a){e.hasSenderKey.add(a)});await d.stores.personalSenderKeyStatuses.bulkPut([e])},d("WASignalDB").signalOp("markSenderKeyAsSent"))};g.markSenderKeyAsSent=a}),98);
__d("WASmaxInDevicesNotifyResponseError",["WAResultOrError","WASmaxInDevicesIQErrorResponseMixin","WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInDevicesIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInDevicesRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup").parseRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup:b.value}))}g.parseNotifyResponseError=a}),98);
__d("WASmaxInDevicesNotifyResponseSuccess",["WASmaxInDevicesIQResultResponseMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxInDevicesIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!c.success?c:c}g.parseNotifyResponseSuccess=a}),98);
__d("WASmaxOutDevicesBaseIQSetRequestMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"set"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseIQSetRequestMixin=a}),98);
__d("WASmaxOutDevicesNotifyRequest",["WASmaxChildren","WASmaxJsx","WASmaxOutDevicesBaseIQSetRequestMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.userJid;a=d("WASmaxJsx").smax("user",{jid:d("WAWap").USER_JID(a)});return a}function a(a){a=a.userArgs;a=d("WASmaxOutDevicesBaseIQSetRequestMixin").mergeBaseIQSetRequestMixin(d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET,xmlns:"fbid:devices"},d("WASmaxJsx").smax("users",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,25))));return a}g.makeNotifyRequestUsersUser=h;g.makeNotifyRequest=a}),98);
__d("WASmaxDevicesNotifyRPC",["WAComms","WASmaxInDevicesNotifyResponseError","WASmaxInDevicesNotifyResponseSuccess","WASmaxOutDevicesNotifyRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a,b){a=d("WASmaxOutDevicesNotifyRequest").makeNotifyRequest(a);b=await d("WAComms").sendSmaxStanza(a,b);var c=d("WASmaxInDevicesNotifyResponseSuccess").parseNotifyResponseSuccess(b,a);if(c.success)return{name:"NotifyResponseSuccess",value:c.value};b=d("WASmaxInDevicesNotifyResponseError").parseNotifyResponseError(b,a);if(b.success)return{name:"NotifyResponseError",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Notify",{Success:c,Error:b}))}g.sendNotifyRPC=a}),98);
__d("WANotifyDeviceChange",["WAGlobals","WALogger","WAPersistedJobManager","WASmaxDevicesNotifyRPC","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){a=b.users;if(a.size===0)return Promise.resolve();b=d("WAGlobals").getConfig().maxUsersForNotifyDeviceChange();var c=Array.from(a);a.size>b&&(d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["The maximum number of users that can be notified is ",""])),b),c=c.slice(0,b));return i(c)}async function i(a){a=await d("WASmaxDevicesNotifyRPC").sendNotifyRPC({userArgs:a.map(function(a){return{userJid:a}})});if(a.name==="NotifyResponseSuccess")return;a.name;a=a.value.errorRetryableIQErrorOrNonRetryableIQErrorRetryableIQErrorMixinGroup;if(a.name==="RetryableIQError"){var b=a.value.backoff;if(b!=null)throw new(d("WAPersistedJobManager").RetryOnBackoff)({algo:{type:"constant",delay:b},jitter:0});else throw new(d("WAPersistedJobManager").RetryOnBackoff)({algo:{type:"exponential",first:d("WATimeUtils").HOUR_MILLISECONDS/60},jitter:.1})}throw c("err")("Failed with an unexpected error code "+a.value.code)}g.notifyDeviceChange=a}),98);
__d("WAParseFranking",["WAFranking","WAFrankingTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b;if(a==null)return null;b=(b=a.maybeChild("franking_tag"))==null?void 0:b.contentBytes();a=(a=a.maybeChild("reporting_tag"))==null?void 0:a.contentBytes();return{frankingKey:null,frankingTag:b!=null?d("WAFrankingTypes").castToFrankingTag(b):null,reportingTag:a!=null?d("WAFrankingTypes").castToReportingTag(a):null,frankingVersion:d("WAFranking").getFrankingVersion(),reportingContent:null}}g.parseFrankingNode=a}),98);
__d("WAWaterFlow",["$InternalEnum","WAMapWithDefault","WAPREMetrics","WATagsLogger","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r=d("WATagsLogger").TAGS(["WAWaterflow"]),s=b("$InternalEnum").Mirrored(["INIT","ON_GOING","COMPLETED"]),t=function(){function a(a,b,c){this.$1=s.INIT,this.$7=[],this.$9=new(d("WAMapWithDefault").MapWithDefault)(function(){return[]}),this.$5=r.TAGS([a]),this.$8=b,this.$3={},this.$4=new Set(),this.$10=!c,this.$6=d("WATimeUtils").performanceAbsoluteNow()}var b=a.prototype;b.$11=function(){var a=this,b={"int":{},bool:{},string:{},string_array:{}};this.$4.forEach(function(c){var d=a.$3[c];Array.isArray(d)&&(b.string_array[c]=d);typeof d==="boolean"&&(b.bool[c]=d);typeof d==="number"&&(b["int"][c]=d);typeof d==="string"&&(b.string[c]=d)});return b};b.$12=function(a){if(a==null)return;for(var b in a){var c=a[b];c!==this.$3[b]&&(this.$4.add(b),this.$3[b]=c)}};b.$13=function(a,b){this.$6=d("WATimeUtils").performanceAbsoluteNow();this.$12(a);a=this.$11();this.$4.clear();this.$10&&this.$5.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose([" -> Start.",""])),u(this.$3));this.$1=s.ON_GOING;if(this.$8==null)return this;this.$2=d("WAPREMetrics").startMetric(this.$8,a,b);return this};b.startMetric=function(a){return this.$13(a)};b.reStartMetric=function(a,b){return this.$13(b,a)};b.startPoint=function(a,b){var e;if(typeof a!=="string"){this.$5.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Step should be a enum type"])));throw c("err")("Step should be a enum type")}this.$12(b);b=this.$11();(e=this.$2)==null||e.addPoint(a+"_start",b);this.$4.clear();e={step:a,from:d("WATimeUtils").performanceAbsoluteNow()};this.$7.push(e);this.$9.get(a).push(e);this.$10&&this.$5.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose([""," -> Start.","",""])),a,v(this.$7,this.$6),u(this.$3))};b.endPoint=function(a,b){var e,f=d("WATimeUtils").performanceAbsoluteNow(),g=this.$9.get(a).pop();g==null?this.$5.WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["No start point was found for step: ","."])),a):g.to=f;if(typeof a!=="string"){this.$5.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Step should be a enum type"])));throw c("err")("Step should be a enum type")}this.$12(b);b=this.$11();(e=this.$2)==null||e.addPoint(a+"_end",b);this.$4.clear();this.$10&&this.$5.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose([""," -> Done.;\nTime taken: ",";\nTime from start: ",";","","\n"])),a,w(g!=null?f-g.from:0),w(f-this.$6),v(this.$7,this.$6),u(this.$3))};b.isOnGoing=function(){return this.$1===s.ON_GOING};b.isCompleted=function(){return this.$1===s.COMPLETED};b.annotate=function(a){this.$12(a)};b.reAnnotate=function(a){this.$12(a(this.$3))};b.getAnnotations=function(){return this.$3};b.annotateImmediately=function(a){var b;this.$12(a);a=this.$11();(b=this.$2)==null||b.addAnnotations(a);this.$4.clear()};b.addPoint=function(a,b){var d;if(typeof a!=="string"){this.$5.ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Step should be a enum type"])));throw c("err")("Step should be a enum type")}this.$12(b);b=this.$11();(d=this.$2)==null||d.addPoint(a,b);this.$4.clear()};b.getStartTime=function(){return this.$6};b.log=function(){this.$10&&this.$5.LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose([" -> in progress.\nTime passed: "," sec;","","\n"])),(d("WATimeUtils").performanceAbsoluteNow()-this.$6)/1e3,v(this.$7,this.$6),u(this.$3))};b.endSuccess=function(a){var b;this.$12(a);a=this.$11();(b=this.$2)==null||b.endSuccess(a);this.$4.clear();this.$10&&this.$5.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose([" -> Done. Success: true\nTime taken: "," sec;","","\n"])),(d("WATimeUtils").performanceAbsoluteNow()-this.$6)/1e3,v(this.$7,this.$6),u(this.$3));this.$1=s.COMPLETED};b.endFail=function(a,b){var c;this.$12(b);b=this.$11();(c=this.$2)==null||c.endFail(a,b);this.$4.clear();this.$10&&this.$5.LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose([" -> Done. Success: false\nTime taken: "," sec;","","\n"])),(d("WATimeUtils").performanceAbsoluteNow()-this.$6)/1e3,v(this.$7,this.$6),u(this.$3));this.$1=s.COMPLETED};return a}();function a(a){if(a==null)return{};var b={bool:{},"int":{},string:{},string_array:{}};for(var c in a)Array.isArray(a[c])&&(b.string_array[c]=a[c]),typeof a[c]==="number"&&(b["int"][c]=a[c]),typeof a[c]==="boolean"&&(b.bool[c]=a[c]),typeof a[c]==="string"&&(b.string[c]=a[c]);return b}function u(a){a=Object.entries(a).map(function(a){var b=a[0];a=a[1];return b+": "+String(a)});return a.length>0?"\n"+a.join("\n"):""}function v(a,b){a=a.map(function(a){var c=a.step,e=a.from;a=a.to;return typeof c==="string"?c+" => Started after: "+w(e-b)+"; "+(a!=null?"Completed after: "+w(a-e):"In progress: "+w(d("WATimeUtils").performanceAbsoluteNow()-e)):""}).filter(Boolean);return a.length>0?"\n"+a.join("\n"):""}function w(a){return a/1e3+"s"}function e(a,b,c){return new t(a,b,c!=null?c:!1)}g.WAWaterflow=t;g.convertToPREAnnotation=a;g.makeWaterflow=e}),98);
__d("WAQueryGroup",["$InternalEnum","WADeprecatedSendIq","WADeprecatedWapParser","WAGroupParserUtils","WAPREList","WAPREMetrics","WAResultOrError","WAWap","WAWaterFlow"],(function(a,b,c,d,e,f,g){"use strict";var h=new(c("WADeprecatedWapParser"))("queryAllGroupsResponse",function(a){a.assertTag("iq");return{groups:a.child("groups").mapChildren(d("WAGroupParserUtils").parseGroupNode)}});async function a(){var a,b=d("WAPREMetrics").startMetric(d("WAPREList").PRE_METRIC.QUERY_GROUPS);a=(a=d("WAWap")).wap("iq",{id:a.generateId(),to:a.G_US,type:"get",xmlns:"w:g2"},a.wap("participating",null,a.wap("participants",null),a.wap("description",null)));a=await d("WADeprecatedSendIq").deprecatedSendIq(a,h);if(!a.success){b.endFail("query_groups_fail");return d("WAResultOrError").makeError(a)}b.endSuccess();return d("WAResultOrError").makeResult(a.result)}var i=new(c("WADeprecatedWapParser"))("queryAllGroupsResponse",function(a){a.assertTag("iq");return{group:d("WAGroupParserUtils").parseGroupNode(a.child("group"))}}),j=b("$InternalEnum").Mirrored(["IQ_REQUEST"]);async function e(a,b){var c=b!=null?b:"unknown",e=d("WAWaterFlow").makeWaterflow("query-group",d("WAPREList").PRE_METRIC.QUERY_GROUP).startMetric();e.addPoint(j.IQ_REQUEST,{key:c});a=await d("WADeprecatedSendIq").deprecatedSendIq(d("WAWap").wap("iq",{id:d("WAWap").generateId(),to:d("WAWap").GROUP_JID(a),type:"get",xmlns:"w:g2"},d("WAWap").wap("query",{request:b!=null?d("WAWap").CUSTOM_STRING(b):d("WAWap").DROP_ATTR})),i);if(!a.success){e.endFail("Fail-"+c+"-"+a.errorCode);return d("WAResultOrError").makeError(a)}e.endSuccess();return d("WAResultOrError").makeResult(a.result.group)}g.queryAllGroups=a;g.parseQueryGroupResponse=i;g.queryGroup=e}),98);
__d("WAQueryGroups",["WACreateGroup","WAGetDevices","WAPushSafeTypes","WAQueryGroup","WATimeUtils","err"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b,e){e===void 0&&(e=!1);a=d("WAPushSafeTypes").unsafeNotNullable(b);b={groups:[]};if(a.type==="all"){var f=await d("WAQueryGroup").queryAllGroups();if(f.success===!1){var g;throw c("err")("Failed to parse queryAllGroup response with error "+JSON.stringify((g=f.error)!=null?g:null))}b=f.value}else{a.type;g=await Promise.all(a.groups.map(async function(a){a=await d("WAQueryGroup").queryGroup(a);if(a.success===!1){var b;throw c("err")("Failed to parse queryGroup response with error "+JSON.stringify((b=a.error)!=null?b:null))}return a.value}));b={groups:g}}await d("WACreateGroup").createGroups(b.groups.map(function(a){return{groupStatus:"queried",groupToCreate:a,serverTs:d("WATimeUtils").unixTime(),extras:void 0,folder:void 0,key:void 0}}));var h=new Set();b.groups.forEach(function(a){return a.participants.forEach(function(a){a.success?h.add(a.value.user):h.add(a.error.user)})});await d("WAGetDevices").getDevices(null,{users:h,reason:"query-groups",ignoreDhash:e})}g.queryGroups=a}),98);
__d("WASmaxInPreKeysIQErrorItemNotFoundMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"error");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"text","item-not-found");if(!b.success)return b;a=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrInt,a,"code",404);return!a.success?a:d("WAResultOrError").makeResult({text:b.value,code:a.value})}g.parseIQErrorItemNotFoundMixin=a}),98);
__d("WASmaxInPreKeysRequestErrorsFetchDigest",["WAResultOrError","WASmaxInPreKeysIQErrorFallbackClientMixin","WASmaxInPreKeysIQErrorItemNotFoundMixin","WASmaxInPreKeysIQErrorNotAcceptableMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysIQErrorNotAcceptableMixin").parseIQErrorNotAcceptableMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"IQErrorNotAcceptable",value:b.value});var c=d("WASmaxInPreKeysIQErrorItemNotFoundMixin").parseIQErrorItemNotFoundMixin(a);if(c.success)return d("WAResultOrError").makeResult({name:"IQErrorItemNotFound",value:c.value});var e=d("WASmaxInPreKeysIQErrorFallbackClientMixin").parseIQErrorFallbackClientMixin(a);return e.success?d("WAResultOrError").makeResult({name:"IQErrorFallbackClient",value:e.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["IQErrorNotAcceptable","IQErrorItemNotFound","IQErrorFallbackClient"],[b,c,e])}g.parseRequestErrorsFetchDigest=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseRequestError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysRequestErrorsFetchDigest","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysRequestErrorsFetchDigest").parseRequestErrorsFetchDigest(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorRequestErrorsFetchDigest:b.value}))}g.parseFetchDigestResponseRequestError=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseServerError",["WAResultOrError","WASmaxInPreKeysIQErrorResponseMixin","WASmaxInPreKeysServerErrors","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"error");if(!c.success)return c;a=d("WASmaxInPreKeysIQErrorResponseMixin").parseIQErrorResponseMixin(a,b);if(!a.success)return a;b=d("WASmaxInPreKeysServerErrors").parseServerErrors(c.value);return!b.success?b:d("WAResultOrError").makeResult(babelHelpers["extends"]({},a.value,{errorServerErrors:b.value}))}g.parseFetchDigestResponseServerError=a}),98);
__d("WASmaxInPreKeysKeysHashMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"hash");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,20,20);return!a.success?a:d("WAResultOrError").makeResult({hashElementValue:a.value})}g.parseKeysHashMixin=a}),98);
__d("WASmaxInPreKeysPreKeyIDListMixin",["WAResultOrError","WASmaxInPreKeysKeyIDMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"id");if(!b.success)return b;b=d("WASmaxInPreKeysKeyIDMixin").parseKeyIDMixin(a);return!b.success?b:b}function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"list");if(!a.success)return a;a=d("WASmaxParseUtils").mapChildrenWithTag(a.value,"id",0,2e4,h);return!a.success?a:d("WAResultOrError").makeResult({listId:a.value})}g.parsePreKeyIDListListId=h;g.parsePreKeyIDListMixin=a}),98);
__d("WASmaxInPreKeysIdentityDigestBundleMixin",["WAResultOrError","WASmaxInPreKeysIdentityKeyMixin","WASmaxInPreKeysKeyTypeMixin","WASmaxInPreKeysKeysHashMixin","WASmaxInPreKeysPreKeyIDListMixin","WASmaxInPreKeysRegistrationIDMixin","WASmaxInPreKeysSignedPreKeyMixin"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInPreKeysRegistrationIDMixin").parseRegistrationIDMixin(a);if(!b.success)return b;var c=d("WASmaxInPreKeysIdentityKeyMixin").parseIdentityKeyMixin(a);if(!c.success)return c;var e=d("WASmaxInPreKeysPreKeyIDListMixin").parsePreKeyIDListMixin(a);if(!e.success)return e;var f=d("WASmaxInPreKeysSignedPreKeyMixin").parseSignedPreKeyMixin(a);if(!f.success)return f;var g=d("WASmaxInPreKeysKeyTypeMixin").parseKeyTypeMixin(a);a=d("WASmaxInPreKeysKeysHashMixin").parseKeysHashMixin(a);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({},b.value,c.value,e.value,f.value,{keyTypeMixin:g.success?g.value:null},a.value))}g.parseIdentityDigestBundleMixin=a}),98);
__d("WASmaxInPreKeysFetchDigestResponseSuccess",["WAResultOrError","WASmaxInPreKeysIQResultResponseMixin","WASmaxInPreKeysIdentityDigestBundleMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseUtils").flattenedChildWithTag(a,"digest");if(!c.success)return c;var e=d("WASmaxParseReference").optionalAttrStringFromReference(b,["digest","identity_type"]);if(!e.success)return e;e=d("WASmaxParseUtils").optionalLiteral(d("WASmaxParseUtils").attrString,c.value,"identity_type",e.value);if(!e.success)return e;c=d("WASmaxInPreKeysIdentityDigestBundleMixin").parseIdentityDigestBundleMixin(c.value);if(!c.success)return c;a=d("WASmaxInPreKeysIQResultResponseMixin").parseIQResultResponseMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({hasDigestIdentityType:e.value!=null,digestIdentityDigestBundleMixin:c.value},a.value))}g.parseFetchDigestResponseSuccess=a}),98);
__d("WASmaxOutPreKeysFetchDigestRequest",["WASmaxJsx","WASmaxOutPreKeysClientRequestMixin"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutPreKeysClientRequestMixin").mergeClientRequestMixin(d("WASmaxJsx").smax("iq",{type:"get"},d("WASmaxJsx").smax("digest",null)));return a}g.makeFetchDigestRequest=a}),98);
__d("WASmaxPreKeysFetchDigestRPC",["WAComms","WASmaxInPreKeysFetchDigestResponseRequestError","WASmaxInPreKeysFetchDigestResponseServerError","WASmaxInPreKeysFetchDigestResponseSuccess","WASmaxOutPreKeysFetchDigestRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a){var b=d("WASmaxOutPreKeysFetchDigestRequest").makeFetchDigestRequest();a=await d("WAComms").sendSmaxStanza(b,a);var c=d("WASmaxInPreKeysFetchDigestResponseSuccess").parseFetchDigestResponseSuccess(a,b);if(c.success)return{name:"FetchDigestResponseSuccess",value:c.value};var e=d("WASmaxInPreKeysFetchDigestResponseRequestError").parseFetchDigestResponseRequestError(a,b);if(e.success)return{name:"FetchDigestResponseRequestError",value:e.value};a=d("WASmaxInPreKeysFetchDigestResponseServerError").parseFetchDigestResponseServerError(a,b);if(a.success)return{name:"FetchDigestResponseServerError",value:a.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("FetchDigest",{Success:c,RequestError:e,ServerError:a}))}g.sendFetchDigestRPC=a}),98);
__d("WARequestPreKeyDigestProtocol",["WABinary","WAConvertRegistrationIdMixin","WAConvertSignedPreKeyMixin","WACryptoDependencies","WACryptoUtils","WAParsableXmlNode","WAResultOrError","WASignalKeys","WASmaxPreKeysFetchDigestRPC","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WATagsLogger").TAGS(["requestPreKeyDigestProtocol"]);function a(a){return d("WASmaxPreKeysFetchDigestRPC").sendFetchDigestRPC({withoutRetry:!1}).then(function(b){switch(b.name){case"FetchDigestResponseServerError":var c=b.value.errorServerErrors.name;j.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),b.name,c);return d("WAResultOrError").makeError({type:"server-error",payload:c});case"FetchDigestResponseRequestError":c=b.value.errorRequestErrorsFetchDigest.name;j.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["",": ",""])),b.name,c);return d("WAResultOrError").makeError({type:"request-error",payload:c});default:b.name;c=k(b.value.digestIdentityDigestBundleMixin);return l(c,a).then(function(a){return a==="ok"?d("WAResultOrError").makeResult():d("WAResultOrError").makeError({type:"compare-error",payload:a})})}})}function k(a){var b=d("WAConvertRegistrationIdMixin").registrationIdMixin(a),c=d("WAConvertSignedPreKeyMixin").convertSignedPreKeyMixin(a),e=a.listId.map(function(a){return d("WASignalKeys").castToPreKeyId(d("WAParsableXmlNode").convertBytesToUint(a.elementValue,3))});a=a.hashElementValue;return{regId:b,skeyId:c.id,preKeyIds:e,hash:a}}async function l(a,b){if(a.regId!==b.regInfo.regId)return"RegIdMismatch";if(a.skeyId!==b.signedPreKey.id)return"SignedPreKeyIdMismatch";var c=new Map();b.preKeys.forEach(function(a){return c.set(a.id,a)});var e=a.preKeyIds.some(function(a){return!c.has(a)});if(e)return"UnknownPreKey";e=a.preKeyIds.map(function(a){return c.get(a)}).filter(Boolean);b=await m(b,e);return!d("WACryptoUtils").uint8ArraysEqual(b,a.hash)?"HashMismatch":"ok"}function m(a,b){var c=new(d("WABinary").Binary)();c.writeByteArray(a.regInfo.staticKeyPair.publicKey);c.writeByteArray(a.signedPreKey.keyPair.publicKey);c.writeByteArray(a.signedPreKey.signature);b.forEach(function(a){c.writeByteArray(a.keyPair.publicKey)});return d("WACryptoDependencies").getCrypto().subtle.digest("SHA-1",c.readByteArrayView()).then(function(a){return new Uint8Array(a)})}g.requestPreKeyDigestProtocol=a}),98);
__d("WARequestPreKeyDigest",["WABridge","WAGenerateAndUploadPreKeys","WAGetKeysForUpload","WAGlobals","WALogger","WAOdsEnums","WARequestPreKeyDigestProtocol","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;async function j(a){a=await a(function(a){a=a.cryptoManager;return d("WAGetKeysForUpload").getKeysForUpload(a)});a=await d("WARequestPreKeyDigestProtocol").requestPreKeyDigestProtocol(a.value);if(a.success===!1){d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"fail"});if(a.error.type==="compare-error"){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["PreKey digest comparison failed: ",""])),a.error.payload);d("WAGenerateAndUploadPreKeys").generateAndUploadPreKeys(null,{reason:"prekey digest comparison failed"}).catch(function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Error while generating and uploading prekeys: ",""])),a)});return}throw c("err")("Error while requesting key digest: "+a.error.type+" "+a.error.payload)}a.success;d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PREKEY_DIGEST,key:"success"})}function a(a){return j(function(a){return d("WAGlobals").getWaOneQueue().enqueue(a,{operationType:"request_prekey_digest",flush:!1})})}g.requestPreKeyDigestFn=j;g.requestPreKeyDigest=a}),98);
__d("WASmaxInMessagePublishAckAdminEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","3");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckAdminEditMixin=a}),98);
__d("WASmaxInMessagePublishAckAdminRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","8");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckAdminRevokeMixin=a}),98);
__d("WASmaxInMessagePublishAckMessageEditMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","1");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckMessageEditMixin=a}),98);
__d("WASmaxInMessagePublishAckMessagePinMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","2");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckMessagePinMixin=a}),98);
__d("WASmaxInMessagePublishEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={CBP:"CBP",NBP:"NBP",PMP:"PMP"};b={delivery:"delivery",no_optimization:"no_optimization"};c={"false":"false","true":"true"};e={free_customer_service:"free_customer_service",free_entry_point:"free_entry_point",regular:"regular"};f={lid:"lid",pn:"pn"};var h={validators:[(d=d("WAJids")).validateDeviceJid,d.validateDeviceJid,d.validateUserJid,d.validateUserJid],typeName:"DeviceJid|DeviceJid|UserJid|UserJid"};d={validators:[d.validateUserJid,d.validateUserJid],typeName:"UserJid|UserJid"};g.ENUM_CBP_NBP_PMP=a;g.ENUM_DELIVERY_NOOPTIMIZATION=b;g.ENUM_FALSE_TRUE=c;g.ENUM_FREECUSTOMERSERVICE_FREEENTRYPOINT_REGULAR=e;g.ENUM_LID_PN=f;g.DEVICEJID_DEVICEJID_USERJID_USERJID=h;g.USERJID_USERJID=d}),98);
__d("WASmaxInMessagePublishAckPaidConversationMixin",["WAResultOrError","WASmaxInMessagePublishEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function h(a){var b=d("WASmaxParseUtils").assertTag(a,"delivery_context");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"optimization_goal",d("WASmaxInMessagePublishEnums").ENUM_DELIVERY_NOOPTIMIZATION);return!b.success?b:d("WAResultOrError").makeResult({optimizationGoal:b.value})}function i(a){var b=d("WASmaxParseUtils").assertTag(a,"source_url");if(!b.success)return b;b=d("WASmaxParseUtils").contentString(a);return!b.success?b:d("WAResultOrError").makeResult({elementValue:b.value})}function j(a){var b=d("WASmaxParseUtils").assertTag(a,"referral");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"source_url",i);if(!b.success)return b;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"source_type");return!a.success?a:d("WAResultOrError").makeResult({sourceType:a.value,sourceUrl:b.value})}function k(a){var b=d("WASmaxParseUtils").assertTag(a,"origin");if(!b.success)return b;b=d("WASmaxParseUtils").optionalChildWithTag(a,"referral",j);if(!b.success)return b;a=d("WASmaxParseUtils").attrString(a,"type");return!a.success?a:d("WAResultOrError").makeResult({type:a.value,referral:b.value})}function l(a){var b=d("WASmaxParseUtils").assertTag(a,"pricing");if(!b.success)return b;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"consumer_country_code");if(!b.success)return b;var c=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"business_country_code");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"conversation_status",0,void 0);if(!e.success)return e;var f=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"latest_c2b_timestamp",0,void 0);if(!f.success)return f;var g=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a,"analytics_conversation_id");if(!g.success)return g;a=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,a,"b2c_timestamp",0,void 0);return!a.success?a:d("WAResultOrError").makeResult({consumerCountryCode:b.value,businessCountryCode:c.value,conversationStatus:e.value,latestC2bTimestamp:f.value,analyticsConversationId:g.value,b2cTimestamp:a.value})}function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").optionalChildWithTag(b.value,"delivery_context",h);if(!a.success)return a;var c=d("WASmaxParseUtils").optionalChildWithTag(b.value,"origin",k);if(!c.success)return c;var e=d("WASmaxParseUtils").optionalChildWithTag(b.value,"pricing",l);if(!e.success)return e;var f=d("WASmaxParseUtils").attrString(b.value,"paid_convo_id");if(!f.success)return f;var g=d("WASmaxParseUtils").attrStringEnum(b.value,"pricing_model",d("WASmaxInMessagePublishEnums").ENUM_CBP_NBP_PMP);if(!g.success)return g;var i=d("WASmaxParseUtils").attrStringEnum(b.value,"billable",d("WASmaxInMessagePublishEnums").ENUM_FALSE_TRUE);if(!i.success)return i;var j=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrIntRange,b.value,"expiration_timestamp",0,void 0);if(!j.success)return j;var m=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,b.value,"pricing_category");if(!m.success)return m;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrStringEnum,b.value,"pricing_type",d("WASmaxInMessagePublishEnums").ENUM_FREECUSTOMERSERVICE_FREEENTRYPOINT_REGULAR);return!b.success?b:d("WAResultOrError").makeResult({bizPaidConvoId:f.value,bizPricingModel:g.value,bizBillable:i.value,bizExpirationTimestamp:j.value,bizPricingCategory:m.value,bizPricingType:b.value,bizDeliveryContext:a.value,bizOrigin:c.value,bizPricing:e.value})}g.parseAckPaidConversationBizDeliveryContext=h;g.parseAckPaidConversationBizOriginReferralSourceUrl=i;g.parseAckPaidConversationBizOriginReferral=j;g.parseAckPaidConversationBizOrigin=k;g.parseAckPaidConversationBizPricing=l;g.parseAckPaidConversationMixin=a}),98);
__d("WASmaxInMessagePublishAckPaidGroupConversationMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"biz");if(!b.success)return b;a=d("WASmaxParseUtils").flattenedChildWithTag(b.value,"pricing");if(!a.success)return a;b=d("WASmaxParseUtils").optional(d("WASmaxParseUtils").attrString,a.value,"business_country_code");return!b.success?b:d("WAResultOrError").makeResult({bizPricingBusinessCountryCode:b.value})}g.parseAckPaidGroupConversationMixin=a}),98);
__d("WASmaxInMessagePublishAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup",["WAResultOrError","WASmaxInMessagePublishAckPaidConversationMixin","WASmaxInMessagePublishAckPaidGroupConversationMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxInMessagePublishAckPaidConversationMixin").parseAckPaidConversationMixin(a);if(b.success)return d("WAResultOrError").makeResult({name:"AckPaidConversation",value:b.value});var c=d("WASmaxInMessagePublishAckPaidGroupConversationMixin").parseAckPaidGroupConversationMixin(a);return c.success?d("WAResultOrError").makeResult({name:"AckPaidGroupConversation",value:c.value}):d("WASmaxParseUtils").errorMixinDisjunction(a,["AckPaidConversation","AckPaidGroupConversation"],[b,c])}g.parseAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup=a}),98);
__d("WASmaxInMessagePublishAckRevokeMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"edit","7");return!b.success?b:d("WAResultOrError").makeResult({edit:b.value})}g.parseAckRevokeMixin=a}),98);
__d("WASmaxInMessagePublishServerFrankingTagMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){a=d("WASmaxParseUtils").flattenedChildWithTag(a,"franking");if(!a.success)return a;a=d("WASmaxParseUtils").flattenedChildWithTag(a.value,"reporting_tag");if(!a.success)return a;a=d("WASmaxParseUtils").contentBytesRange(a.value,9,128);return!a.success?a:d("WAResultOrError").makeResult({frankingReportingTagElementValue:a.value})}g.parseServerFrankingTagMixin=a}),98);
__d("WASmaxInMessagePublishAckMixin",["WAResultOrError","WASmaxInMessagePublishAckAdminEditMixin","WASmaxInMessagePublishAckAdminRevokeMixin","WASmaxInMessagePublishAckMessageEditMixin","WASmaxInMessagePublishAckMessagePinMixin","WASmaxInMessagePublishAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup","WASmaxInMessagePublishAckRevokeMixin","WASmaxInMessagePublishServerFrankingTagMixin","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"class","message");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);if(!b.success)return b;var e=d("WASmaxInMessagePublishAckMessageEditMixin").parseAckMessageEditMixin(a),f=d("WASmaxInMessagePublishAckAdminEditMixin").parseAckAdminEditMixin(a),g=d("WASmaxInMessagePublishAckMessagePinMixin").parseAckMessagePinMixin(a),h=d("WASmaxInMessagePublishAckAdminRevokeMixin").parseAckAdminRevokeMixin(a),i=d("WASmaxInMessagePublishAckRevokeMixin").parseAckRevokeMixin(a),j=d("WASmaxInMessagePublishServerFrankingTagMixin").parseServerFrankingTagMixin(a);a=d("WASmaxInMessagePublishAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup").parseAckPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup(a);return d("WAResultOrError").makeResult({"class":c.value,t:b.value,ackMessageEditMixin:e.success?e.value:null,ackAdminEditMixin:f.success?f.value:null,ackMessagePinMixin:g.success?g.value:null,ackAdminRevokeMixin:h.success?h.value:null,ackRevokeMixin:i.success?i.value:null,serverFrankingTagMixin:j.success?j.value:null,ackPaidAckPaidConversationOrAckPaidGroupConversationConversationMixinGroup:a.success?a.value:null})}g.parseAckMixin=a}),98);
__d("WASmaxInMessagePublishApplicationNegativeAckMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"application_error",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({applicationError:b.value})}g.parseApplicationNegativeAckMixin=a}),98);
__d("WASmaxInMessagePublishMessageNackRetryAttributesMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"backoff",0,86400);return!b.success?b:d("WAResultOrError").makeResult({backoff:b.value})}g.parseMessageNackRetryAttributesMixin=a}),98);
__d("WASmaxInMessagePublishNegativeAckMixin",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishApplicationNegativeAckMixin","WASmaxInMessagePublishMessageNackRetryAttributesMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").attrString(a,"error");if(!c.success)return c;b=d("WASmaxInMessagePublishAckMixin").parseAckMixin(a,b);if(!b.success)return b;var e=d("WASmaxInMessagePublishApplicationNegativeAckMixin").parseApplicationNegativeAckMixin(a);a=d("WASmaxInMessagePublishMessageNackRetryAttributesMixin").parseMessageNackRetryAttributesMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({error:c.value},b.value,{applicationNegativeAckMixin:e.success?e.value:null,messageNackRetryAttributesMixin:a.success?a.value:null}))}g.parseNegativeAckMixin=a}),98);
__d("WASmaxInMessagePublishIndividualResponseNegative",["WAResultOrError","WASmaxInMessagePublishNegativeAckMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"recipient");if(!c.success)return c;a=d("WASmaxInMessagePublishNegativeAckMixin").parseNegativeAckMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({recipient:c.value},a.value))}g.parseIndividualResponseNegative=a}),98);
__d("WASmaxInMessagePublishAckRcatMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").flattenedChildWithTag(a,"rcat");if(!b.success)return b;a=d("WASmaxParseUtils").contentBytes(b.value);return!a.success?a:d("WAResultOrError").makeResult({rcatElementValue:a.value})}g.parseAckRcatMixin=a}),98);
__d("WASmaxInMessagePublishDeviceListStaleMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"phash");return!b.success?b:d("WAResultOrError").makeResult({phash:b.value})}g.parseDeviceListStaleMixin=a}),98);
__d("WASmaxInMessagePublishRefreshLIDMixin",["WAResultOrError","WASmaxInMessagePublishEnums","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrStringEnum(a,"refresh_lid",d("WASmaxInMessagePublishEnums").ENUM_FALSE_TRUE);return!b.success?b:d("WAResultOrError").makeResult({refreshLid:b.value})}g.parseRefreshLIDMixin=a}),98);
__d("WASmaxInMessagePublishIndividualResponseSuccess",["WAResultOrError","WASmaxInMessagePublishAckMixin","WASmaxInMessagePublishAckRcatMixin","WASmaxInMessagePublishDeviceListStaleMixin","WASmaxInMessagePublishEnums","WASmaxInMessagePublishRefreshLIDMixin","WASmaxParseJid","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrUserJid,a,"recipient");if(!c.success)return c;var e=d("WASmaxParseUtils").optional(d("WASmaxParseJid").attrJidEnum,a,"participant",d("WASmaxInMessagePublishEnums").USERJID_USERJID);if(!e.success)return e;b=d("WASmaxInMessagePublishAckMixin").parseAckMixin(a,b);if(!b.success)return b;var f=d("WASmaxInMessagePublishDeviceListStaleMixin").parseDeviceListStaleMixin(a),g=d("WASmaxInMessagePublishRefreshLIDMixin").parseRefreshLIDMixin(a);a=d("WASmaxInMessagePublishAckRcatMixin").parseAckRcatMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({recipient:c.value,participant:e.value},b.value,{deviceListStaleMixin:f.success?f.value:null,refreshLIDMixin:g.success?g.value:null,ackRcatMixin:a.success?a.value:null}))}g.parseIndividualResponseSuccess=a}),98);
__d("WASmaxOutMessagePublishAppdataMetaAttributeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaAppdata;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{appdata:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAppdataMetaAttributeMixin=a}),98);
__d("WASmaxOutMessagePublishAutomatedMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("automated",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAutomatedMixin=a}),98);
__d("WASmaxOutMessagePublishAuthMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.authVerificationTimestamp,c=a.authDisableIosAutofill;a=a.authEnableRiskCheck;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("auth",{verification_timestamp:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b),disable_ios_autofill:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c),enable_risk_check:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAuthMixin=a}),98);
__d("WASmaxOutMessagePublishBizAcceptTsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.bizAcceptTs;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{accept_ts:d("WAWap").INT(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizAcceptTsMixin=a}),98);
__d("WASmaxOutMessagePublishBizAutoResponseMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.bizAutoResponse;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{auto_response:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizAutoResponseMixin=a}),98);
__d("WASmaxOutMessagePublishBizCampaignMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.bizCampaignId;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{campaign_id:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizCampaignMixin=a}),98);
__d("WASmaxOutMessagePublishBizEngagementDataMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.engagementConversationState;a=a.engagementCustomerServiceState;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("engagement",{conversation_state:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),customer_service_state:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizEngagementDataMixin=a}),98);
__d("WASmaxOutMessagePublishBizMetadataMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c,e=a.metadataAppOwner,f=a.metadataCsidBm,g=a.metadataPaymentBm,h=a.metadataCustomerCategory;a=a.metadataDidBepRun;e=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("metadata",{app_owner:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,e),csid_bm:b.OPTIONAL(c.CUSTOM_STRING,f),payment_bm:b.OPTIONAL(c.CUSTOM_STRING,g),customer_category:b.OPTIONAL(c.CUSTOM_STRING,h),did_bep_run:b.OPTIONAL(c.CUSTOM_STRING,a)})));return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizMetadataMixin=a}),98);
__d("WASmaxOutMessagePublishBizPricingDataMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.pricingConsumerCountryCode;a=a.pricingBusinessCountryCode;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("pricing",{consumer_country_code:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),business_country_code:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizPricingDataMixin=a}),98);
__d("WASmaxOutMessagePublishBizRolesMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.bizHostStorage,c=a.bizActualActors;a=a.bizPrivacyModeTs;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{host_storage:d("WAWap").INT(b),actual_actors:d("WAWap").INT(c),privacy_mode_ts:d("WAWap").INT(a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizRolesMixin=a}),98);
__d("WASmaxMixinGroupExhaustiveError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){function b(){var b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(b=a.call.apply(a,[this].concat(d))||this,b.name="SmaxMixinGroupExhaustiveError",babelHelpers.assertThisInitialized(b))||babelHelpers.assertThisInitialized(b)}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));f.SmaxMixinGroupExhaustiveError=a}),66);
__d("WASmaxOutMessagePublishButtonsMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("buttons",null)));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeButtonsMixin=a}),98);
__d("WASmaxOutMessagePublishExtensionsMetadataMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.capabilityArgs;a=d("WASmaxJsx").smax("capabilities",null,d("WASmaxChildren").REPEATED_CHILD(i,a,1,50));return a}function i(a){a=a.capabilityName;a=d("WASmaxJsx").smax("capability",{name:d("WAWap").CUSTOM_STRING(a)});return a}function j(a){var b=a.capabilitiesArgs,c=a.extensionsMetadataWellVersion,e=a.extensionsMetadataDataApiVersion;a=a.extensionsMetadataFlowMessageVersion;c=d("WASmaxJsx").smax("native_flow",null,d("WASmaxJsx").smax("extensions_metadata",{well_version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c),data_api_version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,e),flow_message_version:d("WAWap").INT(a)},d("WASmaxChildren").OPTIONAL_CHILD(h,b)));return c}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeExtensionsMetadataExtensionsMetadataCapabilities=h;g.makeExtensionsMetadataExtensionsMetadataCapabilitiesCapability=i;g.mergeExtensionsMetadataMixin=a}),98);
__d("WASmaxOutMessagePublishMixedMetadataMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.paymentsMetadataVersion;a=d("WASmaxJsx").smax("native_flow",null,d("WASmaxJsx").smax("mixed_metadata",null,d("WASmaxJsx").smax("payments_metadata",{version:d("WAWap").INT(a)})));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMixedMetadataMixin=a}),98);
__d("WASmaxOutMessagePublishNativeFlowMessageTypeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishExtensionsMetadataMixin","WASmaxOutMessagePublishMixedMetadataMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.nativeFlowName,c=a.nativeFlowV,e=a.extensionsMetadataMixinArgs;a=a.mixedMetadataMixinArgs;b=d("WASmaxJsx").smax("interactive",{type:"native_flow"},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishMixedMetadataMixin").mergeMixedMetadataMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishExtensionsMetadataMixin").mergeExtensionsMetadataMixin,d("WASmaxJsx").smax("native_flow",{name:d("WAWap").CUSTOM_STRING(b),v:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c)}),e),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNativeFlowMessageTypeMixin=a}),98);
__d("WASmaxOutMessagePublishInteractiveMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishNativeFlowMessageTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasInteractiveV1;a=a.nativeFlowMessageTypeMixinArgs;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxOutMessagePublishNativeFlowMessageTypeMixin").mergeNativeFlowMessageTypeMixin(d("WASmaxJsx").smax("interactive",{v:d("WASmaxAttrs").OPTIONAL_LITERAL("1",b)}),a)));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInteractiveMixin=a}),98);
__d("WASmaxOutMessagePublishNativeFlowMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.bizNativeFlowName;a=a.bizNativeFlowVersion;b=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",{native_flow_name:d("WAWap").CUSTOM_STRING(b),native_flow_version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNativeFlowMixin=a}),98);
__d("WASmaxOutMessagePublishButtonsOrNativeFlowOrInteractiveMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishButtonsMixin","WASmaxOutMessagePublishInteractiveMixin","WASmaxOutMessagePublishNativeFlowMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isButtons)return d("WASmaxOutMessagePublishButtonsMixin").mergeButtonsMixin(a);if(b.nativeFlow)return d("WASmaxOutMessagePublishNativeFlowMixin").mergeNativeFlowMixin(a,b.nativeFlow);if(b.interactive)return d("WASmaxOutMessagePublishInteractiveMixin").mergeInteractiveMixin(a,b.interactive);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeButtonsOrNativeFlowOrInteractiveMixinGroup=a}),98);
__d("WASmaxOutMessagePublishConversionRecipientStatusMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.conversionRecipientStatus;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("conversion",{recipient_status:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeConversionRecipientStatusMixin=a}),98);
__d("WASmaxOutMessagePublishClickToWhatsAppAttributionMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.ctwaAttributionElementValue;a=d("WASmaxJsx").smax("ctwa_attribution",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClickToWhatsAppAttributionMixin=a}),98);
__d("WASmaxOutMessagePublishCtwaAttributionMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishClickToWhatsAppAttributionMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishClickToWhatsAppAttributionMixin").mergeClickToWhatsAppAttributionMixin(d("WASmaxJsx").smax("ctwa_attribution",null),a);return a}function i(a){a=a.ctwaAttributionArgs;a=d("WASmaxJsx").smax("message",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeCtwaAttributionCtwaAttribution=h;g.mergeCtwaAttributionMixin=a}),98);
__d("WASmaxOutMessagePublishClickToWhatsAppTypeMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.sourceUrlElementValue;a=d("WASmaxJsx").smax("source_url",null,a);return a}function i(a){var b,c,e=a.sourceUrlArgs,f=a.ctwaConversionSource,g=a.ctwaConversionData,i=a.ctwaSourceType,j=a.ctwaEntryPointConversionSource,k=a.ctwaEntryPointConversionApp;a=a.ctwaSignals;f=d("WASmaxJsx").smax("ctwa",{conversion_source:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,f),conversion_data:b.OPTIONAL(c.CUSTOM_STRING,g),source_type:b.OPTIONAL(c.CUSTOM_STRING,i),entry_point_conversion_source:b.OPTIONAL(c.CUSTOM_STRING,j),entry_point_conversion_app:b.OPTIONAL(c.CUSTOM_STRING,k),signals:b.OPTIONAL(c.CUSTOM_STRING,a)},d("WASmaxChildren").OPTIONAL_CHILD(h,e));return f}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeClickToWhatsAppTypeSourceUrl=h;g.mergeClickToWhatsAppTypeMixin=a}),98);
__d("WASmaxOutMessagePublishCtwaConversionMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishClickToWhatsAppTypeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishClickToWhatsAppTypeMixin").mergeClickToWhatsAppTypeMixin(d("WASmaxJsx").smax("ctwa",null),a);return a}function i(a){a=a.ctwaArgs;a=d("WASmaxJsx").smax("message",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeCtwaConversionCtwa=h;g.mergeCtwaConversionMixin=a}),98);
__d("WASmaxOutMessagePublishDeliveryContextMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c,e=a.deliveryContextHsmMaxBid,f=a.deliveryContextOptimizationGoal,g=a.deliveryContextTemplateId,h=a.deliveryContextCampaignId,i=a.deliveryContextSourceType,j=a.deliveryContextTierType,k=a.deliveryContextDeliveryType,l=a.deliveryContextClientToken,m=a.deliveryContextPrice,n=a.deliveryContextWabaId,o=a.deliveryContextQualityFlag,p=a.deliveryContextIsZeroRatedTemplate,q=a.deliveryContextPartnerId,r=a.deliveryContextAppId,s=a.deliveryContextVertical,t=a.deliveryContextBmMessageLimitStatus;a=a.deliveryContextShouldBypassIntegrityPhoneLimit;e=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("delivery_context",{hsm_max_bid:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).INT,e),optimization_goal:b.OPTIONAL(c.CUSTOM_STRING,f),template_id:b.OPTIONAL(c.CUSTOM_STRING,g),campaign_id:b.OPTIONAL(c.CUSTOM_STRING,h),source_type:b.OPTIONAL(c.CUSTOM_STRING,i),tier_type:b.OPTIONAL(c.CUSTOM_STRING,j),delivery_type:b.OPTIONAL(c.CUSTOM_STRING,k),client_token:b.OPTIONAL(c.CUSTOM_STRING,l),price:b.OPTIONAL(c.INT,m),waba_id:b.OPTIONAL(c.CUSTOM_STRING,n),quality_flag:b.OPTIONAL(c.CUSTOM_STRING,o),is_zero_rated_template:b.OPTIONAL(c.CUSTOM_STRING,p),partner_id:b.OPTIONAL(c.CUSTOM_STRING,q),app_id:b.OPTIONAL(c.CUSTOM_STRING,r),vertical:b.OPTIONAL(c.INT,s),bm_message_limit_status:b.OPTIONAL(c.CUSTOM_STRING,t),should_bypass_integrity_phone_limit:b.OPTIONAL(c.CUSTOM_STRING,a)})));return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeliveryContextMixin=a}),98);
__d("WASmaxOutMessagePublishCapabilitiesMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.hasFeatureV1;a=d("WASmaxJsx").smax("feature",{name:"full_catalog",v:d("WASmaxAttrs").OPTIONAL_LITERAL("1",a)});return a}function i(a){a=a.featureArgs;a=d("WASmaxJsx").smax("hsm",null,d("WASmaxJsx").smax("capabilities",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeCapabilitiesCapabilitiesFeature=h;g.mergeCapabilitiesMixin=a}),98);
__d("WASmaxOutMessagePublishHSMReviewMetadataMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c,e=a.anyCategory,f=a.anyTag,g=a.anyId,h=a.anySubTag,i=a.anyLibraryTemplateId;a=a.anyIsTemplateFromLibraryEdited;e=d("WASmaxJsx").smax("smax$any",{category:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,e),tag:b.OPTIONAL(c.CUSTOM_STRING,f),id:b.OPTIONAL(c.CUSTOM_STRING,g),sub_tag:b.OPTIONAL(c.CUSTOM_STRING,h),library_template_id:b.OPTIONAL(c.CUSTOM_STRING,i),is_template_from_library_edited:b.OPTIONAL(c.CUSTOM_STRING,a)});return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHSMReviewMetadataMixin=a}),98);
__d("WASmaxOutMessagePublishQualityTokenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){var b=a.hasQualityTokenV1;a=a.qualityTokenElementValue;b=d("WASmaxJsx").smax("hsm",null,d("WASmaxJsx").smax("quality_token",{v:d("WASmaxAttrs").OPTIONAL_LITERAL("1",b)},a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeQualityTokenMixin=a}),98);
__d("WASmaxOutMessagePublishHsmMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishCapabilitiesMixin","WASmaxOutMessagePublishHSMReviewMetadataMixin","WASmaxOutMessagePublishQualityTokenMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.messageTtl,e=a.hasHsmV1,f=a.hasHsmButtons1,g=a.hsmObjective,h=a.hSMReviewMetadataMixinArgs,i=a.capabilitiesMixinArgs;a=a.qualityTokenMixinArgs;c=d("WASmaxJsx").smax("message",{ttl:(b=d("WASmaxAttrs")).OPTIONAL(d("WAWap").INT,c)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishQualityTokenMixin").mergeQualityTokenMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishCapabilitiesMixin").mergeCapabilitiesMixin,d("WASmaxOutMessagePublishHSMReviewMetadataMixin").mergeHSMReviewMetadataMixin(d("WASmaxJsx").smax("hsm",{v:b.OPTIONAL_LITERAL("1",e),buttons:b.OPTIONAL_LITERAL("1",f),objective:b.OPTIONAL(d("WAWap").CUSTOM_STRING,g)}),h),i),a));return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeHsmMixin=a}),98);
__d("WASmaxOutMessagePublishQualityControlMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.decisionSourceValue;a=d("WASmaxJsx").smax("decision_source",{value:d("WAWap").CUSTOM_STRING(a)});return a}function i(a){var b=a.decisionSourceArgs,c=a.qualityControlSourceType;a=a.qualityControlDecisionId;c=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("quality_control",{source_type:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c),decision_id:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)},d("WASmaxChildren").REPEATED_CHILD(h,b,0,Infinity))));return c}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeQualityControlBizQualityControlDecisionSource=h;g.mergeQualityControlMixin=a}),98);
__d("WASmaxOutMessagePublishBizMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAuthMixin","WASmaxOutMessagePublishBizAcceptTsMixin","WASmaxOutMessagePublishBizAutoResponseMixin","WASmaxOutMessagePublishBizCampaignMixin","WASmaxOutMessagePublishBizEngagementDataMixin","WASmaxOutMessagePublishBizMetadataMixin","WASmaxOutMessagePublishBizPricingDataMixin","WASmaxOutMessagePublishBizRolesMixin","WASmaxOutMessagePublishButtonsOrNativeFlowOrInteractiveMixinGroup","WASmaxOutMessagePublishConversionRecipientStatusMixin","WASmaxOutMessagePublishCtwaAttributionMixin","WASmaxOutMessagePublishCtwaConversionMixin","WASmaxOutMessagePublishDeliveryContextMixin","WASmaxOutMessagePublishHsmMixin","WASmaxOutMessagePublishQualityControlMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.hsmMixinArgs,e=a.bizRolesMixinArgs,f=a.bizAutoResponseMixinArgs,g=a.bizAcceptTsMixinArgs,h=a.bizCampaignMixinArgs,i=a.deliveryContextMixinArgs,j=a.qualityControlMixinArgs,k=a.authMixinArgs,l=a.conversionRecipientStatusMixinArgs,m=a.ctwaConversionMixinArgs,n=a.bizMetadataMixinArgs,o=a.ctwaAttributionMixinArgs,p=a.bizEngagementDataMixinArgs,q=a.bizPricingDataMixinArgs;a=a.buttonsOrNativeFlowOrInteractiveMixinGroupArgs;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishButtonsOrNativeFlowOrInteractiveMixinGroup").mergeButtonsOrNativeFlowOrInteractiveMixinGroup,b.optionalMerge(d("WASmaxOutMessagePublishBizPricingDataMixin").mergeBizPricingDataMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizEngagementDataMixin").mergeBizEngagementDataMixin,b.optionalMerge(d("WASmaxOutMessagePublishCtwaAttributionMixin").mergeCtwaAttributionMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizMetadataMixin").mergeBizMetadataMixin,b.optionalMerge(d("WASmaxOutMessagePublishCtwaConversionMixin").mergeCtwaConversionMixin,b.optionalMerge(d("WASmaxOutMessagePublishConversionRecipientStatusMixin").mergeConversionRecipientStatusMixin,b.optionalMerge(d("WASmaxOutMessagePublishAuthMixin").mergeAuthMixin,b.optionalMerge(d("WASmaxOutMessagePublishQualityControlMixin").mergeQualityControlMixin,b.optionalMerge(d("WASmaxOutMessagePublishDeliveryContextMixin").mergeDeliveryContextMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizCampaignMixin").mergeBizCampaignMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizAcceptTsMixin").mergeBizAcceptTsMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizAutoResponseMixin").mergeBizAutoResponseMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizRolesMixin").mergeBizRolesMixin,b.optionalMerge(d("WASmaxOutMessagePublishHsmMixin").mergeHsmMixin,d("WASmaxJsx").smax("message",null),c),e),f),g),h),i),j),k),l),m),n),o),p),q),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBizMixin=a}),98);
__d("WASmaxOutMessagePublishClientFrankingTagMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.frankingTagElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("franking",null,d("WASmaxJsx").smax("franking_tag",null,a)));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientFrankingTagMixin=a}),98);
__d("WASmaxOutMessagePublishClientReportingTokenMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.reportingTokenV;a=a.reportingTokenElementValue;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("reporting",null,d("WASmaxJsx").smax("reporting_token",{v:d("WAWap").INT(b)},a)));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientReportingTokenMixin=a}),98);
__d("WASmaxOutMessagePublishDeviceIdentityMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("device-identity",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeviceIdentityMixin=a}),98);
__d("WASmaxOutMessagePublishInternalTestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.testConfig;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("test",{config:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInternalTestMixin=a}),98);
__d("WASmaxOutMessagePublishLIDSessionDeprecationMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaDeprecatedLidSession;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{deprecated_lid_session:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLIDSessionDeprecationMixin=a}),98);
__d("WASmaxOutMessagePublishMessageAssociationTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaMessageAssociationType;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{message_association_type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageAssociationTypeMixin=a}),98);
__d("WASmaxOutMessagePublishMetaHideDecryptionPlaceholderMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("meta",{"decrypt-fail":"hide"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMetaHideDecryptionPlaceholderMixin=a}),98);
__d("WASmaxOutMessagePublishMulticastMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("multicast",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMulticastMixin=a}),98);
__d("WASmaxOutMessagePublishNoExtraFanoutMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{device_fanout:"false"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeNoExtraFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishAnonPaddingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.taPadElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("ta_pad",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAnonPaddingMixin=a}),98);
__d("WASmaxOutMessagePublishWireSizePaddingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.paddingElementValue;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("padding",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeWireSizePaddingMixin=a}),98);
__d("WASmaxOutMessagePublishPaddingMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAnonPaddingMixin","WASmaxOutMessagePublishWireSizePaddingMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.anonPaddingMixinArgs;a=a.wireSizePaddingMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishWireSizePaddingMixin").mergeWireSizePaddingMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishAnonPaddingMixin").mergeAnonPaddingMixin,d("WASmaxJsx").smax("message",null),b),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePaddingMixin=a}),98);
__d("WASmaxOutMessagePublishPreFilledNumberMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("url_number",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePreFilledNumberMixin=a}),98);
__d("WASmaxOutMessagePublishPreFilledTextMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("url_text",null));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePreFilledTextMixin=a}),98);
__d("WASmaxOutMessagePublishSenderIntentMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{sender_intent:"hosted"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderIntentMixin=a}),98);
__d("WASmaxOutMessagePublishRequestIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestIdElementValue;a=d("WASmaxJsx").smax("trace",null,d("WASmaxJsx").smax("request_id",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRequestIDMixin=a}),98);
__d("WASmaxOutMessagePublishTraceIDMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.edgeIdElementValue;a=d("WASmaxJsx").smax("edge_id",null,a);return a}function i(a){var b=a.deviceArgs,c=a.correlationIdType;a=a.idElementValue;c=d("WASmaxJsx").smax("correlation_id",{type:d("WAWap").CUSTOM_STRING(c)},d("WASmaxJsx").smax("id",null,a),d("WASmaxChildren").OPTIONAL_CHILD(k,b));return c}function j(a){a=a.observabilityFlagsId;a=d("WASmaxJsx").smax("observability_flags",{id:d("WAWap").INT(a)});return a}function k(a){a=a.deviceId;a=d("WASmaxJsx").smax("device",{id:d("WAWap").INT(a)});return a}function l(a){var b=a.edgeIdArgs,c=a.correlationIdArgs,e=a.observabilityFlagsArgs;a=a.traceIdElementValue;a=d("WASmaxJsx").smax("trace",null,[d("WASmaxJsx").smax("trace_id",null,a),d("WASmaxChildren").OPTIONAL_CHILD(h,b)].concat(d("WASmaxChildren").REPEATED_CHILD(i,c,0,10),[d("WASmaxChildren").OPTIONAL_CHILD(j,e)]));return a}function a(a,b){b=l(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeTraceIDEdgeId=h;g.makeTraceIDCorrelationId=i;g.makeTraceIDObservabilityFlags=j;g.makeTraceIDCorrelationIdDevice=k;g.mergeTraceIDMixin=a}),98);
__d("WASmaxOutMessagePublishRequestOrTraceIDMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishRequestIDMixin","WASmaxOutMessagePublishTraceIDMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.requestID)return d("WASmaxOutMessagePublishRequestIDMixin").mergeRequestIDMixin(a,b.requestID);if(b.traceID)return d("WASmaxOutMessagePublishTraceIDMixin").mergeTraceIDMixin(a,b.traceID);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeRequestOrTraceIDMixinGroup=a}),98);
__d("WASmaxOutMessagePublishTraceContextMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishRequestOrTraceIDMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestOrTraceIDMixinGroupArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutMessagePublishRequestOrTraceIDMixinGroup").mergeRequestOrTraceIDMixinGroup(d("WASmaxJsx").smax("trace",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTraceContextMixin=a}),98);
__d("WASmaxOutMessagePublishVerifiedNameNameMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageVerifiedName;a=d("WASmaxJsx").smax("message",{verified_name:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeVerifiedNameNameMixin=a}),98);
__d("WASmaxOutMessagePublishWebDriverConfigMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaWebdriverConfig;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{webdriver_config:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeWebDriverConfigMixin=a}),98);
__d("WASmaxOutMessagePublishBaseMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAutomatedMixin","WASmaxOutMessagePublishBizMixin","WASmaxOutMessagePublishClientFrankingTagMixin","WASmaxOutMessagePublishClientReportingTokenMixin","WASmaxOutMessagePublishDeviceIdentityMixin","WASmaxOutMessagePublishInternalTestMixin","WASmaxOutMessagePublishLIDSessionDeprecationMixin","WASmaxOutMessagePublishMessageAssociationTypeMixin","WASmaxOutMessagePublishMetaHideDecryptionPlaceholderMixin","WASmaxOutMessagePublishMulticastMixin","WASmaxOutMessagePublishNoExtraFanoutMixin","WASmaxOutMessagePublishPaddingMixin","WASmaxOutMessagePublishPreFilledNumberMixin","WASmaxOutMessagePublishPreFilledTextMixin","WASmaxOutMessagePublishSenderIntentMixin","WASmaxOutMessagePublishTraceContextMixin","WASmaxOutMessagePublishVerifiedNameNameMixin","WASmaxOutMessagePublishWebDriverConfigMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.deviceIdentityMixinArgs,e=a.hasNoExtraFanout,f=a.hasMulticast,g=a.hasPreFilledText,h=a.hasPreFilledNumber,i=a.hasAutomated,j=a.bizMixinArgs,k=a.verifiedNameNameMixinArgs,l=a.clientFrankingTagMixinArgs,m=a.clientReportingTokenMixinArgs,n=a.internalTestMixinArgs,o=a.hasMetaHideDecryptionPlaceholder,p=a.traceContextMixinArgs,q=a.hasSenderIntent,r=a.lIDSessionDeprecationMixinArgs,s=a.paddingMixinArgs,t=a.webDriverConfigMixinArgs;a=a.messageAssociationTypeMixinArgs;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishMessageAssociationTypeMixin").mergeMessageAssociationTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishWebDriverConfigMixin").mergeWebDriverConfigMixin,b.optionalMerge(d("WASmaxOutMessagePublishPaddingMixin").mergePaddingMixin,b.optionalMerge(d("WASmaxOutMessagePublishLIDSessionDeprecationMixin").mergeLIDSessionDeprecationMixin,b.optionalMerge(d("WASmaxOutMessagePublishSenderIntentMixin").mergeSenderIntentMixin,b.optionalMerge(d("WASmaxOutMessagePublishTraceContextMixin").mergeTraceContextMixin,b.optionalMerge(d("WASmaxOutMessagePublishMetaHideDecryptionPlaceholderMixin").mergeMetaHideDecryptionPlaceholderMixin,b.optionalMerge(d("WASmaxOutMessagePublishInternalTestMixin").mergeInternalTestMixin,b.optionalMerge(d("WASmaxOutMessagePublishClientReportingTokenMixin").mergeClientReportingTokenMixin,b.optionalMerge(d("WASmaxOutMessagePublishClientFrankingTagMixin").mergeClientFrankingTagMixin,b.optionalMerge(d("WASmaxOutMessagePublishVerifiedNameNameMixin").mergeVerifiedNameNameMixin,b.optionalMerge(d("WASmaxOutMessagePublishBizMixin").mergeBizMixin,b.optionalMerge(d("WASmaxOutMessagePublishAutomatedMixin").mergeAutomatedMixin,b.optionalMerge(d("WASmaxOutMessagePublishPreFilledNumberMixin").mergePreFilledNumberMixin,b.optionalMerge(d("WASmaxOutMessagePublishPreFilledTextMixin").mergePreFilledTextMixin,b.optionalMerge(d("WASmaxOutMessagePublishMulticastMixin").mergeMulticastMixin,b.optionalMerge(d("WASmaxOutMessagePublishNoExtraFanoutMixin").mergeNoExtraFanoutMixin,b.optionalMerge(d("WASmaxOutMessagePublishDeviceIdentityMixin").mergeDeviceIdentityMixin,d("WASmaxJsx").smax("message",null),c),e),f),g),h),i),j),k),l),m),n),o),p),q),r),s),t),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseMixin=a}),98);
__d("WASmaxOutMessagePublishGroupInviteTargetMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaGroupInvite;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{group_invite:d("WAWap").GROUP_JID(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeGroupInviteTargetMixin=a}),98);
__d("WASmaxOutMessagePublishBotFeedbackMessageTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("bot",{type:"feedback"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotFeedbackMessageTypeMixin=a}),98);
__d("WASmaxOutMessagePublishEncRetryMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encCount;a=d("WASmaxJsx").smax("enc",{count:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncRetryMixin=a}),98);
__d("WASmaxOutMessagePublishEncPayloadMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.encElementValue;a=d("WASmaxJsx").smax("enc",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncPayloadMixin=a}),98);
__d("WASmaxOutMessagePublishEncTypeIndividualMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncPayloadMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encType;b=d("WASmaxOutMessagePublishEncPayloadMixin").mergeEncPayloadMixin(d("WASmaxJsx").smax("enc",{type:d("WAWap").CUSTOM_STRING(b)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncTypeIndividualMixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion2Mixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{v:"2"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersion2Mixin=a}),98);
__d("WASmaxOutMessagePublishEncVersionFutureproofMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encV;a=d("WASmaxJsx").smax("enc",{v:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersionFutureproofMixin=a}),98);
__d("WASmaxOutMessagePublishEncVersionBot",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncVersion2Mixin","WASmaxOutMessagePublishEncVersionFutureproofMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isEncVersion2)return d("WASmaxOutMessagePublishEncVersion2Mixin").mergeEncVersion2Mixin(a);if(b.encVersionFutureproof)return d("WASmaxOutMessagePublishEncVersionFutureproofMixin").mergeEncVersionFutureproofMixin(a,b.encVersionFutureproof);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncVersionBot=a}),98);
__d("WASmaxOutMessagePublishMediaTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encMediatype;a=d("WASmaxJsx").smax("enc",{mediatype:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMediaTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBotRequestMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncRetryMixin","WASmaxOutMessagePublishEncTypeIndividualMixin","WASmaxOutMessagePublishEncVersionBot","WASmaxOutMessagePublishMediaTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid,c=a.encRetryMixinArgs,e=a.encTypeIndividualMixinArgs,f=a.mediaTypeMixinArgs;a=a.encVersionBotArgs;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").JID(b)},d("WASmaxOutMessagePublishEncVersionBot").mergeEncVersionBot(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishMediaTypeMixin").mergeMediaTypeMixin,d("WASmaxOutMessagePublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishEncRetryMixin").mergeEncRetryMixin,d("WASmaxJsx").smax("enc",null),c),e),f),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotRequestMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"media"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeMediaMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeTextMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"text"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeTextMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeTextOrMediaMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishContentTypeTextMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.isContentTypeMedia)return d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentTypeTextOrMediaMixinGroup=a}),98);
__d("WASmaxOutMessagePublishBotMetricsEntryPointMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaOrigin;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{origin:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotMetricsEntryPointMixin=a}),98);
__d("WASmaxOutMessagePublishBotLocalAutomatedTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botLocalAutomatedType;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{local_automated_type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotLocalAutomatedTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBotMessageTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botType;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotMessageTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBotMetricsThreadEntryPointMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaThreadOrigin;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{thread_origin:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotMetricsThreadEntryPointMixin=a}),98);
__d("WASmaxOutMessagePublishBotPersonaTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botPersonaType;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{persona_type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotPersonaTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBusinessBotMessageFeedbackRequestedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botFeedbackRequested;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{feedback_requested:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBusinessBotMessageFeedbackRequestedMixin=a}),98);
__d("WASmaxOutMessagePublishBusinessBotMessageMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.botBizBot;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("bot",{biz_bot:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBusinessBotMessageMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeEventMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaEventType;a=d("WASmaxJsx").smax("message",{type:"event"},d("WASmaxJsx").smax("meta",{event_type:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeEventMixin=a}),98);
__d("WASmaxOutMessagePublishProductListMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("list",{type:"product_list"})));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeProductListMixin=a}),98);
__d("WASmaxOutMessagePublishSingleSelectListMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.listV;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("biz",null,d("WASmaxJsx").smax("list",{type:"single_select",v:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)})));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSingleSelectListMixin=a}),98);
__d("WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishProductListMixin","WASmaxOutMessagePublishSingleSelectListMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.singleSelectList)return d("WASmaxOutMessagePublishSingleSelectListMixin").mergeSingleSelectListMixin(a,b.singleSelectList);if(b.isProductList)return d("WASmaxOutMessagePublishProductListMixin").mergeProductListMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeSingleSelectOrProductListMixinGroup=a}),98);
__d("WASmaxOutMessagePublishContentTypeListFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"list"}));return a}function i(a){var b=a.toCount;a=a.singleSelectOrProductListMixinGroupArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup").mergeSingleSelectOrProductListMixinGroup,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD_COUNT(h,b)))),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeListFanoutParticipantsTo=h;g.mergeContentTypeListFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishLiveLocationModeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaLivelocMode;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{liveloc_mode:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLiveLocationModeMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeLiveLocationFanoutMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishLiveLocationModeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)}));return a}function i(a){var b=a.toArgs;a=a.liveLocationModeMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLiveLocationModeMixin").mergeLiveLocationModeMixin,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b)))),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeLiveLocationFanoutParticipantsTo=h;g.mergeContentTypeLiveLocationFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMedianotifyMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"medianotify"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeMedianotifyMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishContentTypeMedianotifyMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeMedia)return d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(a);if(b.isContentTypeMedianotify)return d("WASmaxOutMessagePublishContentTypeMedianotifyMixin").mergeContentTypeMedianotifyMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentTypeMediaOrMedianotifyMixinGroup=a}),98);
__d("WASmaxOutMessagePublishSenderContentBindingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.senderContentBindingElementValue;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("sender_content_binding",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeSenderContentBindingMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaFanoutDeprecatedMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup","WASmaxOutMessagePublishSenderContentBindingMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encMediatype,c=a.hasEncStickerTypeAvatar;a=a.encNativeFlowName;b=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),sticker_type:d("WASmaxAttrs").OPTIONAL_LITERAL("avatar",c),native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return b}function i(a){var b=a.toArgs,c=a.senderContentBindingMixinArgs;a=a.contentTypeMediaOrMedianotifyMixinGroupArgs;b=d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup").mergeContentTypeMediaOrMedianotifyMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentBindingMixin").mergeSenderContentBindingMixin,d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b))),c),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeMediaFanoutDeprecatedParticipantsTo=h;g.mergeContentTypeMediaFanoutDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaFanoutMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup","WASmaxOutMessagePublishSenderContentBindingMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encMediatype,c=a.hasEncStickerTypeAvatar;a=a.encNativeFlowName;b=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:d("WAWap").CUSTOM_STRING(b),sticker_type:d("WASmaxAttrs").OPTIONAL_LITERAL("avatar",c),native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return b}function i(a){var b=a.toArgs,c=a.senderContentBindingMixinArgs;a=a.contentTypeMediaOrMedianotifyMixinGroupArgs;b=d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup").mergeContentTypeMediaOrMedianotifyMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentBindingMixin").mergeSenderContentBindingMixin,d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").HOMOGENEOUS_CHILD(h,b))),c),a);return b}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeContentTypeMediaFanoutParticipantsTo=h;g.mergeContentTypeMediaFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePollCreationMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaContenttype;a=d("WASmaxJsx").smax("message",{type:"poll"},d("WASmaxJsx").smax("meta",{polltype:"creation",contenttype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePollCreationMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePollResultSnapshotMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"poll"},d("WASmaxJsx").smax("meta",{polltype:"result_snapshot"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePollResultSnapshotMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePollVoteMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaContenttype;a=d("WASmaxJsx").smax("message",{type:"poll"},d("WASmaxJsx").smax("meta",{polltype:"vote",contenttype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePollVoteMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeReactionMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"reaction"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeReactionMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypePayMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{type:"pay"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypePayMixin=a}),98);
__d("WASmaxOutMessagePublishPayNodeTypeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.payType;a=d("WASmaxJsx").smax("pay",{type:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePayNodeTypeMixin=a}),98);
__d("WASmaxOutMessagePublishBasePayNodeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishPayNodeTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.payCountry,c=a.payVersion,e=a.payIsFirstSend;b=d("WASmaxOutMessagePublishPayNodeTypeMixin").mergePayNodeTypeMixin(d("WASmaxJsx").smax("pay",{country:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),version:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,c),is_first_send:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,e)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBasePayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishLegacyAmountMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.payCurrency;a=a.payAmount;b=d("WASmaxJsx").smax("pay",{currency:d("WAWap").CUSTOM_STRING(b),amount:d("WAWap").CUSTOM_STRING(a)});return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLegacyAmountMixin=a}),98);
__d("WASmaxOutMessagePublishMoneyMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.moneyValue,c=a.moneyOffset;a=a.moneyCurrency;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("money",{value:d("WAWap").CUSTOM_STRING(b),offset:d("WAWap").CUSTOM_STRING(c),currency:d("WAWap").CUSTOM_STRING(a)}));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMoneyMixin=a}),98);
__d("WASmaxOutMessagePublishBaseIndividualPublishSendPayNodeMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBasePayNodeMixin","WASmaxOutMessagePublishLegacyAmountMixin","WASmaxOutMessagePublishMoneyMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishMoneyMixin").mergeMoneyMixin(d("WASmaxJsx").smax("amount",null),a);return a}function i(a){var b=a.amountArgs,c=a.payCredentialId,e=a.payDeviceId,f=a.payRequestId,g=a.legacyAmountMixinArgs;c=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLegacyAmountMixin").mergeLegacyAmountMixin,d("WASmaxOutMessagePublishBasePayNodeMixin").mergeBasePayNodeMixin(d("WASmaxJsx").smax("pay",{"credential-id":d("WAWap").CUSTOM_STRING(c),"device-id":d("WAWap").CUSTOM_STRING(e),"request-id":d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,f)},d("WASmaxChildren").OPTIONAL_CHILD(h,b)),a),g);return c}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeBaseIndividualPublishSendPayNodeAmount=h;g.mergeBaseIndividualPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishInstallmentMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishMoneyMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishMoneyMixin").mergeMoneyMixin(d("WASmaxJsx").smax("due_amount",null),a);return a}function i(a){a=d("WASmaxOutMessagePublishMoneyMixin").mergeMoneyMixin(d("WASmaxJsx").smax("interest",null),a);return a}function j(a){var b=a.dueAmountArgs,c=a.interestArgs,e=a.installmentMaxCount;a=a.installmentSelectedCount;e=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("installment",{max_count:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,e),selected_count:d("WAWap").INT(a)},d("WASmaxChildren").OPTIONAL_CHILD(h,b),d("WASmaxChildren").OPTIONAL_CHILD(i,c)));return e}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeInstallmentInstallmentDueAmount=h;g.makeInstallmentInstallmentInterest=i;g.mergeInstallmentMixin=a}),98);
__d("WASmaxOutMessagePublishBeneficiaryMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.beneficiaryName,e=a.beneficiaryAddressLine1,f=a.beneficiaryAddressLine2,g=a.beneficiaryCity,h=a.beneficiaryState,i=a.beneficiaryPhoneNumber,j=a.beneficiaryCountry;a=a.beneficiaryPostalCode;e=d("WASmaxJsx").smax("beneficiary",{name:(b=d("WAWap")).CUSTOM_STRING(c),address_line1:b.CUSTOM_STRING(e),address_line2:(c=d("WASmaxAttrs")).OPTIONAL(b.CUSTOM_STRING,f),city:c.OPTIONAL(b.CUSTOM_STRING,g),state:c.OPTIONAL(b.CUSTOM_STRING,h),phone_number:c.OPTIONAL(b.CUSTOM_STRING,i),country:b.CUSTOM_STRING(j),postal_code:b.CUSTOM_STRING(a)});return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBeneficiaryMixin=a}),98);
__d("WASmaxOutMessagePublishBeneficiariesMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBeneficiaryMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishBeneficiaryMixin").mergeBeneficiaryMixin(d("WASmaxJsx").smax("beneficiary",null),a);return a}function i(a){a=a.beneficiaryArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxChildren").REPEATED_CHILD(h,a,1,5));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeBeneficiariesBeneficiary=h;g.mergeBeneficiariesMixin=a}),98);
__d("WASmaxOutMessagePublishOrderInPaymentMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBeneficiariesMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishBeneficiariesMixin").mergeBeneficiariesMixin(d("WASmaxJsx").smax("beneficiaries",null),a);return a}function i(a){var b,c=a.beneficiariesArgs,e=a.orderId,f=a.orderMessageId,g=a.orderPaymentConfigId;a=a.orderType;e=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("order",{id:(b=d("WAWap")).CUSTOM_STRING(e),message_id:d("WASmaxAttrs").OPTIONAL(b.STANZA_ID,f),payment_config_id:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,g),type:d("WASmaxAttrs").OPTIONAL(b.CUSTOM_STRING,a)},d("WASmaxChildren").OPTIONAL_CHILD(h,c)));return e}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeOrderInPaymentOrderBeneficiaries=h;g.mergeOrderInPaymentMixin=a}),98);
__d("WASmaxOutMessagePublishPaymentInitiatorMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPaymentInitiator;a=d("WASmaxJsx").smax("smax$any",{payment_initiator:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePaymentInitiatorMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeP2MMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishInstallmentMixin","WASmaxOutMessagePublishOrderInPaymentMixin","WASmaxOutMessagePublishPaymentInitiatorMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.orderInPaymentMixinArgs,c=a.paymentInitiatorMixinArgs;a=a.installmentMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishInstallmentMixin").mergeInstallmentMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishPaymentInitiatorMixin").mergePaymentInitiatorMixin,d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishOrderInPaymentMixin").mergeOrderInPaymentMixin,d("WASmaxJsx").smax("pay",{"transaction-type":"p2m"}),b),c),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeP2MMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeP2PMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("pay",{"transaction-type":"p2p"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeP2PMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishBRPublishSendPayNodeP2MMixin","WASmaxOutMessagePublishBRPublishSendPayNodeP2PMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isBRPublishSendPayNodeP2P)return d("WASmaxOutMessagePublishBRPublishSendPayNodeP2PMixin").mergeBRPublishSendPayNodeP2PMixin(a);if(b.bRPublishSendPayNodeP2M)return d("WASmaxOutMessagePublishBRPublishSendPayNodeP2MMixin").mergeBRPublishSendPayNodeP2MMixin(a,b.bRPublishSendPayNodeP2M);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBRPublishSendPayNodeP2POrMMixinGroup=a}),98);
__d("WASmaxOutMessagePublishBRSendPayEloNodeMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.eloDeviceSignature,e=a.eloWalletSignature,f=a.eloChallengeId;a=a.eloCardholderVerificationMethod;c=d("WASmaxJsx").smax("pay",null,d("WASmaxJsx").smax("elo",{device_signature:(b=d("WAWap")).CUSTOM_STRING(c),wallet_signature:b.CUSTOM_STRING(e),challenge_id:b.CUSTOM_STRING(f),cardholder_verification_method:b.CUSTOM_STRING(a)}));return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRSendPayEloNodeMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishSendPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup","WASmaxOutMessagePublishBRSendPayEloNodeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.payId,e=a.payPaymentRails,f=a.payTrustedDeviceInfo,g=a.payNonce,h=a.bRSendPayEloNodeMixinArgs;a=a.bRPublishSendPayNodeP2POrMMixinGroupArgs;c=d("WASmaxOutMessagePublishBRPublishSendPayNodeP2POrMMixinGroup").mergeBRPublishSendPayNodeP2POrMMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishBRSendPayEloNodeMixin").mergeBRSendPayEloNodeMixin,d("WASmaxJsx").smax("pay",{id:(b=d("WAWap")).CUSTOM_STRING(c),"payment-rails":b.CUSTOM_STRING(e),"trusted-device-info":b.CUSTOM_STRING(f),nonce:b.CUSTOM_STRING(g)}),h),a);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBRPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishUPILiteDetailsMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.upiLiteDetailsLiteReferenceNumber,e=a.upiLiteDetailsLiteArqc,f=a.upiLiteDetailsLiteTimestamp;a=a.upiLiteDetailsLitePurpose;c=d("WASmaxJsx").smax("upi_lite_details",{lite_reference_number:(b=d("WAWap")).CUSTOM_STRING(c),lite_arqc:b.CUSTOM_STRING(e),lite_timestamp:b.INT(f),lite_purpose:b.CUSTOM_STRING(a)});return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUPILiteDetailsMixin=a}),98);
__d("WASmaxOutMessagePublishOrderMessageMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.orderOrderId,e=a.orderOrderMessageId,f=a.orderExpiryTs,g=a.orderOrderType;a=a.orderDiscountProgramName;e=d("WASmaxJsx").smax("order",{"order-id":(b=d("WAWap")).CUSTOM_STRING(c),"order-message-id":(c=d("WASmaxAttrs")).OPTIONAL(b.CUSTOM_STRING,e),"expiry-ts":c.OPTIONAL(b.INT,f),"order-type":c.OPTIONAL(b.CUSTOM_STRING,g),"discount-program-name":c.OPTIONAL(b.CUSTOM_STRING,a)});return e}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeOrderMessageMixin=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2MMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishOrderMessageMixin","WASmaxOutMessagePublishPaymentInitiatorMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.orderArgs;a=a.paymentLinkArgs;b=d("WASmaxJsx").smax("upi",null,d("WASmaxChildren").OPTIONAL_CHILD(i,b),d("WASmaxChildren").OPTIONAL_CHILD(j,a));return b}function i(a){a=d("WASmaxOutMessagePublishOrderMessageMixin").mergeOrderMessageMixin(d("WASmaxJsx").smax("order",null),a);return a}function j(a){var b=a.paymentLinkOrderId;a=a.paymentLinkMessageId;b=d("WASmaxJsx").smax("payment_link",{order_id:d("WAWap").CUSTOM_STRING(b),message_id:d("WAWap").CUSTOM_STRING(a)});return b}function k(a){var b=a.upiArgs;a=a.paymentInitiatorMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishPaymentInitiatorMixin").mergePaymentInitiatorMixin,d("WASmaxJsx").smax("pay",{"transaction-type":"p2m"},d("WASmaxChildren").OPTIONAL_CHILD(h,b)),a);return b}function a(a,b){b=k(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeUPIPublishSendPayNodeP2MUpi=h;g.makeUPIPublishSendPayNodeP2MUpiOrder=i;g.makeUPIPublishSendPayNodeP2MUpiPaymentLink=j;g.mergeUPIPublishSendPayNodeP2MMixin=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2PMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.hasPayTransactionTypeP2P;a=d("WASmaxJsx").smax("pay",{"transaction-type":d("WASmaxAttrs").OPTIONAL_LITERAL("p2p",a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeUPIPublishSendPayNodeP2PMixin=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2POrMMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishUPIPublishSendPayNodeP2MMixin","WASmaxOutMessagePublishUPIPublishSendPayNodeP2PMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.uPIPublishSendPayNodeP2P)return d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2PMixin").mergeUPIPublishSendPayNodeP2PMixin(a,b.uPIPublishSendPayNodeP2P);if(b.uPIPublishSendPayNodeP2M)return d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2MMixin").mergeUPIPublishSendPayNodeP2MMixin(a,b.uPIPublishSendPayNodeP2M);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeUPIPublishSendPayNodeP2POrMMixinGroup=a}),98);
__d("WASmaxOutMessagePublishUPIPublishSendPayNodeMixin",["WASmaxAttrs","WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishUPILiteDetailsMixin","WASmaxOutMessagePublishUPIPublishSendPayNodeP2POrMMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.upiToken;a=d("WASmaxJsx").smax("upi",{token:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return a}function i(a){a=d("WASmaxOutMessagePublishUPILiteDetailsMixin").mergeUPILiteDetailsMixin(d("WASmaxJsx").smax("upi_lite_details",null),a);return a}function j(a){var b,c,e=a.upiArgs,f=a.upiLiteDetailsArgs,g=a.payId,j=a.payMpin,k=a.payReceiverVpa,l=a.payReceiverVpaId,m=a.paySenderVpa,n=a.paySenderVpaId,o=a.paySeqNo,p=a.payUpiBankInfo,q=a.payMode,r=a.payPurposeCode,s=a.payMcc,t=a.payRefId,u=a.payDeviceSsid,v=a.payNote;a=a.uPIPublishSendPayNodeP2POrMMixinGroupArgs;g=d("WASmaxOutMessagePublishUPIPublishSendPayNodeP2POrMMixinGroup").mergeUPIPublishSendPayNodeP2POrMMixinGroup(d("WASmaxJsx").smax("pay",{id:(b=d("WASmaxAttrs")).OPTIONAL((c=d("WAWap")).CUSTOM_STRING,g),mpin:b.OPTIONAL(c.CUSTOM_STRING,j),"receiver-vpa":c.CUSTOM_STRING(k),"receiver-vpa-id":b.OPTIONAL(c.CUSTOM_STRING,l),"sender-vpa":c.CUSTOM_STRING(m),"sender-vpa-id":b.OPTIONAL(c.CUSTOM_STRING,n),"seq-no":c.CUSTOM_STRING(o),"upi-bank-info":c.CUSTOM_STRING(p),mode:b.OPTIONAL(c.CUSTOM_STRING,q),"purpose-code":b.OPTIONAL(c.CUSTOM_STRING,r),mcc:b.OPTIONAL(c.CUSTOM_STRING,s),"ref-id":b.OPTIONAL(c.CUSTOM_STRING,t),device_ssid:b.OPTIONAL(c.CUSTOM_STRING,u),note:b.OPTIONAL(c.CUSTOM_STRING,v)},d("WASmaxChildren").OPTIONAL_CHILD(h,e),d("WASmaxChildren").OPTIONAL_CHILD(i,f)),a);return g}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeUPIPublishSendPayNodeUpi=h;g.makeUPIPublishSendPayNodeUpiLiteDetails=i;g.mergeUPIPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishBRPublishOrUPIPublishSendPayNodeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishBRPublishSendPayNodeMixin","WASmaxOutMessagePublishUPIPublishSendPayNodeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.bRPublishSendPayNode)return d("WASmaxOutMessagePublishBRPublishSendPayNodeMixin").mergeBRPublishSendPayNodeMixin(a,b.bRPublishSendPayNode);if(b.uPIPublishSendPayNode)return d("WASmaxOutMessagePublishUPIPublishSendPayNodeMixin").mergeUPIPublishSendPayNodeMixin(a,b.uPIPublishSendPayNode);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeBRPublishOrUPIPublishSendPayNodeMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIntegrationPublishPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBRPublishOrUPIPublishSendPayNodeMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.bRPublishOrUPIPublishSendPayNodeMixinGroupArgs;a=d("WASmaxOutMessagePublishBRPublishOrUPIPublishSendPayNodeMixinGroup").mergeBRPublishOrUPIPublishSendPayNodeMixinGroup(d("WASmaxJsx").smax("pay",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIntegrationPublishPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualNonNoviPublishSendPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBaseIndividualPublishSendPayNodeMixin","WASmaxOutMessagePublishIntegrationPublishPayNodeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishIntegrationPublishPayNodeMixin").mergeIntegrationPublishPayNodeMixin(d("WASmaxOutMessagePublishBaseIndividualPublishSendPayNodeMixin").mergeBaseIndividualPublishSendPayNodeMixin(d("WASmaxJsx").smax("pay",null),a),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualNonNoviPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualPublishSendPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualNonNoviPublishSendPayNodeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishIndividualNonNoviPublishSendPayNodeMixin").mergeIndividualNonNoviPublishSendPayNodeMixin(d("WASmaxJsx").smax("pay",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualPublishSendPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualRequestPayNodeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBasePayNodeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.paySender,c=a.payExpiryTs,e=a.payRequestId;b=d("WASmaxOutMessagePublishBasePayNodeMixin").mergeBasePayNodeMixin(d("WASmaxJsx").smax("pay",{sender:d("WASmaxAttrs").OPTIONAL(d("WAWap").USER_JID,b),"expiry-ts":d("WAWap").CUSTOM_STRING(c),"request-id":d("WAWap").CUSTOM_STRING(e)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualRequestPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishPayInviteNodeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.payService;a=d("WASmaxJsx").smax("pay",{type:"invite",service:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePayInviteNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishIndividualPublishSendPayNodeMixin","WASmaxOutMessagePublishIndividualRequestPayNodeMixin","WASmaxOutMessagePublishPayInviteNodeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualPublishSendPayNode)return d("WASmaxOutMessagePublishIndividualPublishSendPayNodeMixin").mergeIndividualPublishSendPayNodeMixin(a,b.individualPublishSendPayNode);if(b.individualRequestPayNode)return d("WASmaxOutMessagePublishIndividualRequestPayNodeMixin").mergeIndividualRequestPayNodeMixin(a,b.individualRequestPayNode);if(b.payInviteNode)return d("WASmaxOutMessagePublishPayInviteNodeMixin").mergePayInviteNodeMixin(a,b.payInviteNode);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIndividualPublishPayNodeMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.individualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroupArgs;a=d("WASmaxOutMessagePublishIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup").mergeIndividualPublishSendPayOrIndividualRequestPayOrPayInviteNodeMixinGroup(d("WASmaxJsx").smax("pay",null),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualPublishPayNodeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualPublishPayNodeMessageMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualPublishPayNodeMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishIndividualPublishPayNodeMixin").mergeIndividualPublishPayNodeMixin(d("WASmaxJsx").smax("pay",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualPublishPayNodeMessageMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypePayMixin","WASmaxOutMessagePublishIndividualIndividualPublishPayNodeMessageMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.individualIndividualPublishPayNodeMessageMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualPublishPayNodeMessageMixin").mergeIndividualIndividualPublishPayNodeMessageMixin,d("WASmaxOutMessagePublishContentTypePayMixin").mergeContentTypePayMixin(d("WASmaxJsx").smax("message",null)),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualContentTypePayIndividualMixin=a}),98);
__d("WASmaxOutMessagePublishContentFanoutMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeEventMixin","WASmaxOutMessagePublishContentTypeListFanoutMixin","WASmaxOutMessagePublishContentTypeLiveLocationFanoutMixin","WASmaxOutMessagePublishContentTypeMediaFanoutDeprecatedMixin","WASmaxOutMessagePublishContentTypeMediaFanoutMixin","WASmaxOutMessagePublishContentTypeMedianotifyMixin","WASmaxOutMessagePublishContentTypePollCreationMixin","WASmaxOutMessagePublishContentTypePollResultSnapshotMixin","WASmaxOutMessagePublishContentTypePollVoteMixin","WASmaxOutMessagePublishContentTypeReactionMixin","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.contentTypeMediaFanout)return d("WASmaxOutMessagePublishContentTypeMediaFanoutMixin").mergeContentTypeMediaFanoutMixin(a,b.contentTypeMediaFanout);if(b.contentTypeMediaFanoutDeprecated)return d("WASmaxOutMessagePublishContentTypeMediaFanoutDeprecatedMixin").mergeContentTypeMediaFanoutDeprecatedMixin(a,b.contentTypeMediaFanoutDeprecated);if(b.contentTypeLiveLocationFanout)return d("WASmaxOutMessagePublishContentTypeLiveLocationFanoutMixin").mergeContentTypeLiveLocationFanoutMixin(a,b.contentTypeLiveLocationFanout);if(b.individualContentTypePayIndividual)return d("WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin").mergeIndividualContentTypePayIndividualMixin(a,b.individualContentTypePayIndividual);if(b.contentTypeListFanout)return d("WASmaxOutMessagePublishContentTypeListFanoutMixin").mergeContentTypeListFanoutMixin(a,b.contentTypeListFanout);if(b.isContentTypeReaction)return d("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(a);if(b.contentTypePollCreation)return d("WASmaxOutMessagePublishContentTypePollCreationMixin").mergeContentTypePollCreationMixin(a,b.contentTypePollCreation);if(b.contentTypePollVote)return d("WASmaxOutMessagePublishContentTypePollVoteMixin").mergeContentTypePollVoteMixin(a,b.contentTypePollVote);if(b.isContentTypePollResultSnapshot)return d("WASmaxOutMessagePublishContentTypePollResultSnapshotMixin").mergeContentTypePollResultSnapshotMixin(a);if(b.isContentTypeMedianotify)return d("WASmaxOutMessagePublishContentTypeMedianotifyMixin").mergeContentTypeMedianotifyMixin(a);if(b.contentTypeEvent)return d("WASmaxOutMessagePublishContentTypeEventMixin").mergeContentTypeEventMixin(a,b.contentTypeEvent);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentFanoutMixins=a}),98);
__d("WASmaxOutMessagePublishLidChatOriginMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{origin:"ctwa"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeLidChatOriginMixin=a}),98);
__d("WASmaxOutMessagePublishMsgMetaOriginMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaOrigin;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{origin:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMsgMetaOriginMixin=a}),98);
__d("WASmaxOutMessagePublishTDeprecatedMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageT;a=d("WASmaxJsx").smax("message",{t:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishToContentBindingMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid;a=a.contentBindingElementValue;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").JID(b)},d("WASmaxJsx").smax("content_binding",null,a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeToContentBindingMixin=a}),98);
__d("WASmaxOutMessagePublishAvatarStickerTypeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{sticker_type:"avatar"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeAvatarStickerTypeMixin=a}),98);
__d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAvatarStickerTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encMediatype,c=a.encNativeFlowName;a=a.hasAvatarStickerType;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishAvatarStickerTypeMixin").mergeAvatarStickerTypeMixin,d("WASmaxJsx").smax("enc",{mediatype:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b),native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncMediaTypeDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion3Mixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{v:"3"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersion3Mixin=a}),98);
__d("WASmaxOutMessagePublishEncVersion",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncVersion2Mixin","WASmaxOutMessagePublishEncVersion3Mixin","WASmaxOutMessagePublishEncVersionFutureproofMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isEncVersion2)return d("WASmaxOutMessagePublishEncVersion2Mixin").mergeEncVersion2Mixin(a);if(b.isEncVersion3)return d("WASmaxOutMessagePublishEncVersion3Mixin").mergeEncVersion3Mixin(a);if(b.encVersionFutureproof)return d("WASmaxOutMessagePublishEncVersionFutureproofMixin").mergeEncVersionFutureproofMixin(a,b.encVersionFutureproof);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncVersion=a}),98);
__d("WASmaxOutMessagePublishToDeviceMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin","WASmaxOutMessagePublishEncTypeIndividualMixin","WASmaxOutMessagePublishEncVersion","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid,c=a.encTypeIndividualMixinArgs,e=a.encMediaTypeDeprecatedMixinArgs;a=a.encVersionArgs;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").JID(b)},d("WASmaxOutMessagePublishEncVersion").mergeEncVersion(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin").mergeEncMediaTypeDeprecatedMixin,d("WASmaxOutMessagePublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxJsx").smax("enc",null),c),e),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeToDeviceMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotLocalAutomatedTypeMixin","WASmaxOutMessagePublishBotMessageTypeMixin","WASmaxOutMessagePublishBotMetricsEntryPointMixin","WASmaxOutMessagePublishBotMetricsThreadEntryPointMixin","WASmaxOutMessagePublishBotPersonaTypeMixin","WASmaxOutMessagePublishBusinessBotMessageFeedbackRequestedMixin","WASmaxOutMessagePublishBusinessBotMessageMixin","WASmaxOutMessagePublishContentFanoutMixins","WASmaxOutMessagePublishLidChatOriginMixin","WASmaxOutMessagePublishMsgMetaOriginMixin","WASmaxOutMessagePublishTDeprecatedMixin","WASmaxOutMessagePublishToContentBindingMixin","WASmaxOutMessagePublishToDeviceMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toContentBindingMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishToContentBindingMixin").mergeToContentBindingMixin,d("WASmaxOutMessagePublishToDeviceMixin").mergeToDeviceMixin(d("WASmaxJsx").smax("to",null),a),b);return a}function a(){var a=d("WASmaxJsx").smax("enc",null);return a}function i(a){var b,c=a.toArgs,e=a.messageTo,f=a.tDeprecatedMixinArgs,g=a.botMessageTypeMixinArgs,i=a.businessBotMessageMixinArgs,j=a.botMetricsEntryPointMixinArgs,k=a.botMetricsThreadEntryPointMixinArgs,l=a.msgMetaOriginMixinArgs,m=a.hasLidChatOrigin,n=a.botLocalAutomatedTypeMixinArgs,o=a.businessBotMessageFeedbackRequestedMixinArgs,p=a.botPersonaTypeMixinArgs;a=a.contentFanoutMixinsArgs;b=d("WASmaxOutMessagePublishContentFanoutMixins").mergeContentFanoutMixins((b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishBotPersonaTypeMixin").mergeBotPersonaTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishBusinessBotMessageFeedbackRequestedMixin").mergeBusinessBotMessageFeedbackRequestedMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotLocalAutomatedTypeMixin").mergeBotLocalAutomatedTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishLidChatOriginMixin").mergeLidChatOriginMixin,b.optionalMerge(d("WASmaxOutMessagePublishMsgMetaOriginMixin").mergeMsgMetaOriginMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMetricsThreadEntryPointMixin").mergeBotMetricsThreadEntryPointMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMetricsEntryPointMixin").mergeBotMetricsEntryPointMixin,b.optionalMerge(d("WASmaxOutMessagePublishBusinessBotMessageMixin").mergeBusinessBotMessageMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMessageTypeMixin").mergeBotMessageTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishTDeprecatedMixin").mergeTDeprecatedMixin,d("WASmaxJsx").smax("message",{to:d("WAWap").JID(e)},d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD(h,c,1,1997))),f),g),i),j),k),l),m),n),o),p),a);return b}function b(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeIndividualIndividualFanoutParticipantsTo=h;g.makeIndividualIndividualFanoutEnc=a;g.mergeIndividualIndividualFanoutMixin=b}),98);
__d("WASmaxOutMessagePublishEncListMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("enc",{mediatype:"list"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncListMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeListMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishEncListMixin","WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.singleSelectOrProductListMixinGroupArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSingleSelectOrProductListMixinGroup").mergeSingleSelectOrProductListMixinGroup,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishEncListMixin").mergeEncListMixin(d("WASmaxJsx").smax("enc",null)))),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeListMixin=a}),98);
__d("WASmaxOutMessagePublishEncLiveLocationDeprecatedMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncLiveLocationDeprecatedMixin=a}),98);
__d("WASmaxOutMessagePublishEncLiveLocationMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encDuration;a=d("WASmaxJsx").smax("enc",{mediatype:"livelocation",duration:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncLiveLocationMixin=a}),98);
__d("WASmaxOutMessagePublishEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncLiveLocationDeprecatedMixin","WASmaxOutMessagePublishEncLiveLocationMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.encLiveLocation)return d("WASmaxOutMessagePublishEncLiveLocationMixin").mergeEncLiveLocationMixin(a,b.encLiveLocation);if(b.encLiveLocationDeprecated)return d("WASmaxOutMessagePublishEncLiveLocationDeprecatedMixin").mergeEncLiveLocationDeprecatedMixin(a,b.encLiveLocationDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup=a}),98);
__d("WASmaxOutMessagePublishContentTypeLiveLocationSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin","WASmaxOutMessagePublishEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup","WASmaxOutMessagePublishLiveLocationModeMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.liveLocationModeMixinArgs;a=a.encLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroupArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishLiveLocationModeMixin").mergeLiveLocationModeMixin,d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup").mergeEncLiveLocationEncLiveLocationOrEncLiveLocationDeprecatedMixinGroup(d("WASmaxJsx").smax("enc",null),a))),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeLiveLocationSingleMixin=a}),98);
__d("WASmaxOutMessagePublishEncMediaTypeMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAvatarStickerTypeMixin","WASmaxOutMessagePublishMediaTypeMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encNativeFlowName,c=a.hasAvatarStickerType;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishAvatarStickerTypeMixin").mergeAvatarStickerTypeMixin,d("WASmaxOutMessagePublishMediaTypeMixin").mergeMediaTypeMixin(d("WASmaxJsx").smax("enc",{native_flow_name:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,b)}),a),c);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncMediaTypeMixin=a}),98);
__d("WASmaxOutMessagePublishEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin","WASmaxOutMessagePublishEncMediaTypeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.encMediaType)return d("WASmaxOutMessagePublishEncMediaTypeMixin").mergeEncMediaTypeMixin(a,b.encMediaType);if(b.encMediaTypeDeprecated)return d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin").mergeEncMediaTypeDeprecatedMixin(a,b.encMediaTypeDeprecated);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup=a}),98);
__d("WASmaxOutMessagePublishContentTypeMediaSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup","WASmaxOutMessagePublishEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup","WASmaxOutMessagePublishSenderContentBindingMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.senderContentBindingMixinArgs,c=a.contentTypeMediaOrMedianotifyMixinGroupArgs;a=a.encMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroupArgs;a=d("WASmaxOutMessagePublishContentTypeMediaOrMedianotifyMixinGroup").mergeContentTypeMediaOrMedianotifyMixinGroup(d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishSenderContentBindingMixin").mergeSenderContentBindingMixin,d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup").mergeEncMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroup(d("WASmaxJsx").smax("enc",null),a)),b),c);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeContentTypeMediaSingleMixin=a}),98);
__d("WASmaxOutMessagePublishContentMixins",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeEventMixin","WASmaxOutMessagePublishContentTypeListMixin","WASmaxOutMessagePublishContentTypeLiveLocationSingleMixin","WASmaxOutMessagePublishContentTypeMediaSingleMixin","WASmaxOutMessagePublishContentTypePollCreationMixin","WASmaxOutMessagePublishContentTypePollResultSnapshotMixin","WASmaxOutMessagePublishContentTypePollVoteMixin","WASmaxOutMessagePublishContentTypeReactionMixin","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.contentTypeMediaSingle)return d("WASmaxOutMessagePublishContentTypeMediaSingleMixin").mergeContentTypeMediaSingleMixin(a,b.contentTypeMediaSingle);if(b.contentTypeLiveLocationSingle)return d("WASmaxOutMessagePublishContentTypeLiveLocationSingleMixin").mergeContentTypeLiveLocationSingleMixin(a,b.contentTypeLiveLocationSingle);if(b.individualContentTypePayIndividual)return d("WASmaxOutMessagePublishIndividualContentTypePayIndividualMixin").mergeIndividualContentTypePayIndividualMixin(a,b.individualContentTypePayIndividual);if(b.contentTypeList)return d("WASmaxOutMessagePublishContentTypeListMixin").mergeContentTypeListMixin(a,b.contentTypeList);if(b.isContentTypeReaction)return d("WASmaxOutMessagePublishContentTypeReactionMixin").mergeContentTypeReactionMixin(a);if(b.contentTypePollCreation)return d("WASmaxOutMessagePublishContentTypePollCreationMixin").mergeContentTypePollCreationMixin(a,b.contentTypePollCreation);if(b.contentTypePollVote)return d("WASmaxOutMessagePublishContentTypePollVoteMixin").mergeContentTypePollVoteMixin(a,b.contentTypePollVote);if(b.isContentTypePollResultSnapshot)return d("WASmaxOutMessagePublishContentTypePollResultSnapshotMixin").mergeContentTypePollResultSnapshotMixin(a);if(b.contentTypeEvent)return d("WASmaxOutMessagePublishContentTypeEventMixin").mergeContentTypeEventMixin(a,b.contentTypeEvent);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentMixins=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualRetryToPeerMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipient;a=d("WASmaxJsx").smax("message",{recipient:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualRetryToPeerMixin=a}),98);
__d("WASmaxOutMessagePublishRetryMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncRetryMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageT;a=a.encRetryMixinArgs;b=d("WASmaxJsx").smax("message",{t:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishEncRetryMixin").mergeEncRetryMixin,d("WASmaxJsx").smax("enc",null),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRetryMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualRetryMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishIndividualIndividualRetryToPeerMixin","WASmaxOutMessagePublishRetryMixin"],(function(a,b,c,d,e,f,g){function h(a){var b=a.individualIndividualRetryToPeerMixinArgs;a=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualRetryToPeerMixin").mergeIndividualIndividualRetryToPeerMixin,d("WASmaxOutMessagePublishRetryMixin").mergeRetryMixin(d("WASmaxJsx").smax("message",null),a),b);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualRetryMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualSingleContentBindingMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.contentBindingElementValue;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("content_binding",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualSingleContentBindingMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotLocalAutomatedTypeMixin","WASmaxOutMessagePublishBotMessageTypeMixin","WASmaxOutMessagePublishBotMetricsEntryPointMixin","WASmaxOutMessagePublishBotMetricsThreadEntryPointMixin","WASmaxOutMessagePublishBotPersonaTypeMixin","WASmaxOutMessagePublishBusinessBotMessageFeedbackRequestedMixin","WASmaxOutMessagePublishBusinessBotMessageMixin","WASmaxOutMessagePublishContentMixins","WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin","WASmaxOutMessagePublishEncTypeIndividualMixin","WASmaxOutMessagePublishEncVersion","WASmaxOutMessagePublishIndividualIndividualRetryMixin","WASmaxOutMessagePublishIndividualIndividualSingleContentBindingMixin","WASmaxOutMessagePublishLidChatOriginMixin","WASmaxOutMessagePublishMsgMetaOriginMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.messageTo,e=a.individualIndividualRetryMixinArgs,f=a.individualIndividualSingleContentBindingMixinArgs,g=a.botMessageTypeMixinArgs,h=a.businessBotMessageMixinArgs,i=a.botMetricsEntryPointMixinArgs,j=a.botMetricsThreadEntryPointMixinArgs,k=a.msgMetaOriginMixinArgs,l=a.hasLidChatOrigin,m=a.botLocalAutomatedTypeMixinArgs,n=a.businessBotMessageFeedbackRequestedMixinArgs,o=a.botPersonaTypeMixinArgs,p=a.contentMixinsArgs,q=a.encTypeIndividualMixinArgs,r=a.encMediaTypeDeprecatedMixinArgs;a=a.encVersionArgs;c=d("WASmaxOutMessagePublishContentMixins").mergeContentMixins((b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishBotPersonaTypeMixin").mergeBotPersonaTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishBusinessBotMessageFeedbackRequestedMixin").mergeBusinessBotMessageFeedbackRequestedMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotLocalAutomatedTypeMixin").mergeBotLocalAutomatedTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishLidChatOriginMixin").mergeLidChatOriginMixin,b.optionalMerge(d("WASmaxOutMessagePublishMsgMetaOriginMixin").mergeMsgMetaOriginMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMetricsThreadEntryPointMixin").mergeBotMetricsThreadEntryPointMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMetricsEntryPointMixin").mergeBotMetricsEntryPointMixin,b.optionalMerge(d("WASmaxOutMessagePublishBusinessBotMessageMixin").mergeBusinessBotMessageMixin,b.optionalMerge(d("WASmaxOutMessagePublishBotMessageTypeMixin").mergeBotMessageTypeMixin,b.optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualSingleContentBindingMixin").mergeIndividualIndividualSingleContentBindingMixin,b.optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualRetryMixin").mergeIndividualIndividualRetryMixin,d("WASmaxJsx").smax("message",{to:d("WAWap").JID(c)},d("WASmaxOutMessagePublishEncVersion").mergeEncVersion(b.optionalMerge(d("WASmaxOutMessagePublishEncMediaTypeDeprecatedMixin").mergeEncMediaTypeDeprecatedMixin,d("WASmaxOutMessagePublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxJsx").smax("enc",null),q),r),a)),e),f),g),h),i),j),k),l),m),n),o),p);return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualIndividualSingleMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualIndividualSingleOrIndividualIndividualFanoutOrBotMetricsEntryPointMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishBotMetricsEntryPointMixin","WASmaxOutMessagePublishIndividualIndividualFanoutMixin","WASmaxOutMessagePublishIndividualIndividualSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualIndividualSingle)return d("WASmaxOutMessagePublishIndividualIndividualSingleMixin").mergeIndividualIndividualSingleMixin(a,b.individualIndividualSingle);if(b.individualIndividualFanout)return d("WASmaxOutMessagePublishIndividualIndividualFanoutMixin").mergeIndividualIndividualFanoutMixin(a,b.individualIndividualFanout);if(b.botMetricsEntryPoint)return d("WASmaxOutMessagePublishBotMetricsEntryPointMixin").mergeBotMetricsEntryPointMixin(a,b.botMetricsEntryPoint);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualIndividualSingleOrIndividualIndividualFanoutOrBotMetricsEntryPointMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIndividualBotRequestMessageMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotFeedbackMessageTypeMixin","WASmaxOutMessagePublishBotRequestMixin","WASmaxOutMessagePublishContentTypeTextOrMediaMixinGroup","WASmaxOutMessagePublishIndividualIndividualSingleOrIndividualIndividualFanoutOrBotMetricsEntryPointMixinGroup","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.messageTo,c=a.contentTypeTextOrMediaMixinGroupArgs,e=a.individualIndividualSingleOrIndividualIndividualFanoutOrBotMetricsEntryPointMixinGroupArgs,f=a.hasBotFeedbackMessageType;a=a.botRequestMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishIndividualIndividualSingleOrIndividualIndividualFanoutOrBotMetricsEntryPointMixinGroup").mergeIndividualIndividualSingleOrIndividualIndividualFanoutOrBotMetricsEntryPointMixinGroup,d("WASmaxOutMessagePublishContentTypeTextOrMediaMixinGroup").mergeContentTypeTextOrMediaMixinGroup(d("WASmaxJsx").smax("message",{to:d("WAWap").USER_JID(b)},d("WASmaxMixins").optionalMerge(d("WASmaxOutMessagePublishBotFeedbackMessageTypeMixin").mergeBotFeedbackMessageTypeMixin,d("WASmaxJsx").smax("bot",null,d("WASmaxOutMessagePublishBotRequestMixin").mergeBotRequestMixin(d("WASmaxJsx").smax("to",null),a)),f)),c),e);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualBotRequestMessageMixin=a}),98);
__d("WASmaxOutMessagePublishBotResponseMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.botEditTargetId,e=a.botSenderTimestampMs,f=a.botEdit;a=a.hasBotTypeVoice;c=d("WASmaxJsx").smax("bot",{edit_target_id:(b=d("WASmaxAttrs")).OPTIONAL(d("WAWap").STANZA_ID,c),sender_timestamp_ms:b.OPTIONAL(d("WAWap").INT,e),edit:b.OPTIONAL(d("WAWap").CUSTOM_STRING,f),type:b.OPTIONAL_LITERAL("voice",a)});return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBotResponseMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualContentTypeBotResponseMediaFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishContentTypeMediaMixin"],(function(a,b,c,d,e,f,g){function h(a){a=a.toCount;a=d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD_COUNT(i,a,2,2));return a}function i(){var a=d("WASmaxJsx").smax("to",null,d("WASmaxJsx").smax("enc",{mediatype:"image"}));return a}function j(a){a=a.participantsArgs;a=d("WASmaxOutMessagePublishContentTypeMediaMixin").mergeContentTypeMediaMixin(d("WASmaxJsx").smax("message",null,d("WASmaxChildren").OPTIONAL_CHILD(h,a)));return a}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeIndividualContentTypeBotResponseMediaFanoutParticipants=h;g.makeIndividualContentTypeBotResponseMediaFanoutParticipantsTo=i;g.mergeIndividualContentTypeBotResponseMediaFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishContentTypeTextMixin","WASmaxOutMessagePublishIndividualContentTypeBotResponseMediaFanoutMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isContentTypeText)return d("WASmaxOutMessagePublishContentTypeTextMixin").mergeContentTypeTextMixin(a);if(b.individualContentTypeBotResponseMediaFanout)return d("WASmaxOutMessagePublishIndividualContentTypeBotResponseMediaFanoutMixin").mergeIndividualContentTypeBotResponseMediaFanoutMixin(a,b.individualContentTypeBotResponseMediaFanout);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup=a}),98);
__d("WASmaxOutMessagePublishEncTypeMessageSecretMessageMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishEncPayloadMixin"],(function(a,b,c,d,e,f,g){function h(a){a=d("WASmaxOutMessagePublishEncPayloadMixin").mergeEncPayloadMixin(d("WASmaxJsx").smax("enc",{type:"msmsg"}),a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncTypeMessageSecretMessageMixin=a}),98);
__d("WASmaxOutMessagePublishMessageTargetMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.metaTargetId,e=a.metaTargetSenderJid,f=a.metaTargetChatJid;a=a.metaTargetChatJidLid;c=d("WASmaxJsx").smax("meta",{target_id:(b=d("WAWap")).STANZA_ID(c),target_sender_jid:d("WASmaxAttrs").OPTIONAL(b.USER_JID,e),target_chat_jid:d("WASmaxAttrs").OPTIONAL(b.JID,f),target_chat_jid_lid:d("WASmaxAttrs").OPTIONAL(b.JID,a)});return c}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageTargetMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualBotResponseFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishBotResponseMixin","WASmaxOutMessagePublishContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup","WASmaxOutMessagePublishEncTypeMessageSecretMessageMixin","WASmaxOutMessagePublishEncVersionBot","WASmaxOutMessagePublishMessageTargetMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.toArgs;a=d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD(i,a,2,2));return a}function i(a){a=a.toJid;a=d("WASmaxJsx").smax("to",{jid:d("WAWap").USER_JID(a)});return a}function j(a){var b,c=a.participantsArgs,e=a.messageTo,f=a.contentTypeTextOrIndividualBotResponseMediaFanoutMixinGroupArgs,g=a.botResponseMixinArgs,i=a.messageTargetMixinArgs,j=a.encTypeMessageSecretMessageMixinArgs;a=a.encVersionBotArgs;e=d("WASmaxOutMessagePublishContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup").mergeContentTypeTextOrIndividualBotResponseMediaFanoutMixinGroup((b=d("WASmaxJsx")).smax("message",{to:d("WAWap").USER_JID(e)},d("WASmaxOutMessagePublishBotResponseMixin").mergeBotResponseMixin(b.smax("bot",null),g),d("WASmaxOutMessagePublishMessageTargetMixin").mergeMessageTargetMixin(b.smax("meta",null),i),d("WASmaxOutMessagePublishEncVersionBot").mergeEncVersionBot(d("WASmaxOutMessagePublishEncTypeMessageSecretMessageMixin").mergeEncTypeMessageSecretMessageMixin(b.smax("enc",null),j),a),d("WASmaxChildren").OPTIONAL_CHILD(h,c)),f);return e}function a(a,b){b=j(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeIndividualBotResponseFanoutParticipants=h;g.makeIndividualBotResponseFanoutParticipantsTo=i;g.mergeIndividualBotResponseFanoutMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishIndividualBotRequestMessageMixin","WASmaxOutMessagePublishIndividualBotResponseFanoutMixin","WASmaxOutMessagePublishIndividualIndividualFanoutMixin","WASmaxOutMessagePublishIndividualIndividualSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.individualBotResponseFanout)return d("WASmaxOutMessagePublishIndividualBotResponseFanoutMixin").mergeIndividualBotResponseFanoutMixin(a,b.individualBotResponseFanout);if(b.individualBotRequestMessage)return d("WASmaxOutMessagePublishIndividualBotRequestMessageMixin").mergeIndividualBotRequestMessageMixin(a,b.individualBotRequestMessage);if(b.individualIndividualSingle)return d("WASmaxOutMessagePublishIndividualIndividualSingleMixin").mergeIndividualIndividualSingleMixin(a,b.individualIndividualSingle);if(b.individualIndividualFanout)return d("WASmaxOutMessagePublishIndividualIndividualFanoutMixin").mergeIndividualIndividualFanoutMixin(a,b.individualIndividualFanout);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup=a}),98);
__d("WASmaxOutMessagePublishIndividualRecipientDeprecaredMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipient;a=d("WASmaxJsx").smax("message",{recipient:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeIndividualRecipientDeprecaredMixin=a}),98);
__d("WASmaxOutMessagePublishMessageEditMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"1"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessageEditMixin=a}),98);
__d("WASmaxOutMessagePublishMessagePinMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"2"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMessagePinMixin=a}),98);
__d("WASmaxOutMessagePublishRevokeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",{edit:"7"});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRevokeMixin=a}),98);
__d("WASmaxOutMessagePublishMessageEditOrMessagePinOrRevokeMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishMessageEditMixin","WASmaxOutMessagePublishMessagePinMixin","WASmaxOutMessagePublishRevokeMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.isMessageEdit)return d("WASmaxOutMessagePublishMessageEditMixin").mergeMessageEditMixin(a);if(b.isMessagePin)return d("WASmaxOutMessagePublishMessagePinMixin").mergeMessagePinMixin(a);if(b.isRevoke)return d("WASmaxOutMessagePublishRevokeMixin").mergeRevokeMixin(a);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeMessageEditOrMessagePinOrRevokeMixinGroup=a}),98);
__d("WASmaxOutMessagePublishMetaDestinationIdMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaDestinationId;a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{destination_id:d("WAWap").CUSTOM_STRING(a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeMetaDestinationIdMixin=a}),98);
__d("WASmaxOutMessagePublishPeerRecipientUsernameMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPeerRecipientUsername;a=d("WASmaxJsx").smax("smax$any",{peer_recipient_username:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerRecipientUsernameMixin=a}),98);
__d("WASmaxOutMessagePublishPeerRecipientLIDMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPeerRecipientLid;a=d("WASmaxJsx").smax("smax$any",{peer_recipient_lid:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerRecipientLIDMixin=a}),98);
__d("WASmaxOutMessagePublishPeerRecipientPNMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyPeerRecipientPn;a=d("WASmaxJsx").smax("smax$any",{peer_recipient_pn:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerRecipientPNMixin=a}),98);
__d("WASmaxOutMessagePublishRecipientPNMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.messageRecipientPn;a=d("WASmaxJsx").smax("message",{recipient_pn:d("WAWap").JID(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRecipientPNMixin=a}),98);
__d("WASmaxOutMessagePublishRecipientPNOrPeerRecipientPNOrPeerRecipientLIDMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishPeerRecipientLIDMixin","WASmaxOutMessagePublishPeerRecipientPNMixin","WASmaxOutMessagePublishRecipientPNMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.recipientPN)return d("WASmaxOutMessagePublishRecipientPNMixin").mergeRecipientPNMixin(a,b.recipientPN);if(b.peerRecipientPN)return d("WASmaxOutMessagePublishPeerRecipientPNMixin").mergePeerRecipientPNMixin(a,b.peerRecipientPN);if(b.peerRecipientLID)return d("WASmaxOutMessagePublishPeerRecipientLIDMixin").mergePeerRecipientLIDMixin(a,b.peerRecipientLID);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeRecipientPNOrPeerRecipientPNOrPeerRecipientLIDMixinGroup=a}),98);
__d("WASmaxOutMessagePublishStatusMentionMessageMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{is_status_mention:"true"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeStatusMentionMessageMixin=a}),98);
__d("WASmaxOutMessagePublishPrivacyTokenContentsMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.anyElementValue;a=d("WASmaxJsx").smax("smax$any",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePrivacyTokenContentsMixin=a}),98);
__d("WASmaxOutMessagePublishTCTokenMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishPrivacyTokenContentsMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.tctokenT;a=a.privacyTokenContentsMixinArgs;b=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutMessagePublishPrivacyTokenContentsMixin").mergePrivacyTokenContentsMixin(d("WASmaxJsx").smax("tctoken",{t:d("WASmaxAttrs").OPTIONAL(d("WAWap").INT,b)}),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTCTokenMixin=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagEnumMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaThreadType;a=d("WASmaxJsx").smax("meta",{thread_type:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeThreadTypeTagEnumMixin=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagLegacyMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.metaThreadType;a=d("WASmaxJsx").smax("meta",{thread_type:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeThreadTypeTagLegacyMixin=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagEnumOrLegacyMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutMessagePublishThreadTypeTagEnumMixin","WASmaxOutMessagePublishThreadTypeTagLegacyMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.threadTypeTagEnum)return d("WASmaxOutMessagePublishThreadTypeTagEnumMixin").mergeThreadTypeTagEnumMixin(a,b.threadTypeTagEnum);if(b.threadTypeTagLegacy)return d("WASmaxOutMessagePublishThreadTypeTagLegacyMixin").mergeThreadTypeTagLegacyMixin(a,b.threadTypeTagLegacy);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeThreadTypeTagEnumOrLegacyMixinGroup=a}),98);
__d("WASmaxOutMessagePublishThreadTypeTagMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishThreadTypeTagEnumOrLegacyMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.threadTypeTagEnumOrLegacyMixinGroupArgs;a=d("WASmaxJsx").smax("message",null,d("WASmaxOutMessagePublishThreadTypeTagEnumOrLegacyMixinGroup").mergeThreadTypeTagEnumOrLegacyMixinGroup(d("WASmaxJsx").smax("meta",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeThreadTypeTagMixin=a}),98);
__d("WASmaxOutMessagePublishViewOnceMetaAttributeMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("message",null,d("WASmaxJsx").smax("meta",{view_once:"true"}));return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeViewOnceMetaAttributeMixin=a}),98);
__d("WASmaxOutMessagePublishIndividualRequest",["WASmaxJsx","WASmaxMixins","WASmaxOutMessagePublishAppdataMetaAttributeMixin","WASmaxOutMessagePublishBaseMixin","WASmaxOutMessagePublishGroupInviteTargetMixin","WASmaxOutMessagePublishIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup","WASmaxOutMessagePublishIndividualRecipientDeprecaredMixin","WASmaxOutMessagePublishMessageEditOrMessagePinOrRevokeMixinGroup","WASmaxOutMessagePublishMetaDestinationIdMixin","WASmaxOutMessagePublishPeerRecipientUsernameMixin","WASmaxOutMessagePublishRecipientPNOrPeerRecipientPNOrPeerRecipientLIDMixinGroup","WASmaxOutMessagePublishStatusMentionMessageMixin","WASmaxOutMessagePublishTCTokenMixin","WASmaxOutMessagePublishThreadTypeTagMixin","WASmaxOutMessagePublishViewOnceMetaAttributeMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b,c=a.messageId,e=a.groupInviteTargetMixinArgs,f=a.threadTypeTagMixinArgs,g=a.peerRecipientUsernameMixinArgs,h=a.individualRecipientDeprecaredMixinArgs,i=a.appdataMetaAttributeMixinArgs,j=a.hasStatusMentionMessage,k=a.tCTokenMixinArgs,l=a.hasViewOnceMetaAttribute,m=a.metaDestinationIdMixinArgs,n=a.individualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroupArgs,o=a.messageEditOrMessagePinOrRevokeMixinGroupArgs,p=a.recipientPNOrPeerRecipientPNOrPeerRecipientLIDMixinGroupArgs;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutMessagePublishRecipientPNOrPeerRecipientPNOrPeerRecipientLIDMixinGroup").mergeRecipientPNOrPeerRecipientPNOrPeerRecipientLIDMixinGroup,b.optionalMerge(d("WASmaxOutMessagePublishMessageEditOrMessagePinOrRevokeMixinGroup").mergeMessageEditOrMessagePinOrRevokeMixinGroup,d("WASmaxOutMessagePublishIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup").mergeIndividualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroup(b.optionalMerge(d("WASmaxOutMessagePublishMetaDestinationIdMixin").mergeMetaDestinationIdMixin,b.optionalMerge(d("WASmaxOutMessagePublishViewOnceMetaAttributeMixin").mergeViewOnceMetaAttributeMixin,b.optionalMerge(d("WASmaxOutMessagePublishTCTokenMixin").mergeTCTokenMixin,b.optionalMerge(d("WASmaxOutMessagePublishStatusMentionMessageMixin").mergeStatusMentionMessageMixin,b.optionalMerge(d("WASmaxOutMessagePublishAppdataMetaAttributeMixin").mergeAppdataMetaAttributeMixin,b.optionalMerge(d("WASmaxOutMessagePublishIndividualRecipientDeprecaredMixin").mergeIndividualRecipientDeprecaredMixin,b.optionalMerge(d("WASmaxOutMessagePublishPeerRecipientUsernameMixin").mergePeerRecipientUsernameMixin,b.optionalMerge(d("WASmaxOutMessagePublishThreadTypeTagMixin").mergeThreadTypeTagMixin,b.optionalMerge(d("WASmaxOutMessagePublishGroupInviteTargetMixin").mergeGroupInviteTargetMixin,d("WASmaxOutMessagePublishBaseMixin").mergeBaseMixin(d("WASmaxJsx").smax("message",{id:d("WAWap").STANZA_ID(c)}),a),e),f),g),h),i),j),k),l),m),n),o),p);return b}g.makeIndividualRequest=a}),98);
__d("WASmaxMessagePublishIndividualRPC",["WAComms","WASmaxInMessagePublishIndividualResponseNegative","WASmaxInMessagePublishIndividualResponseSuccess","WASmaxOutMessagePublishIndividualRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a,b){a=d("WASmaxOutMessagePublishIndividualRequest").makeIndividualRequest(a);b=await d("WAComms").sendSmaxStanza(a,b);var c=d("WASmaxInMessagePublishIndividualResponseNegative").parseIndividualResponseNegative(b,a);if(c.success)return{name:"IndividualResponseNegative",value:c.value};b=d("WASmaxInMessagePublishIndividualResponseSuccess").parseIndividualResponseSuccess(b,a);if(b.success)return{name:"IndividualResponseSuccess",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Individual",{Negative:c,Success:b}))}g.sendIndividualRPC=a}),98);
__d("WASendMsgRPC",["WADeprecatedSendIq","WADeprecatedWapParser","WAFrankingTypes","WAGetDeviceIdentityMixin","WAJids","WALogger","WAParseFranking","WASmaxMessagePublishIndividualRPC","WATimeUtils","WAWap"],(function(a,b,c,d,e,f,g){"use strict";var h,i;async function a(a,b,c,e,f){f===void 0&&(f=!1);var g=d("WAJids").interpretAsGroupJid(a.protocolMsgId.chat),h=a.messageType.type==="text"&&a.messageType.invitedParticipantUserJid!=null;if(b.type==="direct_user"){var i={individualIndividualSingle:{messageTo:b.message.to,individualIndividualRetryMixinArgs:m(a.count,b.recipient),contentMixinsArgs:l(a,b.message),encTypeIndividualMixinArgs:n(b.message),encVersionArgs:o(b.message)}};i={messageId:a.externalId,deviceIdentityMixinArgs:d("WAGetDeviceIdentityMixin").getDeviceIdentityMixin(a.deviceIdentity),hasNoExtraFanout:a.messageType.isInvisible===!0?!0:null,messageEditOrMessagePinOrRevokeMixinGroupArgs:p(a.messageType),clientFrankingTagMixinArgs:c!=null&&c.frankingTag?{frankingTagElementValue:c.frankingTag}:null,hasMetaHideDecryptionPlaceholder:a.messageType.isInvisible===!0?!0:null,groupInviteTargetMixinArgs:h&&g!=null?{metaGroupInvite:g}:null,individualBotResponseFanoutOrIndividualBotRequestMessageOrIndividualIndividualSingleOrIndividualIndividualFanoutMixinGroupArgs:i,internalTestMixinArgs:f?{testConfig:"armadillo_express"}:null};e==null||e.addPoint("send_individual_rpc");i=await d("WASmaxMessagePublishIndividualRPC").sendIndividualRPC(i);if(i.name==="IndividualResponseSuccess"){var r;r=((r=i.value.deviceListStaleMixin)==null?void 0:r.phash)!=null?{type:"mismatch",local:null,server:i.value.deviceListStaleMixin.phash}:{type:"ok"};var s=i.value.serverFrankingTagMixin!=null&&c!=null?babelHelpers.extends({},c,{reportingTag:d("WAFrankingTypes").castToReportingTag(i.value.serverFrankingTagMixin.frankingReportingTagElementValue)}):null;return{type:"success",ts:d("WATimeUtils").castToUnixTime(i.value.t),phash:r,count:null,reportingMeta:s}}else{i.name;return{type:"error",errorCode:parseInt(i.value.error,10),backoff:parseInt((r=i.value.messageNackRetryAttributesMixin)==null?void 0:r.backoff,10),applicationError:(s=i.value.applicationNegativeAckMixin)==null?void 0:s.applicationError}}}r=a.messageType.isInvisible===!0?"false":d("WAWap").DROP_ATTR;i=b.participant!=null?d("WAWap").JID(b.participant):d("WAWap").DROP_ATTR;s=b.phash!=null&&b.type==="group"?d("WAWap").CUSTOM_STRING(b.phash):d("WAWap").DROP_ATTR;function t(){if(a.messageType.type==="text"&&a.messageType.isRevoked)return d("WAWap").CUSTOM_STRING("7");else if(a.messageType.type==="text"&&a.messageType.isEdit===!0)return d("WAWap").CUSTOM_STRING("1");return d("WAWap").DROP_ATTR}t=t();function u(){if(h&&g!=null)return d("WAWap").wap("meta",{"decrypt-fail":"hide",group_invite:d("WAWap").CUSTOM_STRING(g)});return a.messageType.isInvisible===!0||a.messageType.isEdit===!0?d("WAWap").wap("meta",{"decrypt-fail":"hide"}):null}u=u();f=f?d("WAWap").wap("test",{config:d("WAWap").CUSTOM_STRING("armadillo_express")}):null;var v=a.deviceIdentity!=null?d("WAWap").wap("device-identity",null,a.deviceIdentity):null,w=(c==null?void 0:c.frankingTag)!=null?d("WAWap").wap("franking",null,d("WAWap").wap("franking_tag",null,c.frankingTag)):null,x=null;b.participants!=null&&(x=d("WAWap").wap("participants",null,b.participants.map(function(a){return j(a)})));var y=null;b.message!=null&&(y=j(b.message,!0));r=d("WAWap").wap("message",{device_fanout:r,edit:t,id:d("WAWap").CUSTOM_STRING(a.externalId),participant:i,phash:s,to:d("WAWap").JID(b.messageTo),type:d("WAWap").CUSTOM_STRING(a.messageType.type)},u,w,x,y,v,f);q(a.externalId);e==null||e.addPoint("send_stanza_and_return_ack");t=await d("WADeprecatedSendIq").deprecatedSendStanzaAndReturnAck(r,{id:a.externalId,class:"message",from:b.messageTo,participant:b.participant!=null?b.participant:null});e==null||e.addPoint("send_msg_ack_parser");i=k.parse(t);if(i.success){e==null||e.addPoint("send_msg_ack_parser_success");s=i.success;u=s.errorCode;w=s.applicationError;x=s.backoff;if(u==null){y=i.success;v=y.ts;f=y.phash;r=y.count;s=c!=null?babelHelpers.extends({},c,{reportingTag:(t=i.success.reportingMeta)==null?void 0:t.reportingTag}):null;return{type:"success",ts:v,phash:f==null||f===b.phash?{type:"ok"}:{type:"mismatch",local:b.phash,server:f},count:r,reportingMeta:s}}else{e==null||e.addPoint("send_msg_ack_parser_failed",{int:{errorCode:u,applicationError:w}});return{type:"error",errorCode:u,applicationError:w,backoff:x}}}else return{type:"parsing_error"}}function j(a,b){b===void 0&&(b=!1);var c=d("WAWap").wap("enc",{count:a.count!=null?d("WAWap").INT(a.count):d("WAWap").DROP_ATTR,mediatype:a.mediaType!=null?d("WAWap").CUSTOM_STRING(a.mediaType):d("WAWap").DROP_ATTR,type:d("WAWap").CUSTOM_STRING(a.type),v:d("WAWap").CUSTOM_STRING(a.v)},a.ciphertext);if(b||a.encType==="group")return c;else return d("WAWap").wap("to",{jid:d("WAWap").DEVICE_JID(a.to)},c)}var k=new(c("WADeprecatedWapParser"))("sendMsgAck",function(a){a.assertTag("ack");return{count:a.maybeAttrInt("count"),errorCode:a.maybeAttrInt("error"),phash:a.maybeAttrString("phash"),applicationError:a.maybeAttrInt("application_error"),ts:a.attrTime("t"),reportingMeta:d("WAParseFranking").parseFrankingNode(a.maybeChild("franking")),backoff:a.maybeAttrInt("backoff")}});function l(a,b){if(a.messageType.type==="reaction")return{isContentTypeReaction:!0};if(a.messageType.type==="text")return{isContentTypeText:!0};a.messageType.type;if(b.mediaType!=null){b={contentTypeMediaOrMedianotifyMixinGroupArgs:{isContentTypeMedia:!0},encMediaTypeEncMediaTypeOrEncMediaTypeDeprecatedMixinGroupArgs:{encMediaType:{encMediatype:b.mediaType}}};return{contentTypeMediaSingle:b}}d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WASendMsgRPC: Wrong media type: ",""])),a.messageType.mediaType);return{isContentTypeText:!0}}function m(a,b){a=a!=null?{encCount:a}:null;b=b!=null?{messageRecipient:b}:null;return{encRetryMixinArgs:a,individualIndividualRetryToPeerMixinArgs:b}}function n(a){return{encType:a.type,encElementValue:a.ciphertext}}function o(a){return a.v==="2"?{isEncVersion2:!0}:{isEncVersion3:!0}}function p(a){return a.type==="text"&&a.isRevoked?{isRevoke:!0}:null}function q(a){try{BigInt(a)}catch(b){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[WASendMsgRPC] Sending message with not allowed stanzaId: ",", error: ",""])),a,b)}}g.sendStanza=a;g.createEncWapNode=j}),98);
__d("WASendMsgInternal",["FBLogger","WABridge","WADevicesState","WAEncGroupMsg","WAEncUserMsg","WAGlobals","WAJids","WALogger","WAMarkSenderKeyAsSentApi","WAOdsEnums","WAQueryGroups","WAResultOrError","WASendMsgRPC"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n=10002,o=10009;async function a(a,b){var e;b.addPoint("encrypt_start",{string:{sentMessageType:a.messageType.isRevoked===!0?"revoke":a.messageType.type},bool:{isInvisibleMsg:a.messageType.type==="text"&&a.messageType.isInvisible===!0}});var f=await d("WAGlobals").getWaOneQueue().enqueue(function(c){c=c.cryptoManager;return a.type==="chat"?s(a,b,2,{cryptoManager:c}):r(a,{cryptoManager:c},2)},{operationType:"encrypt",flush:!0});b.addPoint("finish_encrypt",{string:{chatType:f.success?f.value.type:f.error}});if(f.success===!1)throw c("FBLogger")("wmi").mustfixThrow("Encryption failed %s",f.error);f=f.value;b.addPoint("sending_stanza_start",{string:{encryptionType:f.type},int:{ciphertextByteLength:(e=(e=(e=f.message)==null||(e=e.ciphertext)==null?void 0:e.length)!=null?e:(e=f.participants)==null||(e=e[0].ciphertext)==null?void 0:e.length)!=null?e:0}});e=await d("WASendMsgRPC").sendStanza(a,f,a.reportingMeta,b);b.addPoint("sending_stanza_end",{bool:{wai:e.type==="success"}});return{serverResponse:e,encryption:f}}async function b(a,b,c){var e;c===void 0&&(c=!1);v(a,b);var f=c?3:2,g=function(c){return a.type==="chat"?s(a,b,f,{cryptoManager:c}):r(a,{cryptoManager:c},f)},i=await d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return g(a)},{operationType:"encrypt",flush:!0}),j=i.success?i.value.type:i.error;b.addPoint("finish_encrypt",{string:{chatType:j}});if(i.success===!1){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MAWSendMsg Failed to encrypt message for "," message"])),j);return d("WAResultOrError").makeError({type:"encryption-error",isRetriable:!1})}i=i.value;b.addPoint("sending_stanza_start",{string:{encryptionType:i.type},int:{ciphertextByteLength:(e=(e=(e=i.message)==null||(e=e.ciphertext)==null?void 0:e.length)!=null?e:(e=i.participants)==null||(e=e[0].ciphertext)==null?void 0:e.length)!=null?e:0}});e=await d("WASendMsgRPC").sendStanza(a,i,a.reportingMeta,b,c);b.addPoint("sending_stanza_end");if(e.type==="success"){b.addPoint("send_stanza_success");try{c=await Promise.all([t(a,i,e,b),u(i)]);c=c[0];b.addPoint("mark_sender_key_sent");return d("WAResultOrError").makeResult({baseKey:(i=i.message)==null?void 0:i.baseKey,reportingMeta:e.reportingMeta,serverTs:e.ts,meta:{pOrDhashMismatch:c}})}catch(a){b.addPoint("send_stanza_failed");throw a}}e.type;w(e,j,b);e.applicationError===n&&await d("WAGlobals").getDependencies().handleReachabilityErrorAdminMsg(a.chat);if(e.type==="parsing_error")return d("WAResultOrError").makeError({type:"result-parsing-error",isRetriable:!0});if(e.type==="error"){i=e.errorCode!=null&&e.errorCode>=500;if(i)return d("WAResultOrError").makeError({type:"retryable-error",backoff:e.backoff,isRetriable:!0});else return d("WAResultOrError").makeError({type:"non-retryable-error",applicationErrorCode:e.applicationError,errorCode:e.errorCode,isRetriable:!1})}return d("WAResultOrError").makeError({type:"unexpected-message-codepath",details:"impossible-server-error-result",isRetriable:!0,applicationErrorCode:e.applicationError})}function p(a){d("WADevicesState").getDevicesState().reset([a]);return d("WADevicesState").getDevicesState().waitForUserDevices([a],"SendMsgUtil_recoverUser",!0)}function q(a){return d("WAJids").switchOnChatJidType(a,{interopUser:p,msgrUser:p,lidUser:p,phoneUser:p,group:function(a){return d("WAQueryGroups").queryGroups(null,{type:"array",groups:[a]},!0)}})}async function r(a,b,c){var e=a.chat,f=a.to,g=a.messageBytes,h=a.messageType,i=a.count,j=a.sessionInfo,k=a.identityKey,l=a.backupDirective,m=await d("WAEncUserMsg").encryptDeviceJidMessage(f,{type:"message",chat:e,messageBytes:g,messageType:h,applicationPayloadVersion:c,backupDirective:l},b,i,j,k);return d("WAJids").switchOnUserChatJidType(e,{user:function(b){return m!=null?d("WAResultOrError").makeResult({type:"direct_user",messageTo:a.to,message:m,recipient:d("WAGlobals").isPeerDevice(a.to)?b:null}):d("WAResultOrError").makeError("direct_user")},group:function(b){return m!=null?d("WAResultOrError").makeResult({type:"direct_group",messageTo:b,participant:a.to,message:m}):d("WAResultOrError").makeError("direct_group")}})}function s(a,b,c,e){var f=a.recipients,g=a.messageBytes,h=a.messageType,k=a.chat,l=a.backupDirective;return d("WAJids").switchOnUserChatJidType(k,{user:async function(a){var i=await d("WAEncUserMsg").encryptUserMsg(f,{type:"message",messageBytes:g,messageType:h,chat:a,applicationPayloadVersion:c,backupDirective:l},e,b),j=i.participants;return j!=null&&j.length>0?d("WAResultOrError").makeResult({type:"user",messageTo:a,participants:j,phash:i.phash}):d("WAResultOrError").makeError("user")},group:async function(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptChatMessage -- group message"])));var c=await d("WAEncGroupMsg").encryptGroupMsg(a,f,g,h,e,l,b);d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["sendWrittenMsg -- encryptChatMessage -- finish encrypt group message"])));var k=c.participants,m=c.encNode;return k==null&&m==null?d("WAResultOrError").makeError("group"):d("WAResultOrError").makeResult({type:"group",messageTo:a,participants:k,message:m,senderKeyDistributionInfo:c.senderKeyDistributionInfo,phash:c.phash})}})}async function t(a,b,c,e){if(c.type!=="success")return!1;c=c.phash;if(c.type==="mismatch"){e.addPoint("phash_mismatch");d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Got phash mismatch, local[","] server[","]"])),c.local,c.server);d("WABridge").getBridge().fireAndForget("event","odsBumpEntityKey",{entity:d("WAOdsEnums").Entity.PHASH_MISMATCH,key:b.type});await q(a.chat);e.addPoint("participant_recovery_finished");return!0}return!1}async function u(a){if(a.senderKeyDistributionInfo!=null){a=a.senderKeyDistributionInfo;var b=a.group,c=a.senderKeyId;a=a.knowsSenderKey;await d("WAMarkSenderKeyAsSentApi").markSenderKeyAsSent(b,c,a)}}function v(a,b){var c=0;a.type==="chat"&&(c=a.recipients.reduce(function(a,b){return a+b.devicesInfo.length},0));var d=a.messageType.type==="text"&&a.messageType.isRevoked;d=d?"revoke":a.messageType.type;b.addPoint("start_encrypt",{string:{sentMessageType:d},int:{numDevices:c},bool:{isInvisibleMsg:a.messageType.type==="text"&&a.messageType.isInvisible===!0}})}function w(a,b,c){if(a.type==="success")return;a.type==="parsing_error"&&(d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["sendMessage ack success is false, chatType:",""])),b),c.addPoint("ack_parse_fail"));var e=a.errorCode;a=a.applicationError;a===n&&c.addPoint("reachability_error_code");d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["sendMessage ack success is true, error: ",", applicationError: ",", chatType:",""])),e,a,b);e!=null&&c.addPoint("ack_success_error_"+e,{int:{applicationError:a}});a===o&&c.addPoint("sender_blocked",{})}g.sendMessageV2=a;g.sendMessage=b}),98);
__d("WASentBytesCacheApi",["MAWTransactionMode","WADbTransactor"],(function(a,b,c,d,e,f,g){"use strict";c=(a=d("WADbTransactor")).makeSignalTransactor({sentBytesCache:(b=d("MAWTransactionMode")).READWRITE},"deleteSentBytes",function(a){return function(b){return a.sentBytesCache.bulkDelete(b)}});e=a.makeSignalTransactor({sentBytesCache:b.READONLY},"loadExpired",function(a){return function(b){return a.sentBytesCache.where("ts").belowOrEqual(b).toArray().then(function(a){return a.map(function(a){return a.waMsgId})})}});f=a.makeSignalTransactor({sentBytesCache:b.READONLY},"loadSentBytes",function(a){return function(b){return a.sentBytesCache.bulkGet(b).then(function(a){return a.filter(Boolean)})}});d=a.makeSignalTransactor({sentBytesCache:b.READWRITE},"saveSentBytes",function(a){return function(b){return a.sentBytesCache.put(b).then(function(){})}});g.deleteSentBytes=c;g.loadExpired=e;g.loadSentBytes=f;g.saveSentBytes=d}),98);
__d("WASentBytesCache",["WAGlobals","WAJids","WAMsg","WASentBytesCacheApi","WATagsLogger","WATimeUtils","WAWaitForUserUnblocked"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WATagsLogger").TAGS(["SentBytesCache"]),k=30*24*60*60;b=function(){function a(){var a=this;void d("WAWaitForUserUnblocked").waitForUserUnblocked().then(function(){a.$1().catch(function(a){j.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to prune sent bytes: ",""])),a)})})}var b=a.prototype;b.loadSentBytes=function(a){return d("WASentBytesCacheApi").loadSentBytes(a)};b.getMsgsForRetry=async function(a){var b=Array.from(new Set(a.map(function(a){a=a.deviceJid;return d("WAJids").extractUserJid(a)}))),c=new Map();try{c=await d("WAGlobals").getWaOneQueue().enqueue(function(a){a=a.cryptoManager;return a.storage.bulkLoadIdentities(b)},{operationType:"retries_load_identities",flush:!1,afterInit:!0})}catch(a){j.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["It fails to bulkLoadIdentities: ",""])),a.toString())}var e=await this.loadSentBytes(a.map(function(a){a=a.protocolMsgId;return d("WAMsg").craftWAMsgIdString({author:a.author,chat:a.chat,externalId:a.externalId})}));return a.map(function(a){var b=a.deviceJid,f=a.protocolMsgId,g=d("WAMsg").craftWAMsgIdString({author:f.author,chat:f.chat,externalId:f.externalId});f=(f=c.get(d("WAJids").extractUserJid(b)))==null?void 0:f.get(b);if(f==null)return{type:"unauthorized"};b=e.find(function(a){return a.waMsgId===g});if(b==null)return{type:"missing"};else if(!d("WATimeUtils").happenedWithin(b.ts,k))return{type:"unauthorized"};return{frankingKey:b.frankingKey,frankingVersion:b.frankingVersion,messageBytes:b.messageBytes,backupDirective:b.backupDirective,messageType:b.messageType,protocolMsgId:b.protocolMsgId,retryCount:a.retryCount+1,type:"unacked"}})};b.saveSentBytes=function(a){return d("WASentBytesCacheApi").saveSentBytes(a)};b.$1=function(){return d("WASentBytesCacheApi").loadExpired(d("WATimeUtils").pastUnixTime(k)).then(function(a){return d("WASentBytesCacheApi").deleteSentBytes(a)})};return a}();var l=new b();function a(){return l}g.SentBytesCache=b;g.sentBytesCache=a}),98);
__d("WASetMetaApi",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return d("WASignalDB").getDb().runInTransaction(["meta"],"readwrite",function(b){return b.stores.meta.bulkPut(Object.entries(a).map(function(a){var b,c=a[0];a=a[1];return{key:c,value:(b={},b[c]=a,b)}}))},d("WASignalDB").signalOp("setMeta"))};g.setMeta=a}),98);
__d("WASmaxInAppdataPublishAckMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseReference").attrStringFromReference(b,["to"]);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"from",c.value);if(!c.success)return c;c=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"class","appdata");if(!c.success)return c;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").attrIntRange(a,"t",0,void 0);return!b.success?b:d("WAResultOrError").makeResult({"class":c.value,t:b.value})}g.parseAckMixin=a}),98);
__d("WASmaxInAppdataPublishPeerResponseNegative",["WAResultOrError","WASmaxInAppdataPublishAckMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxParseUtils").attrString(a,"error");if(!c.success)return c;a=d("WASmaxInAppdataPublishAckMixin").parseAckMixin(a,b);return!a.success?a:d("WAResultOrError").makeResult(babelHelpers["extends"]({error:c.value},a.value))}g.parsePeerResponseNegative=a}),98);
__d("WASmaxInAppdataPublishDeviceListStaleMixin",["WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a){var b=d("WASmaxParseUtils").assertTag(a,"ack");if(!b.success)return b;b=d("WASmaxParseUtils").attrString(a,"phash");return!b.success?b:d("WAResultOrError").makeResult({phash:b.value})}g.parseDeviceListStaleMixin=a}),98);
__d("WASmaxInAppdataPublishPeerResponseSuccess",["WAResultOrError","WASmaxInAppdataPublishAckMixin","WASmaxInAppdataPublishDeviceListStaleMixin","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"ack");if(!c.success)return c;c=d("WASmaxInAppdataPublishAckMixin").parseAckMixin(a,b);if(!c.success)return c;b=d("WASmaxInAppdataPublishDeviceListStaleMixin").parseDeviceListStaleMixin(a);return d("WAResultOrError").makeResult(babelHelpers["extends"]({},c.value,{deviceListStaleMixin:b.success?b.value:null}))}g.parsePeerResponseSuccess=a}),98);
__d("WASmaxOutAppdataPublishDeviceIdentityMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.deviceIdentityElementValue;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("device-identity",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeDeviceIdentityMixin=a}),98);
__d("WASmaxOutAppdataPublishInternalTestMixin",["WASmaxAttrs","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.testConfig;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxJsx").smax("test",{config:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,a)}));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeInternalTestMixin=a}),98);
__d("WASmaxOutAppdataPublishRequestIDMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestIdElementValue;a=d("WASmaxJsx").smax("trace",null,d("WASmaxJsx").smax("request_id",null,a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRequestIDMixin=a}),98);
__d("WASmaxOutAppdataPublishTraceIDMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.edgeIdElementValue;a=d("WASmaxJsx").smax("edge_id",null,a);return a}function i(a){var b=a.deviceArgs,c=a.correlationIdType;a=a.idElementValue;c=d("WASmaxJsx").smax("correlation_id",{type:d("WAWap").CUSTOM_STRING(c)},d("WASmaxJsx").smax("id",null,a),d("WASmaxChildren").OPTIONAL_CHILD(j,b));return c}function j(a){a=a.deviceId;a=d("WASmaxJsx").smax("device",{id:d("WAWap").INT(a)});return a}function k(a){var b=a.edgeIdArgs,c=a.correlationIdArgs;a=a.traceIdElementValue;a=d("WASmaxJsx").smax("trace",null,[d("WASmaxJsx").smax("trace_id",null,a),d("WASmaxChildren").OPTIONAL_CHILD(h,b)].concat(d("WASmaxChildren").REPEATED_CHILD(i,c,0,10)));return a}function a(a,b){b=k(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makeTraceIDEdgeId=h;g.makeTraceIDCorrelationId=i;g.makeTraceIDCorrelationIdDevice=j;g.mergeTraceIDMixin=a}),98);
__d("WASmaxOutAppdataPublishRequestOrTraceIDMixinGroup",["WASmaxMixinGroupExhaustiveError","WASmaxOutAppdataPublishRequestIDMixin","WASmaxOutAppdataPublishTraceIDMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.requestID)return d("WASmaxOutAppdataPublishRequestIDMixin").mergeRequestIDMixin(a,b.requestID);if(b.traceID)return d("WASmaxOutAppdataPublishTraceIDMixin").mergeTraceIDMixin(a,b.traceID);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergeRequestOrTraceIDMixinGroup=a}),98);
__d("WASmaxOutAppdataPublishTraceContextMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutAppdataPublishRequestOrTraceIDMixinGroup"],(function(a,b,c,d,e,f,g){function h(a){a=a.requestOrTraceIDMixinGroupArgs;a=d("WASmaxJsx").smax("smax$any",null,d("WASmaxOutAppdataPublishRequestOrTraceIDMixinGroup").mergeRequestOrTraceIDMixinGroup(d("WASmaxJsx").smax("trace",null),a));return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeTraceContextMixin=a}),98);
__d("WASmaxOutAppdataPublishWithDeviceListCheckMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.appdataDeviceListCheck;a=d("WASmaxJsx").smax("appdata",{device_list_check:d("WAWap").CUSTOM_STRING(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeWithDeviceListCheckMixin=a}),98);
__d("WASmaxOutAppdataPublishBaseMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutAppdataPublishDeviceIdentityMixin","WASmaxOutAppdataPublishInternalTestMixin","WASmaxOutAppdataPublishTraceContextMixin","WASmaxOutAppdataPublishWithDeviceListCheckMixin"],(function(a,b,c,d,e,f,g){function h(a){var b,c=a.deviceIdentityMixinArgs,e=a.withDeviceListCheckMixinArgs,f=a.internalTestMixinArgs;a=a.traceContextMixinArgs;b=(b=d("WASmaxMixins")).optionalMerge(d("WASmaxOutAppdataPublishTraceContextMixin").mergeTraceContextMixin,b.optionalMerge(d("WASmaxOutAppdataPublishInternalTestMixin").mergeInternalTestMixin,b.optionalMerge(d("WASmaxOutAppdataPublishWithDeviceListCheckMixin").mergeWithDeviceListCheckMixin,b.optionalMerge(d("WASmaxOutAppdataPublishDeviceIdentityMixin").mergeDeviceIdentityMixin,d("WASmaxJsx").smax("appdata",null),c),e),f),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeBaseMixin=a}),98);
__d("WASmaxOutAppdataPublishEncPayloadMixin",["WASmaxJsx","WASmaxMixins"],(function(a,b,c,d,e,f,g){function h(a){a=a.encElementValue;a=d("WASmaxJsx").smax("enc",null,a);return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncPayloadMixin=a}),98);
__d("WASmaxOutAppdataPublishEncTypeIndividualMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutAppdataPublishEncPayloadMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.encType;b=d("WASmaxOutAppdataPublishEncPayloadMixin").mergeEncPayloadMixin(d("WASmaxJsx").smax("enc",{type:d("WAWap").CUSTOM_STRING(b)}),a);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncTypeIndividualMixin=a}),98);
__d("WASmaxOutAppdataPublishEncVersionFutureproofMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encV;a=d("WASmaxJsx").smax("enc",{v:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncVersionFutureproofMixin=a}),98);
__d("WASmaxOutAppdataPublishPeerPeerFanoutMixin",["WASmaxChildren","WASmaxJsx","WASmaxMixins","WASmaxOutAppdataPublishEncTypeIndividualMixin","WASmaxOutAppdataPublishEncVersionFutureproofMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.toJid,c=a.encVersionFutureproofMixinArgs;a=a.encTypeIndividualMixinArgs;b=d("WASmaxJsx").smax("to",{jid:d("WAWap").DEVICE_JID(b)},d("WASmaxOutAppdataPublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxOutAppdataPublishEncVersionFutureproofMixin").mergeEncVersionFutureproofMixin(d("WASmaxJsx").smax("enc",null),c),a));return b}function i(a){var b=a.toArgs;a=a.appdataTo;a=d("WASmaxJsx").smax("appdata",{to:d("WAWap").USER_JID(a)},d("WASmaxJsx").smax("participants",null,d("WASmaxChildren").REPEATED_CHILD(h,b,1,24)));return a}function a(a,b){b=i(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.makePeerPeerFanoutParticipantsTo=h;g.mergePeerPeerFanoutMixin=a}),98);
__d("WASmaxOutAppdataPublishEncRetryMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(a){a=a.encCount;a=d("WASmaxJsx").smax("enc",{count:d("WAWap").INT(a)});return a}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeEncRetryMixin=a}),98);
__d("WASmaxOutAppdataPublishRetryMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutAppdataPublishEncRetryMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.appdataT;a=a.encRetryMixinArgs;b=d("WASmaxJsx").smax("appdata",{t:d("WAWap").INT(b)},d("WASmaxOutAppdataPublishEncRetryMixin").mergeEncRetryMixin(d("WASmaxJsx").smax("enc",null),a));return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeRetryMixin=a}),98);
__d("WASmaxOutAppdataPublishPeerPeerSingleMixin",["WASmaxJsx","WASmaxMixins","WASmaxOutAppdataPublishEncTypeIndividualMixin","WASmaxOutAppdataPublishEncVersionFutureproofMixin","WASmaxOutAppdataPublishRetryMixin","WAWap"],(function(a,b,c,d,e,f,g){function h(a){var b=a.appdataTo,c=a.retryMixinArgs,e=a.encVersionFutureproofMixinArgs;a=a.encTypeIndividualMixinArgs;b=d("WASmaxMixins").optionalMerge(d("WASmaxOutAppdataPublishRetryMixin").mergeRetryMixin,d("WASmaxJsx").smax("appdata",{to:d("WAWap").DEVICE_JID(b)},d("WASmaxOutAppdataPublishEncTypeIndividualMixin").mergeEncTypeIndividualMixin(d("WASmaxOutAppdataPublishEncVersionFutureproofMixin").mergeEncVersionFutureproofMixin(d("WASmaxJsx").smax("enc",null),e),a)),c);return b}function a(a,b){b=h(b);return d("WASmaxMixins").mergeStanzas(a,b)}g.mergePeerPeerSingleMixin=a}),98);
__d("WASmaxOutAppdataPublishPeerMsgTypes",["WASmaxMixinGroupExhaustiveError","WASmaxOutAppdataPublishPeerPeerFanoutMixin","WASmaxOutAppdataPublishPeerPeerSingleMixin"],(function(a,b,c,d,e,f,g){function a(a,b){if(b.peerPeerFanout)return d("WASmaxOutAppdataPublishPeerPeerFanoutMixin").mergePeerPeerFanoutMixin(a,b.peerPeerFanout);if(b.peerPeerSingle)return d("WASmaxOutAppdataPublishPeerPeerSingleMixin").mergePeerPeerSingleMixin(a,b.peerPeerSingle);throw new(d("WASmaxMixinGroupExhaustiveError").SmaxMixinGroupExhaustiveError)()}g.mergePeerMsgTypes=a}),98);
__d("WASmaxOutAppdataPublishPeerRequest",["WASmaxAttrs","WASmaxJsx","WASmaxOutAppdataPublishBaseMixin","WASmaxOutAppdataPublishPeerMsgTypes","WAWap"],(function(a,b,c,d,e,f,g){function a(a){var b=a.appdataId,c=a.appdataPushPriority,e=a.peerMsgTypesArgs;b=d("WASmaxOutAppdataPublishPeerMsgTypes").mergePeerMsgTypes(d("WASmaxOutAppdataPublishBaseMixin").mergeBaseMixin(d("WASmaxJsx").smax("appdata",{id:d("WAWap").STANZA_ID(b),category:"peer",push_priority:d("WASmaxAttrs").OPTIONAL(d("WAWap").CUSTOM_STRING,c)}),a),e);return b}g.makePeerRequest=a}),98);
__d("WASmaxAppdataPublishPeerRPC",["WAComms","WASmaxInAppdataPublishPeerResponseNegative","WASmaxInAppdataPublishPeerResponseSuccess","WASmaxOutAppdataPublishPeerRequest","WASmaxParsingFailure","WASmaxRpcUtils"],(function(a,b,c,d,e,f,g){async function a(a,b){a=d("WASmaxOutAppdataPublishPeerRequest").makePeerRequest(a);b=await d("WAComms").sendSmaxStanza(a,b);var c=d("WASmaxInAppdataPublishPeerResponseNegative").parsePeerResponseNegative(b,a);if(c.success)return{name:"PeerResponseNegative",value:c.value};b=d("WASmaxInAppdataPublishPeerResponseSuccess").parsePeerResponseSuccess(b,a);if(b.success)return{name:"PeerResponseSuccess",value:b.value};throw new(d("WASmaxParsingFailure").SmaxParsingFailure)(d("WASmaxRpcUtils").errorMessageRpcParsing("Peer",{Negative:c,Success:b}))}g.sendPeerRPC=a}),98);/*FB_PKG_DELIM*/
__d("EncryptedBackupsUtils",["FBLogger","WAJids","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";f=function(a){return Date.now()-a>d("WATimeUtils").DAY_MILLISECONDS*30};var h=function(a){return Date.now()-a>d("WATimeUtils").DAY_MILLISECONDS*30};function a(a,b,c,d,e){d={frankingTag:d==null?void 0:d.frankingTag,reportingTag:d==null?void 0:d.reportingTag};d={frankingMetadata:d,messageId:b,senderId:a,timestampMs:c};return{encryptedTransportMessage:e,metadata:d}}function b(a){return JSON.stringify([a.author,a.chat,a.externalId])}function e(a){a=JSON.parse(a);if(!Array.isArray(a))throw c("FBLogger")("wmi_eb").mustfixThrow("Unable to parse msg id string as proper json");if(a.length!==3)throw c("FBLogger")("wmi_eb").mustfixThrow("Parsed array should have 3 components");var b=d("WAJids").unsafeCoerceToUserJid(a[0]),e=d("WAJids").unsafeCoerceToChatJid(a[1]);a=d("WAStanzaUtils").toStanzaId(a[2]);return{author:b,chat:e,externalId:a}}g.entryOlderThan30Days=f;g.timestampOlderThan30Days=h;g.asBackupMessage=a;g.convertWAMsgIdToStringId=b;g.convertStringIdToWAMsgId=e}),98);
__d("MAWAdminMsgTypesGrouped",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";b=[(a=d("MAWLocalizationType")).LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE,a.LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE,a.LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE];c=[a.LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE,a.LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE,a.LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE,a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE,a.LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE];e=[a.LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS,a.LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT,a.LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS,a.LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS,a.LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT,a.LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS];f=[a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER,a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER,a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER,a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU,a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS,a.LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS,a.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_MORE_THAN_TWO_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_ONE_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_TWO_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU,a.LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_ONE_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_MORE_THAN_TWO_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_ONE_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_TWO_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_YOU,a.LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_YOU_AND_MORE_THAN_ONE_USER,a.LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_YOU_AND_ONE_USER];d=[a.LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT,a.LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT,a.LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT,a.LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT,a.LOCALIZATION_TYPE.CURRENT_USER_GOT_DEMOTED,a.LOCALIZATION_TYPE.CURRENT_USER_GOT_PROMOTED,a.LOCALIZATION_TYPE.CURRENT_USER_SELF_DEMOTED,a.LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED,a.LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED,a.LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU,a.LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU,a.LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED,a.LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ADMIN_ONLY,a.LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ALL_MEMBERS,a.LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY,a.LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS,a.LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ADMIN_ONLY,a.LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ALL_MEMBERS];var h=[a.LOCALIZATION_TYPE.CURRENT_USER_LEFT_GROUP,a.LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP],i=[a.LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP,a.LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE,a.LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME,a.LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO,a.LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME,a.LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME,a.LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME,a.LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME,a.LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_AI_THEME],j=[a.LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP,a.LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME,a.LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE,a.LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME,a.LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO,a.LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME,a.LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_AI_THEME,a.LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP,a.LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME,a.LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME,a.LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME,a.LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME],k=[a.LOCALIZATION_TYPE.CURRENT_USER_PINNED_MESSAGE,a.LOCALIZATION_TYPE.CURRENT_USER_UNPINNED_MESSAGE,a.LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE,a.LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE],l=[a.LOCALIZATION_TYPE.CURRENT_USER_LIMIT_SHARING_ENABLED,a.LOCALIZATION_TYPE.CURRENT_USER_LIMIT_SHARING_DISABLED,a.LOCALIZATION_TYPE.PARTICIPANT_LIMIT_SHARING_ENABLED,a.LOCALIZATION_TYPE.PARTICIPANT_LIMIT_SHARING_DISABLED],m=[a.LOCALIZATION_TYPE.TWO_USERS_CONNECTED,a.LOCALIZATION_TYPE.TWO_USERS_CONNECTED_ONE_MSPLIT],n=[a.LOCALIZATION_TYPE.CURRENT_USER_SEND_UNRENDERABLE_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_LIVE_LOCATION_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_LOCATION_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_POLL_CREATION_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_CONTACT_SHARE_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_STORY_MENTION_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_BUMP_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK],o=[a.LOCALIZATION_TYPE.PARTICIPANT_SEND_UNRENDERABLE_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_LIVE_LOCATION_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_LOCATION_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_POLL_CREATION_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_CONTACT_SHARE_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_STORY_MENTION_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_BUMP_MESSAGE,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.MESSENGER_MEMORY_ENCRYPTED_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.META_AI_SEND_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.USER_SEND_UNAVAILABLE_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.USER_SEND_ENCRYPTED_MESSAGE_FALLBACK,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_BUMP_MESSAGE_ORIGINAL_UNAVAILABLE_FALLBACK,a.LOCALIZATION_TYPE.RTC_XMA_FALLBACK],p=[a.LOCALIZATION_TYPE.CURRENT_USER_BUMPED_MESSAGE,a.LOCALIZATION_TYPE.CURRENT_USER_BUMPED_OWN_MESSAGE],q=[a.LOCALIZATION_TYPE.PARTICIPANT_BUMPED_CURRENT_USER_MESSAGE,a.LOCALIZATION_TYPE.PARTICIPANT_BUMPED_OWN_MESSAGE,a.LOCALIZATION_TYPE.PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE],r=[a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_DAYS,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_HOURS,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_MINUTES,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_CHANGE_SECONDS,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_OFF,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_DAYS,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_HOURS,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_MINUTES,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_SETTING_TURNED_ON_SECONDS,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_DAYS,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_HOURS,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_MINUTES,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_CHANGE_SECONDS,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_OFF,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_DAYS,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_HOURS,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_MINUTES,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_SETTING_TURNED_ON_SECONDS,a.LOCALIZATION_TYPE.EPHEMERAL_SETTINGS_AUTO_RESET],s=[a.LOCALIZATION_TYPE.YOUR_DEVICE_ICDC_ALERT_ADMIN_MESSAGE,a.LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE],t=[a.LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL,a.LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL,a.LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_AUDIO_CALL,a.LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_VIDEO_CALL],u=[a.LOCALIZATION_TYPE.CURRENT_USER_AUDIO_CALLED,a.LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_AUDIO_CALL,a.LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_VIDEO_CALL,a.LOCALIZATION_TYPE.CURRENT_USER_VIDEO_CALLED,a.LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL,a.LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL,a.LOCALIZATION_TYPE.PARTICIPANT_AUDIO_CALLED,a.LOCALIZATION_TYPE.PARTICIPANT_VIDEO_CALLED],v=[a.LOCALIZATION_TYPE.CURRENT_USER_CREATED_GROUP,a.LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG,a.LOCALIZATION_TYPE.CURRENT_USER_SENT_EVENT,a.LOCALIZATION_TYPE.CURRENT_USER_SENT_POST,a.LOCALIZATION_TYPE.CURRENT_USER_SENT_REEL,a.LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY,a.LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY_HIGHLIGHT,a.LOCALIZATION_TYPE.CURRENT_USER_RECEIVED_STORY_MENTION_IG,a.LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_RECORD_SCREEN,a.LOCALIZATION_TYPE.YOU_EPHEMERAL_TAKE_SCREENSHOT,a.LOCALIZATION_TYPE.CURRENT_USER_UNSENT_MESSAGE],w=[a.LOCALIZATION_TYPE.PARTICIPANT_CREATED_GROUP,a.LOCALIZATION_TYPE.UNKNOWN_USER_CREATED_GROUP,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_AUDIO,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_GIF,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP,a.LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO,a.LOCALIZATION_TYPE.PARTICIPANT_SENT_EVENT,a.LOCALIZATION_TYPE.PARTICIPANT_SENT_POST,a.LOCALIZATION_TYPE.PARTICIPANT_SENT_REEL,a.LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,a.LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY_HIGHLIGHT,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN,a.LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT,a.LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE,a.LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE_IN_GROUP,a.LOCALIZATION_TYPE.PARTICIPANT_UNSENT_MESSAGE,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_RECORD_SCREEN,a.LOCALIZATION_TYPE.UNKNOWN_USER_EPHEMERAL_TAKE_SCREENSHOT];a=[a.LOCALIZATION_TYPE.EMPTY_SNIPPET];g.cutoverAdminMsgs=b;g.deviceChanges=c;g.currentUserAddRemoveParticipant=e;g.otherUserAddRemoveParticipant=f;g.groupPermissionsChanged=d;g.participantLeftGroup=h;g.chatCustomizedByCurrentUser=i;g.chatCustomizedByOtherUser=j;g.pinnedMessageUpdate=k;g.limitSharingUpdate=l;g.twoUsersConnected=m;g.fallbackMsgFromCurrentUser=n;g.fallbackMsgFromOtherUser=o;g.currentUserBumpsMessage=p;g.otherUserBumpsMessage=q;g.ephemeralSettingChanges=r;g.icdcAlerts=s;g.callActionToNotifyAbout=t;g.callActionNotToNotifyAbout=u;g.otherNonAdminMsgToBeBumped=v;g.otherNonAdminMsgToBeMarkedAsUnread=w;g.otherNonAdminMsgToNotTriggerUpdate=a}),98);
__d("MAWArmadilloAppDataTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={};a.name="ProtocolMsgId";a.internalSpec={externalId:[1,(d=d("WAProtoConst")).TYPES.STRING],author:[2,d.TYPES.STRING],chat:[3,d.TYPES.STRING]};b.name="MetaSyncMessageKeyProto";b.internalSpec={fromMe:[1,d.TYPES.BOOL],id:[2,d.TYPES.STRING]};c.name="MetaSyncMessageProto";c.internalSpec={key:[1,d.TYPES.MESSAGE,b],ts:[2,d.TYPES.INT64]};e.name="MetaSyncMessageRangeProto";e.internalSpec={lastMessageTimestamp:[1,d.TYPES.INT64],lastSystemMessageTimestamp:[2,d.TYPES.INT64],messages:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,c]};f.name="MetaSyncChatActionProto";f.internalSpec={type:[1,d.TYPES.STRING],chatJid:[2,d.TYPES.STRING],archived:[3,d.TYPES.BOOL],ts:[4,d.TYPES.INT64],messageRange:[5,d.TYPES.MESSAGE,e],read:[6,d.TYPES.BOOL]};h.name="MetaSyncMessageActionProto";h.internalSpec={type:[1,d.TYPES.STRING],protocolMsgId:[2,d.TYPES.MESSAGE,a]};i.name="MetaSyncActionProto";i.internalSpec={chatAction:[1,d.TYPES.MESSAGE,f],messageAction:[2,d.TYPES.MESSAGE,h],__oneofs__:{action:["chatAction","messageAction"]}};j.name="MetaSyncAppDataProto";j.internalSpec={actions:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,i]};k.name="EncryptedBackupsSecretsEpochProto";k.internalSpec={id:[1,d.TYPES.UINT64],anonId:[2,d.TYPES.BYTES],rootKey:[3,d.TYPES.BYTES],status:[4,d.TYPES.INT32]};l.name="EncryptedBackupsSecretsProto";l.internalSpec={backupId:[1,d.TYPES.UINT64],serverDataId:[2,d.TYPES.UINT64],epoch:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,k],tempOcmfClientState:[4,d.TYPES.BYTES],mailboxRootKey:[5,d.TYPES.BYTES],obliviousValidationToken:[6,d.TYPES.BYTES]};m.name="FingerprintProto";m.internalSpec={currentIndex:[1,d.TYPES.UINT32],deviceIndexes:[2,d.FLAGS.REPEATED|d.TYPES.UINT32],rawId:[3,d.TYPES.UINT32]};n.name="SyncKeyDataProto";n.internalSpec={keyId:[1,d.TYPES.BYTES],keyData:[2,d.TYPES.BYTES],keyEpoch:[3,d.TYPES.UINT32],timestamp:[4,d.TYPES.INT64],fingerprint:[5,d.TYPES.MESSAGE,m]};o.name="SyncKeyShareProto";o.internalSpec={keys:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,n],orphanKeys:[2,d.FLAGS.REPEATED|d.TYPES.BYTES]};p.name="SyncKeyRequestProto";p.internalSpec={keyIds:[1,d.FLAGS.REPEATED|d.TYPES.BYTES]};q.name="AppDataProto";q.internalSpec={type:[1,d.TYPES.STRING],actions:[2,d.FLAGS.REPEATED|d.TYPES.MESSAGE,i],encryptedBackupsSecrets:[3,d.TYPES.MESSAGE,l],syncKeyShare:[4,d.TYPES.MESSAGE,o],syncKeyRequest:[5,d.TYPES.MESSAGE,p]};r.name="IdentitiesPerDeviceProto";r.internalSpec={deviceJid:[1,d.TYPES.STRING],serializedPubKey:[2,d.TYPES.BYTES],baseKey:[3,d.TYPES.BYTES]};s.name="AppDataTableSchemaProto";s.internalSpec={externalId:[1,d.TYPES.STRING],ts:[2,d.TYPES.INT64],contents:[3,d.TYPES.MESSAGE,q],permittedIdentitiesPerDevice:[4,d.FLAGS.REPEATED|d.TYPES.MESSAGE,r],ack:[5,d.TYPES.INT32],appDataId:[6,d.TYPES.INT32],recipientDevices:[7,d.FLAGS.REPEATED|d.TYPES.STRING],sendPartial:[8,d.TYPES.BOOL]};g.ProtocolMsgIdSpec=a;g.MetaSyncMessageKeyProtoSpec=b;g.MetaSyncMessageProtoSpec=c;g.MetaSyncMessageRangeProtoSpec=e;g.MetaSyncChatActionProtoSpec=f;g.MetaSyncMessageActionProtoSpec=h;g.MetaSyncActionProtoSpec=i;g.MetaSyncAppDataProtoSpec=j;g.EncryptedBackupsSecretsEpochProtoSpec=k;g.EncryptedBackupsSecretsProtoSpec=l;g.FingerprintProtoSpec=m;g.SyncKeyDataProtoSpec=n;g.SyncKeyShareProtoSpec=o;g.SyncKeyRequestProtoSpec=p;g.AppDataProtoSpec=q;g.IdentitiesPerDeviceProtoSpec=r;g.AppDataTableSchemaProtoSpec=s}),98);
__d("MAWArmadilloAppMetaTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.name="DbAppMetaValuesProto";a.internalSpec={msgTypeVersion:[1,(c=d("WAProtoConst")).TYPES.INT32],hmacKey:[2,c.TYPES.BYTES],allowSecurityAlert:[3,c.TYPES.BOOL],hotlikeSticker:[4,c.TYPES.BYTES],isBackfilledForOccamadillo:[5,c.TYPES.BOOL],allowSecurityAlertForSelf:[11,c.TYPES.BOOL],hasMigratedFromDexie:[12,c.TYPES.BOOL],restoreMigrationAttempts:[13,c.TYPES.INT32],deviceJid:[14,c.TYPES.STRING],restoreToDexieMigrationComplete:[15,c.TYPES.BOOL],dbMigrationVersion:[16,c.TYPES.INT32]};b.name="AppMetaTableSchemaProto";b.internalSpec={key:[1,c.TYPES.STRING],value:[2,c.TYPES.MESSAGE,a]};g.DbAppMetaValuesProtoSpec=a;g.AppMetaTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloCollectionVersionsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="CollectionVersionsTableSchemaProto";a.internalSpec={collection:[1,(b=d("WAProtoConst")).TYPES.STRING],version:[2,b.TYPES.INT32],state:[3,b.TYPES.STRING],finiteFailureStartTime:[4,b.TYPES.INT64],ltHash:[5,b.TYPES.BYTES],isCollectionInMacMismatchFatal:[6,b.TYPES.BOOL],isCollectionLthashInconsistent:[7,b.TYPES.BOOL]};g.CollectionVersionsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloContactsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.name="EphemeralSettingProto";a.internalSpec={ephemeralExpirationInSec:[1,(c=d("WAProtoConst")).TYPES.UINT32],ephemeralLastUpdatedOrSetTimestamp:[2,c.TYPES.INT64]};b.name="EphemeralSyncResponseBackoffInfo";b.internalSpec={syncResponseRetries:[1,c.TYPES.INT32],syncResponseSentTs:[2,c.TYPES.INT64]};g.EphemeralSettingProtoSpec=a;g.EphemeralSyncResponseBackoffInfoSpec=b}),98);
__d("MAWArmadilloDeletedMessagesTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="DeletedMessagesTableSchemaProto";a.internalSpec={author:[1,(b=d("WAProtoConst")).TYPES.STRING],chat:[2,b.TYPES.STRING],externalId:[3,b.TYPES.STRING],reason:[4,b.TYPES.STRING]};g.DeletedMessagesTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloDeviceChangeAlertsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="DeviceChangeAlertsTableSchemaProto";a.internalSpec={action:[1,(b=d("WAProtoConst")).TYPES.STRING],isArchived:[2,b.TYPES.BOOL],deviceChangeAlertsId:[3,b.TYPES.INT64],location:[4,b.TYPES.STRING],model:[5,b.TYPES.STRING],ts:[6,b.TYPES.INT64],loggedOut:[7,b.TYPES.BOOL],deviceJid:[8,b.TYPES.STRING],identity:[9,b.TYPES.BYTES],platform:[10,b.TYPES.STRING],latitude:[11,b.TYPES.STRING],longitude:[12,b.TYPES.STRING],isConfirmed:[13,b.TYPES.BOOL],isNotified:[14,b.TYPES.BOOL]};g.DeviceChangeAlertsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloDyiBatchTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={BACKUP_RESTORE:0,E2E_DYI:1};b={};b.name="DyiBatchTableSchemaProto";b.internalSpec={batchId:[1,(c=d("WAProtoConst")).TYPES.INT32],numMessages:[2,c.TYPES.INT32],oldestTs:[3,c.TYPES.INT64],threadId:[4,c.TYPES.STRING],isThread:[5,c.TYPES.BOOL],numMessagesRestored:[6,c.TYPES.INT32],qplInstanceKeyForThread:[7,c.TYPES.INT64],qplFlowDescriptor:[8,c.TYPES.ENUM,a],qplInstanceKeyE2E:[9,c.TYPES.INT64],numThreadsRestored:[10,c.TYPES.INT64]};g.DYI_BATCH_TABLE_SCHEMA_PROTO_QPL_FLOW_DESCRIPTOR=a;g.DyiBatchTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloEBMsgRangesTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="EBMsgRangesTableSchemaProto";a.internalSpec={rangeId:[1,(b=d("WAProtoConst")).TYPES.UINT32],threadJid:[2,b.TYPES.STRING],minMsgExternalId:[3,b.TYPES.STRING],maxMsgExternalId:[4,b.TYPES.STRING],minMsgSortOrderMs:[5,b.TYPES.UINT64],maxMsgSortOrderMs:[6,b.TYPES.UINT64],creationTime:[7,b.TYPES.INT64]};g.EBMsgRangesTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloMessagesTableSchema.pb",["MAWArmadilloContactsTableSchema.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){var h;a={};b={};c={};e={};f={};var i={},j={},k={},l={},m={},n={};a.name="MsgContentProto";a.internalSpec={content:[1,(h=d("WAProtoConst")).TYPES.STRING],adminMsgContent:[2,h.FLAGS.REPEATED|h.TYPES.STRING],adminType:[3,h.TYPES.STRING],obsoleteExpiration:[4,h.TYPES.INT32],obsoleteTs:[5,h.TYPES.INT64],subtype:[6,h.TYPES.STRING],protobuf:[7,h.TYPES.BYTES],screenshotActionType:[8,h.TYPES.INT32],authorName:[9,h.TYPES.STRING],version:[10,h.TYPES.INT32],mentionedJids:[11,h.FLAGS.REPEATED|h.TYPES.STRING],commands:[12,h.FLAGS.REPEATED|h.TYPES.MESSAGE,b]};b.name="MsgContentCommandProto";b.internalSpec={commandType:[1,h.TYPES.INT32],offset:[2,h.TYPES.INT32],length:[3,h.TYPES.INT32],validationToken:[4,h.TYPES.STRING]};c.name="ReportingMetaProto";c.internalSpec={frankingTag:[1,h.TYPES.BYTES],frankingVersion:[2,h.TYPES.INT32],reportingContent:[3,h.TYPES.BYTES],reportingTag:[4,h.TYPES.BYTES],frankingKey:[5,h.TYPES.BYTES]};e.name="DbQuotedMsgProto";e.internalSpec={remoteJid:[1,h.TYPES.STRING],content:[2,h.TYPES.MESSAGE,m]};f.name="VideoMsgContentProto";f.internalSpec={duration:[1,h.TYPES.INT32],width:[2,h.TYPES.INT32],height:[3,h.TYPES.INT32],mimetype:[4,h.TYPES.STRING],jpegThumbnail:[5,h.TYPES.BYTES],jpegThumbnailHeight:[6,h.TYPES.INT32],jpegThumbnailWidth:[7,h.TYPES.INT32]};i.name="ImageMsgContentProto";i.internalSpec={width:[1,h.TYPES.UINT32],height:[2,h.TYPES.UINT32],jpegThumbnail:[3,h.TYPES.BYTES],jpegThumbnailHeight:[4,h.TYPES.INT32],jpegThumbnailWidth:[5,h.TYPES.INT32]};j.name="AudioMsgContentProto";j.internalSpec={duration:[1,h.TYPES.INT32],mimetype:[2,h.TYPES.STRING],played:[3,h.TYPES.BOOL]};k.name="DocumentFileMsgContentProto";k.internalSpec={filename:[1,h.TYPES.STRING],mimetype:[2,h.TYPES.STRING]};l.name="QuotedDbMediaProto";l.internalSpec={mediaType:[1,h.TYPES.STRING],plaintextHash:[2,h.TYPES.STRING],size:[3,h.TYPES.INT32],ts:[4,h.TYPES.INT64],mediaEntry:[5,h.TYPES.BYTES],validatedVideoInfo:[6,h.TYPES.MESSAGE,f],validatedImageInfo:[7,h.TYPES.MESSAGE,i],validatedAudioInfo:[8,h.TYPES.MESSAGE,j],validatedDocumentFileInfo:[9,h.TYPES.MESSAGE,k]};m.name="DbQuotedMsgContentProto";m.internalSpec={type:[1,h.TYPES.STRING],ts:[2,h.TYPES.INT64],externalId:[3,h.TYPES.STRING],author:[4,h.TYPES.STRING],msgContent:[5,h.TYPES.MESSAGE,a],obsoleteMedia:[6,h.TYPES.MESSAGE,l],msgId:[7,h.TYPES.STRING],mediaId:[8,h.TYPES.INT32],sourceId:[9,h.TYPES.STRING],xmaMessageType:[10,h.TYPES.INT32],specialTextSize:[11,h.TYPES.INT32],plaintextHash:[12,h.TYPES.STRING],expirationTs:[13,h.TYPES.INT64]};n.name="MessagesTableSchemaProto";n.internalSpec={type:[1,h.TYPES.STRING],ts:[2,h.TYPES.INT64],externalId:[3,h.TYPES.STRING],msgId:[4,h.TYPES.STRING],author:[5,h.TYPES.STRING],ack:[6,h.TYPES.INT32],resendCount:[7,h.TYPES.INT32],msgContent:[8,h.TYPES.MESSAGE,a],altIndex:[9,h.TYPES.STRING],forwardingScore:[10,h.TYPES.INT32],quote:[11,h.TYPES.MESSAGE,e],messageExpirationTs:[12,h.TYPES.INT64],ephemeralSetting:[13,h.TYPES.MESSAGE,d("MAWArmadilloContactsTableSchema.pb").EphemeralSettingProtoSpec],revokedExternalId:[14,h.TYPES.STRING],isForwarded:[15,h.TYPES.BOOL],originalTs:[17,h.TYPES.INT64],sortOrderMs:[18,h.TYPES.INT64],reportingMeta:[19,h.TYPES.MESSAGE,c],messageDeleteTs:[20,h.TYPES.INT64],ephemeralCounterStarted:[21,h.TYPES.BOOL],quoteExternalId:[22,h.TYPES.STRING],unsendMsgContentDeleteTs:[23,h.TYPES.INT64],rowId:[24,h.TYPES.INT32],thread:[25,h.TYPES.INT32],mediaId:[26,h.TYPES.INT32],ephemeralMsgDisappeared:[27,h.TYPES.BOOL],threadJid:[28,h.TYPES.STRING],xmaId:[29,h.TYPES.INT32],specialTextSize:[30,h.TYPES.INT32],xmaMessageType:[31,h.TYPES.INT32],isExpiredXmaMsg:[32,h.TYPES.BOOL],ravenEphemeralType:[33,h.TYPES.INT32],ravenEphemeralMediaState:[34,h.TYPES.INT32],editCount:[35,h.TYPES.INT32],groupId:[36,h.TYPES.STRING],groupIndex:[37,h.TYPES.INT64],groupSize:[38,h.TYPES.INT64],receiverFetchId:[39,h.TYPES.STRING],source:[40,h.TYPES.STRING],quoteExpirationTs:[41,h.TYPES.INT64],applicationErrorCode:[42,h.TYPES.INT32],hdType:[43,h.TYPES.INT32],pollStanzaId:[44,h.TYPES.STRING],collapsibleId:[45,h.TYPES.STRING],isCollapsed:[46,h.TYPES.BOOL]};g.MsgContentProtoSpec=a;g.MsgContentCommandProtoSpec=b;g.ReportingMetaProtoSpec=c;g.DbQuotedMsgProtoSpec=e;g.VideoMsgContentProtoSpec=f;g.ImageMsgContentProtoSpec=i;g.AudioMsgContentProtoSpec=j;g.DocumentFileMsgContentProtoSpec=k;g.QuotedDbMediaProtoSpec=l;g.DbQuotedMsgContentProtoSpec=m;g.MessagesTableSchemaProtoSpec=n}),98);
__d("MAWArmadilloEditMsgHistoryTableSchema.pb",["MAWArmadilloMessagesTableSchema.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="EditMsgHistoryTableSchemaProto";a.internalSpec={author:[1,(b=d("WAProtoConst")).TYPES.STRING],editMsgHistoryId:[2,b.TYPES.INT32],editTs:[3,b.TYPES.INT64],msgContent:[4,b.TYPES.MESSAGE,d("MAWArmadilloMessagesTableSchema.pb").MsgContentProtoSpec],originalMsgExternalId:[5,b.TYPES.STRING],specialTextSize:[6,b.TYPES.INT32],threadJid:[7,b.TYPES.STRING],editExternalId:[8,b.TYPES.STRING],sendStatus:[9,b.TYPES.INT32]};g.EditMsgHistoryTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloGroupInfoTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="GroupInfoSchemaProto";a.internalSpec={groupJid:[1,(b=d("WAProtoConst")).TYPES.STRING],threadId:[2,b.TYPES.INT32],creator:[3,b.TYPES.STRING],creationTs:[4,b.TYPES.INT64],name:[5,b.TYPES.STRING],nameOwner:[6,b.TYPES.STRING],nameTs:[7,b.TYPES.INT64],msgExpiration:[8,b.TYPES.INT32],participantVersion:[9,b.TYPES.STRING],inviter:[10,b.TYPES.STRING],memberAddMode:[11,b.TYPES.STRING]};g.GroupInfoSchemaProtoSpec=a}),98);
__d("MAWArmadilloGroupInvitesTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="GroupInvitesTableSchemaProto";a.internalSpec={inviterJid:[1,(b=d("WAProtoConst")).TYPES.STRING],invitedParticipantId:[2,b.TYPES.STRING],inviteCode:[3,b.TYPES.STRING],inviteExpirationTs:[4,b.TYPES.INT64],caption:[5,b.TYPES.STRING]};g.GroupInvitesTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloMediaTablesSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={NONE:0,LQ_4K:1,HQ_4K:2};b={};c={};e={};f={};var h={},i={},j={},k={},l={};b.name="ChunkTableSchemaProto";b.internalSpec={plaintextHash:[1,(d=d("WAProtoConst")).TYPES.STRING],blobData:[2,d.TYPES.BYTES],mimetype:[3,d.TYPES.STRING],hashedPlaintextHash:[4,d.TYPES.STRING],chunkId:[5,d.TYPES.INT32]};c.name="MediaBackupSchemaProto";c.internalSpec={mediaBackupId:[1,d.TYPES.INT32],mediaId:[2,d.TYPES.INT32],objectId:[3,d.TYPES.STRING],msgId:[4,d.TYPES.STRING],fbid:[5,d.TYPES.STRING]};e.name="MediaEntriesProto";e.internalSpec={msgId:[1,d.TYPES.STRING],mediaEntryData:[2,d.TYPES.BYTES]};f.name="VideoMsgContentProto";f.internalSpec={duration:[1,d.TYPES.UINT32],width:[2,d.TYPES.UINT32],height:[3,d.TYPES.UINT32],mimetype:[4,d.TYPES.STRING],jpegThumbnail:[5,d.TYPES.BYTES],jpegThumbnailHeight:[6,d.TYPES.UINT32],jpegThumbnailWidth:[7,d.TYPES.UINT32],thumbnailPlaintextHash:[8,d.TYPES.STRING]};h.name="ImageMsgContentProto";h.internalSpec={width:[1,d.TYPES.UINT32],height:[2,d.TYPES.UINT32],jpegThumbnail:[3,d.TYPES.BYTES],jpegThumbnailHeight:[4,d.TYPES.UINT32],jpegThumbnailWidth:[5,d.TYPES.UINT32],thumbnailPlaintextHash:[6,d.TYPES.STRING],hdType:[7,d.TYPES.ENUM,a]};i.name="AudioMsgContentProto";i.internalSpec={duration:[1,d.TYPES.UINT32],mimetype:[2,d.TYPES.STRING],played:[3,d.TYPES.BOOL]};j.name="DocumentFileMsgContentProto";j.internalSpec={filename:[1,d.TYPES.STRING],mimetype:[2,d.TYPES.STRING]};k.name="ValidatedResult";k.internalSpec={validatedMimeType:[1,d.TYPES.STRING],videoStreamType:[2,d.TYPES.STRING],videoCalculatedFps:[3,d.TYPES.UINT32],videoNominalFps:[4,d.TYPES.UINT32],videoWidth:[5,d.TYPES.UINT32],videoHeight:[6,d.TYPES.UINT32],videoDuration:[7,d.TYPES.UINT32],videoAvgBitsPerSecond:[8,d.TYPES.UINT32],audioStreamType:[9,d.TYPES.STRING],audioSamplingRate:[10,d.TYPES.UINT32],audioNumberOfChannels:[11,d.TYPES.UINT32],audioAvgBitsPerSecond:[12,d.TYPES.UINT32]};l.name="MediaTableSchemaProto";l.internalSpec={mediaType:[1,d.TYPES.STRING],plaintextHash:[2,d.TYPES.STRING],size:[3,d.TYPES.UINT64],mediaEntries:[4,d.FLAGS.REPEATED|d.TYPES.MESSAGE,e],ts:[5,d.TYPES.INT64],validatedVideoInfo:[6,d.TYPES.MESSAGE,f],validatedImageInfo:[7,d.TYPES.MESSAGE,h],validatedAudioInfo:[8,d.TYPES.MESSAGE,i],hashedPlaintextHash:[9,d.TYPES.STRING],mediaId:[10,d.TYPES.INT32],msgIds:[11,d.FLAGS.REPEATED|d.TYPES.STRING],objectId:[12,d.TYPES.STRING],fbid:[13,d.TYPES.STRING],validatedDocumentFileInfo:[14,d.TYPES.MESSAGE,j],validatedResult:[15,d.TYPES.MESSAGE,k],accessibilitySummaryText:[16,d.TYPES.STRING]};g.HD_TYPE=a;g.ChunkTableSchemaProtoSpec=b;g.MediaBackupSchemaProtoSpec=c;g.MediaEntriesProtoSpec=e;g.VideoMsgContentProtoSpec=f;g.ImageMsgContentProtoSpec=h;g.AudioMsgContentProtoSpec=i;g.DocumentFileMsgContentProtoSpec=j;g.ValidatedResultSpec=k;g.MediaTableSchemaProtoSpec=l}),98);
__d("MAWArmadilloMissingKeysTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.name="DeviceResponse";a.internalSpec={deviceId:[1,(c=d("WAProtoConst")).TYPES.INT32],deviceResponse:[2,c.TYPES.BOOL]};b.name="MissingKeysTableSchemaProto";b.internalSpec={keyHex:[1,c.TYPES.STRING],keyId:[2,c.TYPES.BYTES],timestamp:[3,c.TYPES.INT64],deviceResponses:[4,c.FLAGS.REPEATED|c.TYPES.MESSAGE,a]};g.DeviceResponseSpec=a;g.MissingKeysTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloParticipantsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="ParticipantsTableSchemaProto";a.internalSpec={id:[1,(b=d("WAProtoConst")).TYPES.STRING],userJid:[2,b.TYPES.STRING],deliveredWatermarkTs:[3,b.TYPES.INT64],lastReadWatermarkTs:[4,b.TYPES.INT64],type:[5,b.TYPES.STRING],addressable:[6,b.TYPES.BOOL],lastReadActionTs:[7,b.TYPES.INT64],threadId:[9,b.TYPES.INT32],threadJid:[10,b.TYPES.STRING]};g.ParticipantsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloPendingMutationsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={SET:0,REMOVE:1};b={};b.name="PendingMutationsTableSchemaProto";b.internalSpec={id:[1,(c=d("WAProtoConst")).TYPES.INT32],collection:[2,c.TYPES.STRING],index:[3,c.TYPES.STRING],binarySyncAction:[4,c.TYPES.BYTES],version:[5,c.TYPES.INT32],operation:[6,c.TYPES.ENUM,a],timestamp:[7,c.TYPES.INT64],action:[8,c.TYPES.STRING]};g.SYNCD_MUTATION_SYNCD_OPERATION=a;g.PendingMutationsTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloPersonalSenderKeyStatusTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="PersonalSenderKeyStatusTableSchemaProto";a.internalSpec={groupJid:[1,(b=d("WAProtoConst")).TYPES.STRING],senderKeyId:[2,b.TYPES.INT32],rotateSenderKey:[4,b.TYPES.BOOL],senderKeyTs:[5,b.TYPES.INT64],hasSenderKey:[6,b.FLAGS.REPEATED|b.TYPES.STRING]};g.PersonalSenderKeyStatusTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloPollTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={OPEN:0,FROZEN:1};b={};c={};e={};f={};b.name="PollOptionProto";b.internalSpec={optionText:[1,(d=d("WAProtoConst")).TYPES.STRING],voteAuthors:[2,d.FLAGS.REPEATED|d.TYPES.STRING]};c.name="PollOptionsProto";c.internalSpec={pollOptionHash:[1,d.TYPES.STRING],pollOption:[2,d.TYPES.MESSAGE,b]};e.name="LatestSenderTimestampsMsProto";e.internalSpec={author:[1,d.TYPES.STRING],latestSenderTimestampMs:[2,d.TYPES.INT64]};f.name="PollTableSchemaProto";f.internalSpec={chatJid:[1,d.TYPES.STRING],encKey:[2,d.TYPES.BYTES],pollAuthor:[3,d.TYPES.STRING],pollStanzaId:[4,d.TYPES.STRING],pollOptions:[5,d.FLAGS.REPEATED|d.TYPES.MESSAGE,c],pollParticipantCount:[6,d.TYPES.UINT32],pollState:[7,d.TYPES.ENUM,a],selectableOptionsCount:[8,d.TYPES.UINT32],title:[9,d.TYPES.STRING],latestSenderTimestampsMs:[10,d.FLAGS.REPEATED|d.TYPES.MESSAGE,e]};g.POLL_STATE=a;g.PollOptionProtoSpec=b;g.PollOptionsProtoSpec=c;g.LatestSenderTimestampsMsProtoSpec=e;g.PollTableSchemaProtoSpec=f}),98);
__d("MAWArmadilloReactionsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="ReactionsTableSchemaProto";a.internalSpec={ack:[1,(b=d("WAProtoConst")).TYPES.INT32],author:[2,b.TYPES.STRING],externalId:[3,b.TYPES.STRING],reactionId:[4,b.TYPES.STRING],reactToExternalId:[5,b.TYPES.STRING],reactToAuthor:[6,b.TYPES.STRING],reactToMsgId:[7,b.TYPES.STRING],threadJid:[8,b.TYPES.STRING],reaction:[9,b.TYPES.STRING],groupingKey:[10,b.TYPES.STRING],ts:[11,b.TYPES.INT64],rowId:[12,b.TYPES.INT32],senderTimestampMs:[13,b.TYPES.INT64]};g.ReactionsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloReceiptTablesSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={};a.name="DbUserStatusTsProto";a.internalSpec={deliveredTs:[1,(d=d("WAProtoConst")).TYPES.INT64],readTs:[2,d.TYPES.INT64]};b.name="StatusTsPerUserProto";b.internalSpec={userJid:[1,d.TYPES.STRING],dbUserStatusTs:[2,d.TYPES.MESSAGE,a]};c.name="IdentitiesPerDeviceProto";c.internalSpec={deviceJid:[1,d.TYPES.STRING],serializedPubKey:[2,d.TYPES.BYTES],baseKey:[3,d.TYPES.BYTES]};e.name="RetryCountPerDeviceProto";e.internalSpec={deviceJid:[1,d.TYPES.STRING],count:[2,d.TYPES.INT32]};f.name="ReceiptsTableSchemaProto";f.internalSpec={msgId:[1,d.TYPES.STRING],statusTsPerUser:[2,d.FLAGS.REPEATED|d.TYPES.MESSAGE,b],permittedIdentitiesPerDevice:[3,d.FLAGS.REPEATED|d.TYPES.MESSAGE,c],recipientDevices:[4,d.FLAGS.REPEATED|d.TYPES.STRING],retryCountsPerDevice:[5,d.FLAGS.REPEATED|d.TYPES.MESSAGE,e],waMsgId:[6,d.TYPES.STRING]};h.name="Receipts";h.internalSpec={device:[1,d.TYPES.STRING],ts:[2,d.TYPES.INT64]};i.name="PendingReceiptsTableSchemaProto";i.internalSpec={pendingReceiptId:[1,d.TYPES.STRING],thread:[2,d.TYPES.STRING],externalId:[3,d.TYPES.STRING],author:[4,d.TYPES.STRING],deliveryReceipts:[5,d.FLAGS.REPEATED|d.TYPES.MESSAGE,h],readReceipts:[6,d.FLAGS.REPEATED|d.TYPES.MESSAGE,h]};g.DbUserStatusTsProtoSpec=a;g.StatusTsPerUserProtoSpec=b;g.IdentitiesPerDeviceProtoSpec=c;g.RetryCountPerDeviceProtoSpec=e;g.ReceiptsTableSchemaProtoSpec=f;g.ReceiptsSpec=h;g.PendingReceiptsTableSchemaProtoSpec=i}),98);
__d("MAWArmadilloReceiverFetchInfoTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="ReceiverFetchInfoTableSchemaProto";a.internalSpec={mimetype:[1,(b=d("WAProtoConst")).TYPES.STRING],previewHeight:[2,b.TYPES.UINT32],previewWidth:[3,b.TYPES.UINT32],receiverFetchId:[4,b.TYPES.STRING],type:[5,b.TYPES.STRING],previewUrl:[6,b.TYPES.STRING],previewUrlExpirationTimestampMs:[7,b.TYPES.UINT64],accessibilitySummaryText:[8,b.TYPES.STRING]};g.ReceiverFetchInfoTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloSyncActionsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="SyncActionsTableSchemaProto";a.internalSpec={index:[1,(b=d("WAProtoConst")).TYPES.STRING],binarySyncData:[2,b.TYPES.BYTES],actionState:[3,b.TYPES.STRING],version:[4,b.TYPES.INT32],keyId:[5,b.TYPES.BYTES],modelId:[6,b.TYPES.STRING],modelType:[7,b.TYPES.STRING],indexMac:[8,b.TYPES.BYTES],valueMac:[9,b.TYPES.BYTES],collection:[10,b.TYPES.STRING],timestamp:[11,b.TYPES.INT64],action:[12,b.TYPES.STRING]};g.SyncActionsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloSyncKeysTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.name="SyncKeyFingerprint";a.internalSpec={currentIndex:[1,(c=d("WAProtoConst")).TYPES.INT32],deviceIndexes:[2,c.FLAGS.REPEATED|c.TYPES.INT32],rawId:[3,c.TYPES.INT64]};b.name="SyncKeysTableSchemaProto";b.internalSpec={id:[1,c.TYPES.BYTES],keyId:[2,c.TYPES.BYTES],keyData:[3,c.TYPES.BYTES],keyEpoch:[4,c.TYPES.INT64],timestamp:[5,c.TYPES.INT64],fingerprint:[6,c.TYPES.MESSAGE,a]};g.SyncKeyFingerprintSpec=a;g.SyncKeysTableSchemaProtoSpec=b}),98);
__d("MAWArmadilloTasksTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="TasksTableSchemaProto";a.internalSpec={taskName:[1,d("WAProtoConst").TYPES.STRING],scheduledTime:[2,d("WAProtoConst").TYPES.INT64]};g.TasksTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloThreadsTableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="ThreadsTableSchemaProto";a.internalSpec={jid:[1,(b=d("WAProtoConst")).TYPES.STRING],threadOrder:[2,b.TYPES.STRING],folder:[4,b.TYPES.INT32],newestMsg:[5,b.TYPES.STRING],oldestMsg:[6,b.TYPES.STRING],lastReadMsg:[7,b.TYPES.STRING],lastReadMsgReceiptSent:[8,b.TYPES.STRING],lastReadMsgTs:[9,b.TYPES.INT64],newestMsgTs:[10,b.TYPES.INT64],muteExpireTimeMs:[11,b.TYPES.INT64],muteCallsExpireTimeMs:[12,b.TYPES.INT64],archived:[13,b.TYPES.BOOL],cannotReplyReason:[14,b.TYPES.STRING],chatId:[15,b.TYPES.INT32],optimisticThreadKey:[16,b.TYPES.STRING],isMigratedLocally:[17,b.TYPES.BOOL],snippetMsg:[18,b.TYPES.STRING],deduplicationKey:[19,b.TYPES.STRING],authoritativeThreadKey:[20,b.TYPES.STRING],snippetMsgTs:[21,b.TYPES.INT64],didInsertDualThreadCutoverAdminMsg:[22,b.TYPES.BOOL],unbumpFromTs:[23,b.TYPES.INT64],unbumpToTs:[24,b.TYPES.INT64]};g.ThreadsTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloUnrenderedMessagesTableSchema.pb",["MAWArmadilloContactsTableSchema.pb","MAWArmadilloMessagesTableSchema.pb","WAProtoConst"],(function(a,b,c,d,e,f,g){a={};a.name="UnrenderedMessagesTableSchemaProto";a.internalSpec={type:[1,(b=d("WAProtoConst")).TYPES.STRING],ts:[2,b.TYPES.INT64],externalId:[3,b.TYPES.STRING],msgId:[4,b.TYPES.STRING],author:[5,b.TYPES.STRING],ack:[6,b.TYPES.INT32],resendCount:[7,b.TYPES.INT32],ephemeralSetting:[8,b.TYPES.MESSAGE,d("MAWArmadilloContactsTableSchema.pb").EphemeralSettingProtoSpec],messageDeleteForMeTs:[9,b.TYPES.INT64],rowId:[10,b.TYPES.INT32],thread:[11,b.TYPES.INT32],mediaId:[12,b.TYPES.INT32],msgContent:[13,b.TYPES.STRING],threadJid:[14,b.TYPES.STRING],reportingMeta:[15,b.TYPES.MESSAGE,d("MAWArmadilloMessagesTableSchema.pb").ReportingMetaProtoSpec],invitedParticipantUserJid:[16,b.TYPES.STRING],groupName:[17,b.TYPES.STRING],quote:[18,b.TYPES.MESSAGE,d("MAWArmadilloMessagesTableSchema.pb").DbQuotedMsgProtoSpec],xmaMessageType:[19,b.TYPES.INT32],sortOrderMs:[20,b.TYPES.INT64]};g.UnrenderedMessagesTableSchemaProtoSpec=a}),98);
__d("MAWArmadilloXMATableSchema.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};a.name="XMATableSchemaProto";a.internalSpec={associatedMessageId:[1,(c=d("WAProtoConst")).TYPES.STRING],author:[2,c.TYPES.STRING],ctas:[3,c.FLAGS.REPEATED|c.TYPES.MESSAGE,b],defaultCTA:[4,c.TYPES.MESSAGE,b],defaultPreviewMediaId:[5,c.TYPES.INT32],externalId:[6,c.TYPES.STRING],faviconMediaId:[7,c.TYPES.INT32],headerMediaId:[8,c.TYPES.INT32],headerTitle:[9,c.TYPES.STRING],isTombstoned:[10,c.TYPES.BOOL],maxSubtitleNumOfLines:[11,c.TYPES.INT32],maxTitleNumOfLines:[12,c.TYPES.INT32],msgId:[13,c.TYPES.STRING],overlayDescription:[14,c.TYPES.STRING],overlayIconGlyph:[15,c.TYPES.INT32],overlayTitle:[16,c.TYPES.STRING],previewMediaIds:[17,c.FLAGS.REPEATED|c.TYPES.INT32],subtitleText:[18,c.TYPES.STRING],targetExpiringAtSec:[19,c.TYPES.INT64],targetId:[20,c.TYPES.STRING],targetType:[21,c.TYPES.INT32],targetUsername:[22,c.TYPES.STRING],threadJid:[23,c.TYPES.STRING],titleText:[24,c.TYPES.STRING],xmaId:[25,c.TYPES.INT32],xmaLayoutType:[26,c.TYPES.INT32],defaultPreviewMediaPlaintextHash:[27,c.TYPES.STRING],faviconPlaintextHash:[28,c.TYPES.STRING],headerMediaPlaintextHash:[29,c.TYPES.STRING]};b.name="CTAProto";b.internalSpec={buttonType:[1,c.TYPES.INT32],title:[2,c.TYPES.STRING],actionUrl:[3,c.TYPES.STRING],nativeUrl:[4,c.TYPES.STRING],ctaType:[5,c.TYPES.STRING]};g.XMATableSchemaProtoSpec=a;g.CTAProtoSpec=b}),98);
__d("MAWAuthor",["MAWUserJidWrapper","WAJids","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){if(a==null||a===d("WAJids").AUTHOR_SYSTEM)return null;if(d("WAJids").isAuthorMe(a))return d("MAWUserJidWrapper").getMyUserJid();var b=d("WAJids").authorAsUserJid(a);if(b==null||c("isStringNullOrEmpty")(d("WAJids").userIdFromJid(b)))return null;else return d("WAJids").authorAsUserJid(a)};g.getAuthorUserJid=a}),98);
__d("MAWAuthoritativeThreadsCache",[],(function(a,b,c,d,e,f){"use strict";a=new Set();f.AuthoritativeThreadsCache=a}),66);
__d("MAWBridgeReceiverFetchInfo",["WALogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,d,e){var f=e.accessibilitySummaryText,g=e.mimetype,h=e.previewHeight,k=e.previewUrl,l=e.previewUrlExpirationTimestampMs,m=e.previewWidth,n=e.receiverFetchId;e=e.type;return{accessibilitySummaryText:f,mimetype:g,msgId:b,previewHeight:h,previewUrl:k,previewUrlExpirationTimestampMs:j(l),previewWidth:m,receiverFetchId:n,sortOrderMs:i(c,d),threadJid:a,type:e}}function b(a,b,c,d,e){var f=e.mimetype,g=e.previewHeight,h=e.previewWidth,j=e.receiverFetchId;e=e.type;return{mimetype:f,msgId:b,previewHeight:g,previewWidth:h,receiverFetchId:j,sortOrderMs:i(c,d),threadJid:a,type:e}}function i(a,b){return d("WATimeUtils").castToMillisTime(a!=null?a:b*1e3)}function j(a){if(a==null)return void 0;try{return d("WATimeUtils").castLongIntToMillisTime(a)}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to cast previewUrlExpirationTimestampMs to millis time: ",""])),a);return void 0}}g.createBridgeReceiverFetchInfoPayloadFromDbInfo=a;g.createBridgeReceiverFetchInfoPayloadFromUnstoredInfo=b}),98);
__d("MAWBridgeTypesCreators",["FBLogger","MAWDbMsg","MAWImageUtils","MAWMsgType","MAWUserJidWrapper","WAJids","WAMediaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{threadJid:a}}function h(a){var b,c=a.ts;switch(a.type){case d("MAWMsgType").MSG_TYPE.REVOKED:c=(b=a.originalTs)!=null?b:a.ts;break;default:c=d("MAWDbMsg").getCanonicalTsFromMsg(a)}return{msgId:a.msgId,ts:c}}function b(a,b){b=b.map(h);return{messages:b,threadJid:a}}function e(a){return{ravenMsgId:a.msgId,threadJid:a.threadJid}}function f(a,b){return a.filter(function(a){return b===a.threadJid}).map(function(a){return a.msgId})}function i(a){var b,e=a.chatJid,f=a.filteredMsgIds,g=a.hasMediaForUI,h=a.hdTypes,i=a.media,j=a.offlineAttachmentId,k=a.ravenSettings,l=a.sortOrderMs;a=a.transportKey;switch(i.mediaType){case"Image":return{duration:null,ephemeralMediaState:k==null?void 0:k.ephemeralMediaState,ephemeralMediaViewMode:k==null?void 0:k.ephemeralMediaViewMode,filesize:i.size,hasMedia:g,hasPreviewMedia:((b=i.validatedImageInfo)==null?void 0:b.jpegThumbnail)!=null,hdTypes:h,mediaId:i.mediaId,mediaType:i.mediaType,msgIds:f,offlineAttachmentId:j,plaintextHash:i.plaintextHash,previewHeight:(b=i.validatedImageInfo)==null?void 0:b.jpegThumbnailHeight,previewHeightLarge:(h=i.validatedImageInfo)==null?void 0:h.height,previewWidth:(b=i.validatedImageInfo)==null?void 0:b.jpegThumbnailWidth,previewWidthLarge:(h=i.validatedImageInfo)==null?void 0:h.width,sortOrderMs:d("WATimeUtils").castToMillisTime(l!=null?l:i.ts*1e3),threadJid:e,transportKey:a,ts:d("WATimeUtils").castToUnixTime(l!=null?l/1e3:i.ts)};case"Video":return{duration:((b=i.validatedVideoInfo)==null?void 0:b.duration)!=null?((h=i.validatedVideoInfo)==null?void 0:h.duration)*1e3:0,ephemeralMediaState:k==null?void 0:k.ephemeralMediaState,ephemeralMediaViewMode:k==null?void 0:k.ephemeralMediaViewMode,filesize:i.size,hasMedia:g,hasPreviewMedia:((b=i.validatedVideoInfo)==null?void 0:b.jpegThumbnail)!=null,mediaId:i.mediaId,mediaType:i.mediaType,msgIds:f,offlineAttachmentId:j,plaintextHash:i.plaintextHash,previewHeight:(h=i.validatedVideoInfo)==null?void 0:h.jpegThumbnailHeight,previewHeightLarge:(k=i.validatedVideoInfo)==null?void 0:k.height,previewWidth:(b=i.validatedVideoInfo)==null?void 0:b.jpegThumbnailWidth,previewWidthLarge:(h=i.validatedVideoInfo)==null?void 0:h.width,sortOrderMs:d("WATimeUtils").castToMillisTime(l!=null?l:i.ts*1e3),threadJid:e,transportKey:a,ts:d("WATimeUtils").castToUnixTime(l!=null?l/1e3:i.ts)};case"Ptt":return{duration:(k=i.validatedAudioInfo)!=null&&k.duration?i.validatedAudioInfo.duration*1e3:null,filesize:i.size,hasMedia:g,mediaId:i.mediaId,mediaType:i.mediaType,msgIds:f,offlineAttachmentId:j,plaintextHash:i.plaintextHash,previewHeight:null,previewHeightLarge:null,previewWidth:null,previewWidthLarge:null,sortOrderMs:d("WATimeUtils").castToMillisTime(l!=null?l:i.ts*1e3),threadJid:e,transportKey:a,ts:d("WATimeUtils").castToUnixTime(l!=null?l/1e3:i.ts)};case"Gif":return{accessibilitySummaryText:(b=i.accessibilitySummaryText)!=null?b:void 0,duration:null,filesize:i.size,hasMedia:g,mediaId:i.mediaId,mediaType:i.mediaType,msgIds:i.msgIds,offlineAttachmentId:j,plaintextHash:i.plaintextHash,previewHeight:(h=i.validatedImageInfo)==null?void 0:h.jpegThumbnailHeight,previewHeightLarge:(k=i.validatedImageInfo)==null?void 0:k.height,previewWidth:(b=i.validatedImageInfo)==null?void 0:b.jpegThumbnailWidth,previewWidthLarge:(h=i.validatedImageInfo)==null?void 0:h.width,sortOrderMs:d("WATimeUtils").castToMillisTime(l!=null?l:i.ts*1e3),threadJid:e,transportKey:a,ts:d("WATimeUtils").castToUnixTime(l!=null?l/1e3:i.ts)};case"Sticker":h=d("MAWImageUtils").boundHeightWidth((k=i.validatedImageInfo)==null?void 0:k.jpegThumbnailHeight,(b=i.validatedImageInfo)==null?void 0:b.jpegThumbnailWidth,d("MAWImageUtils").STICKER_THUMBNAIL_MAX_SIZE);k=h.height;b=h.width;return{accessibilitySummaryText:(h=i.accessibilitySummaryText)!=null?h:void 0,duration:null,filesize:i.size,hasMedia:g,mediaId:i.mediaId,mediaType:i.mediaType,msgIds:i.msgIds,offlineAttachmentId:j,plaintextHash:i.plaintextHash,previewHeight:k,previewHeightLarge:k,previewWidth:b,previewWidthLarge:b,sortOrderMs:d("WATimeUtils").castToMillisTime(l!=null?l:i.ts*1e3),threadJid:e,transportKey:a,ts:d("WATimeUtils").castToUnixTime(l!=null?l/1e3:i.ts)};case"DocumentFile":h={};for(k of i.mediaEntries){b=k[0];var m=k[1];m=d("WAMediaUtils").mediaEntryDataToRawData(i.plaintextHash,m);m=m.filename;m!=null&&(h[b]=m)}return{defaultFilename:(b=i.validatedDocumentFileInfo)==null?void 0:b.filename,duration:null,filenames:h,filesize:i.size,hasMedia:g,mediaId:i.mediaId,mediaType:i.mediaType,msgIds:f,offlineAttachmentId:j,plaintextHash:i.plaintextHash,previewHeight:null,previewHeightLarge:null,previewWidth:null,previewWidthLarge:null,sortOrderMs:d("WATimeUtils").castToMillisTime(l!=null?l:i.ts*1e3),threadJid:e,transportKey:a,ts:d("WATimeUtils").castToUnixTime(l!=null?l/1e3:i.ts)};default:i.mediaType;throw c("FBLogger")("messenger_web").mustfixThrow("[createBridgeMedia] Unsupported media type: "+i.mediaType)}}function j(a,b,c){return{chatJid:a,deliveredWatermarkTs:c!=null?c:d("WATimeUtils").castToUnixTime(0),fbid:b,lastReadActionTs:d("WATimeUtils").castToUnixTime(0),lastReadWatermarkTs:d("WATimeUtils").castToUnixTime(0)}}function k(a){var b=a.cannotReplyReason,c=a.folder,d=a.snippetParams,e=a.snippetSenderContactId,f=a.snippetType;a=a.threadJid;return{cannotReplyReason:b,folder:c,snippetContactIDs:d==null?void 0:d.contactIDs,snippetMentionJIDs:d==null?void 0:d.mentionJIDs,snippetParams:d==null?void 0:d.strings,snippetSenderContactId:e,snippetType:f,threadJid:a}}function l(a){return{chatJid:a.groupJid,memberAddMode:a.memberAddMode,threadName:a.name}}var m={snippetContactIDs:[],snippetMentionJIDs:[],snippetParams:[],snippetSenderContactId:null,snippetType:null};function n(a){var b,c=a.bumpTimestampMs,d=a.description,e=a.isMessageAuthorMe,f=a.isUnbump,g=a.skipBumpTimestampValidation,h=a.skipServerThreadBump,i=a.snippetData;a=a.threadJid;b=i==null?m:{snippetContactIDs:i.params.contactIDs,snippetMentionJIDs:(b=i.params.mentionJIDs)!=null?b:[],snippetParams:i.params.strings,snippetSenderContactId:i.senderContactId,snippetType:i.type};return babelHelpers["extends"]({},b,{bumpTimestampMs:c,description:d,isMessageAuthorMe:e,isUnbump:f,skipBumpTimestampValidation:g!=null?g:!1,skipServerThreadBump:h!=null?h:!1,threadJid:a})}function o(a){var b=a.author,c=a.chatJid,e=a.reaction,f=a.reactToMsgId;a=a.ts;return{actorId:d("WAJids").authorToUserId(b,d("WAJids").extractUserId(d("MAWUserJidWrapper").getMyUserJid())),chatJid:c,messageId:f,reaction:e,ts:a}}function p(a){var b=d("WAJids").extractUserId(d("MAWUserJidWrapper").getMyUserJid()),c=a.author,e=a.chatJid;a=a.reactToMsgId;return{actorId:d("WAJids").authorToUserId(c,b),chatJid:e,messageId:a}}function q(a){return{creationTs:a.creationTs,creator:a.creator,groupJid:a.groupJid,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion}}function r(a){var b=a.threadJid,c=a.inviteeJid;return{caption:a.caption,inviteCode:a.inviteCode,inviteeId:c,inviteExpireTs:a.inviteExpirationTs,inviterId:d("WAJids").extractUserId(a.inviterJid),threadJid:b}}function s(a){return{threadJid:a}}function t(a,b,c){return{senderId:d("WAJids").extractUserId(b),state:c,threadJid:a}}g.createBridgeUpdateE2EEMetadataParticipants=a;g.createBridgeDeletedMessage=h;g.createBridgeDeleteMessages=b;g.createBridgeRavenAction=e;g.getMsgIdsFilteredByJid=f;g.createBridgeMedia=i;g.createBridgeReceivedReceipt=j;g.createBridgeUpdatedThread=k;g.createBridgeUpdatedGroupInfo=l;g.createBridgeBumpedThreadV2=n;g.createBridgeUpsertReaction=o;g.createBridgeDeleteReaction=p;g.createBridgeGroupInfo=q;g.createBridgeGroupInvite=r;g.createBridgeDeleteGroupInvite=s;g.createBridgeReceivedChatState=t}),98);
__d("MAWCacheServiceBase",["MAWCacheServiceDB"],(function(a,b,c,d,e,f,g){"use strict";var h=["id"];a=function(){function a(a){this.$1=new Map(),this.namespace=a}var b=a.prototype;b.$2=function(a){return(a=this.$1.get(a))!=null?a:null};b.updateInMemoryCache=function(a,b){this.$1.set(a,b)};b.updateInMemoryCacheBulk=function(a){var b=this;a.forEach(function(a){var c=a[0];a=a[1];b.updateInMemoryCache(c,a)})};b.getValueFromCache=async function(a){var b=this,c=this.$2(a);if(c!=null)return c;c=await d("MAWCacheServiceDB").getOrSetupMAWCacheDB();c=await c.runInTransaction([this.namespace],"readonly",function(c){return c.stores[b.namespace].getByIndex("key",[a])},"read_from_persisted_"+this.namespace);if(c==null)return null;c.id;c=babelHelpers.objectWithoutPropertiesLoose(c,h);this.updateInMemoryCache(a,c);return c};return a}();g.default=a}),98);
__d("MAWDbParticipant",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a+"_"+b}f.craftParticipantId=a}),66);
__d("MAWDbThread",["MAWHexUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWHexUtils").orderPreservingHex(a)+"_"+b}g.craftThreadOrder=a}),98);
__d("MAWDexie",["cr:10766"],(function(a,b,c,d,e,f,g){"use strict";f.exports=b("cr:10766")}),34);
__d("MAWDexieTable",["MAWDexie","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return Promise.resolve(a)}function a(a){return a.reduce(function(a,b,c){return a.then(function(a){return b(c).then(function(b){a.push(b);return a})})},l([]))}function b(a){return c("MAWDexie").Promise.all(a)}function e(a){return c("MAWDexie").Promise.allSettled(a)}function f(a){return c("MAWDexie").Promise.PSD[a]}function i(a,b){c("MAWDexie").Promise.PSD[a]=b}function j(a){c("MAWDexie").Promise.PSD[a]=void 0}var k=function(){function a(a,b,d,e){d===void 0&&(d=!0);e=new(c("MAWDexie"))(a,babelHelpers.extends({},e,{chromeTransactionDurability:"relaxed",modifyChunkSize:c("justknobx")._("3166")}));b(e);this.name=a;this.stores=e;d&&this.open()}var b=a.prototype;b.open=function(){this.stores.open()};b.close=function(){this.stores.close()};b.transact=function(a,b,c){var d=this;return h(this.stores.transaction(a,b.map(function(a){return d.stores[a]}),async function(){var a=await c();return a}))};return babelHelpers.createClass(a,[{key:"tables",get:function(){return this.stores.tables}}])}();function l(a){return c("MAWDexie").Promise.resolve(a)}g.DEXIE_MIN_KEY=d("MAWDexie").Dexie.minKey;g.DEXIE_MAX_KEY=d("MAWDexie").Dexie.maxKey;g.undexify=h;g.dexieSequentialAll=a;g.dexieAll=b;g.dexieAllSettled=e;g.getDexiePSDItem=f;g.setDexiePSDItem=i;g.clearDexiePSDItem=j;g.DexieTable=k;g.dexieResolve=l}),98);
__d("MAWDbSchema.dexie",["FBLogger","MAWDbMsg","MAWDbParticipant","MAWDbThread","MAWDbVersionList","MAWDexie","MAWDexieTable","MAWFolderTypes","MAWLocalizationType","MAWODSProxy","MAWTimeUtils","WAJids","WALogger","WAMsg","WAMsgType","WAOdsEnums","WAStanzaUtils","WATimeUtils","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(a){var b=function(a){var b;b=(b=a.quote)==null?void 0:b.content;return a.quoteExternalId!=null&&(b==null?void 0:b.media)!=null};return a.messages.where("quoteExternalId").between(d("WAStanzaUtils").toStanzaId("0"),d("WAStanzaUtils").toStanzaId("["),!0,!0).filter(b).toArray()["catch"](function(){return a.messages.filter(b).toArray()}).then(function(b){var c=new Set(b.map(function(a){var b;a=(a=a.quote)==null?void 0:a.content;return a==null||(b=a.media)==null?void 0:b.plaintextHash}).filter(Boolean)),d=b.map(function(a){a=a.msgId;return a});return a.media.filter(function(a){a=a.plaintextHash;return c.has(a)}).toArray().then(function(b){var c=new Map(b.map(function(a){var b=a.mediaId;a=a.plaintextHash;return[a,b]}));return a.messages.where("msgId").anyOf(d).modify(function(a){var b;b=(b=a.quote)==null?void 0:b.content;a.quote.content.mediaId=c.get(b.media.plaintextHash);delete a.quote.content.media})})})};b=function(a){return a.groupInfo.toCollection().modify(function(a){typeof a.inviter==="number"&&delete a.inviter})};e=function(){return d("MAWDexieTable").dexieResolve()};f=function(a){return a.threads.filter(function(a){return d("WAJids").switchOnMsgrChatJidType(a.jid,{group:function(){return!1},user:function(){return a.oldestMsg!=null}})}).toArray().then(function(b){var c=[];b.forEach(function(a){c.push(a.oldestMsg),c.push(d("MAWDbMsg").toMsgId__UNSAFE_DO_NOT_USE(a.newestMsg))});return a.messages.where("msgId").anyOf(c.filter(Boolean)).toArray().then(function(c){var e=new Map(),f=[],g=[];c.forEach(function(a){e.set(a.msgId,a)});b.forEach(function(b){var c=e.get(b.oldestMsg),h=e.get(b.newestMsg);(c==null?void 0:c.type)==="Admin"&&(h==null?void 0:h.type)==="Admin"&&(c.msgId===h.msgId?g.push(b.chatId):f.push(b));return d("MAWDexieTable").dexieAll(f.map(function(b){return a.messages.where("thread").equals(b.chatId).toArray()})).then(function(b){b.forEach(function(a){if(a.length===0)return;var b=a[0].thread;a=a.filter(function(a){return a.type!=="Admin"});if(a.length>0)return;g.push(b)});return d("MAWDexieTable").dexieAll([a.threads.bulkDelete(g),a.messages.where("thread").anyOf(g)["delete"]()])})})})})};var j=function(a){return a.unrenderedMessages.toCollection().modify(function(a){if(a.type===d("WAMsgType").MSG_TYPE.DELETE_FOR_ME){var b=a.messageDeleteForMeTs;a.messageDeleteForMeTs=b}})},k=function(a){var b=0,e=0,f=c("MAWDexie").currentTransaction;if(f==null)throw c("FBLogger")("maw_db").mustfixThrow("transaction does not exist");f.on("complete",function(){b>0&&d("MAWODSProxy").odsBumpEntityKey({amount:b,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING_THREAD_JID,key:"fail"}),e>0&&d("MAWODSProxy").odsBumpEntityKey({amount:e,entity:d("WAOdsEnums").Entity.MESSAGE_MISSING,key:"fail"})});return a.threads.toArray().then(function(c){var f=c.reduce(function(a,b){b!=null&&a.set(b.chatId,b);return a},new Map());return d("MAWDexieTable").dexieAll([a.messages.toCollection().modify(function(a){if(a!=null){var c=f.get(a.thread);c!=null?a.threadJid=c.jid:b+=1}else e+=1}),a.unrenderedMessages.toCollection().modify(function(a){if(a!=null){var c=f.get(a.thread);c!=null?a.threadJid=c.jid:b+=1}else e+=1})])})},l=function(a){return a.isDualSend.toCollection().modify(function(a){a.version==null&&(a.version=1)})},m=function(a){return a.messages.toCollection().modify(function(a){a.type===d("WAMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION&&(a.altIndex=d("MAWDbMsg").craftE2eeAdminMsgAltIndex(a.thread))})},n=function(a){return a.messages.toCollection().modify(function(a){a.sortOrderMs=d("MAWDbMsg").getSortOrderWithFallback(a)})},o=function(a){return a.threads.toCollection().modify(function(a){a.folder==null&&(a.folder=d("MAWFolderTypes").FOLDER_ID.INBOX)})},p=function(a){return a.messages.toCollection().modify(function(a){a.sortOrderMs=d("MAWDbMsg").getSortOrderWithFallback(a)})},q=function(a){return a.personalSenderKeyStatuses.toCollection().modify(function(a){a.rotateSenderKey=!0,a.hasSenderKey=new Set()})},r=function(a){return a.messages.toCollection().modify(function(a){a.type===d("WAMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE&&a.sortOrderMs!=null&&a.sortOrderMs>0&&(a.sortOrderMs=0)})},s=function(a){return a.messages.toCollection().modify(function(a){!(a.type===d("WAMsgType").MSG_TYPE.ADMIN&&(a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION))&&a.sortOrderMs!=null&&a.sortOrderMs<1661204086&&(a.sortOrderMs=d("MAWDbMsg").getCanonicalTsFromMsg(a)*1e3)})},t=function(a){return a.threads.filter(function(a){return a.isMigratedLocally===!0&&a.newestMsg!=null}).toArray().then(function(b){var c=b.map(function(a){return a.chatId}),e=new Map();return d("MAWDexieTable").dexieAll(b.map(function(b){return a.messages.where(["thread","sortOrderMs"]).between([b.chatId,0],[b.chatId,Number.MAX_VALUE]).last().then(function(a){a!=null&&e.set(a.thread,a.msgId)})})).then(function(){return a.threads.where("chatId").anyOf(c)})})},u=function(){return d("MAWDexieTable").dexieResolve()},v=function(a){return a.threads.toCollection().modify(function(a){a.lastReadMsgTs!=null&&a.lastReadMsgTs<d("WATimeUtils").MAX_INT&&(a.lastReadMsgTs=d("MAWTimeUtils").ensureValidMillisTime(a.lastReadMsgTs));if(a.newestMsgTs!=null&&a.newestMsgTs<d("WATimeUtils").MAX_INT){var b=d("MAWTimeUtils").ensureValidMillisTime(a.newestMsgTs);a.newestMsgTs=b;b!=null&&(a.threadOrder=d("MAWDbThread").craftThreadOrder(b,a.jid))}})},w=function(a){return a.messages.toCollection().modify(function(a){a.type===d("WAMsgType").MSG_TYPE.ADMIN&&a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE&&(a.altIndex=d("MAWDbMsg").craftCutoverAdminMsgAltIndex(a.thread))})},x=function(){return d("MAWDexieTable").dexieResolve()},y=function(){return d("MAWDexieTable").dexieResolve()},z=function(){return d("MAWDexieTable").dexieResolve()},A=function(a){return a.participants.toCollection().modify(function(a){var b;if(a==null||((b=a.userJid)==null?void 0:b.indexOf("@msgr@msgr"))===!1)return;a.id=a.id.replace("@msgr@msgr","@msgr");a.userJid=a.userJid.replace("@msgr@msgr","@msgr")}).then(c("emptyFunction"))},B=function(a){var b=a.threads.filter(function(a){return a.snippetMsg!=null&&a.snippetMsgTs==null});return b.toArray().then(function(c){var e=c.reduce(function(a,b){b!=null&&b.snippetMsg!=null&&a.set(b.jid,b.snippetMsg);return a},new Map());c=Array.from(e.values());return a.messages.where("msgId").anyOf(c).toArray().then(function(a){var c=a.reduce(function(a,b){b!=null&&b.serverTs!=null&&a.set(b.msgId,b.serverTs);return a},new Map());b.modify(function(a){var b=e.get(a.jid);if(b!=null){b=c.get(b);b!=null&&(a.snippetMsgTs=d("WATimeUtils").castUnixTimeToMillisTime(b))}})})})},C=function(a){return a.threads.toArray().then(function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){return a.participants.where("threadId").equals(b.chatId).modify(function(a){a.threadJid=(a=a.threadJid)!=null?a:b.jid})}))})},D=C,E=function(a){var b=[];return a.groupInvites.toArray().then(function(c){var d=c.map(function(a){return a.invitedParticipantId});return a.participants.bulkGet(d).then(function(d){d.forEach(function(a,d){if(a==null){a=c[d];b.push(a)}});var e=d.filter(Boolean);return a.groupInvites.bulkPut(c.map(function(a){var c=e.find(function(b){return b.id===a.invitedParticipantId});if(c!=null){a.inviteeJid=c.userJid;a.threadJid=c.threadJid;return babelHelpers["extends"]({},a,{inviteeJid:c.userJid,threadJid:c.threadJid})}else{b.push(a);return a}}))})}).then(function(){return a.groupInvites.bulkDelete(b.map(function(a){return[a.invitedParticipantId,a.inviterJid]}))})},F=function(a){var b=new Map();return a.receipts.toArray().then(function(e){return d("MAWDexieTable").dexieAll(e.map(function(e){return a.messages.get({msgId:e.msgId}).then(function(f){if(f==null)return a.receipts["delete"](e.msgId).then(c("emptyFunction"));else{var g=d("WAMsg").craftWAMsgIdString({author:f.author,chat:f.threadJid,externalId:f.externalId});if(b.has(g)){var i;i=(i=b.get(g))!=null?i:1;b.set(g,i);d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Duplicate waMsgId found for receipt, number of duplicates: ",""])),i);return a.receipts["delete"](e.msgId).then(c("emptyFunction"))}else{b.set(g,1);return a.receipts.where("msgId").equals(f.msgId).modify(function(a){a.waMsgId=g}).then(c("emptyFunction"))}}})}))})},G=function(){return d("MAWDexieTable").dexieResolve()},H=function(a){return a.participants.toArray().then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({},a,{id:d("MAWDbParticipant").craftParticipantId(a.threadJid,a.userJid)})});b=b.map(function(a){return a.id});return a.participants.bulkDelete(b).then(function(){a.participants.bulkPut(c)})})},I=function(a){return a.reactions.toCollection().modify(function(a){a.ts=a.ts})};a=new Map([[(i=d("MAWDbVersionList")).VERSION.V26,a],[i.VERSION.V27,b],[i.VERSION.V28,e],[i.VERSION.V29,f],[i.VERSION.V30,j],[i.VERSION.V31,k],[i.VERSION.V43,l],[i.VERSION.V44,m],[i.VERSION.V45,n],[i.VERSION.V46,o],[i.VERSION.V47,p],[i.VERSION.V53,q],[i.VERSION.V54,r],[i.VERSION.V55,s],[i.VERSION.V56,t],[i.VERSION.V57,u],[i.VERSION.V58,v],[i.VERSION.V60,w],[i.VERSION.V66,x],[i.VERSION.V68,y],[i.VERSION.V71,z],[i.VERSION.V72,A],[i.VERSION.V82,B],[i.VERSION.V85,C],[i.VERSION.V87,D],[i.VERSION.V90,E],[i.VERSION.V91,F],[i.VERSION.V101,G],[i.VERSION.V104,H],[i.VERSION.V116,I]]);g.dbUpgrades=a}),98);
__d("MAWDbSchemaReStoreDexieUtils",["FBLogger","MAWDbSchema","MAWDbSchema.dexie","sortBy"],(function(a,b,c,d,e,f,g){"use strict";var h=c("sortBy")(Array.from(new Set([].concat(Array.from(d("MAWDbSchema").dbSchema.keys()),Array.from(d("MAWDbSchema.dexie").dbUpgrades.keys())))).map(function(a){return{schema:d("MAWDbSchema").dbSchema.get(a),upgrade:d("MAWDbSchema.dexie").dbUpgrades.get(a),version:a}}),function(a){a=a.version;return a}),i=function(a,b){return Array.from(a.filter(function(a){return a.version<=b&&a.schema!=null}).reduce(function(a,b){(b=b.schema)==null||b.forEach(function(b){a.set(b.name,b)});return a},new Map()).values())},j=function(a,b){return i(a,b).reduce(function(a,b){var d=b.autoIncrement,e=b.dexieOnly_primaryKeyUnique,f=b.name,g=b.primaryKey,h=b.removed;f=f.replace(/^e2ee_/,"");if(h===!0){a[f]=null;return a}if(d&&e===!0)throw c("FBLogger")("messenger_web").mustfixThrow("Invalid schema, cannot have both autoincremnet and unique constraints "+JSON.stringify(b));h=d?"++":"";d=e===!0?"&":"";e=""+(g.length>1?"[":"")+g.join("+")+(g.length>1?"]":"");g=Object.values(b.indexes).map(function(a){var b=a.columns,c=!(a.unique===!1),d=b.length>1;a=a.multiEntry_DO_NOT_USE===!0;c=c&&!a?"&":"";a=a?"*":"";c=""+c+a;return""+c+(d?"[":"")+b.join("+")+(d?"]":"")}).join(",");a[f]=[""+h+d+e,g].filter(Boolean).join(",");return a},{})};a=function(a){return j(h,a)};g.MAW_DB_VERSION_CHANGES=h;g.getDexieSchemaForVersion=j;g.getCompleteDexieSchemaForVersion=a}),98);
__d("MAWDbVersion",["MAWCurrentUser","MAWDbSchemaReStoreDexieUtils","MAWDbVersionList","MAWGetDbVersion","MAWIndexedDbMetadata","MAWODSProxy","MWFBLogger","Promise","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r=d("MWFBLogger").MWLogger().tags(["db","getDexieDbVersion"]);e=d("MAWGetDbVersion").getArmadilloDbVersion();f=d("MAWDbSchemaReStoreDexieUtils").getCompleteDexieSchemaForVersion(Math.min(d("MAWDbSchemaReStoreDexieUtils").MAW_DB_VERSION_CHANGES[d("MAWDbSchemaReStoreDexieUtils").MAW_DB_VERSION_CHANGES.length-1].version,e>0?e:Infinity));function s(a,b){var c=b.schema,d=b.upgrade;b=b.version;c!=null&&d!=null?a.version(b).stores(c).upgrade(d):c!=null?a.version(b).stores(c):d!=null?a.version(b).upgrade(d):a.version(b);return b}function t(a){return new(q||(q=b("Promise")))(function(b){if(!indexedDB){b();return}var c=indexedDB.open(a);c.onupgradeneeded=function(c){c.target.transaction.abort();c=c.target.result;r.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose([""," onupgradeneeded - closing db"])),a);c==null||c.close();b()};c.onsuccess=function(c){c=c.target.result;var e=c==null?void 0:c.version;r.DEBUG(i||(i=babelHelpers.taggedTemplateLiteralLoose([""," version: ",""])),a,e!=null?e:"null");c==null||c.close();e!=null?(e%10>=1&&d("MAWODSProxy").odsBumpEntityKey({amount:1,entity:d("WAOdsEnums").Entity.MAW_DB_UNEXPECTED_VERSION,key:"fail_"+e%10}),b(d("MAWDbVersionList").toVersion(e/10))):b()};c.onerror=function(c){var d;r.DEBUG(j||(j=babelHelpers.taggedTemplateLiteralLoose([""," error ",""])),a,c==null||(d=c.target)==null||(d=d.error)==null?void 0:d.message);b()};c.onblocked=function(b){b=b.target.result;var c=b==null?void 0:b.version;r.DEBUG(k||(k=babelHelpers.taggedTemplateLiteralLoose([""," blocked, version: ",""])),a,c!=null?c:"null");b==null||b.close()}})}function a(){var a=d("MAWCurrentUser").getID();return t(d("MAWIndexedDbMetadata").dbName(a))}function u(a,b){if(a.upgrade!=null||b.upgrade!=null)return!0;a=Object.keys((a==null?void 0:a.schema)||{});b=Object.keys((b==null?void 0:b.schema)||{});a=[].concat(a,b);b=new Set(a);return b.size!==a.length}function v(a){return a.reduce(function(a,b,c){if(c===0)return[babelHelpers["extends"]({},b,{schema:d("MAWDbSchemaReStoreDexieUtils").getCompleteDexieSchemaForVersion(b.version)})];c=a[a.length-1];b=babelHelpers["extends"]({},b,{schema:b.schema!=null?d("MAWDbSchemaReStoreDexieUtils").getDexieSchemaForVersion([b],b.version):null});if(u(c,b)){a.push(b);return a}a.splice(a.length-1,1,babelHelpers["extends"]({},c,b,{schema:babelHelpers["extends"]({},c==null?void 0:c.schema,b==null?void 0:b.schema)}));return a},[])}function c(a,b,c,e){var f=e!=null?e:d("MAWGetDbVersion").getArmadilloDbVersion==null?void 0:d("MAWGetDbVersion").getArmadilloDbVersion();r.DEBUG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["current db version: ",", target db version: ",""])),c,f);f==null&&r.WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["version is not set in QE"])));c!=null&&c>f&&(r.WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["current db version is greater than target db version"]))),f=c);e=d("MAWDbSchemaReStoreDexieUtils").MAW_DB_VERSION_CHANGES.filter(function(a){a=a.version;return c==null||a>c}).filter(function(a){a=a.version;return f==null||f>=a});var g=d("MAWDbSchemaReStoreDexieUtils").MAW_DB_VERSION_CHANGES.filter(function(a){a=a.version;return f==null||f>=a});if(e.length===0||e.length===g.length){r.DEBUG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Skipping db upgrade and just applying latest schema"])));b.addAnnotations({bool:{isUpgradeNeeded:!1}});g=d("MAWDbSchemaReStoreDexieUtils").MAW_DB_VERSION_CHANGES[d("MAWDbSchemaReStoreDexieUtils").MAW_DB_VERSION_CHANGES.length-1].version;g=Math.min(f!=null&&f>0?f:g,g);a.version(g).stores(d("MAWDbSchemaReStoreDexieUtils").getCompleteDexieSchemaForVersion(g));return g}g=v(e);r.DEBUG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Applying "," updates between "," and ",""])),g.length,e[0].version,e[e.length-1].version);e=g.filter(function(a){return!!a.upgrade}).map(function(a){return a.version.toString()});var h=g.filter(function(a){return!!a.schema}).map(function(a){return a.version.toString()});e.length&&b.addAnnotations({string_array:{dataMigrationVersions:e}});h.length&&b.addAnnotations({string_array:{schemaUpgradeVersions:h}});b.addAnnotations({bool:{isUpgradeNeeded:!0}});var i=0;g.forEach(function(b){i=Math.max((b=s(a,b))!=null?b:0,i!=null?i:0)});return i}g.CURRENT_MAW_STORES=f;g.getDexieDbVersion=t;g.getDBVersion=a;g.updateDB=c}),98);
__d("MAWDexieError",[],(function(a,b,c,d,e,f){"use strict";a="ModifyError";b="BulkError";c="OpenFailedError";d="VersionChangeError";e="SchemaError";var g="UpgradeError",h="InvalidTableError",i="MissingAPIError",j="NoSuchDatabaseError",k="InvalidArgumentError",l="SubTransactionError",m="UnsupportedError",n="InternalError",o="DatabaseClosedError",p="PrematureCommitError",q="ForeignAwaitError",r="UnknownError",s="ConstraintError",t="DataError",u="TransactionInactiveError",v="ReadOnlyError",w="VersionError",x="NotFoundError",y="InvalidStateError",z="InvalidAccessError",A="AbortError",B="TimeoutError",C="QuotaExceededError",D="SyntaxError",E="DataCloneError";A={AbortError:A,BulkError:b,ConstraintError:s,DatabaseClosedError:o,DataCloneError:E,DataError:t,ForeignAwaitError:q,InternalError:n,InvalidAccessError:z,InvalidArgumentError:k,InvalidStateError:y,InvalidTableError:h,MissingAPIError:i,ModifyError:a,NoSuchDatabaseError:j,NotFoundError:x,OpenFailedError:c,PrematureCommitError:p,QuotaExceededError:C,ReadOnlyError:v,SchemaError:e,SubTransactionError:l,SyntaxError:D,TimeoutError:B,TransactionInactiveError:u,UnknownError:r,UnsupportedError:m,UpgradeError:g,VersionChangeError:d,VersionError:w};f.DEXIE_ERROR=A}),66);
__d("MAWIDbSetupQplEventListener",["MAWDexieError","MAWQplProxy","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=null;function j(a){var b=new Set(Object.keys(d("MAWDexieError").DEXIE_ERROR));b.has(a.reason)&&h!=null&&(h.endFail(a.reason),d("MAWQplProxy").sendQplPointThroughBridge(c("qpl")._(25310776,"6155"),"database_setup_failed"),i!=null&&(i(),i=null))}b=function(b,c){h=b;i=c;a.addEventListener("unhandledrejection",j);return function(){return a.removeEventListener("unhandledrejection",j)}};g.trackDbSetupFailure=b}),98);
__d("MAWLowLevelApiTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a={EXISTING_GROUP_INVITE:"existing_group_invite",MISSING_GROUP:"missing_group"};c={EXPIRED_GROUP_INVITE:"expired_group_invite",MISSING_GROUP:"missing_group",MISSING_GROUP_INVITE:"missing_group_invite"};d=b("$InternalEnum")({Initializing:"initializing",Open:"open",Closed:"closed",Error:"error",Upgrading:"upgrading"});f.WRITE_GROUP_INVITE_ERROR=a;f.GET_GROUP_INVITE_ERROR=c;f.DatabaseState=d}),66);
__d("MAWDbFactory",["ClientConsistencyEventEmitter","Deferred","MAWCurrentUser","MAWDbVersion","MAWDexieTable","MAWGetDbVersion","MAWIDbSetupQplEventListener","MAWIndexedDBDeletion","MAWIndexedDbMetadata","MAWLowLevelApiTypes","MAWQplProxy","MAWReliabilityMonitor","MWFBLogger","gkx","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q=["backendInitPromise","middleware","onDbPopulate"];function a(a,b){var e=null,f=d("MWFBLogger").MWLogger().tags(["db",a,b]),g=new(c("Deferred"))(),r=!1,s=!1,t,u=!1,v=null,w=b!=="worker"?null:d("MAWReliabilityMonitor").MAWReliabilityMonitorSingleton.startMonitoring("DB_"+a+"_"+b,function(){return{extra:{isMakingDB:String(r),willBeSetup:String(s)},reason:String(v),state:function(){if(v==null)return d("MAWReliabilityMonitor").HealthReportState.UNKNOWN;switch(v){case d("MAWLowLevelApiTypes").DatabaseState.Initializing:case d("MAWLowLevelApiTypes").DatabaseState.Upgrading:return d("MAWReliabilityMonitor").HealthReportState.PENDING;case d("MAWLowLevelApiTypes").DatabaseState.Open:return d("MAWReliabilityMonitor").HealthReportState.OK;case d("MAWLowLevelApiTypes").DatabaseState.Closed:case d("MAWLowLevelApiTypes").DatabaseState.Error:return d("MAWReliabilityMonitor").HealthReportState.ERROR}}()}});function x(){g=new(c("Deferred"))(),t==null||t(),r=!1,s=!1}function y(){return s}function z(){return g.getPromise().then(function(){return u})}async function A(y,z,A){var B=z.backendInitPromise,C=z.middleware,D=z.onDbPopulate;z=babelHelpers.objectWithoutPropertiesLoose(z,q);var E=d("MAWCurrentUser").getID();E=d("MAWIndexedDbMetadata").dbName(E);var F=c("qpl")._(25310776,"6155");function G(a){v=a,w==null||w.updateState()}if(e!=null){f.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["DB exists"])));d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_exsists");return}var H=d("MAWQplProxy").startQplUserFlow(c("qpl")._(1056836116,"905"),{string:{db:a,name:E}});s=!0;if(r){d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_make_in_progress");return g.getPromise()}f.DEBUG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Starting DB Setup"])));r=!0;d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_make_started");t=d("MAWIDbSetupQplEventListener").trackDbSetupFailure(H,function(){G(d("MAWLowLevelApiTypes").DatabaseState.Error),g.reject("DB setup failed"),d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_setup_failed"),x()});G(d("MAWLowLevelApiTypes").DatabaseState.Initializing);var I=await d("MAWDbVersion").getDexieDbVersion(E);I==null&&(u=!0);H.addAnnotations({int:{currentVersion:I}});var J=A!=null?A:d("MAWGetDbVersion").getArmadilloDbVersion();H.addAnnotations({int:{targetVersion:J}});if(B&&(I||0)<J){H.addPoint("separate_read_waiting_on_worker_upgrade");f.DEBUG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Waiting for worker to upgrade schema..."])));try{await B}catch(a){throw f.catching(a).mustfixThrow("Worker startup promise rejected, schema upgrade failed.")}var K=await d("MAWDbVersion").getDexieDbVersion(E);if(K!==J)throw f.mustfixThrow("Main thread waiting on worker schema upgrade from %s to %s, upgrade failed with version %s",I,J,K);I=K}else b==="worker"&&(d("MAWQplProxy").sendQPLIntAnnotationThroughBridge(c("qpl")._(1056839232,"112"),"dbVersion",I!=null?I:0),d("MAWQplProxy").sendQPLIntAnnotationThroughBridge(c("qpl")._(1056839232,"112"),"useSentBytesCache",c("gkx")("33008")?1:0));var L=function(e){e=d("MAWDbVersion").updateDB(e,H,I,A);!B&&b==="worker"&&d("MAWQplProxy").sendQPLBoolAnnotationThroughBridge(c("qpl")._(1056839232,"112"),"dbUpgradeNeeded",I!==e);f.DEBUG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["latest pushed version: ",", current: ",", requested: ",""])),e,I,A!=null?A:"<latest>");b==="worker"&&(I!==e?d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_version_upgraded"):d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_version_upgrade_not_required"));return e};e=new(d("MAWDexieTable").DexieTable)(E,function(e){C.forEach(function(a){e.use(a(y))});var h=L(e);e.on("populate",function(b){if(!b){G(d("MAWLowLevelApiTypes").DatabaseState.Error);g.reject("Missing DB for populate event");H.endFail("on_populata-missing_txn");d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_on_populate_missing_txn");return}f.info("MAWDB populated. HasPopulateEvent: %s",Boolean(D));D==null||D(b)});e.on("blocked",function(){f.MUSTFIX(l||(l=babelHelpers.taggedTemplateLiteralLoose(["DB Open blocked"]))),G(d("MAWLowLevelApiTypes").DatabaseState.Error),g.reject("DB Open blocked"),H.endFail("db_blocked"),d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_blocked"),x()});e.on("ready",function(b){f.DEBUG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["MAW DB setup complete"])));r=!1;if(b==null){G(d("MAWLowLevelApiTypes").DatabaseState.Error);f.MUSTFIX(n||(n=babelHelpers.taggedTemplateLiteralLoose(["DB is null"])));g.reject("DB is null");H.endFail("db_null");d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_null");x();return}G(d("MAWLowLevelApiTypes").DatabaseState.Open);t==null||t();g.resolve();H.endSuccess({int:{dbVersion:h}});d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_ready")});e.on("close",function(){G(d("MAWLowLevelApiTypes").DatabaseState.Closed),f.WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["DB forcibly closed"]))),d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_forcibly_closed")});e.on("versionchange",function(e){f.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Versionchange detected: ("," -> "," (event version: ",", highestUsed: (","), name: ",""])),e==null?void 0:e.oldVersion,e==null?void 0:e.newVersion,String(e==null?void 0:e.version),h,e==null?void 0:e.name),G(d("MAWLowLevelApiTypes").DatabaseState.Upgrading),b!=="worker"&&c("ClientConsistencyEventEmitter").emit("softRefresh","mawdb_versionchange"),d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_versionchange")})},void 0,z);d("MAWQplProxy").sendQplPointThroughBridge(F,"database_"+a+"_make_requested");return g.getPromise()}function B(a){if(e==null)throw f.mustfixThrow('IndexDB has not been initialized before executing "'+(a!=null?a:"unnamed")+'"');return e}function C(a){if(e!=null&&!r)return Promise.resolve(e);g=g||new(c("Deferred"))();return g.getPromise().then(function(){return B(a)})}async function D(){var a=await C();a!=null&&(a.close(),e=null);x()}function E(){e=null,x()}function F(a){c("promiseDone")(D());a=d("MAWIndexedDbMetadata").dbName(a!=null?a:d("MAWCurrentUser").getID());c("promiseDone")(d("MAWIndexedDBDeletion").deleteDB(a,"maw"));w==null||w.stopMonitoring()}return{closeDB:D,deleteDb:F,getDB:C,getDBExn:B,isNewDb:z,makeDB:A,reset_singleton_INTERNAL_ONLY:E,setupPromise:function(){return g.getPromise()},willSetupDB:y}}g.makeIDBFactory=a}),98);
__d("MAWIndexedDbUI",["ExecutionEnvironment","MAWDbFactory","MAWDbMutationMiddleware","MAWDbProtocolMsgIdMiddleware","MAWDexieTable","MAWIndexedDb","MAWTransactor","Promise","cr:3527","gkx","performance"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(){var a=d("MAWDbFactory").makeIDBFactory("ui_idb","main");return{closeDB:a.closeDB,deleteDb:a.deleteDb,getDB:a.getDB,makeDB:function(e,f,g){var h=[d("MAWDbMutationMiddleware").getMAWDbMutationMiddleware];c("gkx")("1760")&&h.push(d("MAWDbProtocolMsgIdMiddleware").MAWDbProtocolMsgIdMiddleware);b("cr:3527")!=null&&h.push(b("cr:3527"));e=a.makeDB(e,{autoOpen:c("gkx")("6817"),backendInitPromise:f.backendInitPromise,cache:"disabled",middleware:h,onDbPopulate:f.onDbPopulate},g);return e},reset_singleton_INTERNAL_ONLY:a.reset_singleton_INTERNAL_ONLY}}e=a();f=e.makeDB;var k=e.closeDB,l=e.getDB,m=e.deleteDb;e=e.reset_singleton_INTERNAL_ONLY;var n=(i||(i=c("ExecutionEnvironment"))).isInBrowser?l("MawDbInUISingleton_INTERNAL_ONLY").then(function(a){return{openReadonlyTransaction:function(b,e,f){return a.stores.transaction("r",e,function(){d("MAWDexieTable").setDexiePSDItem("transactorName",b);d("MAWDexieTable").setDexiePSDItem("transactionRequested",(j||(j=c("performance"))).now()+j.timeOrigin);return f(a.stores)})},openReadWriteTransaction:function(b,e,f){return a.stores.transaction("rw",e,function(){d("MAWDexieTable").setDexiePSDItem("transactorName",b);d("MAWDexieTable").setDexiePSDItem("transactionRequested",(j||(j=c("performance"))).now()+j.timeOrigin);return f(a.stores)})}}}):new(h||(h=b("Promise")))(function(){});g.makeMsgrTransactor=d("MAWTransactor").makeMsgrUITransactor_IMPORT_FROM_MAWIndexedDbUI_INSTEAD;g.afterTransaction=d("MAWIndexedDb").afterTransaction;g.makeMAWIndexedDBFactory=a;g.makeDB=f;g.closeDB=k;g.getDB=l;g.deleteDb=m;g.reset_singleton_INTERNAL_ONLY=e;g.MawDbInUISingleton=n}),98);
__d("MAWWorkerCacheServiceRegistry",["MAWSnippetsCacheService"],(function(a,b,c,d,e,f,g){"use strict";var h={snippets:d("MAWSnippetsCacheService").getMAWSnippetsCacheService()};function a(){return h}g.getWorkerRegistry=a}),98);
__d("WorkerSchedulerPriority",[],(function(a,b,c,d,e,f){"use strict";a=2;b=1;c=0;f.BACKGROUND_PRIORITY=a;f.REGULAR_PRIORITY=b;f.BLOCKING_PRIORITY=c}),66);
__d("WorkerScheduler",["$InternalEnum","Promise","QPLFlow","QuickPerformanceLogger","WAGetSafeQPLError","WAResolvable","WAShiftTimer","WATagsLogger","WATimeUtils","WorkerSchedulerPriority","err","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=d("WATagsLogger").TAGS(["WorkerScheduler"]),w=0,x=100,y=3e4,z=10,A=6e4,B=b("$InternalEnum")({CREATED:0,SCHEDULED:1,RUNNING:2,COMPLETED:3,CANCELLED:-3,FAILED:-2,STUCK:-1}),C=function(){function a(a,b){var c;this.$3=!1;this.$4=new Map();this.$5=new Map();this.$6=new Map();this.$7=[new Set(),new Set(),new Set()];this.$8=[new((c=d("WAResolvable")).Resolvable)(),new c.Resolvable(),new c.Resolvable()];this.$9=new c.Resolvable();this.$1=a;this.config=b;this.$2=v.TAGS([a])}var e=a.prototype;e.waitUntilEndReached=function(){return this.$9.promise};e.waitUntilBlockingEnded=function(){return this.$8[d("WorkerSchedulerPriority").BLOCKING_PRIORITY].promise};e.waitUntilRegularEnded=function(){return this.$8[d("WorkerSchedulerPriority").REGULAR_PRIORITY].promise};e.waitUntilBackgroundEnded=function(){return this.$8[d("WorkerSchedulerPriority").BACKGROUND_PRIORITY].promise};e.getDebugState=function(){var a=this,b=Date.now();return{activeTasks:Array.from(this.$6.entries()).map(function(c){var d=c[0];c=c[1];d=a.$5.get(d);return!d||d.startTime==null?null:{executionTimeMs:b-d.startTime,priority:c,task:d.name,waitTimeMs:b-d.scheduledTime}}).filter(Boolean),pendingTasksByPriority:this.$7.map(function(c){var d=[];c.forEach(function(c){c=a.$5.get(c);if(!c)return;d.push({task:c.name,waitTimeMs:b-c.scheduledTime})});return d})}};e.$10=function(){if(this.$6.size<this.config.maxConcurrency){var a=this.pendingTasksTick({increaseCounter:!1,lowestTier:this.$3?d("WorkerSchedulerPriority").BACKGROUND_PRIORITY:d("WorkerSchedulerPriority").BLOCKING_PRIORITY,tasksToPick:1,tickDelta:0});a=a.candidates;var b=E.getHighestActivePriority();a.length>0&&this.maybeStartTask(a[0].id,b)}};e.runTask=function(a){return this.task(a).run()};e.task=function(a){var b,c=this.$1+":"+a.name+":"+w++;b=(b=a.priority)!=null?b:d("WorkerSchedulerPriority").REGULAR_PRIORITY;a=this.$11(c,{annotations:a.annotations,customFlags:a.customFlags,eventSamplingRate:a.eventSamplingRate,fn:a.fn,name:a.name,priority:b});this.$4.set(c,a);return a.publicApi};e.$12=function(a){var d=this.$4.get(a);if(d==null)return(u||(u=b("Promise"))).reject(c("err")("Cannot run task from Scheduler:"+this.$1+" Task was already cancelled"));d.publicApi.status=B.SCHEDULED;this.$5.set(a,d);this.$7[d.priority].add(a);this.$13(d.priority);d.metric.addPoint("schedule_start");E.scheduleTimerIfNeeded();this.$10();return d.resolvable.promise};e.$11=function(a,b){var c,e=this,f=new(d("WAResolvable").Resolvable)();c=d("QPLFlow").startQplFlowWithCoinflip(F,b.eventSamplingRate!=null?b.eventSamplingRate:this.config.defaultSamplingRate,{annotations:{bool:babelHelpers["extends"]({},(c=b.annotations)==null?void 0:c.bool,b.customFlags),"int":babelHelpers["extends"]({},(c=b.annotations)==null?void 0:c["int"],{originalPriority:b.priority}),string:babelHelpers["extends"]({},(c=b.annotations)==null?void 0:c.string,{name:b.name,scheduler:this.$1,workerID:self!=null&&"worker_id"in self?self.worker_id:void 0})}});var g={fn:b.fn,id:a,loggingParams:{},maxTickDelta:0,metric:c,name:b.name,priority:b.priority,publicApi:{cancel:function(){if(g.publicApi.status!==B.CREATED&&g.publicApi.status!==B.SCHEDULED)return!1;e.$14(a,B.CANCELLED);return e.$4["delete"](a)},id:a,name:b.name,promise:f.promise,promote:function(a){e.$2.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Promoting "," from "," to ",""])),g.id,g.priority,a);if((g.publicApi.status===B.CREATED||g.publicApi.status===B.SCHEDULED)&&g.priority>a){e.$15(g,a);return!0}return!1},run:function(){return e.$12(a)},status:B.CREATED},resolvable:f,scheduledTime:Date.now(),startTime:null,tickCounter:0,waitCounter:0};return g};e.$14=function(a,b){var c=this.$5.get(a),e=c==null?void 0:c.publicApi.status;if(c==null||e===B.COMPLETED||e===B.FAILED||e===B.STUCK)return;this.$5["delete"](a);this.$6["delete"](a);c.publicApi.status=b;var f=[this.$7[d("WorkerSchedulerPriority").BLOCKING_PRIORITY].size===0,this.$7[d("WorkerSchedulerPriority").REGULAR_PRIORITY].size===0,this.$7[d("WorkerSchedulerPriority").BACKGROUND_PRIORITY].size===0];this.$6.forEach(function(a){f[a]=!1});f[d("WorkerSchedulerPriority").BLOCKING_PRIORITY]&&f[d("WorkerSchedulerPriority").REGULAR_PRIORITY]&&f[d("WorkerSchedulerPriority").BACKGROUND_PRIORITY]&&this.$9.resolve();for(e=d("WorkerSchedulerPriority").BLOCKING_PRIORITY;e<=d("WorkerSchedulerPriority").BACKGROUND_PRIORITY;e++)f[e]&&this.$8[e].resolve()};e.maybeStartTask=function(a,b){var c=this.$5.get(a);if(c==null){this.$2.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Safeguard: Task without corresponding record: Task: ",", Scheduler: ",""])),a,this.$1);return}if(b==null||this.$3===!0)return this.$16(c);if(b<c.priority)return;return this.$16(c)};e.$16=function(a){var c=this;this.$7[a.priority]["delete"](a.id);this.$6.set(a.id,a.priority);this.$2.TAGS([a.name]).LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Started: ",""])),a.id);a.startTime=Date.now();a.publicApi.status=B.RUNNING;a.metric.addPoint("schedule_end",{"int":{priorityTier:a.priority,waitTicks:a.waitCounter}});a.metric.addPoint("run_start",{"int":{startPriority:a.priority}});var e;try{e=a.fn({metric:a.metric})}catch(a){e=(u||(u=b("Promise"))).reject(a)}e.then(function(b){a.resolvable.resolve(b),c.$2.TAGS([a.name]).LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Completed: ",""])),a.id),a.metric.addPoint("run_end",{"int":{executionTicks:a.tickCounter}}),c.$14(a.id,B.COMPLETED),a.metric.endSuccess({"int":{maxTickDeltaMs:a.maxTickDelta}}),c.$10()})["catch"](function(b){a.resolvable.reject(b),c.$2.TAGS([a.name]).WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Failed: ",""])),a.id),a.metric.addPoint("run_fail"),c.$2.TAGS([a.name]).ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Debug params: "," failed: ",""])),a.loggingParams,b),c.$14(a.id,B.FAILED),a.metric.endFail("runtime",{"int":{maxTickDeltaMs:a.maxTickDelta},string:{jsError:d("WAGetSafeQPLError").getSafeQPLErrorMessage(b)}}),c.$10()})};e.$13=function(a){for(var b=d("WorkerSchedulerPriority").BLOCKING_PRIORITY;b<=a;b++)this.$8[b].resolveWasCalled()&&(this.$8[b]=new(d("WAResolvable").Resolvable)());this.$9.resolveWasCalled()&&(this.$9=new(d("WAResolvable").Resolvable)())};e.getHighestActivePriority=function(){var a=this,b=null;this.$6.forEach(function(c,d){c=a.$5.get(d);if(c==null){v.ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Safeguard: Active task without corresponding record: Task: ",", Scheduler: ",""])),d,a.$1);a.$6["delete"](d);return}(b==null||b>c.priority)&&(b=c.priority)});return b};e.activeTasksTick=function(a){var b=this,d=null;this.$6.forEach(function(e,f){e=b.$5.get(f);if(e==null){v.ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Safeguard: Active task without corresponding record: Task: ",", Scheduler: ",""])),f,b.$1);b.$6["delete"](f);return}e.tickCounter++;e.maxTickDelta=Math.max(a,e.maxTickDelta);(d==null||d>e.priority)&&(d=e.priority);e.tickCounter>b.config.ticksToStuck&&e.publicApi.status===B.RUNNING&&(v.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Possibly stuck: ",""])),e.name),b.$14(e.id,B.STUCK),e.resolvable.reject(c("err")("Stuck")),e.metric.endFail("stuck",{"int":{maxTickDeltaMs:e.maxTickDelta}}))});return d};e.$15=function(a,b){function c(){switch(e){case d("WorkerSchedulerPriority").BACKGROUND_PRIORITY:return d("WorkerSchedulerPriority").REGULAR_PRIORITY;case d("WorkerSchedulerPriority").REGULAR_PRIORITY:return d("WorkerSchedulerPriority").BLOCKING_PRIORITY;default:return d("WorkerSchedulerPriority").BLOCKING_PRIORITY}}var e=a.priority;b=b!=null?b:c();if(b===e)return;a.metric.addPoint("promote_to_"+b);this.$7[e]["delete"](a.id);a.priority=b;this.$7[b].add(a.id)};e.pendingTasksTick=function(a){var b=this,c=a.increaseCounter,e=a.lowestTier,f=a.tasksToPick,g=a.tickDelta,h=[],i=!0;a=function(a){i&&(i=b.$7[a].size===0),b.$7[a].forEach(function(e){var i=b.$5.get(e);if(i==null){v.ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Safeguard: Pending task without corresponding record: Task: ",", Scheduler: ",""])),e,b.$1);b.$7[a]["delete"](e);return}c&&(i.waitCounter++,i.maxTickDelta=Math.max(g,i.maxTickDelta),i.priority>d("WorkerSchedulerPriority").REGULAR_PRIORITY&&i.waitCounter>=b.config.throttleTicks&&b.$15(i),i.priority===d("WorkerSchedulerPriority").REGULAR_PRIORITY&&i.waitCounter>=E.maxWaitTicksMultiplierForFinalPromotion*b.config.throttleTicks&&(v.LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Promoting task ",":"," to blocking priority"])),b.$1,i.name),b.$15(i)));if(h.length>=f)return;if(b.$6.size+h.length>=b.config.maxConcurrency)return;h.push(i)})};for(var j=d("WorkerSchedulerPriority").BLOCKING_PRIORITY;j<=e;j++)a(j);return{candidates:h.map(function(a){return{id:a.id,priority:a.priority}}),isEmpty:i}};e.TEST_ONLY_ignore_delays=function(){this.$3=!0};return a}(),D=function(){function a(){var a=this;this.$1=new Map();this.tickFrequencyMs=x;this.maxThrottleMs=A;this.maxWaitTicksMultiplierForFinalPromotion=z;this.$2=null;this.$3=new(d("WAShiftTimer").ShiftTimer)(function(){var b=!1;try{var c,e=d("WATimeUtils").performanceAbsoluteNow();b=a.$4(e-((c=a.$2)!=null?c:e))}catch(a){v.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Scheduler fatal: ",""])),a)}finally{b===!1?(a.$2=d("WATimeUtils").performanceAbsoluteNow(),a.$3.onOrBefore(a.tickFrequencyMs)):a.$2=null}});this.$5=new Map()}var b=a.prototype;b.getHighestActivePriority=function(){var a=null;this.$5.forEach(function(b){b=b.getHighestActivePriority();a!=null&&b!=null&&a<b&&(a=b);a==null&&b!=null&&(a=b)});return a};b.$4=function(a){var b,c=!0,e=null;this.$5.forEach(function(b){b=b.activeTasksTick(a);e!=null&&b!=null&&e<b&&(e=b);e==null&&b!=null&&(e=b)});var f=[[],[],[]];this.$5.forEach(function(b){var e=b.pendingTasksTick({increaseCounter:!0,lowestTier:d("WorkerSchedulerPriority").BACKGROUND_PRIORITY,tasksToPick:b.config.concurrency,tickDelta:a}),g=e.candidates;e=e.isEmpty;c&&(c=e);g.forEach(function(a){f[a.priority].push({id:a.id,scheduler:b})})});b=(b=f.find(function(a){return a.length>0}))!=null?b:[];for(b of b){var g=b.id,h=b.scheduler;h.maybeStartTask(g,e)}return c};b.scheduleTimerIfNeeded=function(){this.$3.onOrBefore(this.tickFrequencyMs)};b.newScheduler=function(a,b){var c=this.$5.get(a);if(c)return c;c=new C(a,b);this.$5.set(a,c);return c};b.TEST_ONLY_reset=function(){this.$5=new Map(),this.$1=new Map()};return a}(),E=new D(),F=c("qpl")._(1056838280,"1566");function a(a,b){return E.newScheduler(a,{concurrency:(a=b.concurrency)!=null?a:1,defaultSamplingRate:(a=b.defaultSamplingRate)!=null?a:1e4,maxConcurrency:b.maxConcurrency,throttleTicks:Math.round(((a=b.maxThrottleMs)!=null?a:E.maxThrottleMs)/E.tickFrequencyMs),ticksToStuck:Math.round(((a=b.timeToStuckMs)!=null?a:y)/E.tickFrequencyMs)})}function e(a){a.tickFrequencyMs!=null&&(E.tickFrequencyMs=a.tickFrequencyMs),a.maxThrottleMs!=null&&(E.maxThrottleMs=a.maxThrottleMs),a.maxWaitTicksMultiplierForFinalPromotion!=null&&(E.maxWaitTicksMultiplierForFinalPromotion=a.maxWaitTicksMultiplierForFinalPromotion),a.qplEventType!=null&&(F=a.qplEventType),(t||(t=c("QuickPerformanceLogger"))).setAlwaysOnSampleRate(F,1)}function f(){E.TEST_ONLY_reset()}g.BACKGROUND_PRIORITY=d("WorkerSchedulerPriority").BACKGROUND_PRIORITY;g.BLOCKING_PRIORITY=d("WorkerSchedulerPriority").BLOCKING_PRIORITY;g.REGULAR_PRIORITY=d("WorkerSchedulerPriority").REGULAR_PRIORITY;g.SchedulerExecutionState=B;g.makeScheduler=a;g.configWorkerScheduler=e;g.TEST_ONLY_reset=f}),98);
__d("MAWWorkerCacheServices",["FBLogger","MAWBridge","MAWCacheServiceDB","MAWCacheServiceQPL","MAWCacheServiceUtils","MAWLoggerUtils","MAWWorkerCacheServiceRegistry","WorkerScheduler","cr:2354"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(){this.$1=d("MAWCacheServiceUtils").getMAWCacheServiceBroadcastChannel();var a=d("MAWWorkerCacheServiceRegistry").getWorkerRegistry();this.registry=a;this.schedulerRegistry=Object.keys(a).reduce(function(a,b){return babelHelpers.extends({},a,(a={},a[b]=d("WorkerScheduler").makeScheduler(d("MAWCacheServiceUtils").getSchedulerName(b),d("MAWCacheServiceUtils").SCHEDULER_CONFIG),a))},{})}var e=a.prototype;e.$2=function(a,b,c,e){b={cache:b,instanceKey:e,namespace:a,source:c};this.$1==null?d("MAWBridge").getBridge().fireAndForget("event","broadcastChannelFallback",{event:{data:b},namespace:d("MAWCacheServiceUtils").MAW_CACHE_SERVICE_BROADCAST_CHANNEL}):this.$1.postMessage(b)};e.$3=async function(a,e,f,g){var h=d("MAWCacheServiceUtils").findDuplicates(e,function(a){var b=a[0];a[1];return b});h.length>0&&(c("FBLogger")("MAWCacheService").mustfix("Found duplicate keys in cache: %s. Original keys: %s, Namespace: %s, Source: %s",h.map(function(a){var b=a[0];a[1];return b}).join(", "),e.map(function(a){var b=a[0];a[1];return b}).join(", "),a,f),g!=null&&c("MAWCacheServiceQPL").addAnnotationsQPL(g,{bool:{hasDuplicateKeys:!0},string_array:{duplicateKeys:c("MAWCacheServiceQPL").redactKeysForNonEmployee(h.map(function(a){var b=a[0];a[1];return b}))}}));if(e.length===0){g!=null&&(c("MAWCacheServiceQPL").addPointQPL(g,"nothing_to_update_in_cache",f),c("MAWCacheServiceQPL").endSuccessQPL(g));return}g!=null&&c("MAWCacheServiceQPL").addPointQPL(g,"updating_cache_in_persisted_start",f);h=this.registry[a];h.updateInMemoryCacheBulk(e);try{var i=d("MAWCacheServiceDB").convertCacheValueToDBRawValue(e);h=await d("MAWCacheServiceDB").getOrSetupMAWCacheDB();await h.runInTransaction([a],"readwrite",function(b){var c=i.map(function(a){return{item:a,selector:[a.key]}});return b.stores[a].bulkUpsert("key",c)},"update_cache_"+a);f==="realtime-update"&&(b("cr:2354")==null||b("cr:2354").notifyCacheWrite(i.map(function(a){a=a.key;return a}),this.schedulerRegistry[a]));g!=null&&c("MAWCacheServiceQPL").addPointQPL(g,"updating_cache_in_persisted_end",f)}catch(a){g!=null&&(c("MAWCacheServiceQPL").addAnnotationsQPL(g,{string:{error:a.message}}),c("MAWCacheServiceQPL").addPointQPL(g,"updating_cache_in_persisted_failed",f)),c("FBLogger")("MAWCacheService").catching(a).mustfix("Failed to update persisted cache")}g!=null&&c("MAWCacheServiceQPL").addPointQPL(g,"broadcasting_to_ui_start",f);this.$2(a,e,f,g)};e.calculateDelta=function(a){var b=this,e=Object.values(this.registry).map(function(e){var f=e.shouldDropDelta(a);return f.then(function(f){if(f)return;f=b.schedulerRegistry[e.namespace];return f.runTask({fn:function(){return e.calculateDelta(a).then(function(a){var f=a.map(function(a){var b=a[0];a[1];return b}),g=d("MAWLoggerUtils").getInstanceKey();a.length!==0&&(c("MAWCacheServiceQPL").startQPL(g,e.namespace),c("MAWCacheServiceQPL").addAnnotationsQPL(g,{bool:{isRealtimeUpdate:!0},int:{instanceKey:g},string_array:{realtimeUpdatedKeys:f}}));return b.$3(e.namespace,a,"realtime-update",g)}).catch(function(a){c("FBLogger")("MAWCacheService").catching(a).warn("Failed to calculate delta for: %s",e.namespace)})},name:"maw_calculate_delta",priority:d("WorkerScheduler").REGULAR_PRIORITY})})});Promise.all([].concat(e)).catch(function(a){c("FBLogger")("MAWCacheService").catching(a).mustfix("Failed to calculate delta for all services")})};e.computeCachePayloadFromScratch=function(a,b,e,f){var g=this;f!=null&&c("MAWCacheServiceQPL").registerInstanceKeyInWorker(f);c("MAWCacheServiceQPL").addPointQPL(f,"compute_from_scratch_start",e);c("MAWCacheServiceQPL").addAnnotationsQPL(f,{string_array:{keysReceivedInWorker:c("MAWCacheServiceQPL").redactKeysForNonEmployee(b)}});var h=this.registry[a],i=this.schedulerRegistry[h.namespace];if(h==null)throw c("FBLogger")("messenger_web").mustfixThrow("No service found for namespace: "+a);return i.runTask({fn:function(){return h.computeCachePayloadFromScratch(b).then(function(b){c("MAWCacheServiceQPL").addPointQPL(f,"compute_from_scratch_end",e);return g.$3(a,b,e,f)}).catch(function(a){c("MAWCacheServiceQPL").endFailureQPL(f,"compute_from_scratch_failed",e),c("FBLogger")("MAWCacheService").catching(a).warn("Failed to compute cache payload from scratch")})},name:"maw_compute_cache_payload_from_scratch",priority:d("WorkerScheduler").REGULAR_PRIORITY})};return a}(),i=null;a=function(){i==null&&(i=new h());return i};g.getMAWWorkerCacheServices=a}),98);
__d("MAWDbMsgOrReaction",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.reactToExternalId!=null?b.forReaction(a):b.forMessage(a)}function b(a,b){return a==null?b.forNull():a.reactToExternalId!=null?b.forReaction(a):b.forMessage(a)}function c(a,b){return a.reactToExternalId!=null?b.forReaction(a):b.forMessage(a)}function d(a,b){return a==null?b.forNull():a.reactToExternalId!=null?b.forReaction(a):b.forMessage(a)}f.switchOnMsgOrReaction=a;f.switchOnMsgOrReactionNullish=b;f.switchOnMsgOrReactionMaybeUnstored=c;f.switchOnMsgOrReactionMaybeUnstoredNullish=d}),66);
__d("MAWExtractMsFromExternalId",["I64","MAWExternalId","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=2199023255551;function a(a){try{a=(i||(i=d("I64"))).of_string_opt(a);if(a!=null){return(a=k(a))!=null?a:0}}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to convert externalId to number: ",""])),a)}return 0}function k(a){a=Number((i||(i=d("I64"))).to_string(i.and_(i.lsr_(a,22),i.of_float(j))));return d("MAWExternalId").getThreeMostSignificantDigitsForSortOrderTimestamp(a)}g.extractMsFromStanzaId=a;g.extractMsFromExternalId=k}),98);
__d("MAWGetBumpTimestampMs",["I64","MAWAckLevel","MAWDbMsgOrReaction","MAWExtractMsFromExternalId","MAWTimeUtils","WALongInt","WATimeUtils","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b){b=b==null?null:d("MAWExtractMsFromExternalId").extractMsFromExternalId(b);return(h||(h=d("I64"))).add(d("MAWTimeUtils").millisTimeToTimestamp(a),h.of_int32(b!=null?b:0))}function j(a){var b=a.msg;a=a.throwIfNoServerTs;a=a?c("nullthrows")(b.serverTs):b.serverTs;return i(d("WATimeUtils").castUnixTimeToMillisTime(a!=null?a:b.ts),(h||(h=d("I64"))).of_string(b.externalId))}function k(a){return a.senderTimestampMs!=null?(h||(h=d("I64"))).of_string(d("WALongInt").longIntToDecimalString(a.senderTimestampMs)):i(d("WATimeUtils").castUnixTimeToMillisTime(a.ts),(h||(h=d("I64"))).of_string(a.externalId))}function a(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionMaybeUnstoredNullish(a,{forMessage:function(a){return d("MAWAckLevel").isMsgAuthoritative(a.ack)&&a.sortOrderMs!=null?(h||(h=d("I64"))).of_float(a.sortOrderMs):j({msg:a,throwIfNoServerTs:!1})},forNull:function(){return(h||(h=d("I64"))).zero},forReaction:k})}g.calculateBumpTimestampMs=i;g.getBumpTimestampMs=a}),98);
__d("MAWSnippetsCacheServiceUtils",["I64","MAWDbMsgOrReaction","MAWGetBumpTimestampMs"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionNullish(a,{forMessage:function(a){return{msgAckLevel:a.ack,msgId:a.msgId,reactionId:void 0,timestamp:a.sortOrderMs!=null?a.sortOrderMs:(h||(h=d("I64"))).to_float(d("MAWGetBumpTimestampMs").getBumpTimestampMs(a))}},forNull:function(){return{msgAckLevel:void 0,msgId:void 0,reactionId:void 0,timestamp:Number.MIN_SAFE_INTEGER}},forReaction:function(a){return{msgAckLevel:void 0,msgId:void 0,reactionId:a.reactionId,timestamp:(h||(h=d("I64"))).to_float(d("MAWGetBumpTimestampMs").getBumpTimestampMs(a))}}})}g.getMsgOrReactionIdAndTimestamp=a}),98);
__d("MAWUpdateThreadListItemUtils",["MAWAckLevel","MAWDbMsg","MAWDbMsgOrReaction","MAWMsgType","MAWXMAUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionMaybeUnstored(a,{forMessage:function(a){return a.altIndex===d("MAWDbMsg").SPAM_ALT_INDEX||a.altIndex===d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX},forReaction:function(){return!1}})}function b(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionMaybeUnstored(a,{forMessage:function(a){return a.ack===d("MAWAckLevel").ACK.clock},forReaction:function(){return!1}})}function c(a){return a.msgId!=null&&a.type===d("MAWMsgType").MSG_TYPE.XMA&&((a=a.msgContent)==null?void 0:a.content)===""}function e(a){return a.type===d("MAWMsgType").MSG_TYPE.XMA&&d("MAWXMAUtils").isRtcXMA(a==null?void 0:a.xmaMessageType)}g.isSpamMessage=a;g.isOptimisticMessage=b;g.isXMAThreadSnippet=c;g.isRTCXMAMessage=e}),98);
__d("MAWSnippetsCacheCalculateDelta",["FBLogger","MAWDbMsgOrReaction","MAWGetThreadUpdateType","MAWSnippetsCacheServiceUtils","MAWUpdateThreadListItemUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="[SnippetsCacheService][Worker]";function a(a){var b=new Set(a.map(function(a){var b;b=(b=a.decryptedValues)!=null?b:[];a=(a=a.deletedValues)!=null?a:[];return[].concat(b,a)}).flat().map(function(a){return d("MAWUpdateThreadListItemUtils").isOptimisticMessage(a)?null:a.msgId}).filter(Boolean));return a.reduce(function(a,c){var d=c.type==="delete"?c.deletedValues:c.decryptedValues;d=l(d);d=m(b,d);if(d.length===0)return a;d.forEach(function(b){var d=b.threadJid,e=a.get(d);b=k({type:c.type,value:b},e);a.set(d,b)});return a},new Map())}function b(a){return a.some(function(a){a.chatJid;a.lastComputedCacheValue;a=a.mutateReq;return!i(a)||j(a.value)})}function i(a){return a.type==="delete"||a.type==="deleteRange"||d("MAWUpdateThreadListItemUtils").isXMAThreadSnippet(a.value)||p(a.value)||q(a.value)?!1:!0}function j(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(a){return!1},forReaction:function(a){return a.reaction!=null&&d("MAWGetThreadUpdateType").canReactionAffectBump(a)}})}function k(a,b){if(b==null)return a;var c=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(a.value);c=c.timestamp;var e=a.value.externalId,f=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(b.value);f=f.timestamp;var g=b.value.externalId;if(c===f){if(a.type==="delete"||a.type==="deleteRange")return a;else if(b.type==="delete"||b.type==="deleteRange")return b;return e.localeCompare(g)>0?a:b}if(c==null)return b;return f==null?a:c>f?a:b}function l(a){return a==null||a.length===0?[]:a.filter(function(a){return n(a)})}function m(a,b){return b.reduce(function(b,c){var e=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(c);e=e.msgId;return e!=null&&d("MAWUpdateThreadListItemUtils").isOptimisticMessage(c)&&a.has(e)?b:[].concat(b,[c])},[])}function n(a){var b=o(a)&&!d("MAWUpdateThreadListItemUtils").isSpamMessage(a);b||r(a);return b}function o(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(b){return d("MAWGetThreadUpdateType").isThreadUpdateTypeEligibleForSnippet(a)},forReaction:function(b){return d("MAWGetThreadUpdateType").canReactionAffectBump(b)&&p(b)||d("MAWGetThreadUpdateType").isThreadUpdateTypeEligibleForSnippet(a)}})}function p(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(a){return!1},forReaction:function(a){return a.reaction==null}})}function q(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(a){return a.ephemeralMsgDisappeared===!0},forReaction:function(a){return!1}})}function r(a){a=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(a);var b=a.msgId;a=a.reactionId;c("FBLogger")("MAWCacheService").info(h+" msg or reaction is not eligible for snippet update, msgId: %s, reactionId: %s",b,a)}g.parseAndGetMostRecentSnippetUpdateMutateRequestForChatJids=a;g.isDbTransactionRequiredForSnippetUpdate=b;g.canCalculateSnippetUpdateFromDelta=i;g.isNeededToCheckMessageExistence=j}),98);
__d("MAWSnippetsCacheService",["FBLogger","MAWAckLevel","MAWCacheServiceBase","MAWDbMsgOrReaction","MAWDbMsgTxns","MAWDexieTable","MAWGetThreadUpdateType","MAWIndexedDb","MAWMessagesCompare","MAWSnippetsCacheCalculateDelta","MAWSnippetsCacheServiceUtils","MAWThreadNewestMsgOrReactionUtils","MAWThreadSnippetBuildTxns","MAWThreadSnippetUtils","MAWTransactionMode","MAWUpdateThreadListItemUtils","MAWVault","MWThreadListConsts","WAJids","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=["messages","reactions"],i="[SnippetsCacheService][Worker]";a=function(a){function b(){return a.call(this,"snippets")||this}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.$MAWSnippetsCacheService$p_1=function(a){var b=this;a=a.filter(function(a){a=a[0];return h.includes(a)});a=d("MAWSnippetsCacheCalculateDelta").parseAndGetMostRecentSnippetUpdateMutateRequestForChatJids(a.map(function(a){a[0];a=a[1];return a}));return Promise.all(Array.from(a.entries()).map(async function(a){var c=a[0];a=a[1];var d=await b.getValueFromCache(c);return{chatJid:c,lastComputedCacheValue:d,mutateReq:a}}))};e.calculateDelta=function(a){var b=this;return this.$MAWSnippetsCacheService$p_1(a).then(function(a){if(a.length===0)return Promise.resolve([]);if(d("MAWSnippetsCacheCalculateDelta").isDbTransactionRequiredForSnippetUpdate(a))return d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY,reactions:d("MAWTransactionMode").READONLY,threads:d("MAWTransactionMode").READONLY},"MAWSnippetsCacheService:calculateDelta",function(a){return function(c){return b.$MAWSnippetsCacheService$p_2(a,c)}})(a);else return b.$MAWSnippetsCacheService$p_3(a)})};e.computeCachePayloadFromScratch=function(a){var b=this;return d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY,reactions:d("MAWTransactionMode").READONLY,threads:d("MAWTransactionMode").READONLY},"MAWSnippetsCacheService:computeCachePayloadFromScratch",function(a){return function(c){return d("MAWDexieTable").dexieAll(c.map(function(c){c=d("WAJids").unsafeCoerceToChatJid(c);return b.$MAWSnippetsCacheService$p_4(a,c,"from-scratch")})).then(function(a){return a.filter(Boolean)})}})(a)};e.$MAWSnippetsCacheService$p_5=function(a,b){if(b==null)return"no-value-calculated-from-scratch";if(d("MAWUpdateThreadListItemUtils").isOptimisticMessage(a.value))return null;a=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(a.value);var c=a.msgAckLevel,e=a.msgId,f=a.reactionId;a=a.timestamp;if(a==null)return"missing-timestamp";if(e!=null&&e===b.value.snippetMsgId)return null;if(f!=null&&f===b.value.snippetReactionId)return null;return e!=null&&c!==d("MAWAckLevel").ACK.received&&b.value.snippetMsgAckLevel===d("MAWAckLevel").ACK.clock?"optimistic-snippet-in-cache":a<b.timestamp?"older-than-last-snippet-value":null};e.$MAWSnippetsCacheService$p_6=function(a,b){var e;if(a.type!=="add")return!1;e=(e=c("qex")._("1213"))!=null?e:!1;return!e?!1:d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a.value,{forMessage:function(a){var c;if(a.sortOrderMs==null||!d("MAWThreadNewestMsgOrReactionUtils").filterForSnippetNewestIncomingMessages(d("MAWGetThreadUpdateType").getThreadUpdateTypeForMsg(a),a.ephemeralMsgDisappeared===!0))return!1;var e=b==null||(c=b.value)==null?void 0:c.snippetNewestIncomingMsgs;if(e==null||e.length<d("MWThreadListConsts").SNIPPET_MAX_NEWEST_INCOMING_MESSAGES_COUNT)return!0;e=e[e.length-1];if(e==null||e.sortOrderMs==null)return!0;var f=d("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc");return f({externalId:e.externalId,sortOrderMs:e.sortOrderMs},{externalId:a.externalId,sortOrderMs:a.sortOrderMs})>0},forReaction:function(a){return!1}})};e.$MAWSnippetsCacheService$p_7=function(a,b){var c={externalId:b.value.externalId,sortOrderMs:b.value.sortOrderMs};if(a==null||a.some(function(a){return a.externalId===c.externalId}))return[c];b=d("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc");a=[].concat(a,[c]).sort(b).slice(0,d("MWThreadListConsts").SNIPPET_MAX_NEWEST_INCOMING_MESSAGES_COUNT);return a};e.shouldDropDelta=function(a){var b=this;return this.$MAWSnippetsCacheService$p_1(a).then(function(a){return a.length===0?Promise.resolve(!0):Promise.all(a.map(async function(a){var c=a.chatJid,d=a.lastComputedCacheValue;a=a.mutateReq;if(b.$MAWSnippetsCacheService$p_6(a,d))return!1;d=await b.$MAWSnippetsCacheService$p_5(a,d);if(d!=null){k({dropReason:d,key:c,msgOrReaction:a.value,operation:a.type});return!0}return!1})).then(function(a){if(a.every(function(a){return a===!0}))return!0;else return!1})})};e.$MAWSnippetsCacheService$p_4=function(a,b,c){var e=this;return d("MAWThreadSnippetUtils").getThreadSnippetFromScratch(a,b).then(function(a){a=e.$MAWSnippetsCacheService$p_8(b,a,c);return a==null?void 0:d("MAWDexieTable").dexieResolve([b,a])})};e.$MAWSnippetsCacheService$p_3=function(a){var b=this;return a.map(function(a){var c=b.$MAWSnippetsCacheService$p_9(a);return c==null?void 0:[a.chatJid,c]}).filter(Boolean)};e.$MAWSnippetsCacheService$p_2=function(a,b){var c=this;return d("MAWDexieTable").dexieAll(b.map(function(b){return!d("MAWSnippetsCacheCalculateDelta").canCalculateSnippetUpdateFromDelta(b.mutateReq)?c.$MAWSnippetsCacheService$p_4(a,b.chatJid,"realtime-from-scratch"):c.$MAWSnippetsCacheService$p_10(a,b.mutateReq.value).then(function(a){if(a)return void 0;a=c.$MAWSnippetsCacheService$p_9(b);return a==null?void 0:d("MAWDexieTable").dexieResolve([b.chatJid,a])})})).then(function(a){return a.filter(Boolean)})};e.$MAWSnippetsCacheService$p_9=function(a){var b;b=(b=c("qex")._("1213"))!=null?b:!1;if(b)return this.$MAWSnippetsCacheService$p_11(a);b=d("MAWThreadSnippetBuildTxns").buildThreadSnippetForMsgOrIncomingReaction(a.chatJid,a.mutateReq.value);b=this.$MAWSnippetsCacheService$p_8(a.chatJid,{snippet:b,snippetMsgOrReaction:a.mutateReq.value},"realtime-calculate-delta");return b};e.$MAWSnippetsCacheService$p_11=function(a){var b,c=a.chatJid,e=a.lastComputedCacheValue;a=a.mutateReq;var f=this.$MAWSnippetsCacheService$p_6(a,e),g=this.$MAWSnippetsCacheService$p_5(a,e)==null;f=f?this.$MAWSnippetsCacheService$p_7(e==null||(b=e.value)==null?void 0:b.snippetNewestIncomingMsgs,a):e==null?void 0:e.value.snippetNewestIncomingMsgs;if(!g&&e!=null)return babelHelpers.extends({},e,{value:babelHelpers.extends({},e.value,{snippetNewestIncomingMsgs:f})});g=d("MAWThreadSnippetBuildTxns").buildThreadSnippetForMsgOrIncomingReaction(c,a.value);e=this.$MAWSnippetsCacheService$p_8(c,{snippet:g,snippetMsgOrReaction:a.value,snippetNewestIncomingMsgsMetadata:f},"realtime-calculate-delta");return e};e.$MAWSnippetsCacheService$p_8=function(a,b,c){if(b==null){j({flow:c,key:a,threadSnippetResult:b});return void 0}var e=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(b.snippetMsgOrReaction),f=e.msgAckLevel,g=e.msgId,h=e.reactionId;e=e.timestamp;j({flow:c,key:a,msgAckLevel:f,msgId:g,reactionId:h,threadSnippetResult:b,timestamp:e});if(e==null)return void 0;c=babelHelpers.extends({},b.snippet.snippetParams,{strings:b.snippet.snippetParams.strings.map(function(a){return d("MAWVault").unvault(a)})});return{key:a,timestamp:e,value:{snippet:babelHelpers.extends({},b.snippet,{snippetParams:c}),snippetMsgAckLevel:f,snippetMsgId:g,snippetNewestIncomingMsgs:b.snippetNewestIncomingMsgsMetadata,snippetReactionId:h}}};e.$MAWSnippetsCacheService$p_10=function(a,b){if(!d("MAWSnippetsCacheCalculateDelta").isNeededToCheckMessageExistence(b))return d("MAWDexieTable").dexieResolve(!1);b=d("MAWDbMsgOrReaction").switchOnMsgOrReaction(b,{forMessage:function(a){return null},forReaction:function(a){return a.reactToMsgId}});return b==null?d("MAWDexieTable").dexieResolve(!0):d("MAWDbMsgTxns").getMsgsByMsgIds(a,[b]).then(function(a){return a.length===0})};return b}(c("MAWCacheServiceBase"));function j(a){var b=a.flow,d=a.key,e=a.msgAckLevel,f=a.msgId,g=a.reactionId,h=a.threadSnippetResult;a=a.timestamp;if(h==null){c("FBLogger")("MAWCacheService").warn(i+"["+b+"] Failed to calculate thread snippet, key: %s",d);return}if(a==null){c("FBLogger")("MAWCacheService").warn(i+"["+b+"] No timestamp found for the thread snippet, key: %s,\n      msgId: %s, reactionId: %s",d,f,g);return}c("FBLogger")("MAWCacheService").info(i+"["+b+"] Snippet successfully calculated, key: %s,\n    timestamp: %s, msgId: %s, reactionId: %s, ack level %s",d,a,f,g,e)}function k(a){var b=a.dropReason,e=a.key,f=a.msgOrReaction;a=a.operation;f=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(f);var g=f.msgAckLevel,h=f.msgId,j=f.reactionId;f=f.timestamp;c("FBLogger")("MAWCacheService").info(i+" Drop update for msg or reaction, reason: %s, key: %s, msgId: %s, reactionId: %s, timestamp: %s, ackLevel: %s, operation: %s",b,e,h,j,f,g,a)}var l=new a();b=function(){return l};g.getMAWSnippetsCacheService=b}),98);
__d("MAWDataSyncQueue",["WALogger","getErrorSafe","qex","throttle"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("qex")._("853")||1e3;a=c("qex")._("855")||1e3;b=function(){m=!1;return r({isUnloading:!0})};var k=[],l=[],m=!1,n=[],o=function(){var a,b=k.splice(0,k.length);(a=l).push.apply(a,b)},p=function(){return l.splice(0,j)},q=function(a){var b=p();if(b.length===0)return;return Promise.all(n.map(function(c,e){return c(b,a).catch(function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unhandled exception caught in middleware "," sync: ",""])),e,a)})})).then(function(){return q(a)})},r=async function(a){if(m)return;m=!0;o();try{await q(a)}catch(e){var b;a=c("getErrorSafe")(e);d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[MAWIndexedDbMiddleware] error handling queue batch: ",""])),(b=a==null?void 0:a.message)!=null?b:a.toString());throw e}finally{m=!1,k.length>0&&s()}},s=c("throttle")(r,a);e=function(a,b){k.push({type:a,value:b}),s()};f=function(a){n.some(function(b){return b===a})||n.push(a)};a=function(){n=[]};var t=function(){k=[],l=[]},u=function(){return k};g.forceFlushDataSyncQueue=b;g.addSyncItem=e;g.registerDataSyncCallback=f;g.clearDataSyncCallbacks=a;g.clearDataSyncQueue_FOR_TESTING_ONLY=t;g.getDataSyncQueue_FOR_TESTING_ONLY=u}),98);
__d("MAWDataSyncMiddleware",["FBLogger","MAWDataSyncQueue"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(["contacts","groupInfo","messages","participants","threads","reactions","xma","pendingStanzas"]);function i(a,b){var c=a.table(b);return!h.has(b)?c:babelHelpers["extends"]({},c,{mutate:function(a){return c.mutate(a).then(function(c){if(a.type==="delete"){a.keys.forEach(function(c){d("MAWDataSyncQueue").addSyncItem(a.type,{key:c,tableName:b})});return c}else c.results!=null?c.results.forEach(function(c){d("MAWDataSyncQueue").addSyncItem(a.type,{key:c,tableName:b,values:a.values})}):c.lastResult!=null&&d("MAWDataSyncQueue").addSyncItem(a.type,{key:c.lastResult,tableName:b,values:a.values});return c})}})}function a(){return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return i(a,b)}})}catch(b){c("FBLogger")("messenger_web").catching(b).mustfix("Error applying DataSync Middleware, messages made during this session will not be properly synced to registered consumers");return a}},name:"MAWDataSyncMiddleware",stack:"dbcore"}}g.getDataSyncMiddleware=a}),98);
__d("MAWIndexedDb",["EBGating","ExecutionEnvironment","I64","MAWBridge","MAWCacheServiceMiddleware","MAWDataSyncMiddleware","MAWDbFactory","MAWDbMutationMiddleware","MAWDbMutationValidator","MAWDbProtocolMsgIdMiddleware","MAWDbSchema","MAWDexie","MAWLSDataSyncMiddleware","MAWMiActOnActThreadReadyQueue","MAWTransactor","MWFBLogger","cr:10181","cr:10182","cr:17239","cr:3527","gkx","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(e){e===void 0&&(e="idb");var f=d("MAWDbFactory").makeIDBFactory(e,"worker");function a(a){return f.setupPromise().then(function(){return f.getDBExn(a)})}return babelHelpers.extends({},f,{getSignalDB:a,makeDB:async function(a,e,g){var h=[d("MAWDbMutationMiddleware").getMAWDbMutationMiddleware];h.push(d("MAWLSDataSyncMiddleware").getMAWLSDataSyncMiddleware);c("gkx")("1760")&&h.push(d("MAWDbProtocolMsgIdMiddleware").MAWDbProtocolMsgIdMiddleware);h.push(c("MAWCacheServiceMiddleware"));e.enableDataSyncMiddleware&&h.push(d("MAWDataSyncMiddleware").getDataSyncMiddleware);e.enableMutationValidator===!0&&h.push(d("MAWDbMutationValidator").getMutationValidatorMiddleware);b("cr:3527")!=null&&h.push(b("cr:3527"));c("justknobx")._("4087")&&b("cr:17239")!=null&&await b("cr:17239")(a);return f.makeDB(a,{autoOpen:!0,middleware:h,onDbPopulate:e.onDbPopulate},g)}})}var j=a(),k="idle",l=j.isNewDb,m=j.willSetupDB,n=function(a,b,c){return j.makeDB(a,b,c).then(function(){k="ready"})},o=j.closeDB,p=j.getDBExn,q=j.getSignalDB,r=j.getDB,s=function(a){return j.reset_singleton_INTERNAL_ONLY()},t=j.deleteDb;function e(){return k}function f(a){var b=k;k="migrating";return a.finally(function(){k=b})}var u=new WeakMap(),v=new WeakMap(),w=d("MWFBLogger").MWLogger().tags(["db","afterTransaction"]);function x(a){var b=c("MAWDexie").currentTransaction;if(b==null)throw w.mustfixThrow("afterTransactionEffect called outside of dexie transaction");if(typeof a!=="function")return;var d=u.get(b)||[];d.push(a);u.set(b,d);d.length===1&&b.on("complete",function(){var a=u.get(b)||[];a.forEach(function(a){a()});u.delete(b)})}function y(a){var e=c("MAWDexie").currentTransaction;if(e==null)throw w.mustfixThrow("afterTransaction called outside of dexie transaction","maw_db");var f=v.get(e);if(f!=null)f.push(a);else{var g=[a];v.set(e,g);e.on("complete",function(){v.delete(e),c("gkx")("5675")&&(i||(i=c("ExecutionEnvironment"))).isInMainThread&&b("cr:10182")!==null&&b("cr:10181")!==null?b("cr:10182").handleEvents(b("cr:10181").LSDatabaseSingleton,g):d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:g})})}}function z(a){if(a.tag==="ThreadUpdated")try{var b=a.value.snippetContactIDs;b!=null&&b.some(function(a){return a==="Facebook User"})&&(w.mustfix('Something is still setting a contact id as "Facebook User"'),a.value=babelHelpers.extends({},a.value,{snippetContactIDs:b.map(function(a){return a==="Facebook User"?"0":a})}))}catch(a){}else if(a.tag==="VerifyThreadExists"&&c("gkx")("13646")&&!(d("EBGating").isEBSMv2Phase1Enabled()||c("gkx")("13647"))){b=a.value;if(b.clientThreadKey!=null){var e=(h||(h=d("I64"))).of_string(b==null?void 0:b.clientThreadKey);c("promiseDone")(d("MAWMiActOnActThreadReadyQueue").processQueueOnActThreadReady(e,b.jid,"MAWIndexedDb:afterTransaction:withClientThreadKey","clientThreadKey"))}if(b.authoritativeThreadKey!=null){e=(h||(h=d("I64"))).of_string(b.authoritativeThreadKey);c("promiseDone")(d("MAWMiActOnActThreadReadyQueue").processQueueOnActThreadReady(e,b.jid,"MAWIndexedDb:afterTransaction:withAuthoritativeThreadKey","authoritativeThreadKey"))}}y(a)}function A(a,b){var e=c("MAWDexie").currentTransaction;if(e==null)throw w.mustfixThrow("afterTransactionForThreadEvent called outside of dexie transaction","maw_db");e.on("complete",function(){d("MAWBridge").getBridge().fireAndForget("threadEvent",b,a)})}g.TABLES_TO_ENCRYPT=d("MAWDbSchema").TABLES_TO_ENCRYPT;g.makeMsgrTransactor=d("MAWTransactor").makeMsgrTransactor;g.makeMAWIndexedDBFactory=a;g.isNewDb=l;g.willSetupDB=m;g.makeDB=n;g.closeDB=o;g.getDBExn=p;g.getSignalDB=q;g.getDB=r;g.setDB_INTERNAL_USE_ONLY=s;g.deleteDb=t;g.getDbStatus=e;g.updateStatusDuringMigration=f;g.afterTransactionEffect=x;g.afterTransaction=z;g.afterTransactionThreadEvent=A}),98);
__d("MAWLLAMigrationUtils",["Random","gkx","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";b=c("justknobx")._("652");var h=Math.max(b,10);e=h*10;var i=new Map([["FTS",e]]);function j(a){if(c("gkx")("9340"))return 1;a=i.get(a);return a!=null?a:h}function a(a,b){b===void 0&&(b={});var e=j(a);return a==="debug"||a==="test"?[]:c("gkx")("23956")&&d("Random").coinflip(e)?[c("qpl")._(1056839327,"560"),babelHelpers["extends"]({"double":{sampleRate:1/e},string:{transactor:a}},b)]:[]}g.getTransactorQPLParam=a}),98);
__d("MAWTransactor",["MAWDexie","MAWDexieTable","MAWErrorObject","MAWIndexedDb","MAWIndexedDbUI","MAWLLAMigrationUtils","MAWQplProxy","MAWTransactionMode","MWFBLogger","WAExceededStorageQuota","WALogger","gkx","performance"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=["MWPTransactor"],l=d("MWFBLogger").MWLogger();function m(a,b,e,f,g,i){f!=null&&c("MAWDexie").currentTransaction!=null&&f.endFail("invoked_in_nested_transaction",{string:{current_transaction_mode:c("MAWDexie").currentTransaction.mode},string_array:{current_transaction_store_names:c("MAWDexie").currentTransaction.storeNames}});c("MAWDexie").currentTransaction!=null&&d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["makeMsgrTransactor "," should not be called inside another transaction. The transaction will be forced to execute on top-level"])),g);return a.transact(b,e,i)}function n(a){a=d("MAWLLAMigrationUtils").getTransactorQPLParam(a);a=a.length===2?a:[null,void 0];var b=a[0];a=a[1];return b!=null?d("MAWQplProxy").startQplUserFlow(b,a,{sendThroughBridge:!1}):null}function a(a,b,c,e){return q(a,b,function(a){return d("MAWIndexedDb").getDB(a)},c,e)}function b(a,b,c){return q(a,b,d("MAWIndexedDbUI").getDB,c)}function e(a,b,c){return q(a,b,d("MAWIndexedDbUI").getDB,c)}var o=0,p=new Map();function q(a,b,e,f,g){var h=Object.keys(a),q=h.some(function(b){return a[b]===d("MAWTransactionMode").READWRITE})?d("MAWTransactionMode").READWRITE:d("MAWTransactionMode").READONLY;return function(){for(var a=arguments.length,t=new Array(a),u=0;u<a;u++)t[u]=arguments[u];var v=n(b),w=null,x=function(){return self.clearInterval(w)};if(v!=null){v.addAnnotations({string:{mode:q===d("MAWTransactionMode").READWRITE?"readwrite":"readonly"},string_array:{stores:h}});if(c("gkx")("1006")&&b==="bulkCreateThreadByJid"){var y=1e3,z=Date.now();w=self.setInterval(function(){v.addAnnotations({"int":{heartbeatLatestAliveSinceStartMs:Date.now()-z}})},y);self.setTimeout(x,d("MAWQplProxy").DEFAULT_WORKER_QPL_TIMEOUT_MS)}}var A=(j||(j=c("performance"))).now()+j.timeOrigin;return e(b).then(function(a){var e=Array.from(p.values());v==null||v.addPoint("lock_wait_start",{string_array:{maybeLockedOn:e}});var n=(j||(j=c("performance"))).now();g==null||g.onTxnRequestedCb==null||g.onTxnRequestedCb.apply(g,t);return m(a,q,h,v,b,function(){d("MAWDexieTable").setDexiePSDItem("transactionRequested",A);d("MAWDexieTable").setDexiePSDItem("transactorName",b);v==null||v.addPoint("dexie_transaction_start");o+=1;var m=o;p.set(m,b);var q=v!=null?a.stores[h[0]].get("").then(function(){v==null||v.addPoint("lock_wait_end"),v==null||v.addPoint("transaction_opened"),v==null||v.addPoint("transactor_execution_start")}):d("MAWDexieTable").dexieResolve();return q.then(function(){return f(a.stores).apply(void 0,t)}).then(function(a){if(c("gkx")("6795")&&(g==null?void 0:g.explicitlyCloseTxn)===!0){var f;(f=c("MAWDexie").currentTransaction)==null||(f=f.idbtrans)==null||f.commit==null||f.commit()}p["delete"](m);v==null||v.addPoint("transactor_execution_end");v==null||v.endSuccess();x();f=(j||(j=c("performance"))).now()-n;f>5e3&&(d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[Slow maw transaction] "," took ","ms to complete. Potentially waiting for locks on ",""])),b,f,e.join(", ")),l.mustfix("[Slow maw transaction] %s took long to complete. Potentially waiting for locks on $s",b,e.join(", ")));return a})["catch"](function(a){p["delete"](m);d("WAExceededStorageQuota").checkQuotaExceededError(a);var c=a.name==="AbortError"?a==null?void 0:a.inner:null;c=r(c);v==null||v.markError("transaction_error",null,a);if(a instanceof Error){var e=a,f=typeof (e==null?void 0:e.stack)==="string"?e.stack:typeof (e==null?void 0:e.stack);e=typeof (e==null?void 0:e.message)==="string"?e.message:typeof (e==null?void 0:e.message);v==null||v.addAnnotations({string:{errMessage:e,errStack:f,innerError:c}})}v==null||v.endFail("transaction_fail");x();e=d("MAWErrorObject").getErrorObject(a);throw s(e).mustfixThrow("[%s] Error performing %s transaction. Inner error: %s",k.join("|"),b!=null?b:"",c!=null?c:"unknown")})})})["catch"](function(a){d("WAExceededStorageQuota").checkQuotaExceededError(a);v==null||v.endFail("transaction_fail");x();a=d("MAWErrorObject").getErrorObject(a);throw s(a).mustfixThrow("[%s] Error performing %s transaction",k.join("|"),b!=null?b:"")})}}function r(a){if(typeof a==="string")return a;if(a instanceof Error)return a.name+": "+a.message;if(typeof a==="object")try{return JSON.stringify(a)}catch(a){}return null}function s(a){if(a)return l.catching(a);else return l}g.makeMsgrTransactor=a;g.makeMsgrUITransactor_IMPORT_FROM_MAWIndexedDbUI_INSTEAD=b;g.makeMsgrUIWritableTransactor=e}),98);
__d("MAWThreadUpdateType",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=2;d=3;e=Object.freeze({BUMP_THREAD:c,MARK_THREAD_AS_UNREAD:d,NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:a,SNIPPET_ONLY:b});f.THREAD_UPDATE_TYPE=e}),66);
__d("MAWGetThreadUpdateTypeForAdminMsg",["FBLogger","MAWAdminMsgTypesGrouped","MAWLocalizationType","MAWThreadUpdateType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=(a=a.msgContent)==null?void 0:a.adminType;if(a==null){c("FBLogger")("messenger_web").mustfix("nullAdminType");return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE}if(h(a))return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD;if(i(a))return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD;if(j(a))return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY;if(k(a))return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE;c("FBLogger")("messenger_web").mustfix("unsupportedAdminMsgType");return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE}function h(a){return d("MAWAdminMsgTypesGrouped").otherUserAddRemoveParticipant.includes(a)||d("MAWAdminMsgTypesGrouped").chatCustomizedByOtherUser.includes(a)||d("MAWAdminMsgTypesGrouped").callActionToNotifyAbout.includes(a)||d("MAWAdminMsgTypesGrouped").twoUsersConnected.includes(a)||d("MAWAdminMsgTypesGrouped").fallbackMsgFromOtherUser.includes(a)||d("MAWAdminMsgTypesGrouped").otherUserBumpsMessage.includes(a)||d("MAWAdminMsgTypesGrouped").otherNonAdminMsgToBeMarkedAsUnread.includes(a)||a===d("MAWLocalizationType").LOCALIZATION_TYPE.REACHABILITY_ERROR}function i(a){return d("MAWAdminMsgTypesGrouped").currentUserAddRemoveParticipant.includes(a)||d("MAWAdminMsgTypesGrouped").chatCustomizedByCurrentUser.includes(a)||d("MAWAdminMsgTypesGrouped").callActionNotToNotifyAbout.includes(a)||d("MAWAdminMsgTypesGrouped").fallbackMsgFromCurrentUser.includes(a)||d("MAWAdminMsgTypesGrouped").currentUserBumpsMessage.includes(a)||d("MAWAdminMsgTypesGrouped").otherNonAdminMsgToBeBumped.includes(a)||d("MAWAdminMsgTypesGrouped").limitSharingUpdate.includes(a)}function j(a){return a===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_ROLLBACK_ADMIN_MESSAGE||d("MAWAdminMsgTypesGrouped").ephemeralSettingChanges.includes(a)||d("MAWAdminMsgTypesGrouped").groupPermissionsChanged.includes(a)||d("MAWAdminMsgTypesGrouped").participantLeftGroup.includes(a)||d("MAWAdminMsgTypesGrouped").pinnedMessageUpdate.includes(a)}function k(a){return d("MAWAdminMsgTypesGrouped").cutoverAdminMsgs.includes(a)||d("MAWAdminMsgTypesGrouped").deviceChanges.includes(a)||d("MAWAdminMsgTypesGrouped").icdcAlerts.includes(a)||d("MAWAdminMsgTypesGrouped").otherNonAdminMsgToNotTriggerUpdate.includes(a)||a===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION||a===d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET||a===d("MAWLocalizationType").LOCALIZATION_TYPE.DEBUG_MSG||a===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_UK_OSA_ADMIN_MESSAGE}g.getThreadUpdateTypeForAdminMsg=a}),98);
__d("MAWGetThreadUpdateType",["FBLogger","MAWDbMsgOrReaction","MAWGetThreadUpdateTypeForAdminMsg","MAWThreadSnippetUtils","MAWThreadUpdateType","MAWUserJidWrapper","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.reaction==null;return j(a,b)}function i(a){return k(a.reactToAuthor)&&!k(a.author)}function j(a,b){if(i(a)&&!b)if(a.senderTimestampMs==null)return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY;else return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD;else return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE}function k(a){return a===d("WAJids").AUTHOR_ME||a===d("MAWUserJidWrapper").getMyUserJid()}function l(a){var b=a.type,e=function(b){var c=b.me;b=b.other;return d("WAJids").isAuthorMe(a.author)?c:b};switch(b){case"Text":case"ReceiverFetch":case"Sticker":case"Unavailable":case"Video":case"Futureproof":case"DocumentFile":case"EphemeralScreenshotAction":case"Gif":case"Image":case"Ptt":case"RavenAction":case"Raven":case"GroupPollCreate":case"GroupPollUpdate":case"BumpExistingMessage":return e({me:d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD,other:d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD});case"XMA":return d("MAWThreadSnippetUtils").shouldIgnoreXMAMsgForSnippet(a)?d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:e({me:d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD,other:d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD});case"Revoked":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY;case"DeleteForMe":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE;case"EditAction":return e({me:d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY,other:d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE});case"GroupInvite":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD;case"Admin":if(a.type==="Admin")return d("MAWGetThreadUpdateTypeForAdminMsg").getThreadUpdateTypeForAdminMsg(a);throw c("FBLogger")("messenger_web").mustfixThrow("Non-admin msg passed in "+((e=a.type)!=null?e:"UNKNOWN"));case"SenderKeyDistribution":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE;case"AlertICDC":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD;case"Ciphertext":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD;case"EphemeralSettingAdmin":case"EphemeralSettingChangeFromCurrentDevice":case"EphemeralSyncResponse":return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY;default:b;throw c("FBLogger")("messenger_web").mustfixThrow("[MAWGetThreadUpdateType] Unexpected message type: "+((e=a.type)!=null?e:"UNKNOWN"))}}function m(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionMaybeUnstoredNullish(a,{forMessage:function(a){return l(a)},forNull:function(){return d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE},forReaction:function(a){return h(a)}})}function a(a){a=m(a);switch(a){case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:return!1;case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD:return!0;default:throw c("FBLogger")("messenger_web").mustfixThrow("[MAWCentralizedThreadUpdate][snippet] Unhandled threadUpdateType: "+a)}}function b(a){a=m(a);switch(a){case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY:return!1;case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD:return!0;default:throw c("FBLogger")("messenger_web").mustfixThrow("[MAWCentralizedThreadUpdate][bump] Unhandled threadUpdateType: "+a)}}g.getThreadUpdateTypeForReaction=h;g.canReactionAffectBump=i;g.getReactionThreadUpdateType=j;g.getThreadUpdateTypeForMsg=l;g.getThreadUpdateTypeForMsgOrReaction=m;g.isThreadUpdateTypeEligibleForSnippet=a;g.isThreadUpdateTypeEligibleForBump=b}),98);
__d("MAWCacheServiceMiddleware",["FBLogger","MAWIndexedDb","MAWMpsGating","MAWWorkerCacheServices"],(function(a,b,c,d,e,f,g){"use strict";var h=["messages","reactions"],i=["messages","reactions"];function j(a,b,c){var d,e=c.trans,f=(d=(d=e._transactorMeta)==null?void 0:d.mawCacheServiceAccumulatedRequests)!=null?d:[];if(c.type==="delete"&&i.includes(b.name))return m(a,b.name,c).then(function(a){a=babelHelpers["extends"]({},c,{deletedValues:a});f.push([b.name,a]);e._transactorMeta=babelHelpers["extends"]({},e._transactorMeta,{mawCacheServiceAccumulatedRequests:f});return b.mutate(c)});d=babelHelpers["extends"]({},c,{decryptedValues:c.values?c.values:void 0});f.push([b.name,d]);e._transactorMeta=babelHelpers["extends"]({},e._transactorMeta,{mawCacheServiceAccumulatedRequests:f});return b.mutate(c)}function k(a){var b=a.trans;if(((a=b._transactorMeta)==null?void 0:a.mawCacheServiceAfterTransactionScheduled)===!0)return;d("MAWIndexedDb").afterTransactionEffect(function(){var a;a=(a=(a=b._transactorMeta)==null?void 0:a.mawCacheServiceAccumulatedRequests)!=null?a:[];if(a.length===0)return;d("MAWWorkerCacheServices").getMAWWorkerCacheServices().calculateDelta(a)});b._transactorMeta=babelHelpers["extends"]({},b._transactorMeta,{mawCacheServiceAfterTransactionScheduled:!0})}function l(a,b){var c=a.table(b);if(!h.includes(b))return c;return d("MAWMpsGating").isFullMpsEnabled()?c:babelHelpers["extends"]({},c,{mutate:function(b){k(b);return j(a,c,b)}})}function a(){return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return l(a,b)}})}catch(b){c("FBLogger")("MAWCacheService").catching(b).mustfix("Error applying MAW Cache Service Middleware");return a}},name:"MAWCacheServiceMiddleware",stack:"dbcore"}}function m(a,b,c){var d=c.keys;c=c.trans;return a.table(b).getMany({keys:d,trans:c}).then(function(a){return a.filter(Boolean)})}g["default"]=a}),98);
__d("isEncryptionAtRestEnabled",["isInstamadillo","qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(c("qex")._("507")===!0)return!0;else return c("isInstamadillo")()}g["default"]=a}),98);
__d("MAWDbMiddlewareMutations",["MAWDbObjEncryption","MAWVaultDb","MAWVaultDefinitions","gkx","isEncryptionAtRestEnabled"],(function(a,b,c,d,e,f,g){"use strict";var h=c("gkx")("23909");function a(a,b,e){if(!h&&!(c("isEncryptionAtRestEnabled")()||c("gkx")("23910")))return a;a=babelHelpers["extends"]({},a);a=d("MAWVaultDb").unvaultDbRow(a,b,d("MAWVaultDefinitions").ARMADILLO_IDB_VAULT_DEFINITIONS);a=d("MAWDbObjEncryption").encryptDbObj(a,b,e);return a}function b(a,b){return!h?a:d("MAWVaultDb").unvaultDbRow(babelHelpers["extends"]({},a),b,d("MAWVaultDefinitions").ARMADILLO_IDB_VAULT_DEFINITIONS)}function e(a,b,c){a=d("MAWDbObjEncryption").decryptDbObj(babelHelpers["extends"]({},a),b,c);return!h?a:d("MAWVaultDb").vaultDbRow(a,b,d("MAWVaultDefinitions").ARMADILLO_IDB_VAULT_DEFINITIONS)}function f(a,b){if(a==null)return void 0;return!h?a:d("MAWVaultDb").vaultDbRow(a,b,d("MAWVaultDefinitions").ARMADILLO_IDB_VAULT_DEFINITIONS)}g.mutateValue=a;g.mutateVaultedValue=b;g.getValue=e;g.getVaultedValue=f}),98);
__d("MAWDbMutationValidator",["FBLogger","MAWIndexedDb","MAWMessageHasNonNullServerTsOnReceivedAckValidator","MAWMessageHasUniqueExternalIdValidator","MAWODSProxy","MAWParticipantMatchOneOnOneThreadValidator","MAWReactionHasUniqueProtocolMsgIdValidator","Promise","Random","WAOdsEnums","gkx","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[d("MAWMessageHasUniqueExternalIdValidator").MAWMessageHasUniqueExternalIdValidator,d("MAWParticipantMatchOneOnOneThreadValidator").MAWParticipantMatchOneOnOneThreadValidator,d("MAWReactionHasUniqueProtocolMsgIdValidator").MAWReactionHasUniqueProtocolMsgIdValidator,d("MAWMessageHasNonNullServerTsOnReceivedAckValidator").MAWMessageHasNonNullServerTsOnReceivedAckValidator],j=c("justknobx")._("2610"),k=c("gkx")("5906"),l=function(a){return d("Random").coinflip(a!=null?a:j)||k};function m(a,e){var f=a.table(e),g=i.filter(function(a){return a.table===e});return g.length===0?f:babelHelpers["extends"]({},f,{mutate:function(a){return d("MAWIndexedDb").getDbStatus()!=="ready"?f.mutate(a):f.mutate(a).then(function(e){var f=g.filter(function(b){var c=b.sampleRate;b=b.type;return b.includes(a.type)&&l(c)});d("MAWIndexedDb").afterTransactionEffect(function(){var g=f.flatMap(function(a){var b=a.description,c=a.isValid;return((a=e.results)!=null?a:[]).map(function(a){return c(a).then(function(a){return babelHelpers["extends"]({validatorName:b},a)})})});c("promiseDone")((h||(h=b("Promise"))).all(g).then(function(b){b.forEach(function(b){switch(b.result){case"valid":d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_MUTATION_VALIDATOR,key:b.validatorName+"."+a.type+".valid"});break;case"invalid":d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_MUTATION_VALIDATOR,key:b.validatorName+"."+a.type+".invalid"});c("FBLogger")("maw_mutation_validator").mustfix("Validator %s failed for %s mutation, with description: %s",b.validatorName,a.type,b.description);break;case"skipped":break}})}))});return e})}})}function a(){return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return m(a,b)}})}catch(b){c("FBLogger")("messenger_web").catching(b).mustfix("Error applying Mutation Validator Middleware");return a}},name:"MAWMutationValidatorMiddleware",stack:"dbcore"}}g.getMutationValidatorMiddleware=a}),98);
__d("MAWDbProtocolMsgIdMiddleware",["FBLogger","MAWDBMigrationUtils","MAWJidUtils","MAWODSProxy","Random","WAOdsEnums","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h=c("justknobx")._("3300");function i(a){return babelHelpers["extends"]({},a,{get:function(b){return a.get(b).then(function(a){l(a,"get");return a})},getMany:function(b){return a.getMany(b).then(function(a){return a==null?void 0:a.map(function(a){l(a,"getMany");return a})})},mutate:function(b){b.type==="add"?b.values.map(function(a){return j(a)}):b.type==="put"&&c("gkx")("11791")&&c("justknobx")._("3947")&&b.values.map(function(a){a.protocolMsgId==null&&(d("MAWDBMigrationUtils").mawDbMigrationVersion.version>=d("MAWDBMigrationUtils").MAWDB_DEDUPE_MSGS_MIGRATION_VERSION?(d("Random").coinflip(h)&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_PROTOCOL_MSG_ID_INDEX,key:"null_protocol_msg_id.put_operation_after_migration_complete.migration_version_"+d("MAWDBMigrationUtils").mawDbMigrationVersion.version}),j(a)):a.rowId<d("MAWDBMigrationUtils").mawDbDedupeMsgsMigrationStatus.cursorValue?(d("Random").coinflip(h)&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_PROTOCOL_MSG_ID_INDEX,key:"null_protocol_msg_id.put_operation_below_migration_cursor.migration_version_"+d("MAWDBMigrationUtils").mawDbMigrationVersion.version}),j(a)):d("MAWDBMigrationUtils").mawDbDedupeMsgsMigrationStatus.isRunning&&a.rowId<d("MAWDBMigrationUtils").mawDbDedupeMsgsMigrationStatus.cursorValue+d("MAWDBMigrationUtils").mawDbDedupeMsgsMigrationStatus.batchSize&&(d("Random").coinflip(h)&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_PROTOCOL_MSG_ID_INDEX,key:"null_protocol_msg_id.put_operation_in_current_migration_batch.migration_version_"+d("MAWDBMigrationUtils").mawDbMigrationVersion.version}),j(a)))});return a.mutate(b)},query:function(b){return a.query(b).then(function(a){var b;a==null||(b=a.result)==null||b.map(function(a){l(a,"query")});return a})}})}function j(a){a.protocolMsgId=d("MAWJidUtils").toProtocolMsgIdStringForMAWStorage(a)}function k(a){return(a==null?void 0:a.rowId)==null&&(a==null?void 0:a.externalId)==null}function l(a,b){try{var e=c("justknobx")._("3947");if(k(a)){b!=="get"&&d("Random").coinflip(h)&&c("FBLogger")("messenger_web").warn("Corrupted message row returned from DB, msg is null:%s, queryType: %s",a==null,b);return}(a==null?void 0:a.protocolMsgId)==null&&d("Random").coinflip(h)&&(d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_PROTOCOL_MSG_ID_INDEX,key:"null_protocol_msg_id.migration_version_"+d("MAWDBMigrationUtils").mawDbMigrationVersion.version+".append_protocol_msg_id_for_put_operation_jk_"+String(e)}),d("MAWDBMigrationUtils").mawDbMigrationVersion.version>=d("MAWDBMigrationUtils").MAWDB_DEDUPE_MSGS_MIGRATION_VERSION&&c("FBLogger")("maw_db_migration").warn("Message with null protocolMsgId after the msg dedupe migration. type: %s, rowId: %s, externalId: %s",a==null?void 0:a.type,a==null?void 0:a.rowId,a==null?void 0:a.externalId));a!=null&&a.protocolMsgId!=null&&a.protocolMsgId!==d("MAWJidUtils").toProtocolMsgIdStringForMAWStorage(a)&&d("Random").coinflip(h)&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_PROTOCOL_MSG_ID_INDEX,key:"inconsistent_protocol_msg_id."+(a==null?void 0:a.type)+".migration_version_"+d("MAWDBMigrationUtils").mawDbMigrationVersion.version+".append_protocol_msg_id_for_put_operation_jk_"+String(e)})}catch(a){c("FBLogger")("messenger_web").catching(a).mustfix("Error while checking protocol msg id")}}function a(){return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return b!=="messages"?a.table(b):i(a.table(b))}})}catch(b){c("FBLogger")("messenger_web").catching(b).mustfix("Error applying Protocol MsgId Middleware");return a}},name:"MAWDbProtocolMsgIdMiddleware",stack:"dbcore"}}g.appendProtocolMsgId=j;g.isCorruptedMsgRow=k;g.MAWDbProtocolMsgIdMiddleware=a}),98);
__d("MAWLSDataSyncMiddleware",["FBLogger","MAWBridge","MAWLSEditMsgHistoryAddedDataSyncHandler","MAWLSMsgsDataSync","MAWLSReactionsDataSyncHandler","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(){var a=new Set();a.add(d("MAWLSReactionsDataSyncHandler").mawLSReactionsDataSyncHandler);a.add(d("MAWLSEditMsgHistoryAddedDataSyncHandler").mawLSEditHistoryDataSyncHandler);a.add(d("MAWLSMsgsDataSync").mawLSMsgsDataSyncHandler);a.forEach(function(a){h.set(a.tableName,a)})}function j(a){return babelHelpers["extends"]({},a,{mutate:function(b){var c=h.get(a.name);return c!=null?c.performAndSyncMutation(b,a):a.mutate(b)}})}function a(){i();return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return h.has(b)?j(a.table(b)):a.table(b)}})}catch(d){var b=c("getErrorSafe")(d);c("FBLogger")("maw_db").catching(b).mustfix("Error applying MAW to LS data sync middleware");return a}},name:"MAWLSDataSyncMiddleware",stack:"dbcore"}}function b(a){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[a]})}g.getMAWLSDataSyncMiddleware=a;g.syncToLS=b}),98);
__d("MAWLSEditMsgHistoryAddedDataSyncHandler",["MAWIndexedDb","MAWLSDataSyncMiddleware"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.map(function(a){return babelHelpers["extends"]({},a)});d("MAWLSDataSyncMiddleware").syncToLS({tag:"EditMsgHistoryAdded",value:a})}a={performAndSyncMutation:function(a,b){switch(a.type){case"put":case"add":var c=[].concat(a.values);d("MAWIndexedDb").afterTransactionEffect(function(){return h(c)});break}return b.mutate(a)},tableName:"editMsgHistory"};g.mawLSEditHistoryDataSyncHandler=a}),98);
__d("MAWLSMsgsDataSync",["MAWBridgeTypesCreators","MAWIndexedDb","MAWLSDataSyncMiddleware"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c=b.keys;b=b.trans;return a.getMany({keys:c,trans:b}).then(function(a){return a.filter(Boolean)})}function i(a){a=a.reduce(function(a,b){var c=d("MAWBridgeTypesCreators").createBridgeDeletedMessage(b);a.has(b.threadJid)||a.set(b.threadJid,[]);(b=a.get(b.threadJid))==null||b.push(c);return a},new Map());a.entries().forEach(function(a){var b=a[0];a=a[1];a={messages:a,threadJid:b};d("MAWLSDataSyncMiddleware").syncToLS({tag:"DeleteMessages",value:a})})}a={performAndSyncMutation:function(a,b){switch(a.type){case"delete":return h(b,a).then(function(c){d("MAWIndexedDb").afterTransactionEffect(function(){return i(c)});return b.mutate(a)});default:return b.mutate(a)}},tableName:"messages"};g.mawLSMsgsDataSyncHandler=a}),98);
__d("MAWLSReactionsDataSyncHandler",["MAWBridgeTypesCreators","MAWIndexedDb","MAWLSDataSyncMiddleware"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.author,c=a.reaction,e=a.reactToMsgId,f=a.threadJid;a=a.ts;if(e==null)return;d("MAWLSDataSyncMiddleware").syncToLS({tag:"UpsertReaction",value:d("MAWBridgeTypesCreators").createBridgeUpsertReaction({author:b,chatJid:f,reaction:c||"",reactToMsgId:e,ts:a})})}function i(a){var b=a.author,c=a.reactToMsgId;a=a.threadJid;if(c==null)return;d("MAWLSDataSyncMiddleware").syncToLS({tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:b,chatJid:a,reactToMsgId:c})})}function j(a){a.forEach(function(a){a.reaction==null?i(a):h(a)})}a={performAndSyncMutation:function(a,b){switch(a.type){case"put":case"add":var c=[].concat(a.values);d("MAWIndexedDb").afterTransactionEffect(function(){return j(c)});break}return b.mutate(a)},tableName:"reactions"};g.mawLSReactionsDataSyncHandler=a}),98);
__d("MAWDbReaction",["FBLogger","I64","MAWAckLevel","MAWGetBumpTimestampMs","MAWUserJidWrapper","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){var b=d("MAWUserJidWrapper").getMyUserJid();if(a.reactToAuthor!=="@me"&&a.reactToAuthor!==b||a.reaction==null)return null;b=a.author==="@me"||a.author==="@system"?null:a.author;return b==null?null:babelHelpers["extends"]({},a,{author:b,reaction:a.reaction,reactToAuthor:"@me"})}function a(a){a=i(a);if(a==null)throw c("FBLogger")("messenger_web").mustfixThrow("Cannot cast reaction to incomingDbReaction");return a}function b(a,b,c){var e=d("MAWUserJidWrapper").getMyUserJid();return a.find(function(a){return a.threadJid===b&&d("WAJids").authorToUserId(a.author,e)===d("WAJids").authorToUserId(c,e)})}function e(a){return a}function f(a,b,c,e,f,g,h,i,j,k,l,m,n){m===void 0&&(m=d("MAWAckLevel").ACK.clock);m={ack:m,author:k,externalId:b,groupingKey:g,reaction:f,reactionId:c,reactToAuthor:h,reactToExternalId:e,reactToMsgId:i,senderTimestampMs:n,threadJid:a,ts:j};return l!=null?babelHelpers["extends"]({},m,{rowId:l}):m}function j(a){a=d("MAWGetBumpTimestampMs").getBumpTimestampMs(a);return d("WATimeUtils").castToMillisTime((h||(h=d("I64"))).to_float(a))}g.maybeCastToIncomingDbReaction=i;g.castToIncomingDbReaction=a;g.findMatchingReaction=b;g.reactionIdToMsgId=e;g.formatReactionForDb=f;g.getReactionTimeMs=j}),98);
__d("MAWThreadNewestMsgOrReactionUtils",["FBLogger","MAWDbMsg","MAWDbMsgTxns","MAWDbReaction","MAWDbReactionsTxns","MAWDexieTable","MAWGetThreadUpdateType","MAWODSProxy","MAWThreadUpdateType","WALogger","WAMsg","WAOdsEnums","WATimeUtils","first","last"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return l(a,b,i)}function i(a,b){switch(a){case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD:return b!==!0;case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY:return!1;default:throw c("FBLogger")("messenger_web").mustfixThrow("[MAWCentralizedThreadUpdate] Unhandled threadUpdateType to create filter function : "+a)}}function b(a,b){return l(a,b,j)}function e(a){var b=a.db,c=a.jid;a=a.limit;return d("MAWDbMsgTxns").fetchMessagesFromDbWithSortOrderMs(b,c,null,!0,a,function(a){return k(d("MAWGetThreadUpdateType").getThreadUpdateTypeForMsg(a),a.ephemeralMsgDisappeared===!0)},"before")}function j(a,b){switch(a){case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD:return b!==!0;case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:return!1;default:throw c("FBLogger")("messenger_web").mustfixThrow("[MAWCentralizedThreadUpdate] Unhandled threadUpdateType to create filter function : %s",a)}}function k(a,b){switch(a){case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.MARK_THREAD_AS_UNREAD:return b!==!0;case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.NO_SNIPPET_OR_ACTIVITY_TS_UPDATE:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.SNIPPET_ONLY:case d("MAWThreadUpdateType").THREAD_UPDATE_TYPE.BUMP_THREAD:return!1;default:throw c("FBLogger")("messenger_web").mustfixThrow("[MAWCacheService] Unhandled threadUpdateType to create filter function : %s",a)}}function l(a,b,c){var e=function(e){return e==null?d("MAWDexieTable").dexieResolve(null):n(a,b,c,e)};return m(a,b,c).then(function(a){return e(a).then(function(c){if(a==null&&c==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[CentralizedThreadUpdate] No Reaction or Message in "," is eligible for snippet"])),b);return null}if(c==null)return a;if(a==null)return c;var e=d("WATimeUtils").castToMillisTime(d("MAWDbMsg").getSortOrderWithFallback(a)),f=d("MAWDbReaction").getReactionTimeMs(c);return e>=f?a:c})})}function m(a,b,e){return d("MAWDbMsgTxns").fetchMessagesFromDbWithSortOrderMs(a,b,null,!0,1,function(a){return e(d("MAWGetThreadUpdateType").getThreadUpdateTypeForMsg(a),a.ephemeralMsgDisappeared===!0)},"before").then(c("first"))}function n(a,b,e,f){var g=d("MAWDbMsg").getSortOrderWithFallback(f),h=function(c,f){return d("MAWDbReactionsTxns").fetchReactionsFromDbWithTimestamp(a,b,d("WATimeUtils").castToMillisTime(g),f,f==null,c,function(a){return e(d("MAWGetThreadUpdateType").getThreadUpdateTypeForReaction(a),!1)&&d("MAWDbReaction").getReactionTimeMs(a)>g})},i=[1,10],j=100,k=new Set(),l=function(b,e){var f;return h((f=i[b])!=null?f:j,e).then(function(e){var f=e.filter(function(a){return!k.has(q(a))});if(f.length===0){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREAD_GET_NEWEST_REACTION_BATCH_NUM,key:"new."+b});return null}return o(a,f).then(function(a){var f=a.newestReaction;a=a.nullMsgIds;if(f!=null){d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_THREAD_GET_NEWEST_REACTION_BATCH_NUM,key:"new."+b});return f}a.forEach(function(a){return k.add(a)});return l(b+1,c("last")(e))})})};return l(0,null)}function o(a,b){return d("MAWDbMsgTxns").getUniqueMsgsByProtocolMsgIds(a,b.map(p)).then(function(a){var c=new Set(a.map(r)),d=new Set(),e=null;b.forEach(function(a){var b=q(a);c.has(b)?e=s(e,a):d.add(b)});return{newestReaction:e,nullMsgIds:d}})}function p(a){return{author:a.reactToAuthor,chat:a.threadJid,externalId:a.reactToExternalId}}function q(a){return d("WAMsg").craftWAMsgIdString(p(a))}function r(a){return d("WAMsg").craftWAMsgIdString({author:a.author,chat:a.threadJid,externalId:a.externalId})}function s(a,b){if(a==null)return b;return b==null?a:d("MAWDbReaction").getReactionTimeMs(a)>d("MAWDbReaction").getReactionTimeMs(b)?a:b}g.getNewestMsgOrReactionForBump=a;g.filterForBump=i;g.getNewestMsgOrReactionForSnippet=b;g.getNewestIncomingMsgsForSnippet=e;g.filterForSnippet=j;g.filterForSnippetNewestIncomingMessages=k;g.getNewestReactionToNonNullMsg=o}),98);
__d("MAWLocalizationUtils",["MAWAckLevel","MAWLocalizationType","MAWMsgType","WAJids","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set([(f=d("MAWLocalizationType")).LOCALIZATION_TYPE.CURRENT_USER_CREATED_POLL,f.LOCALIZATION_TYPE.PARTICIPANT_CREATED_POLL,f.LOCALIZATION_TYPE.CURRENT_USER_ADDED_POLL_OPTION,f.LOCALIZATION_TYPE.PARTICIPANT_ADDED_POLL_OPTION,f.LOCALIZATION_TYPE.CURRENT_USER_ADDED_MULTIPLE_POLL_OPTIONS,f.LOCALIZATION_TYPE.PARTICIPANT_ADDED_MULTIPLE_POLL_OPTIONS,f.LOCALIZATION_TYPE.CURRENT_USER_ADDED_POLL_VOTE,f.LOCALIZATION_TYPE.PARTICIPANT_ADDED_POLL_VOTE,f.LOCALIZATION_TYPE.CURRENT_USER_ADDED_MULTIPLE_POLL_VOTES,f.LOCALIZATION_TYPE.PARTICIPANT_ADDED_MULTIPLE_POLL_VOTES,f.LOCALIZATION_TYPE.CURRENT_USER_REMOVED_POLL_VOTE,f.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_POLL_VOTE,f.LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MULTIPLE_POLL_VOTES,f.LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MULTIPLE_POLL_VOTES,f.LOCALIZATION_TYPE.CURRENT_USER_MIXED_POLL_UPDATE,f.LOCALIZATION_TYPE.PARTICIPANT_MIXED_POLL_UPDATE,f.LOCALIZATION_TYPE.CURRENT_USER_CHANGED_POLL_VOTE,f.LOCALIZATION_TYPE.PARTICIPANT_CHANGED_POLL_VOTE,f.LOCALIZATION_TYPE.CURRENT_USER_CHANGED_MULTIPLE_POLL_VOTES,f.LOCALIZATION_TYPE.PARTICIPANT_CHANGED_MULTIPLE_POLL_VOTES,f.LOCALIZATION_TYPE.POLL_UNSENT_UPDATE]);function a(a,b,c,e,f,g){return{ack:d("MAWAckLevel").ACK.sent,altIndex:f!=null?f:void 0,author:d("WAJids").AUTHOR_SYSTEM,externalId:c,msgContent:a,sortOrderMs:g,threadJid:b,ts:e!=null?e:d("WATimeUtils").unixTime(),type:d("MAWMsgType").MSG_TYPE.ADMIN}}function b(a){if(h.has(a))return!0;switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_NAMED_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_PROMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_GOT_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PROMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SELF_DEMOTED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_DEMOTED_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CUSTOMIZE_PHOTO:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNPINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_HOTLIKE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_THEME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PHOTO:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_PINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNPINNED_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CUSTOMIZE_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_CLEAR_PARTICIPANT_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_OWN_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_CLEAR_CURRENT_USER_NICKNAME:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_MINUTES:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_HOURS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_DAYS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_OFF:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_TURNED_ON_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_SETTING_CHANGE_SECONDS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_TAKE_SCREENSHOT:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_EPHEMERAL_RECORD_SCREEN:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SET_ADD_MODE_ALL_MEMBERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SET_ADD_MODE_ALL_MEMBERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ADMIN_ONLY:case d("MAWLocalizationType").LOCALIZATION_TYPE.SERVER_SET_ADD_MODE_ALL_MEMBERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_UK_OSA_ADMIN_MESSAGE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_LIMIT_SHARING_DISABLED:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_LIMIT_SHARING_ENABLED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LIMIT_SHARING_DISABLED:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LIMIT_SHARING_ENABLED:return!0}return!1}function c(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UPDATED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_DEVICE:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UPDATED_DEVICE:return!0}return!1}function e(a){switch(a){case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_ADDED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_ADDED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_ONE_PARTICIPANT:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_REMOVED_MORE_THAN_TWO_PARTICIPANTS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_YOU_AND_MORE_THAN_ONE_USERS:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_YOU:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_YOU_AND_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_YOU_AND_MORE_THAN_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_ONE_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.UNKNOWN_USER_REMOVED_MORE_THAN_TWO_USER:case d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP:return!0}return!1}g.POLL_ADMIN_MSG_TYPES=h;g.buildUnstoredDbAdminMsg=a;g.isAdminMsgNormalized=b;g.isDeviceChangeAdminMsg=c;g.isParticipantChangeAdminMsg=e}),98);
__d("MAWThreadSnippetForAdminOrEphemeralMsg",["FBLogger","MAWAdminMsgNormalized","MAWLocalizationType","MAWLocalizationUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e;e=(e=a.msgContent)==null?void 0:e.adminType;a=(a=a.msgContent)==null?void 0:a.adminMsgContent;if(e==null||a==null){c("FBLogger")("GroupPollsE2EE").mustfix("MAWThreadSnippetForAdminOrEphemeralMsg: snippetType or adminMsgContent is null");return{snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:b,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET}}a=d("MAWLocalizationUtils").isAdminMsgNormalized(e)?d("MAWAdminMsgNormalized").deconstructContactIdsFromAdminContent(e,a):{contactIds:[],contents:a};var f=a.contactIds;a=a.contents;return{snippetParams:{contactIDs:[].concat(f.map(function(a){return a==="Facebook User"?"0":a})),strings:[].concat(a)},snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForBumpExistingMessageMsg",["MAWLocalizationType","WAGlobals","WAJids","WALogger","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(a,b,c){return{snippetParams:{contactIDs:c!=null?c:[],strings:[]},snippetSenderContactId:a,snippetType:b}}var m=function(a){return l(a,d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET)};function a(a,b){var c;if(d("WAJids").isAuthorSystem(a.author)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Bumped message can not have AUTHOR_SYSTEM"])));return m(b)}c=(c=a.quote)==null?void 0:c.content.type;if(c===d("WAMsgType").UNAVAILABLE){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Bump message has unavailable content type"])));return m(b)}c=(c=a.quote)==null?void 0:c.content.author;if(c==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Bump message has no quoted author"])));return m(b)}if(d("WAJids").isAuthorMe(a.author)||a.author===d("WAGlobals").getMyUserJid())return d("WAJids").isAuthorMe(c)||c===d("WAGlobals").getMyUserJid()?l(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_OWN_MESSAGE):l(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_MESSAGE,[d("WAJids").userIdFromJid(c)]);if(b==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Bump message sender is null"])));return m(b)}if(d("WAJids").isAuthorMe(c)||c===d("WAGlobals").getMyUserJid())return l(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_CURRENT_USER_MESSAGE,[b]);return c===a.author?l(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_OWN_MESSAGE,[b]):l(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE,[b,d("WAJids").userIdFromJid(c)])}g["default"]=a}),98);
__d("MAWThreadSnippetForCiphertextMsg",["MAWLocalizationType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:a,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.USER_SEND_ENCRYPTED_MESSAGE_FALLBACK}}g["default"]=a}),98);
__d("MAWThreadSnippetForDocumentFileMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Document file message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForFallbackMessageMsg",["MAWLocalizationType","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return{snippetParams:{contactIDs:c!=null?c:[],strings:[]},snippetSenderContactId:a,snippetType:b}}function a(a,b){var c=a.author;a=a.msgContent.subtype;if(d("WAJids").isAuthorMe(c))switch(a){case"liveLocationMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_LIVE_LOCATION_FALLBACK);case"locationMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_LOCATION_FALLBACK);case"contactShareMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_CONTACT_SHARE_FALLBACK);case"storyMentionMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STORY_MENTION_FALLBACK);case"postMentionMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_POST_MENTION_FALLBACK);case"pollCreationMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_POLL_CREATION_FALLBACK);case"bumpMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_BUMPED_MESSAGE);case"stickerReceiverFetchMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK);case"messengerMemory":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.MESSENGER_MEMORY_ENCRYPTED_MESSAGE_FALLBACK);default:return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET)}else switch(a){case"liveLocationMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_LIVE_LOCATION_FALLBACK);case"locationMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_LOCATION_FALLBACK);case"contactShareMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_CONTACT_SHARE_FALLBACK);case"storyMentionMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STORY_MENTION_FALLBACK);case"postMentionMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_POST_MENTION_FALLBACK);case"pollCreationMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_POLL_CREATION_FALLBACK);case"bumpMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_BUMPED_PARTICIPANT_MESSAGE);case"metaAiMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.META_AI_SEND_MESSAGE_FALLBACK);case"stickerReceiverFetchMessage":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER_RECEIVER_FETCH_MESSAGE_FALLBACK);case"messengerMemory":return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.MESSENGER_MEMORY_ENCRYPTED_MESSAGE_FALLBACK);default:return h(b,d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET)}}g["default"]=a}),98);
__d("MAWThreadSnippetForGifMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_GIF:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Animated message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_GIF,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForImageMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_IMAGE:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Image message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForPttMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_AUDIO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Ptt message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_AUDIO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForRavenMsg",["MAWLocalizationType","MAWMsg","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=a.ravenMediaType===d("MAWMsg").MAWRavenMsgMediaType.IMAGE?d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_IMAGE:d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_VIDEO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Animated message can not have AUTHOR_SYSTEM"]))):(e=a.ravenMediaType===d("MAWMsg").MAWRavenMsgMediaType.IMAGE?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_IMAGE:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForMsgUtils",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c){var e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;b={contactIDs:[],mentionJIDs:b!=null?b:[],strings:[]};d("WAJids").isAuthorMe(a)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STICKER:d("WAJids").isAuthorSystem(a)||c==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Sticker message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STICKER,b.contactIDs.push(c));return{snippetParams:b,snippetSenderContactId:c,snippetType:e}}g.getMAWThreadSnippetForStickerMsg=a}),98);
__d("MAWThreadSnippetForReceiverFetchMsg",["MAWThreadSnippetForMsgUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWThreadSnippetForMsgUtils").getMAWThreadSnippetForStickerMsg(a.author,(a=a.msgContent)==null?void 0:a.mentionedJids,b)}g["default"]=a}),98);
__d("MAWThreadSnippetForRevokedMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_UNSENT_MESSAGE:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Revoked message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_UNSENT_MESSAGE,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForStickerMsg",["MAWThreadSnippetForMsgUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MAWThreadSnippetForMsgUtils").getMAWThreadSnippetForStickerMsg(a.author,(a=a.msgContent)==null?void 0:a.mentionedJids,b)}g["default"]=a}),98);
__d("MAWThreadSnippetForTextMsg",["MAWLocalizationType","MAWVault","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c){var e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET,f={contactIDs:[],mentionJIDs:a.msgContent.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_TEXT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Text message can not have AUTHOR_SYSTEM"]))):(e=c?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT_IN_GROUP:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_TEXT,f.contactIDs.push(b));if(a.specialTextSize===1||a.specialTextSize===2||a.specialTextSize===3){c=d("MAWVault").unvault(a.msgContent.content);f.strings.push(c==="\ud83d\udc4d"?"(Y)":a.msgContent.content)}else f.strings.push(a.msgContent.content);return{snippetParams:f,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForVideoMsg",["MAWLocalizationType","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_VIDEO:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Video message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_VIDEO,c.contactIDs.push(b));return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}g["default"]=a}),98);
__d("MAWThreadSnippetForXMAMsg",["MAWLocalizationType","WAArmadilloXMA.pb","WAJids","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;function a(a,b){var c,e=d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET;c={contactIDs:[],mentionJIDs:(c=a.msgContent)==null?void 0:c.mentionedJids,strings:[]};a.xmaMessageType==null&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["XMA message does not have xmaMessageType"])));switch(a.xmaMessageType){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PROFILE_DIRECTORY_ITEM:if(d("WAJids").isAuthorMe(a.author)){var f;if(a.msgContent!=null&&((f=a.msgContent)==null?void 0:f.content)!=null){f=a.msgContent.content;e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT;f!=null&&c.strings.push(f)}else e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_ATTACHMENT}else if(d("WAJids").isAuthorSystem(a.author)||b==null)d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"])));else{e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_ATTACHMENT;c.contactIDs.push(b);f=(f=a.msgContent)==null?void 0:f.content;f!=null&&c.strings.push(f)}break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_POST_MENTION:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_POST_MENTION:e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_POST_MENTION;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_MEMORIES_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_MEMORIES_SHARE:e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_MEMORIES_SHARE;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_STORY_MENTION:e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_STORY_MENTION;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_LOCATION:e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_LOCATION;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_CONTACT:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_AI_CONTACT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SEND_CONTACT_SHARE:e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SEND_CONTACT_SHARE;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_REEL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_REEL;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_POST:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_POST;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_POST:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_POST;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_STORY_HIGHLIGHT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_STORY_HIGHLIGHT;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_MENTION:if(d("WAJids").isAuthorMe(a.author)){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG;f=a.threadJid;var g;f!=null&&(g=d("WAJids").interpretAsUserJid(f));if(g!=null){f=d("WAJids").userIdFromJid(g);c.contactIDs.push(f)}else d("WALogger").ERROR(t||(t=babelHelpers.taggedTemplateLiteralLoose(["XMA story mentions must have a target Jid"])))}else d("WAJids").isAuthorSystem(a.author)?d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_RECEIVED_STORY_MENTION_IG;break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:if(d("WAJids").isAuthorMe(a.author)){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_AUDIO_CALLED;f=H(a);f!=null?c.contactIDs.push(f):d("WALogger").ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["RTC XMA must have a target Jid"])))}else d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_AUDIO_CALLED,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:if(d("WAJids").isAuthorMe(a.author)&&b!=null){e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_VIDEO_CALLED;f=H(a);f!=null?c.contactIDs.push(f):d("WALogger").ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["RTC XMA must have a target Jid"])))}else d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(y||(y=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_VIDEO_CALLED,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:if(d("WAJids").isAuthorMe(a.author)){e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_AUDIO_CALL;f=H(a);f!=null?c.contactIDs.push(f):d("WALogger").ERROR(z||(z=babelHelpers.taggedTemplateLiteralLoose(["RTC XMA must have a target Jid"])))}else d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(A||(A=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_AUDIO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:if(d("WAJids").isAuthorMe(a.author)){e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_MISSED_VIDEO_CALL;f=H(a);f!=null?c.contactIDs.push(f):d("WALogger").ERROR(B||(B=babelHelpers.taggedTemplateLiteralLoose(["RTC XMA must have a target Jid"])))}else d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(C||(C=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MISSED_VIDEO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_AUDIO_CALL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(D||(D=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_AUDIO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:d("WAJids").isAuthorMe(a.author)&&b!=null?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_STARTED_GROUP_VIDEO_CALL:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(E||(E=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_STARTED_GROUP_VIDEO_CALL,c.contactIDs.push(b));break;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:d("WAJids").isAuthorMe(a.author)?e=d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_SENT_EVENT:d("WAJids").isAuthorSystem(a.author)||b==null?d("WALogger").ERROR(F||(F=babelHelpers.taggedTemplateLiteralLoose(["XMA message can not have AUTHOR_SYSTEM"]))):(e=d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_SENT_EVENT,c.contactIDs.push(b));break;default:d("WALogger").ERROR(G||(G=babelHelpers.taggedTemplateLiteralLoose(["Encountered unexpected XMAMessageType when building a thread snippet: ",""])),a.xmaMessageType)}return{snippetParams:c,snippetSenderContactId:b,snippetType:e}}function H(a){a=a.threadJid!=null?d("WAJids").interpretAsUserJid(a.threadJid):null;return a!=null?d("WAJids").userIdFromJid(a):null}g["default"]=a}),98);
__d("MAWThreadSnippet",["FBLogger","MAWLocalizationType","MAWMsgType","MAWThreadSnippetForAdminOrEphemeralMsg","MAWThreadSnippetForBumpExistingMessageMsg","MAWThreadSnippetForCiphertextMsg","MAWThreadSnippetForDocumentFileMsg","MAWThreadSnippetForFallbackMessageMsg","MAWThreadSnippetForGifMsg","MAWThreadSnippetForImageMsg","MAWThreadSnippetForPttMsg","MAWThreadSnippetForRavenMsg","MAWThreadSnippetForReceiverFetchMsg","MAWThreadSnippetForRevokedMsg","MAWThreadSnippetForStickerMsg","MAWThreadSnippetForTextMsg","MAWThreadSnippetForVideoMsg","MAWThreadSnippetForXMAMsg","MAWUserJidWrapper","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return/^\d+$/.test(a)}function i(a){if(d("WAJids").isAuthorSystem(a))return;a=d("WAJids").isAuthorMe(a)?d("WAJids").userIdFromJid(d("MAWUserJidWrapper").getMyUserJid()):d("WAJids").userIdFromJid(a);if(!h(a)){c("FBLogger")("messenger_web").mustfix("[MAWThreadSnippetBuildTxns] Snippet sender contact id is invalid");return}return a}function a(a){var b=a.chatJid;a=a.dbMsg;b=d("WAJids").switchOnMsgrChatJidType(b,{group:function(a){return!0},user:function(a){return!1}});var e=i(a.author);switch(a.type){case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:return c("MAWThreadSnippetForCiphertextMsg")(e);case d("MAWMsgType").MSG_TYPE.TEXT:return c("MAWThreadSnippetForTextMsg")(a,e,b);case d("MAWMsgType").MSG_TYPE.IMAGE:return c("MAWThreadSnippetForImageMsg")(a,e);case d("MAWMsgType").MSG_TYPE.VIDEO:return c("MAWThreadSnippetForVideoMsg")(a,e);case d("MAWMsgType").MSG_TYPE.PTT:return c("MAWThreadSnippetForPttMsg")(a,e);case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:case d("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE:return c("MAWThreadSnippetForAdminOrEphemeralMsg")(a,e);case d("MAWMsgType").MSG_TYPE.GIF:return c("MAWThreadSnippetForGifMsg")(a,e);case d("MAWMsgType").MSG_TYPE.STICKER:return c("MAWThreadSnippetForStickerMsg")(a,e);case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return c("MAWThreadSnippetForDocumentFileMsg")(a,e);case d("MAWMsgType").MSG_TYPE.REVOKED:return c("MAWThreadSnippetForRevokedMsg")(a,e);case d("MAWMsgType").MSG_TYPE.XMA:return c("MAWThreadSnippetForXMAMsg")(a,e);case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:return c("MAWThreadSnippetForBumpExistingMessageMsg")(a,e);case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:return c("MAWThreadSnippetForFallbackMessageMsg")(a,e);case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return c("MAWThreadSnippetForReceiverFetchMsg")(a,e);case d("MAWMsgType").MSG_TYPE.RAVEN:return c("MAWThreadSnippetForRavenMsg")(a,e);default:return{snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:e,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET}}}function b(a,b){a=d("WAJids").switchOnMsgrChatJidType(a,{group:function(a){return!0},user:function(a){return!1}});return j(b,a)}function j(a,b){var e=i(a.author);switch(a.type){case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:return c("MAWThreadSnippetForCiphertextMsg")(e);case d("MAWMsgType").MSG_TYPE.TEXT:return c("MAWThreadSnippetForTextMsg")(a,e,b);case d("MAWMsgType").MSG_TYPE.IMAGE:return c("MAWThreadSnippetForImageMsg")(a,e);case d("MAWMsgType").MSG_TYPE.VIDEO:return c("MAWThreadSnippetForVideoMsg")(a,e);case d("MAWMsgType").MSG_TYPE.PTT:return c("MAWThreadSnippetForPttMsg")(a,e);case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:case d("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE:return c("MAWThreadSnippetForAdminOrEphemeralMsg")(a,e);case d("MAWMsgType").MSG_TYPE.GIF:return c("MAWThreadSnippetForGifMsg")(a,e);case d("MAWMsgType").MSG_TYPE.STICKER:return c("MAWThreadSnippetForStickerMsg")(a,e);case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return c("MAWThreadSnippetForDocumentFileMsg")(a,e);case d("MAWMsgType").MSG_TYPE.REVOKED:return c("MAWThreadSnippetForRevokedMsg")(a,e);case d("MAWMsgType").MSG_TYPE.XMA:return c("MAWThreadSnippetForXMAMsg")(a,e);case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:return c("MAWThreadSnippetForBumpExistingMessageMsg")(a,e);case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:return c("MAWThreadSnippetForFallbackMessageMsg")(a,e);case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return c("MAWThreadSnippetForReceiverFetchMsg")(a,e);case d("MAWMsgType").MSG_TYPE.RAVEN:return c("MAWThreadSnippetForRavenMsg")(a,e);default:return{snippetParams:{contactIDs:[],strings:[]},snippetSenderContactId:e,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.UNAVAILABLE_SNIPPET}}}g.getSnippetContactId=i;g.buildThreadSnippetV2=a;g.buildThreadSnippet=b}),98);
__d("WAProtocolMsgId",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.externalId===b.externalId&&a.author===b.author&&a.chat===b.chat}f.equals=a}),66);
__d("MAWThreadSnippetBuildTxns",["FBLogger","MAWDbMsg","MAWDbMsgOrReaction","MAWDbReaction","MAWDexieTable","MAWJidUtils","MAWLocalizationType","MAWThreadSnippet","MAWThreadSnippetUtils","MAWUserJidWrapper","WAJids","WAProtocolMsgId","WATimeUtils","emptyFunction","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return d("WAJids").switchOnMsgrChatJidType(c,{group:function(c){return i(a,b,!0)},user:function(c){return i(a,b,!1)}})}function a(a,b){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionMaybeUnstored(b,{forMessage:function(b){return d("MAWThreadSnippet").buildThreadSnippet(a,b)},forReaction:function(a){a=d("MAWDbReaction").castToIncomingDbReaction(a);return h(a.author,a.reaction,a.threadJid)}})}function i(a,b,e){var f;d("WAJids").isAuthorMe(a)?(c("FBLogger")("messenger_web").warn("[MAWThreadSnippetBuildTxns] Reaction snippet author should not be @me"),f=d("WAJids").userIdFromJid(d("MAWUserJidWrapper").getMyUserJid())):f=d("WAJids").userIdFromJid(a);a={contactIDs:[],strings:[]};e=e?d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE_IN_GROUP:d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_REACT_MESSAGE;a.contactIDs.push(f);a.strings.push(b);return{snippetParams:a,snippetSenderContactId:f,snippetType:e}}function b(a,b,e,f){var g=e.newestReaction,h=e.reactionsToClear;if(g!=null&&d("WATimeUtils").castUnixTimeToMillisTime(g.ts)>((e=b.snippetMsgTs)!=null?e:0))return d("MAWDexieTable").dexieResolve({newestReaction:g,thread:j(b,g,f)});e=c("justknobx")._("2763")?h!=null&&h.length>0:h!=null;return e&&b.snippetMsg!=null?a.reactions.get({reactionId:b.snippetMsg}).then(function(c){var e=!1;if(c==null)e=!0;else{var f=d("MAWJidUtils").maybeToProtocolMsgId(c.author,c.threadJid,c.reactToExternalId);f!=null&&(e=h.some(function(a){a=d("MAWJidUtils").maybeToProtocolMsgId(a.author,a.threadJid,a.reactToExternalId);return a!=null&&d("WAProtocolMsgId").equals(a,f)}))}return e?k(a,b).then(function(a){return{newestReaction:null,thread:a}}):d("MAWDexieTable").dexieResolve({newestReaction:null,thread:b})}):d("MAWDexieTable").dexieResolve({newestReaction:null,thread:b})}function j(a,b,c){return babelHelpers["extends"]({},a,{snippetMsg:b.reactionId,snippetMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(b.ts)})}function k(a,b){return d("MAWThreadSnippetUtils").recalculateSnippetFromScratch_EXPENSIVE(a,b).then(function(a){if(a==null){c("FBLogger")("messenger_web").mustfix("[Occamadillo] ThreadUpdated handler called for clear snippet when centralized thread bump is enabled");return babelHelpers["extends"]({},b,{snippetMsg:void 0,snippetMsgTs:void 0})}var e=d("WATimeUtils").castUnixTimeToMillisTime(d("MAWDbMsg").getCanonicalTsFromMsg(a));return babelHelpers["extends"]({},b,{snippetMsg:a.msgId,snippetMsgTs:e})})}function e(a,b){return k(a,b).then(function(b){return a.threads.put(b).then(c("emptyFunction"))})}g.buildReactionThreadSnippet=h;g.buildThreadSnippetForMsgOrIncomingReaction=a;g.getReactionSnippetParams=i;g.getThreadChangesetForReactionChanges=b;g.getThreadChangesetForNewReaction=j;g.refreshThreadSnippet=e}),98);
__d("MAWEphemeralMsgUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return function(b){return!a.has(b.msgId)&&b.ephemeralMsgDisappeared!==!0}}f.filterNonExpiredMsg=a}),66);
__d("MAWThreadSnippetUtils",["MAWDbReaction","MAWDexieTable","MAWEphemeralMsgUtils","MAWJidUtils","MAWLocalizationType","MAWLocalizationUtils","MAWMsgType","MAWThreadNewestMsgOrReactionUtils","MAWThreadSnippet","MAWThreadSnippetBuildTxns","MAWXMAUtils","MWThreadListConsts","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b;if(j(a))return!0;b=((b=a.msgContent)==null?void 0:b.adminType)!=null?d("MAWLocalizationUtils").isDeviceChangeAdminMsg(a.msgContent.adminType):!1;if(a.type!==d("MAWMsgType").MSG_TYPE.ADMIN)return!1;a=a.msgContent.adminType;return a===d("MAWLocalizationType").LOCALIZATION_TYPE.DEBUG_MSG?!0:b}function a(a,b,c){return a.messages.where("[threadJid+sortOrderMs]").between([b.jid,Number.MIN_SAFE_INTEGER],[b.jid,Number.MAX_SAFE_INTEGER],!1,!1).filter(function(a){return(c==null||d("MAWEphemeralMsgUtils").filterNonExpiredMsg(c)(a))&&!h(a)}).reverse().first()}var i={snippetParams:{contactIDs:[],mentionJIDs:[],strings:[]},snippetSenderContactId:null,snippetType:d("MAWLocalizationType").LOCALIZATION_TYPE.EMPTY_SNIPPET};function b(a,b){return d("MAWThreadNewestMsgOrReactionUtils").getNewestMsgOrReactionForSnippet(a,b).then(function(c){return c==null?{snippet:i}:l(a,b).then(function(a){var d=k(b,c);return d==null?d:babelHelpers["extends"]({},d,{snippetNewestIncomingMsgsMetadata:a})})})}function j(a){return d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType)||d("MAWXMAUtils").isXMAMsgHighlightsTabFriendUpdatesReply(a.xmaMessageType)}function k(a,b){if(b.reactionId!=null){var c=d("MAWDbReaction").maybeCastToIncomingDbReaction(b);return c==null?{snippet:i}:{snippet:d("MAWThreadSnippetBuildTxns").buildReactionThreadSnippet(c.author,c.reaction,a),snippetMsgOrReaction:b}}switch(b.type){case d("MAWMsgType").MSG_TYPE.XMA:c=d("MAWJidUtils").toProtocolMsgId(b);return c==null?{snippet:i}:{snippet:d("MAWThreadSnippet").buildThreadSnippetV2({chatJid:b.threadJid,dbMsg:b}),snippetMsgOrReaction:b};default:return{snippet:d("MAWThreadSnippet").buildThreadSnippetV2({chatJid:b.threadJid,dbMsg:b}),snippetMsgOrReaction:b}}}function l(a,b){var e;e=(e=c("qex")._("1213"))!=null?e:!1;return!e?d("MAWDexieTable").dexieResolve(void 0):d("MAWThreadNewestMsgOrReactionUtils").getNewestIncomingMsgsForSnippet({db:a,jid:b,limit:d("MWThreadListConsts").SNIPPET_MAX_NEWEST_INCOMING_MESSAGES_COUNT}).then(function(a){return a.length===0?void 0:a.map(function(a){return{externalId:a.externalId,sortOrderMs:a.sortOrderMs}})})}g.isDbMsgDisabledForThreadSnippet=h;g.recalculateSnippetFromScratch_EXPENSIVE=a;g.EMPTY_SNIPPET_DATA=i;g.getThreadSnippetFromScratch=b;g.shouldIgnoreXMAMsgForSnippet=j}),98);
__d("MAWDbAppMeta",[],(function(a,b,c,d,e,f){"use strict";a={allowSecurityAlert:"allowSecurityAlert",allowSecurityAlertForSelf:"allowSecurityAlertForSelf",dbMigrationVersion:"dbMigrationVersion",deviceJid:"deviceJid",hasMigratedFromDexie:"hasMigratedFromDexie",hmacKey:"hmacKey",hotlikeSticker:"hotlikeSticker",isBackfilledForOccamadillo:"isBackfilledForOccamadillo",msgTypeVersion:"msgTypeVersion",restoreMigrationAttempts:"restoreMigrationAttempts",restoreToDexieMigrationComplete:"restoreToDexieMigrationComplete"};f.AppMetaKeysEnum=a}),66);
__d("MAWDBMigrationUtils",["MAWDbAppMeta","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a={batchSize:0,cursorValue:0,isRunning:!1};var h={version:0};b=d("MAWIndexedDb").makeMsgrTransactor({appMeta:d("MAWTransactionMode").READONLY},"getMigrationVersion",function(a){return function(){return a.appMeta.get(d("MAWDbAppMeta").AppMetaKeysEnum.dbMigrationVersion).then(function(a){a=(a=a==null?void 0:a.value.dbMigrationVersion)!=null?a:0;h.version=a;return a})}});c=6;g.mawDbDedupeMsgsMigrationStatus=a;g.mawDbMigrationVersion=h;g.getMigrationVersion=b;g.MAWDB_DEDUPE_MSGS_MIGRATION_VERSION=c}),98);
__d("MAWLoadReplyMediaTxns",["MAWBridgeReceiverFetchInfo","MAWDbMedia","MAWDbMsg","MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWMediaUtils","MAWMsgType","MAWUserJidWrapper","MAWXMAUtils","MWPBumpEntityKey","WAAssertUnreachable","WAJids","WALogger","WAMsgType","WAResultOrError","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n;function o(a,b,e){if(c("gkx")("2419")&&e!=null){e=d("MAWMediaUtils").genHMACPlaintextHash(e);return a.media.where("hashedPlaintextHash").equals(e).first()}else return a.media.get(b)}var p=new Set([(e=d("MAWDbMedia")).MEDIA_TYPE.IMAGE,e.MEDIA_TYPE.GIF,e.MEDIA_TYPE.PTT,e.MEDIA_TYPE.STICKER,e.MEDIA_TYPE.VIDEO,e.MEDIA_TYPE.DOCUMENT_FILE]);function q(a){var b;switch(a.mediaType){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:case d("MAWDbMedia").MEDIA_TYPE.GIF:case d("MAWDbMedia").MEDIA_TYPE.STICKER:b=a.validatedImageInfo;break;case d("MAWDbMedia").MEDIA_TYPE.VIDEO:b=a.validatedVideoInfo;break}a=b||{};var c=a.height,e=a.jpegThumbnailHeight,f=a.jpegThumbnailWidth;a=a.width;return{replyMediaPreviewHeight:e!=null?e:c,replyMediaPreviewWidth:f!=null?f:a}}function r(a){switch(a.type){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:return!0;case d("MAWMsgType").MSG_TYPE.XMA:if(c("gkx")("9921"))return!0;else return d("MAWXMAUtils").isXMAShare_DO_NOT_USE(a.xmaMessageType)||d("MAWXMAUtils").isXMAStoryReply(a.xmaMessageType);case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:case d("MAWMsgType").MSG_TYPE.GROUP_INVITE:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("WAMsgType").NOTE_REPLY:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:case d("MAWMsgType").MSG_TYPE.RAVEN:return!1;default:return c("WAAssertUnreachable")(a.type)}}function s(a,b,c){if(b==null)return d("MAWDexieTable").dexieResolve();a=o(a,b,c).then(function(a){if(a==null)return d("WAResultOrError").makeError("reply_media_not_found");if(!p.has(a.mediaType))return d("WAResultOrError").makeError("reply_media_type_unknown");var c=q(a),e=c.replyMediaPreviewHeight;c=c.replyMediaPreviewWidth;b!=null&&a.plaintextHash==null&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.reply_attachment_media_missing_plaintext_hash","load_reply_media_txns_for_reply_type_'unknown'}");return d("WAResultOrError").makeResult({replyMediaId:b,replyMediaPreviewHeight:e,replyMediaPreviewWidth:c,replyPlaintextHash:a.plaintextHash})});return a.then(function(a){if(a.success!==!0){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unable to fetch reply media with id ",": ",""])),b,a.error);return}return a.value})}function t(a,b){var c=b.defaultPreviewMediaId;if(c==null)return d("MAWDexieTable").dexieResolve({replyXMAId:b.xmaId});a=o(a,c).then(function(a){if(a==null)return d("WAResultOrError").makeError("reply_xma_media_not_found - "+b.targetType);if(!p.has(a.mediaType))return d("WAResultOrError").makeError("reply_xma_media_type_unknown");var c=q(a),e=c.replyMediaPreviewHeight;c=c.replyMediaPreviewWidth;return d("WAResultOrError").makeResult({replyMediaPreviewHeight:e,replyMediaPreviewWidth:c,replyPlaintextHash:a.plaintextHash,replyXMAId:b.xmaId})});return a.then(function(a){if(a.success!==!0){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unable to fetch reply media XMA with id ",": ",""])),b.xmaId,a.error);return}return a.value})}function a(a,b,e){var f,g;e===void 0&&(e=!1);f=((f=b.quote)==null?void 0:f.content)||{};var h=f.author,i=f.externalId,j=f.mediaId,k=f.msgId,l=f.plaintextHash,m=f.type;f=f.xmaMessageType;if(((g=b.quote)==null?void 0:g.content)==null||!r((g=b.quote)==null?void 0:g.content))return d("MAWDexieTable").dexieResolve();g=b.threadJid;b=h===d("MAWUserJidWrapper").getMyUserJid();b=b?d("WAJids").AUTHOR_ME:h;if(c("gkx")("9921")?m===d("MAWMsgType").MSG_TYPE.XMA:d("MAWXMAUtils").isXMAShare_DO_NOT_USE(f))return u(a,d("MAWJidUtils").maybeToProtocolMsgId(b,g,i));return m===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH?w(a,k):s(a,j,e?null:l)}function u(a,b){return b==null?d("MAWDexieTable").dexieResolve():d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,b).then(function(b){if(b==null||d("MAWXMAUtils").isXMAExpired(b.isTombstoned,b.targetExpiringAtSec))return;return t(a,b)})}function b(a,b){var e=b.author,f=b.externalId,g=b.mediaId,h=b.plaintextHash,i=b.threadJid,j=b.type,k=b.xmaMessageType;k=c("gkx")("9921")?j===d("MAWMsgType").MSG_TYPE.XMA:d("MAWXMAUtils").isXMAShare_DO_NOT_USE(k);j=j===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH;if(!d("MAWDbMsg").isMediaMsg(b)&&!k&&!j)return d("MAWDexieTable").dexieResolve();if(k)return u(a,d("MAWJidUtils").maybeToProtocolMsgId(e,i,f));return j?v(a,b.receiverFetchId):s(a,g,h)}function v(a,b,c){if(b==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Missing receiverFetchId for getReplyMediaForReceiverFetchWithReceiverFetchId"])));return d("MAWDexieTable").dexieResolve()}return a.receiverFetchInfo.get({receiverFetchId:b}).then(function(a){if(a==null){d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Missing receiverFetchInfo for getReplyMediaForReceiverFetchWithReceiverFetchId"])));return}try{var b=d("MAWDbMedia").convertNumberToMediaId(parseInt(a.receiverFetchId,10));c!=null&&d("MAWIndexedDb").afterTransaction({tag:"NewReceiverFetchInfo",value:d("MAWBridgeReceiverFetchInfo").createBridgeReceiverFetchInfoPayloadFromDbInfo(c.threadJid,c.msgId,c.sortOrderMs,c.ts,a)});return{replyMediaId:b,replyMediaPreviewHeight:a.previewHeight,replyMediaPreviewWidth:a.previewWidth}}catch(a){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unable to convert receiver fetch id to media id: ",""])),a);return}})}function w(a,b){if(b==null){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Missing msgId for getReplyMediaForReceiverFetch"])));return d("MAWDexieTable").dexieResolve()}return a.messages.get({msgId:b}).then(function(b){if(b==null||b.type!==d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH||b.receiverFetchId==null){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Invalid msg for getReplyMediaForReceiverFetch with type: ",""])),b==null?void 0:b.type);return}return v(a,b.receiverFetchId,b)})}g.getMedia=o;g.MSG_MEDIA_TYPE=p;g.getImageAttributes=q;g.isMediaReplyContent=r;g.getReplyMediaForMsgQuote=a;g.getReplyMediaForMsg=b}),98);
__d("MAWDbChunkTxns",["MAWDexieTable","MAWMediaUtils","MAWODSProxy","MWFBLogger","WAErrorMessage","WAOdsEnums"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=d("MWFBLogger").MWLogger().tags(["maw_db","txn","MAWDbChunkTxns"]);b=function(a,b,c,e,f){f===void 0&&(f=0);var g=d("MAWMediaUtils").genHMACPlaintextHash(b);return m(a,b,g,c,e,f)};var m=function(a,b,c,e,f,g){g===void 0&&(g=0);return a.chunk.where("hashedPlaintextHash").equals(c).first().then(function(n){if(n){g>0&&l.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Chunk found after retry for hashedPlaintextHash: ",""])),c);return n}else{var o={blobData:e,hashedPlaintextHash:c,mimetype:f,plaintextHash:b};return a.chunk.add(o).then(function(a){return babelHelpers["extends"]({},o,{chunkId:a})})["catch"](function(h){var n=d("WAErrorMessage").maybeGetMessageFromError(h);if(g>0){l.WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk for hashedPlaintextHash: ",". Error: ",""])),c,n);l.MUSTFIX(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk after retry. Error: ",""])),n);throw h}else{l.WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Failed to add chunk. Possible duplicate? Will attempt a retry. For hashedPlaintextHash: ",". Error: ",""])),c,n);d("MAWODSProxy").odsBumpEntityKey({amount:1,entity:d("WAOdsEnums").Entity.MAW_MEDIA_DB_DUPLICATE_CHUNK,key:"retry"});return m(a,b,c,e,f,g+1)}})}})},n=function(a,b){return a.chunk.where("hashedPlaintextHash").equals(b)},o=function(a,b){return n(a,b).count().then(function(a){return a>0})};c=function(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){return o(a,b).then(function(a){return[b,a]})})).then(function(a){return new Map(a)})};e=function(a,b){return n(a,b).first()};f=function(a,b){return a.chunk.where("hashedPlaintextHash").anyOf(b).toArray().then(function(a){return new Map(a.map(function(a){return[a.hashedPlaintextHash,a]}))})};function a(a,b){return a.chunk.bulkGet(b)}var p=function(a,b){b=d("MAWMediaUtils").genHMACPlaintextHash(b);return a.chunk.get({hashedPlaintextHash:b})};g.getOrCreateMediaChunkWithPlaintextHash=b;g.getOrCreateMediaChunkWithHashedPlaintextHash=m;g.hasMediaChunk=o;g.hasMediaChunks=c;g.maybeGetChunkFromHash=e;g.maybeBulkGetChunksFromHash=f;g.bulkGetChunks=a;g.maybeGetChunkByPlaintextHash=p}),98);
__d("MAWDbMediaTxns",["MAWDbMsg","MAWDexieTable","MAWMediaUtils","MAWMsgType","MAWODSProxy","WAHashUtils","WALogger","WAOdsEnums","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.media.get({mediaId:b})}function b(a,b){return b.length===0?d("MAWDexieTable").dexieResolve(new Map()):a.media.bulkGet(b).then(function(a){return new Map(a.filter(Boolean).map(function(a){return[a.mediaId,a]}))})}function l(a,b){return a.media.where("hashedPlaintextHash").equals(b).first()}function e(a,b){b=d("MAWMediaUtils").genHMACPlaintextHash(b);return l(a,b)}function f(a,b){b=b.map(function(a){return d("MAWMediaUtils").genHMACPlaintextHash(a)});return m(a,b)}function m(a,b){return a.media.where("hashedPlaintextHash").anyOf(b).toArray()}function n(a,b){return b==null?d("MAWDexieTable").dexieResolve():o(a,b).then(function(c){c=c==null?void 0:c.mediaId;return c!=null?a.media.get({mediaId:c}):a.media.get({objectId:b})})}function o(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.mediaBackup.get({objectId:b})}function p(a,b){if(b==null)return d("MAWDexieTable").dexieResolve();a=a.mediaBackup.where("msgId").equals(b).toArray();return a}function q(a,b){b=b.filter(d("MAWDbMsg").isMediaMsg);if(b.length===0)return d("MAWDexieTable").dexieResolve([]);d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[getMsgMediaPairFromMsgs] msgs: ",""])),b.map(function(a){return""+a.msgId}));var e=b.reduce(function(a,b){if(b.mediaId==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mediaId is null for media msg with msgId: "," and msg type ",""])),b.msgId,b.type);return a}return a.set(b.mediaId,b)},new Map());b=Array.from(e.keys());return t(a,b).then(function(a){var b=[];a.forEach(function(a){if(a==null)throw c("err")("Error missing media");var f=e.get(a.mediaId);if(f==null)throw c("err")("Error missing media");var g=d("MAWMediaUtils").genHMACPlaintextHash(a.plaintextHash);g!==a.hashedPlaintextHash&&(d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[getMsgMediaPairFromMsgs] encountered mismatched hashedPlaintextHash for media. PlaintextHash: ",""])),d("WAHashUtils").sanitisePlaintextHash(a.plaintextHash)),d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_MEDIA_MISMATCH_HASHED_PLAINTEXT_HASH,key:"mismatch."+f.type}));b.push([f,a])});return b})}function r(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isMediaMsg).map(function(a){var b=a.mediaId;if(b==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["mediaId is null for media msg with msgId: ",""])),a.msgId);throw c("err")("mediaId is missing")}else return b});return t(a,b).then(function(a){var b=[];a.forEach(function(a){a!=null&&b.push(a)});return b})}function s(a,b){if(b.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME||d("MAWDbMsg").isMediaMsg(b)){var c=b.mediaId;return c==null?b.type===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME?d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult()):d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeError("missing")):a.media.get(c).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}else return d("MAWDexieTable").dexieResolve(d("WAResultOrError").makeResult())}function t(a,b){return a.media.bulkGet(b)}function u(a,b){var c=b.previewMediaIds!=null?t(a,b.previewMediaIds):d("MAWDexieTable").dexieResolve(),e=b.headerMediaId!=null?a.media.get(b.headerMediaId):d("MAWDexieTable").dexieResolve(),f=b.faviconMediaId!=null?a.media.get(b.faviconMediaId):d("MAWDexieTable").dexieResolve();a=b.defaultPreviewMediaId!=null?a.media.get(b.defaultPreviewMediaId):d("MAWDexieTable").dexieResolve();return d("MAWDexieTable").dexieAll([c,e,f,a]).then(function(a){var c=a[0],e=a[1],f=a[2];a=a[3];if(b.headerMediaId!=null&&e==null)return d("WAResultOrError").makeError("missing");if(b.faviconMediaId!=null&&f==null)return d("WAResultOrError").makeError("missing");if(c==null)return d("WAResultOrError").makeError("missing");var g=[];for(c of c)if(c==null)return d("WAResultOrError").makeError("missing");else g.push(c);return d("WAResultOrError").makeResult({defaultPreview:a,favicon:f,header:e,previews:g})})}function v(a,b,c){b=babelHelpers["extends"]({},b,c);return a.media.put(b)}g.maybeGetMediaFromMediaId=a;g.maybeBulkGetMediaFromMediaId=b;g.maybeGetMediaFromHashedPlaintextHash=l;g.maybeGetMediaFromPlaintextHash=e;g.maybeBulkGetMediaFromPlaintextHash=f;g.maybeBulkGetMediaFromHashedPlaintextHash=m;g.maybeGetMediaFromObjectId=n;g.maybeGetMediaBackupRowFromObjectId=o;g.maybeGetMediaBackupRowFromMsgId=p;g.getMsgMediaPairFromMsgs=q;g.getMediaFromMsgs=r;g.getAndCheckMediaFromMsg=s;g.bulkGetMedias=t;g.getMediaForXMA=u;g.updateMedia=v}),98);
__d("WAMsgMap",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){var b=this;this.$1=new Map();a==null||a.forEach(function(a){var c=a[0];a=a[1];b.set(c,a)})}var b=a.prototype;b.clear=function(){this.$1.clear()};b["delete"]=function(a){var b;(b=this.$1.get(a.externalId))==null||(b=b.get(a.author))==null||b["delete"](a.chat)};b.get=function(a){var b;return(b=this.$1.get(a.externalId))==null||(b=b.get(a.author))==null?void 0:b.get(a.chat)};b.has=function(a){var b;return(b=(b=this.$1.get(a.externalId))==null||(b=b.get(a.author))==null?void 0:b.has(a.chat))!=null?b:!1};b.set=function(a,b){var c,d;c=(c=this.$1.get(a.externalId))!=null?c:new Map();this.$1.has(a.externalId)||this.$1.set(a.externalId,c);d=(d=c.get(a.author))!=null?d:new Map();c.has(a.author)||c.set(a.author,d);d.set(a.chat,b);return this};b.keys=function(){var a=[],b=this.$1;for(var c of b.keys()){var d;d=(d=b.get(c))!=null?d:new Map();for(var e of d.keys()){var f;f=(f=d.get(e))!=null?f:new Map();for(f of f.keys())a.push({externalId:c,author:e,chat:f})}}return a};b.entries=function(){var a=[],b=this.$1;for(var c of b.keys()){var d;d=(d=b.get(c))!=null?d:new Map();for(var e of d.keys()){var f;f=(f=d.get(e))!=null?f:new Map();for(var g of f.keys()){var h=f.get(g);h!=null&&a.push([{externalId:c,author:e,chat:g},h])}}}return a};b.values=function(){return this.entries().map(function(a){return a[1]})};return a}();f.MsgMap=a}),66);
__d("MAWDbMsgUtil",["WAJids","WALogger","WAMsgMap"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return a.reduce(function(a,b){var c=b.threadJid;if(c==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Missing jid prevents adding message to array map"])));return a}if(b.author==="@system"){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Invalid author when converting msg array to map"])));return a}a.set({author:b.author,chat:c,externalId:b.externalId},b);return a},new(d("WAMsgMap").MsgMap)())}function b(a){return d("WAJids").isAuthorSystem(a.author)||a.threadJid==null?null:{author:a.author,chat:a.threadJid,externalId:a.externalId}}g.convertMsgArrayToMap=a;g.getProtocolMsgIdFromDbMsg=b}),98);
__d("MAWDbUnrenderedMsgTxns",["MAWAckLevel","MAWDbMsg","MAWDbMsgUtil","MAWDexieTable","WAJids","WALogger","WAMsgMap","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b){var c=b.author,e=b.chat,f=b.externalId;return a.threads.get({jid:e}).then(function(b){return b==null?d("WAResultOrError").makeError("missing_thread_unrendered_msg"):k(a,f,e,c).then(function(a){return a==null?d("WAResultOrError").makeError("missing_unrendered_msg"):d("WAResultOrError").makeResult(a)})})}function b(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.unrenderedMessages.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function k(a,b,c,d){return a.unrenderedMessages.where("externalId").equals(b).filter(function(a){return a.author===d&&a.threadJid===c}).first()}function l(a,b){return a+"_"+b}function c(a,b){var c=b.map(function(a){a=a.externalId;return a}),e=Array.from(new Set(b.map(function(a){return a.chat})));return d("MAWDexieTable").dexieAll([a.threads.where("jid").anyOf(e).toArray(),a.unrenderedMessages.where("externalId").anyOf(c).toArray()]).then(function(a){var c=a[0];a=a[1];if(a.length===0||c.length===0)return[];var d=new Map();b.forEach(function(a){var b=a.author,c=a.chat;a=a.externalId;var e=d.get(a)||new Set();e.add(l(b,c));d.set(a,e)});return a.filter(function(a){var b=a.author,c=a.externalId;a=a.threadJid;c=d.get(c);return c!=null&&a!=null&&c.has(l(b,a))})})}function e(a,b,c){return m(a,[{ack:c,msgId:b}]).then(function(a){a=a[0];if(a==null){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["updateSystemAckForUnrenderedMsg on non existing message"])));return null}return a})}function m(a,b){var c=b.map(function(a){return a.msgId}),e=new Map();b.forEach(function(a){return e.set(a.msgId,{ack:a.ack})});return a.unrenderedMessages.where("msgId").anyOf(c).toArray().then(function(b){if(b.length===0)return b;var c=[],f=[];b.forEach(function(a){var b;if(a.author!==d("WAJids").AUTHOR_ME){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on incoming message"])));c.push(a);return}if(a.ack>d("MAWAckLevel").ACK.clock){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck on sent message"])));c.push(a);return}b=(b=e.get(a.msgId))==null?void 0:b.ack;if(b==null)return null;a=babelHelpers["extends"]({},a,{ack:b});b===d("MAWAckLevel").ACK.sent&&delete a.resendCount;f.push(a)});return a.unrenderedMessages.bulkPut(f).then(function(){return[].concat(f,c)})})}function f(a,b){b=b.map(function(b){return a.unrenderedMessages.get({msgId:b})});return d("MAWDexieTable").dexieAll(b)}function n(a,b){return a.unrenderedMessages.where("msgId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.msgId);return a+1})}g.maybeGetUnrenderedMsgByProtocolMsgId=a;g.getUnrenderedMsgMapByProtocolMsgId=b;g.maybeGetUnrenderedMsgByExternalId=k;g.getUnrenderedMsgsByProtocolMsgId=c;g.updateSystemAckForUnrenderedMsg=e;g.bulkUpdateSystemAckForUnrenderedMsgs=m;g.getUnrenderedMsgsByMsgIds=f;g.getNextUnrenderedMsgIdNumberForThread=n}),98);
__d("MAWMessageSortOrderUtils",["I64","MAWDbMsg","MAWExtractMsFromExternalId","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;function a(a){var b=a.revokedExternalId!=null?a.revokedExternalId:a.externalId;b==null&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["generateAuthoritativeMessageSortOrder called without ID"])));b=(l||(l=d("I64"))).of_string_opt(b);if(a.serverTs==null){var c;if(a.sortOrderMs!=null)return a.sortOrderMs;b==null&&d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] ExternalId is not present"])));var e=b==null?null:d("MAWExtractMsFromExternalId").extractMsFromExternalId(b);return Math.floor((c=a.originalTs)!=null?c:d("MAWDbMsg").getCanonicalTsFromMsg(a))*1e3+(e!=null?e:0)}if(b!=null){c=d("MAWExtractMsFromExternalId").extractMsFromExternalId(b);if(c!=null){e=a.originalTs!=null?a.originalTs:a.serverTs;return Number(e)*1e3+c}else d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] Timestamp bits in externalId not valid"])))}else d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[sortOrder] externalId is not a valid int64"])));return d("MAWDbMsg").getSortOrderWithFallback(a)}g.generateAuthoritativeMessageSortOrder=a}),98);
__d("WAArrayGroupBy",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=new Map();for(var d=0;d<a.length;d++){var e=b(a[d]),f=c.get(e);f==null?c.set(e,[a[d]]):f.push(a[d])}return Array.from(c.entries())}f.groupBy=a}),66);
__d("MAWDbMsgTxns",["EncryptedBackupsUtils","FBLogger","MAWAckLevel","MAWBridgeMsg","MAWDbMsg","MAWDbMsgUtil","MAWDbThreadTxns","MAWDbUnrenderedMsgTxns","MAWDbXMATxns","MAWDexieTable","MAWIndexedDb","MAWJidUtils","MAWLoadReplyMediaTxns","MAWMessageSortOrderUtils","MAWMsgType","MAWODSProxy","MAWTransactionMode","MAWTransactor","Random","WAArrayGroupBy","WAJids","WALogger","WAMsg","WAMsgMap","WAOdsEnums","WAResultOrError","WATimeUtils","emptyFunction","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q;function a(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.messages.get({msgId:b})}function b(a,b){return a.messages.where("threadJid").equals(b).count().then(function(a){return a===0})}function e(a,b,c){return a.messages.where("threadJid").equals(b).filter(c).first().then(function(a){return a!=null})}function r(a,b,c,d){return a.messages.where(["threadJid","sortOrderMs"]).between([b,Number.MIN_SAFE_INTEGER],[b,Number.MAX_SAFE_INTEGER],c,d)}function s(a,b){return r(a,b,!1,!1).last()}function f(a,b){return s(a,b).then(function(a){return a==null?void 0:a.msgId})}function t(a,b){return s(a,b).then(function(a){return(a==null?void 0:a.sortOrderMs)==null?null:d("WATimeUtils").castToMillisTime(a.sortOrderMs)})}function u(a,b,c){return r(a,b,!1,!1).reverse().limit(c).toArray()}function v(a,b){return r(a,b,!1,!1).first()}function w(a,b){return v(a,b).then(function(a){return a==null?void 0:a.msgId})}function x(a,b){return a.messages.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).toArray().then(z)}function y(a,b){var c=new Set(b.map(function(a){var b=a.author,c=a.chat;a=a.externalId;return d("WAMsg").craftWAMsgIdString({author:b,chat:c,externalId:a})}));return a.messages.where("externalId").anyOf(b.map(function(a){a=a.externalId;return a})).filter(function(a){var b=a.author,e=a.externalId;a=a.threadJid;return c.has(d("WAMsg").craftWAMsgIdString({author:b,chat:a,externalId:e}))}).toArray().then(function(a){return d("WAArrayGroupBy").groupBy(a,function(a){return d("WAMsg").craftWAMsgIdString({author:a.author,chat:a.threadJid,externalId:a.externalId})}).map(function(a){a[0];a=a[1];return z(a)}).filter(Boolean)})}function z(a){if(a.length>1){var b=a.map(function(a){var b;return a.type+":"+((b=a.serverTs)!=null?b:0).toString()+":"+((b=a.ts)!=null?b:0).toString()});b=new Set(b).size===1;!b?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByProtocolMsgId] Can't have "," messages with the same protocolMsgId!"])),a.length):d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[maybeGetMsgByProtocolMsgId] Suspected multiple instances of same message!"])));(c("gkx")("5039")||d("Random").coinflip(c("justknobx")._("3594")))&&A(a)}return a[0]}function A(a){var b=a.length;if(b<=1)return;var e=b-1,f=a[e],g={editCount:0,mediaId:0,revokedStatus:0,serverTs:0,sortOrderMs:0,ts:0,type:0};a.slice(0,e).forEach(function(a){var b=[];if((a==null?void 0:a.editCount)!==(f==null?void 0:f.editCount)){var e;g.editCount++;b.push("editCount, reference: "+((e=f==null?void 0:f.editCount)!=null?e:"")+", duplicate: "+((e=a==null?void 0:a.editCount)!=null?e:"")+". ")}(a==null?void 0:a.mediaId)!==(f==null?void 0:f.mediaId)&&(g.mediaId++,b.push("mediaId, reference: "+((f==null?void 0:f.mediaId)!=null?String(f.mediaId):"")+", duplicate: "+((a==null?void 0:a.mediaId)!=null?String(a.mediaId):"")+". "));a.sortOrderMs!==f.sortOrderMs&&(g.sortOrderMs++,b.push("sortOrderMs, reference: "+String(f.sortOrderMs)+", duplicate: "+String(a.sortOrderMs)+". "));a.serverTs!==f.serverTs&&(g.serverTs++,b.push("serverTs, reference: "+String(f.serverTs)+", duplicate: "+String(a.serverTs)+". "));a.ts!==f.ts&&(g.ts++,b.push("ts, reference: "+String(f.ts)+", duplicate: "+String(a.ts)+". "));if(a.type!==f.type){(a.type===d("MAWMsgType").MSG_TYPE.REVOKED||f.type===d("MAWMsgType").MSG_TYPE.REVOKED)&&(g.revokedStatus++,c("FBLogger")("MAWDuplicateMessageComparison").info("Revoked duplicate msg conflict, duplicate message, %s, has type: %s, externalId: %s, revokedExternalId: %s, sortOrderMs: %s, serverTs: %s, ts: %s, rowId: %s, reference msg, %s, has type: %s, externalId: %s, revokedExternalId: %s, sortOrderMs: %s, serverTs: %s, ts: %s, rowId: %s",a.msgId,a.type,a.externalId,a.revokedExternalId,a.sortOrderMs,a.serverTs,a.ts,a.rowId,f.msgId,f.type,f.externalId,f.revokedExternalId,a.sortOrderMs,a.serverTs,a.ts,a.rowId));g.type++;b.push("type, reference: "+((e=f.type)!=null?e:"")+", duplicate: "+((e=a.type)!=null?e:"")+". ")}e=b.join("");e.length>0?c("FBLogger")("MAWDuplicateMessageComparison").info("Duplicate msg, %s, has conflicting field values to reference msg, %s: %s",a.msgId,f.msgId,e):c("FBLogger")("MAWDuplicateMessageComparison").info("Duplicate msg, %s, has no conflicting field values to reference msg, %s",a.msgId,f.msgId)});d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_DUPLICATE_MSGS,key:"sets_of_duplicate_msgs"});Object.keys(g).forEach(function(a){var b=g[a];b>0&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_DUPLICATE_MSGS,key:"sets_of_duplicate_msgs_with_"+a+"_field_differences"})});d("MAWODSProxy").odsBumpEntityKey({amount:b-1,entity:d("WAOdsEnums").Entity.MAW_DUPLICATE_MSGS,key:"number_of_duplicate_msgs"});Object.keys(g).forEach(function(a){var b=g[a];b>0&&d("MAWODSProxy").odsBumpEntityKey({amount:b,entity:d("WAOdsEnums").Entity.MAW_DUPLICATE_MSGS,key:"number_of_duplicate_msgs_with_"+a+"_field_differences"})})}function B(a,b,c,d){d={author:d,chat:c,externalId:b};return x(a,d)}function C(a,b){return a.messages.where("msgId").equals(b).toArray()}function D(a,b){return G(a,b).then(function(a){return a.success?a:a})}function E(a,b){var c=b.map(function(a){a=a.externalId;return a});return a.messages.where("externalId").anyOf(c).toArray().then(function(a){var c=d("MAWDbMsgUtil").convertMsgArrayToMap(a),e=new(d("WAMsgMap").MsgMap)();b.forEach(function(a){var b=c.get(a);b!=null&&e.set(a,b)});return e})}function F(a,b){return a.messages.where("msgId").equals(b).first().then(function(a){return a==null?void 0:a.sortOrderMs})}function G(a,b){var c=b.author,e=b.chat,f=b.externalId;return a.threads.get({jid:e}).then(function(b){return b==null?d("WAResultOrError").makeError("missing_thread_msg"):B(a,f,b.jid,c).then(function(a){return a==null?d("WAResultOrError").makeError("missing_msg"):d("WAResultOrError").makeResult(a)})})}function H(a,b){var c=b.author,d=b.chat,e=b.externalId;return a.threads.get({jid:d}).then(function(b){if(b==null)return;return a.messages.where("revokedExternalId").equals(e).filter(function(a){return a.author===c&&a.threadJid===b.jid&&a.type==="Revoked"}).first()})}function I(a,b,c,e){var f=a.messages.where("revokedExternalId").equals(b).filter(function(a){return a.author===e&&a.threadJid===c&&a.type===d("MAWMsgType").MSG_TYPE.REVOKED}).first();a=d("MAWDbUnrenderedMsgTxns").maybeGetUnrenderedMsgByExternalId(a,b,c,e).then(function(a){if((a==null?void 0:a.type)===d("MAWMsgType").MSG_TYPE.DELETE_FOR_ME)return a});return d("MAWDexieTable").dexieAll([f,a]).then(function(a){var b=a[0];a=a[1];return b!=null||a!=null})}function J(a,b){var c=new Array(b.length),e=new Set();b.forEach(function(a){c.push(a.externalId),e.add(d("EncryptedBackupsUtils").convertWAMsgIdToStringId(a))});return a.messages.where("externalId").anyOf(c).filter(function(a){return e.has(d("EncryptedBackupsUtils").convertWAMsgIdToStringId({author:a.author,chat:a.threadJid,externalId:a.externalId}))}).toArray()}function K(a,b,c,e,f,g){return L(a,[{ack:c,applicationErrorCode:g,msgId:b,reportingMeta:f,serverTs:e}]).then(function(a){a=a.find(function(a){return a.msgId===b});if(a==null){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["updateSystemAck on non existing message"])));return null}return a})}function L(a,b){var c=b.map(function(a){return a.msgId});return d("MAWDbXMATxns").getXMAMsgIdsFromAssociatedMsgIds(a,c).then(function(e){var f=new Map();b.forEach(function(a){f.set(a.msgId,{ack:a.ack,applicationErrorCode:a.applicationErrorCode,reportingMeta:a.reportingMeta,serverTs:a.serverTs});var b=e.get(a.msgId);b!=null&&f.set(b,{ack:a.ack,applicationErrorCode:a.applicationErrorCode,reportingMeta:a.reportingMeta,serverTs:a.serverTs})});var g=Array.from(new Set(c.concat(Array.from(e.values()))));return a.messages.where("msgId").anyOf(g).toArray().then(function(b){if(b.length===0)return b;var c=[],e=[];b.forEach(function(a){var b,g;if(a.author!==d("WAJids").AUTHOR_ME||a.ack>d("MAWAckLevel").ACK.clock){c.push(a);return}b=(b=f.get(a.msgId))==null?void 0:b.ack;g=(g=f.get(a.msgId))==null?void 0:g.serverTs;if(b==null)return null;var h=babelHelpers["extends"]({},a,{ack:b});M(h,g);a=(g=f.get(a.msgId))==null?void 0:g.reportingMeta;a!=null&&(h.reportingMeta=a);b===d("MAWAckLevel").ACK.sent&&delete h.resendCount;e.push(h)});c.length>0&&d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["bulkUpdateSystemAck: not updating ",""])),c.map(function(a){return a.msgId}).toString());return a.messages.bulkPut(e).then(function(){return d("MAWDexieTable").dexieAll(e.map(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b)}))}).then(function(a){e.forEach(function(b,c){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(b,a[c])})});return[].concat(e,c)})})})}function M(a,b){if(b==null)return;a.serverTs=b;var e=a.sortOrderMs;if(a.type===d("MAWMsgType").MSG_TYPE.REVOKED&&c("justknobx")._("3841"))return;a.sortOrderMs=d("MAWMessageSortOrderUtils").generateAuthoritativeMessageSortOrder(a);d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Message was acked by server (serverTs = ","), override sortOrderMs: "," -> ",""])),b,e,a.sortOrderMs)}function N(a,b,e,f){return d("MAWDbThreadTxns").getThread(a,b).then(function(b){if(!b.success||f==null)return;var g=b.value;b=[a.messages.where(["threadJid","sortOrderMs"]).above([g.jid,f]).first(),a.messages.where(["threadJid","sortOrderMs"]).below([g.jid,f]).last()];return d("MAWDexieTable").dexieAll(b).then(function(b){var f=b[0];b=b[1];return d("MAWDbThreadTxns").updateThread(a,babelHelpers["extends"]({},g,{newestMsgTs:(b==null?void 0:b.ts)==null?g.newestMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(b.ts),oldestMsg:g.oldestMsg===e?f==null?void 0:f.msgId:g.oldestMsg})).then(c("emptyFunction"))})})}function O(a){return a.messages.where("altIndex").equals(d("MAWDbMsg").FUTUREPROOF_ALT_INDEX).toArray().then(function(a){var b=[];a.forEach(function(a){if(a.type!==d("MAWMsgType").MSG_TYPE.FUTUREPROOF){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["getFutureproofMsg gets a message "," with unsupported type ",""])),a.msgId,a.type);return}b.push(a)});return b})}function P(a){return a.toString()}function Q(a,b,e,f){var g=b.mediaId;if(g===e){d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["updateMediaId on message "," that already has this mediaId ",""])),b.msgId,e);return d("MAWDexieTable").dexieResolve()}g=g!=null?a.media.get(g):d("MAWDexieTable").dexieResolve();return g.then(function(g){g&&d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Replacing mediaId for message with pre-existing media. type=",""])),b.type);g=f!=null?f:void 0;g=babelHelpers["extends"]({},b,{mediaId:e,plaintextHash:g});return a.messages.put(g).then(c("emptyFunction"))})}function R(a,b){var e=Array.from(b.keys());return a.messages.where("msgId").anyOf(e).toArray().then(function(e){var f=[];e.map(function(a){var e=b.get(a.msgId),g=a.mediaId;if(g!=null&&g!==e){if(e!=null)throw c("FBLogger")("messenger_web").mustfixThrow("mediaId "+P(g)+" in message "+a.msgId+" is different with the "+P(e)+" in bulkUpdateMediaId");d("WALogger").LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["updateMediaId on message "," that already has this mediaId ",""])),a.msgId,e);return}g=babelHelpers["extends"]({},a,{mediaId:e,plaintextHash:a.plaintextHash});f.push(g)});return a.messages.bulkPut(f).then(c("emptyFunction"))})}function S(a,b){return T(a,[b]).then(c("emptyFunction"))}function T(a,b){return a.messages.where("msgId").anyOf(b).toArray().then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({},a,{isExpiredXmaMsg:!0})});return a.messages.bulkPut(c).then(function(){return c})})}function U(a,b,c,e){if(e!=null&&e<=0)return d("MAWDexieTable").dexieResolve([]);a=a.messages.where("altIndex").equals(d("MAWDbMsg").craftToBeReadAltIndex(b)).filter(function(a){return d("MAWDbMsg").getSortOrderWithFallback(a)<=c});e!=null&&(a=a.limit(e));return a.toArray()}function V(a,b,c){return U(a,b,c).then(function(b){var c=b.map(function(a){return babelHelpers["extends"]({altIndex:null},a)});return a.messages.bulkPut(c).then(function(){return c})})}function W(a,b){return a.messages["delete"](b)}function X(a,b){return a.messages.bulkDelete(b)}function Y(a,b,c){var e=b.map(function(a){return a.rowId});b=c!=null?b.map(function(a){a=d("MAWJidUtils").toProtocolMsgId(a);if(!a)return;return babelHelpers["extends"]({},a,{reason:c})}).filter(Boolean):[];return d("MAWDexieTable").dexieAll([a.deletedMessages.bulkAdd(b),a.messages.bulkDelete(e)]).then(function(a){a[0];a=a[1];d("WALogger").LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Successfull deleted "," messages"])),a)})}function Z(a,b){return a.messages.where("msgId").anyOf(b).toArray()}function aa(a){return a.messages.where("altIndex").anyOf([d("MAWDbMsg").SPAM_ALT_INDEX,d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX]).toArray()}function ba(a,b,c,e,f,g,h,i){h===void 0&&(h="before");i===void 0&&(i=null);c=c==null?null:d("MAWDbMsg").getSortOrderWithFallback(c);if(h==="before")return a.messages.where(["threadJid","sortOrderMs"]).between([b,i!=null?i:Number.MIN_SAFE_INTEGER],[b,c!=null?c:Number.MAX_SAFE_INTEGER],!0,e).reverse().filter(g).limit(f).toArray();else return a.messages.where(["threadJid","sortOrderMs"]).between([b,c!=null?c:Number.MIN_SAFE_INTEGER],[b,i!=null?i:Number.MAX_SAFE_INTEGER],e,!0).filter(g).limit(f).toArray().then(function(a){return a.sort(function(a,b){return b.ts-a.ts})})}function ca(a,b,c,d){var e=c.msgId;if(d==null){var f;return{oldestMsg:(f=a==null?void 0:a.msgId)!=null?f:e}}f=[a,b,c].filter(Boolean);return{oldestMsg:f.reduce(function(a,b){return $(a,e,d)<$(b,e,d)?a:b}).msgId}}function $(a,b,c){return a.msgId===b?c:d("MAWDbMsg").getSortOrderWithFallback(a)}function da(a,b){return a.messages.where("msgId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.msgId);return a+1})}function ea(a){return d("MAWTransactor").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"checkMessagesExistenceByProtocolMsgIds",function(b){return function(){return d("MAWDexieTable").dexieAll(a.map(function(a){return b.messages.get({protocolMsgId:a.chat+"."+a.externalId})}))}})()}function fa(a,b){return a.messages.where("externalId").anyOf(b).toArray()}g.maybeGetMsg=a;g.getIsThreadEmpty=b;g.doesThreadHaveMsgsMatchCriteria=e;g.getThreadMessagesBySortOrder=r;g.getThreadNewestMessageBySortOrder=s;g.getThreadNewestMessageId=f;g.getThreadNewestMessageMs=t;g.getThreadNewestNumMessagesBySortOrder=u;g.getThreadOldestMessageBySortOrder=v;g.getThreadOldestMessageId=w;g.maybeGetMsgByProtocolMsgId=x;g.getUniqueMsgsByProtocolMsgIds=y;g.maybeGetMsgByExternalId=B;g.maybeGetMsgListByMsgId_I_KNOW_WHAT_I_AM_DOING=C;g.maybeGetMsgResultByProtocolMsgId=D;g.getMsgMapByProtocolMsgId=E;g.getSortOrderFromMsgId=F;g.maybeGetRevokedMsgByProtocolMsgId=H;g.checkIfMsgIsDeletedForMeOrRevoked=I;g.getMsgsByProtocolMsgId=J;g.updateSystemAck=K;g.bulkUpdateSystemAck=L;g.maybeUpdateThreadMsgsForDeleteForMe=N;g.getFutureProofMsgs=O;g.updateMediaId=Q;g.bulkUpdateMediaId=R;g.updateDbMsgXMAExpiration=S;g.bulkUpdateDbMsgXMAExpired=T;g.getMsgsNeedingRetroactiveReadReceiptsUpTo=U;g.clearRetroactiveReadReceiptStatusFromMsgsUpTo=V;g.deleteDbMsg=W;g.bulkDeleteDbMsg=X;g.deleteMessages=Y;g.getMsgsByMsgIds=Z;g.getSpamMsgs=aa;g.fetchMessagesFromDbWithSortOrderMs=ba;g.calculateOldestMsg=ca;g.getNextMsgIdNumberForThread=da;g.checkMessagesExistenceByProtocolMsgIds=ea;g.UNSAFE_getMultipleMsgsByExternalId=fa}),98);
__d("MAWDbMsgTypeVersionTxns",["MAWDbAppMeta","MAWDexieTable","MAWTransactionMode","MAWTransactor","MawMpsDropDeviceNotificationsForTurnedOffSecurityAlertsPreprocessor","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return a.appMeta.get({key:d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion}).then(function(a){return a==null?void 0:a.value.msgTypeVersion})}function b(a,b){return a.appMeta.add({key:d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion,value:{msgTypeVersion:b}})}function e(a,b){return a.appMeta.put({key:d("MAWDbAppMeta").AppMetaKeysEnum.msgTypeVersion,value:{msgTypeVersion:b}})}function f(a,b){return a.appMeta.add({key:d("MAWDbAppMeta").AppMetaKeysEnum.hmacKey,value:{hmacKey:b}})}function i(a){return a.appMeta.get({key:d("MAWDbAppMeta").AppMetaKeysEnum.hmacKey}).then(function(a){return a==null?void 0:a.value.hmacKey})}function j(a,b){return a.appMeta.get({key:b})}function k(a,b){d("MawMpsDropDeviceNotificationsForTurnedOffSecurityAlertsPreprocessor").setCachedShouldSaveSecurityAlert(b);return a.appMeta.put({key:d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlert,value:{allowSecurityAlert:b}}).then(c("emptyFunction"))}function l(a,b){return a.appMeta.put({key:d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlertForSelf,value:{allowSecurityAlertForSelf:b}}).then(c("emptyFunction"))}function m(){return d("MAWTransactor").makeMsgrTransactor({appMeta:d("MAWTransactionMode").READONLY},"handleInstructions",function(a){return function(){return n(a)}})()}function n(a){return j(a,d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlert).then(function(a){return(a=a==null?void 0:a.value.allowSecurityAlert)!=null?a:!1})}function o(a){return j(a,d("MAWDbAppMeta").AppMetaKeysEnum.allowSecurityAlertForSelf).then(function(a){return(a=a==null?void 0:a.value.allowSecurityAlertForSelf)!=null?a:!0})}function p(a,b){return a.appMeta.add({key:d("MAWDbAppMeta").AppMetaKeysEnum.hotlikeSticker,value:{hotlikeSticker:b}})}function q(a){return d("MAWDexieTable").dexieAll([o(a),n(a)]).then(function(a){var b=a[0];a=a[1];return{allowSecurityAlertForContact:a,allowSecurityAlertForSelf:b}})}g.MSG_TYPE_VERSION=(h=d("MAWDbAppMeta")).AppMetaKeysEnum.msgTypeVersion;g.ALLOW_SECURITY_ALERT_FOR_CONTACT=h.AppMetaKeysEnum.allowSecurityAlert;g.ALLOW_SECURITY_ALERT_FOR_SELF=h.AppMetaKeysEnum.allowSecurityAlertForSelf;g.HOT_LIKE=h.AppMetaKeysEnum.hotlikeSticker;g.getMsgTypeVersion=a;g.addMsgTypeVersion=b;g.updateMsgTypeVersion=e;g.addHMACKey=f;g.getHMACKey=i;g.getAppMetaValue=j;g.updateSecurityAlertValueForContact=k;g.updateSecurityAlertValueForSelf=l;g.getSecuritySettingForContactTxn=m;g.getSecuritySettingForContact=n;g.getSecuritySettingForSelf=o;g.addHotLike=p;g.maybeBulkGetSecuritySetting=q}),98);
__d("MAWDbReactionsTxns",["FBLogger","MAWAuthor","MAWBridgeTypesCreators","MAWDbMsg","MAWDexieTable","MAWIndexedDb","WALogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=function(a){return a};function a(a,b){return a.reactions.put(k(b))}function b(a,b){return a.reactions["delete"](b.rowId).then(function(){var a=b.author,c=b.reactionId,e=b.reactToMsgId,f=b.threadJid;if(e==null)return;d("MAWIndexedDb").afterTransaction({tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:a,chatJid:f,reactToMsgId:e})});d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Successfully deleted reaction with id : ","."])),c)})}function e(a,b){var c=d("MAWAuthor").getAuthorUserJid(b.author);return a.reactions.where("reactToExternalId").equals(b.externalId).filter(function(a){return(a.reactToAuthor===c||a.reactToAuthor===b.author)&&a.threadJid===b.chat}).toArray()}function l(a,b){var d=b.reduce(function(a,b){a.set(b.msgId,b);return a},new Map());return a.reactions.where("reactToMsgId").anyOf(b.map(function(a){return a.msgId})).toArray().then(function(a){var b=a.filter(function(a){var b=a.reactToExternalId;a=a.reactToMsgId;return a!=null&&b===((b=d.get(a))==null?void 0:b.externalId)});b.length<a.length&&c("FBLogger")("messenger_web").mustfix("Reactions query by reactToMsgId returns reactions with mismatching externalId");return b})}function f(a,b){return a.reactions.where("reactToMsgId").equals(b.msgId).toArray().then(function(a){var d=a.filter(function(a){a=a.reactToExternalId;return a===b.externalId});d.length<a.length&&c("FBLogger")("messenger_web").mustfix("Reactions query by reactToMsgId returns reactions with mismatching externalId");return d})}function m(a,b){return l(a,[b])}function n(a,b){var c=b.author,d=b.chat;b=b.externalId;return a.reactions.where("externalId").equals(b).filter(function(a){return a.author===c&&a.threadJid===d}).first()}function o(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.author;b=b.externalId;var e=d("MAWAuthor").getAuthorUserJid(c);return a.reactions.where("reactToExternalId").equals(b).filter(function(a){return d("MAWAuthor").getAuthorUserJid(a.reactToAuthor)===e}).toArray()})).then(function(b){b=b.flat();b.forEach(function(a){var b=a.author,c=a.reactToMsgId;a=a.threadJid;if(c==null)return;d("MAWIndexedDb").afterTransaction({tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:b,chatJid:a,reactToMsgId:c})})});if(b.length===0)return;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Successfully deleted: "," reactions rows."])),b.length);return a.reactions.bulkDelete(b.map(function(a){return a.rowId}))})}function p(a,b){return a.reactions.where("reactToMsgId").anyOf(b.map(function(a){return a.msgId}))["delete"]().then(function(a){d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Deleted "," reactions"])),a)})}function q(a,b){return a.reactions.where("reactionId").between(d("MAWDbMsg").msgIdsInChatLowerBound(b.chatId),d("MAWDbMsg").msgIdsInChatUpperBound(b.chatId)).last().then(function(a){a=a==null?0:d("MAWDbMsg").getInChatMsgIdFromMsgId(a.reactionId);return a+1})}function r(a,b,c,e,f,g,h){e=(e=e==null?void 0:e.ts)!=null?e:d("WATimeUtils").unixTime();return a.reactions.where(["threadJid","ts"]).between([b,(a=d("WATimeUtils").castMillisTimeToUnixTime(c))!=null?a:d("WATimeUtils").castToUnixTime(0)],[b,e],!0,f).reverse().filter(h).limit(g).toArray()}g.coerceToReaction=k;g.putReaction=a;g.deleteReaction=b;g.getReactionForEcho=e;g.getReactionsFromMessages=l;g.getReactionsForMessage=f;g.getReactionsFromMessage=m;g.maybeGetReactionByProtocolMsgId=n;g.deleteReactionsByUniqueMsgIdentifiers=o;g.deleteAllReactionsForMessages=p;g.getNextReactionIdNumberForThread=q;g.fetchReactionsFromDbWithTimestamp=r}),98);
__d("MaybeCreateOrUpdateThreadResultCache",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(a){g["delete"](a)}f.cache__I_KNOW_WHAT_I_AM_DOING=g;f.deleteCachedThreadResult=a}),66);
__d("MAWDbThreadTxns",["MAWAuthoritativeThreadsCache","MAWBridgeTypesCreators","MAWDbMsgTxns","MAWDexieTable","MAWFolderTypes","MAWIndexedDb","MaybeCreateOrUpdateThreadResultCache","WAArrayZip","WALogger","WAResultOrError","WATimeUtils","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b){return a.threads.get({deduplicationKey:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function k(a,b){return a.threads.get({jid:b}).then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function l(a,b){return a.threads.where("jid").anyOf(b).toArray()}function b(a,b){return a.threads.where("jid").startsWith(b+"@").first().then(function(a){return a==null?d("WAResultOrError").makeError("missing"):d("WAResultOrError").makeResult(a)})}function m(a){d("MaybeCreateOrUpdateThreadResultCache").deleteCachedThreadResult(a),d("MAWAuthoritativeThreadsCache").AuthoritativeThreadsCache["delete"](a)}function e(a,b){return a.threads.where("jid").equals(b)["delete"]().then(function(){return m(b)})}function f(a,b){return a.participants.where("userJid").equals(b).toArray().then(function(b){b=b.map(function(a){return a.threadJid});return l(a,b)})}function n(a,b){return a.participants.where("userJid").anyOf(b).toArray().then(function(b){var c=new Map(),d=new Set();b.forEach(function(a){var b,e=a.userJid;b=(b=c.get(e))!=null?b:[];b.push(a.threadJid);c.set(e,b);d.add(a.threadJid)});return l(a,Array.from(d)).then(function(a){var b=a.reduce(function(a,b){a.set(b.jid,b);return a},new Map());return new Map(Array.from(c.entries()).map(function(a){var c=a[0];a=a[1];return[c,a.map(function(a){return b.get(a)}).filter(Boolean)]}))})})}function o(a,b,c){return(b==null?void 0:b.lastReadMsgReceiptSent)==null?d("MAWDexieTable").dexieResolve(!1):d("MAWDbMsgTxns").getSortOrderFromMsgId(a,b.lastReadMsgReceiptSent).then(function(a){return c.sortOrderMs==null||a==null?!1:c.sortOrderMs<=a})}function p(a,b){return a.threads.get({jid:b.threadJid}).then(function(c){return o(a,c,b)})}function q(a,b){return a.threads.where("jid").anyOf(b.map(function(a){return a.threadJid})).toArray().then(function(c){return d("MAWDexieTable").dexieAll(d("WAArrayZip").zip(b,c).map(function(b){var c=b[0];b=b[1];return o(a,b,c)}))})}function r(a,b,c){return a.threads.where("jid").anyOf(b).toArray().then(function(b){var e=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{archived:!0,cannotReplyReason:c?"viewer_not_subscribed":a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.ARCHIVED})});return a.threads.bulkPut(e).then(function(){e.forEach(function(a){c&&d("WALogger").LOG(["[Occamadillo] Leaving a group thread\n          "+a.jid.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]),d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.ARCHIVED,threadJid:a.jid})})})})})}function s(a,b){return a.threads.where("jid").anyOf(b).toArray().then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{cannotReplyReason:null})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){a={cannotReplyReason:null,threadJid:a.jid};d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(a)})})})})}function t(a,b){return a.threads.where("jid").anyOf(b).toArray().then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{archived:!1,cannotReplyReason:a.cannotReplyReason==="viewer_not_subscribed"?a.cannotReplyReason:null,folder:d("MAWFolderTypes").FOLDER_ID.INBOX})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread({cannotReplyReason:a.cannotReplyReason,folder:d("MAWFolderTypes").FOLDER_ID.INBOX,threadJid:a.jid})})})})})}function u(a,b){return a.threads.where("jid").anyOf(b).toArray().then(function(b){var c=b.filter(Boolean).map(function(a){return babelHelpers["extends"]({},a,{cannotReplyReason:"viewer_not_subscribed"})});return a.threads.bulkPut(c).then(function(){c.forEach(function(a){var b={cannotReplyReason:"viewer_not_subscribed",threadJid:a.jid};d("WALogger").LOG(["[Occamadillo] User is unsubscribed from thread\n          "+a.jid.toString()+", showing a VIEWER_NOT_SUBSCRIBED composer blocker"]);d("MAWIndexedDb").afterTransaction({tag:"ThreadUpdated",value:d("MAWBridgeTypesCreators").createBridgeUpdatedThread(b)})})})})}function v(a,b){return k(a,b).then(function(b){if(!b.success){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsMigratedLocally failed to get the thread"])));return}b=b.value;if(b.isMigratedLocally===!0){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["markThreadAsMigratedLocally failed because thread is already migrated"])));return}b=babelHelpers["extends"]({},b,{isMigratedLocally:!0});return a.threads.put(b).then(c("emptyFunction"))})}function w(a,b){if(b.isMigratedLocally===!1){d("WALogger").WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["markCutoverThreadAsNotMigratedLocally failed because thread is already unmigrated"])));return d("MAWDexieTable").dexieResolve(b)}var c=babelHelpers["extends"]({},b,{isMigratedLocally:!1});return a.threads.put(c).then(function(){return c})}function x(a,b){return a.threads.put(b).then(c("emptyFunction"))}function y(a,b,c,e,f){return x(a,babelHelpers["extends"]({},b,{newestMsgTs:(f==null?void 0:f.ts)==null?b.newestMsgTs:d("WATimeUtils").castUnixTimeToMillisTime(f.ts),oldestMsg:e==null?void 0:e.msgId}))}g.getThreadByDeduplicationKey=a;g.getThread=k;g.getThreads=l;g.getThreadPrimaryId=b;g.deleteThread=e;g.getAllThreadsForUser=f;g.getAllThreadsForUsers=n;g.needsRetroactiveReadReceiptInThread=p;g.bulkNeedsRetroactiveReadReceiptInThread=q;g.archiveThreads=r;g.subscribeToThreads=s;g.unarchiveThreads=t;g.unsubscribeFromThreads=u;g.markCutoverThreadAsMigratedLocally=v;g.markCutoverThreadAsNotMigratedLocally=w;g.updateThread=x;g.updateThreadMsgsForUndefinedOldestOrNewestMsgs=y}),98);
__d("MAWDbXMATxns",["MAWDbChunkTxns","MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbThreadTxns","MAWDexieTable","MAWJidUtils","MAWXMAUtils","WAResultOrError","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.xma.bulkGet(b)}function b(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.get({xmaId:b})}function h(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.where("associatedMessageId").equals(b).first()}function i(a,b){return b==null?d("MAWDexieTable").dexieResolve():a.xma.where("externalId").equals(b.externalId).filter(function(a){return a.author===b.author&&a.threadJid===b.chat}).first()}function e(a,b){return i(a,b).then(function(b){return b==null?d("WAResultOrError").makeError("missing"):d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").getMediaForXMA(a,b),d("MAWDbMsgTxns").maybeGetMsg(a,b.associatedMessageId)]).then(function(a){var c=a[0];a=a[1];if(!c.success)return d("WAResultOrError").makeError("missing");c=c.value;var e=c.defaultPreview,f=c.favicon,g=c.header;c=c.previews;return d("WAResultOrError").makeResult({associatedMessage:a,defaultPreview:e,favicon:f,header:g,previews:c,xma:b})})})}function f(a,b){return h(a,b).then(function(b){if(b==null)return;return d("MAWDbMsgTxns").maybeGetMsg(a,b.msgId)})}function j(a,b){if(b.length===0)return d("MAWDexieTable").dexieResolve([]);b=b.filter(d("MAWDbMsg").isXMAMsg).map(function(a){return d("MAWJidUtils").maybeToProtocolMsgId(a.author,a.threadJid,a.externalId)}).filter(Boolean);b=b.map(function(b){return i(a,b)});return d("MAWDexieTable").dexieAll(b).then(function(a){return a.filter(Boolean)})}function k(a,b){return a.xma.where("associatedMessageId").anyOf(b).toArray().then(function(a){a=a.filter(function(a){return a.msgId!=null&&c("gkx")("9841")?a.targetType!=null:d("MAWXMAUtils").isXMAShare_DO_NOT_USE(a.targetType)});return a.reduce(function(a,b){return b.associatedMessageId!=null&&b.msgId!=null?a.set(b.associatedMessageId,b.msgId):a},new Map())})}function l(a,b){return a.xma.where("associatedMessageId").equals(b).first()}function m(a,b){return a.xma.where("associatedMessageId").equals(b).first().then(function(b){if(b==null)return;b=d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId);if(b==null)return;return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,b)})}function n(a,b){return l(a,b).then(function(b){return b==null?d("WAResultOrError").makeResult():d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").getMediaForXMA(a,b),d("MAWDbMsgTxns").maybeGetMsg(a,b.associatedMessageId)]).then(function(a){var c=a[0];a=a[1];if(!c.success)return d("WAResultOrError").makeError("missing");c=c.value;var e=c.defaultPreview,f=c.favicon,g=c.header;c=c.previews;return d("WAResultOrError").makeResult({associatedMessage:a,defaultPreview:e,favicon:f,header:g,previews:c,xma:b})})})}function o(a,b,c){return d("MAWDbThreadTxns").getThread(a,c).then(function(c){if(!c.success)return;c=c.value;if(b==null)return d("MAWDexieTable").dexieResolve();c={author:b.author,chat:c.jid,externalId:b.externalId};return d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,c)})}function p(a,b){return i(a,b).then(function(b){if(b==null)return d("MAWDexieTable").dexieResolve();if(d("MAWXMAUtils").isXMAStoryReply(b.targetType))return;return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b.defaultPreviewMediaId).then(function(c){return c==null?{hasMedia:!1,xma:b}:d("MAWDexieTable").dexieAll([c,d("MAWDbChunkTxns").hasMediaChunk(a,c.hashedPlaintextHash)]).then(function(a){var c=a[0];a=a[1];return{hasMedia:a,previewMedia:c,xma:b}})})})}function q(a,b){return a.xma.where("externalId").anyOf(b).toArray()}g.bulkGetXMAs=a;g.maybeGetXMAFromXMAId=b;g.maybeGetXMAFromAssociatedMsgId=h;g.maybeGetXMAFromProtocolMsgId=i;g.maybeGetXMAPayloadFromProtocolMsgId=e;g.getDbXMAMsgFromAssociatedMsgId=f;g.getXMAFromMsgs=j;g.getXMAMsgIdsFromAssociatedMsgIds=k;g.maybeGetDbXMAMsgByAssociatedMsgId=m;g.maybeGetXMAPayloadFromAssociatedMsgId=n;g.maybeGetAssociatedXMAMsg=o;g.maybeGetXMAAndDefaultPreviewMediaFromProtocolMsg=p;g.getMultipleXMAByExternalId=q}),98);
__d("MAWMessageHasNonNullServerTsOnReceivedAckValidator",["MAWAckLevel","MAWTransactionMode","MAWTransactor"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWTransactor").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"isMessageHasNonNullServerTsOnReceivedAckValidator",function(a){return function(b){return a.messages.get(b).then(function(a){return a==null||a.ack<d("MAWAckLevel").ACK.sent?{key:b,result:"skipped"}:a.serverTs!=null?{key:b,result:"valid"}:{description:"Message with "+a.ack+" ack has empty serverTs.",key:b,result:"invalid"}})}});b={description:"MAWMessageHasNonNullServerTsOnReceivedAckValidator",isValid:a,table:"messages",type:["add","put"]};g.MAWMessageHasNonNullServerTsOnReceivedAckValidator=b}),98);
__d("MAWMessageHasUniqueExternalIdValidator",["MAWDexieTable","MAWTransactionMode","MAWTransactor","WAStanzaUtils","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=c("justknobx")._("3288");b=d("MAWTransactor").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"isMessageWithUniqueExternalIdValidator",function(a){return function(b){return a.messages.get(b).then(function(c){var e=c==null?void 0:c.externalId;return c==null||e==null?d("MAWDexieTable").dexieResolve({key:b,result:"skipped"}):a.messages.where("externalId").equals(d("WAStanzaUtils").toStanzaId(e)).filter(function(a){return a.author===c.author&&a.threadJid===c.threadJid}).toArray().then(function(a){if(a.length===1)return{key:b,result:"valid"};else{a=h(b,c,a);return{description:a,key:b,result:"invalid"}}})})}});function h(a,b,c){var d,e=c.every(function(a){return a.serverTs===b.serverTs});c=c.filter(function(b){return b.rowId!==a});d="Message has duplicate externalId."+("New message type: "+((d=b.type)!=null?d:"")+". ")+("Existing message types: "+c.map(function(a){return a.type}).join(", ")+". ")+("Messages have same serverTS: "+e.toString()+". ")+("Message has null protocolMsgId: "+(b.protocolMsgId==null).toString()+". ");return d}e={description:"MAWMessageHasUniqueExternalIdValidator",isValid:b,sampleRate:a,table:"messages",type:["add","put"]};g.MAWMessageHasUniqueExternalIdValidator=e}),98);
__d("MAWParticipantMatchOneOnOneThreadValidator",["MAWIndexedDb","MAWTransactionMode","MAWUserJidWrapper","WAJids","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=c("justknobx")._("3121");b=d("MAWIndexedDb").makeMsgrTransactor({participants:d("MAWTransactionMode").READONLY},"isParticipantMatchingOneOnOneThreadValidator",function(a){return function(b){return a.participants.get(b).then(function(a){return a==null?{key:b,result:"skipped"}:d("WAJids").switchOnMsgrChatJidType(a.threadJid,{group:function(){return{key:b,result:"skipped"}},user:function(c){return a.userJid!==c&&a.userJid!==d("MAWUserJidWrapper").getMyUserJid()?{description:"Participants added to 1:1 thread is neither self or the other user",key:b,result:"invalid"}:{key:b,result:"valid"}}})})}});e={description:"MAWParticipantMatchOneOnOneThreadValidator",isValid:b,sampleRate:a,table:"participants",type:["add","put"]};g.MAWParticipantMatchOneOnOneThreadValidator=e}),98);
__d("MAWReactionHasUniqueProtocolMsgIdValidator",["MAWDexieTable","MAWTransactionMode","MAWTransactor","WAStanzaUtils"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWTransactor").makeMsgrTransactor({reactions:d("MAWTransactionMode").READONLY},"isReactionWithUniqueProtocolMsgIdValidator",function(a){return function(b){return a.reactions.get(b).then(function(c){var e=c==null?void 0:c.externalId;return e==null?d("MAWDexieTable").dexieResolve({key:b,result:"skipped"}):a.reactions.where("externalId").equals(d("WAStanzaUtils").toStanzaId(e)).filter(function(a){return a.threadJid===(c==null?void 0:c.threadJid)}).toArray().then(function(a){if(a.length===1)return{key:b,result:"valid"};else{a=a.find(function(a){return a.author!==(c==null?void 0:c.author)})!=null;return{description:"Reaction has duplicate protocolMsgId, has existing with different author: "+a.toString(),key:b,result:"invalid"}}})})}});b={description:"MAWReactionHasUniqueProtocolMsgIdValidator",isValid:a,table:"reactions",type:["add","put"]};g.MAWReactionHasUniqueProtocolMsgIdValidator=b}),98);
__d("MAWDbMutationMiddleware",["FBLogger","MAWDbMiddlewareMutations"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{create:function(b){return babelHelpers["extends"]({},b,{table:function(e){var f=b.table(e);try{return babelHelpers["extends"]({},f,{get:function(b){return f.get(b).then(function(b){return b==null?void 0:d("MAWDbMiddlewareMutations").getValue(b,e,a)})},getMany:function(b){return f.getMany(b).then(function(b){return b.map(function(b){return b==null?void 0:d("MAWDbMiddlewareMutations").getValue(b,e,a)})})},mutate:function(b){var c=null;switch(b.type){case"add":case"put":c=b.values.map(function(b){return d("MAWDbMiddlewareMutations").mutateValue(b,e,a)});break;case"delete":break;case"deleteRange":break}if(b.type==="delete"||b.type==="deleteRange"||c==null)return f.mutate(b);b.values=c;return f.mutate(b).then(function(a){return a})},openCursor:function(b){return f.openCursor(b).then(function(b){return b==null||b.value==null?b:h(b,e,a)})},query:function(b){return f.query(b).then(function(b){if(b.result.length===0||typeof b.result[0]!=="object")return b;var c=b.result.map(function(b){return d("MAWDbMiddlewareMutations").getValue(b,e,a)});b.result=c;return b})}})}catch(a){c("FBLogger")("messenger_web").catching(a).mustfix("Error applying MAWDbMiddleware");return f}}})},name:"MAWDbMutationMiddleware",stack:"dbcore"}}function b(){return{create:function(a){return babelHelpers["extends"]({},a,{table:function(b){var e=a.table(b);try{return babelHelpers["extends"]({},e,{get:function(a){return e.get(a).then(function(a){return d("MAWDbMiddlewareMutations").getVaultedValue(a,b)})},getMany:function(a){return e.getMany(a).then(function(a){return a.map(function(a){return d("MAWDbMiddlewareMutations").getVaultedValue(a,b)})})},mutate:function(a){if(a.type==="delete"||a.type==="deleteRange")return e.mutate(a);a.values=a.values.map(function(a){return d("MAWDbMiddlewareMutations").mutateVaultedValue(a,b)});return e.mutate(a)},openCursor:function(a){return e.openCursor(a).then(function(a){return a==null||a.value==null?a:i(a,b)})},query:function(a){return e.query(a).then(function(a){return a.result.length===0||typeof a.result[0]!=="object"?a:babelHelpers["extends"]({},a,{result:a.result.map(function(a){return d("MAWDbMiddlewareMutations").getVaultedValue(a,b)})})})}})}catch(a){c("FBLogger")("messenger_web").catching(a).mustfix("Error applying MAWDbMiddleware");return e}}})},name:"getMAWVaultMiddleware",stack:"dbcore"}}function h(a,b,c){var e;return Object.create(a,{"continue":{get:function(){return a["continue"]}},continuePrimaryKey:{get:function(){return a.continuePrimaryKey}},key:{get:function(){return a.key}},primaryKey:{get:function(){return a.primaryKey}},start:{value:function(f){return a.start(function(){e=d("MAWDbMiddlewareMutations").getValue(a.value,b,c);try{a.value=e}catch(a){}f()})}},value:{get:function(){return e}}})}function i(a,b){var c;return Object.create(a,{"continue":{get:function(){return a["continue"]}},continuePrimaryKey:{get:function(){return a.continuePrimaryKey}},key:{get:function(){return a.key}},primaryKey:{get:function(){return a.primaryKey}},start:{value:function(e){return a.start(function(){c=d("MAWDbMiddlewareMutations").getVaultedValue(a.value,b);try{a.value=c}catch(a){}e()})}},value:{get:function(){return c}}})}g.getMAWDbMutationMiddleware=a;g.getMAWVaultMiddleware=b}),98);
__d("MAWDbEncryptObjContent",["MAWKeychainNaClCrypto"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return d("MAWKeychainNaClCrypto").encryptTweetNaClArrayBuffer(a,b,c)}g.encryptContent=a}),98);
__d("MAWXMACTAUtil",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.actionUrl,c=a.buttonType,d=a.ctaType,e=a.nativeUrl;a=a.title;return{actionUrl:b,buttonType:c,ctaType:d,nativeUrl:e,title:a}}function b(a){var b=a.actionUrl,c=a.buttonType,d=a.ctaType,e=a.nativeUrl;a=a.title;return{actionUrl:b,buttonType:c,ctaType:d,nativeUrl:e,title:a}}f.toMAWCTAEncode=a;f.fromMAWCTAEncode=b}),66);
__d("WAServerSync.pb",["$InternalEnum","WAProtoConst"],(function(a,b,c,d,e,f,g){a=b("$InternalEnum")({SET:0,REMOVE:1});c={};e={};f={};b={};var h={},i={},j={},k={},l={},m={},n={};c.name="SyncdVersion";c.internalSpec={version:[1,(d=d("WAProtoConst")).TYPES.UINT64]};e.name="ExitCode";e.internalSpec={code:[1,d.TYPES.UINT64],text:[2,d.TYPES.STRING]};f.name="SyncdIndex";f.internalSpec={blob:[1,d.TYPES.BYTES]};b.name="SyncdValue";b.internalSpec={blob:[1,d.TYPES.BYTES]};h.name="KeyId";h.internalSpec={id:[1,d.TYPES.BYTES]};i.name="SyncdRecord";i.internalSpec={index:[1,d.TYPES.MESSAGE,f],value:[2,d.TYPES.MESSAGE,b],keyId:[3,d.TYPES.MESSAGE,h]};j.name="ExternalBlobReference";j.internalSpec={mediaKey:[1,d.TYPES.BYTES],directPath:[2,d.TYPES.STRING],handle:[3,d.TYPES.STRING],fileSizeBytes:[4,d.TYPES.UINT64],fileSha256:[5,d.TYPES.BYTES],fileEncSha256:[6,d.TYPES.BYTES]};k.name="SyncdSnapshot";k.internalSpec={version:[1,d.TYPES.MESSAGE,c],records:[2,d.FLAGS.REPEATED|d.TYPES.MESSAGE,i],mac:[3,d.TYPES.BYTES],keyId:[4,d.TYPES.MESSAGE,h]};l.name="SyncdMutations";l.internalSpec={mutations:[1,d.FLAGS.REPEATED|d.TYPES.MESSAGE,m]};m.name="SyncdMutation";m.internalSpec={operation:[1,d.TYPES.ENUM,a],record:[2,d.TYPES.MESSAGE,i]};n.name="SyncdPatch";n.internalSpec={version:[1,d.TYPES.MESSAGE,c],mutations:[2,d.FLAGS.REPEATED|d.TYPES.MESSAGE,m],externalMutations:[3,d.TYPES.MESSAGE,j],snapshotMac:[4,d.TYPES.BYTES],patchMac:[5,d.TYPES.BYTES],keyId:[6,d.TYPES.MESSAGE,h],exitCode:[7,d.TYPES.MESSAGE,e],deviceIndex:[8,d.TYPES.UINT32],clientDebugData:[9,d.TYPES.BYTES]};g.SyncdMutation$SyncdOperation=a;g.SyncdVersionSpec=c;g.ExitCodeSpec=e;g.SyncdIndexSpec=f;g.SyncdValueSpec=b;g.KeyIdSpec=h;g.SyncdRecordSpec=i;g.ExternalBlobReferenceSpec=j;g.SyncdSnapshotSpec=k;g.SyncdMutationsSpec=l;g.SyncdMutationSpec=m;g.SyncdPatchSpec=n}),98);
__d("MAWDbObjDecode",["FBLogger","MAWArmadilloAppDataTableSchema.pb","MAWArmadilloAppMetaTableSchema.pb","MAWArmadilloCollectionVersionsTableSchema.pb","MAWArmadilloDeletedMessagesTableSchema.pb","MAWArmadilloDeviceChangeAlertsTableSchema.pb","MAWArmadilloDyiBatchTableSchema.pb","MAWArmadilloEBMsgRangesTableSchema.pb","MAWArmadilloEditMsgHistoryTableSchema.pb","MAWArmadilloGroupInfoTableSchema.pb","MAWArmadilloGroupInvitesTableSchema.pb","MAWArmadilloMediaTablesSchema.pb","MAWArmadilloMessagesTableSchema.pb","MAWArmadilloMissingKeysTableSchema.pb","MAWArmadilloParticipantsTableSchema.pb","MAWArmadilloPendingMutationsTableSchema.pb","MAWArmadilloPersonalSenderKeyStatusTableSchema.pb","MAWArmadilloPollTableSchema.pb","MAWArmadilloReactionsTableSchema.pb","MAWArmadilloReceiptTablesSchema.pb","MAWArmadilloReceiverFetchInfoTableSchema.pb","MAWArmadilloSyncActionsTableSchema.pb","MAWArmadilloSyncKeysTableSchema.pb","MAWArmadilloTasksTableSchema.pb","MAWArmadilloThreadsTableSchema.pb","MAWArmadilloUnrenderedMessagesTableSchema.pb","MAWArmadilloXMATableSchema.pb","MAWMsgType","MAWODSProxy","MAWXMACTAUtil","WAOdsEnums","WAServerSync.pb","decodeProtobuf"],(function(a,b,c,d,e,f,g){var h={appData:function(a){return A(a)},appMeta:function(a){return B(a)},chunk:function(a){return C(a)},collectionVersions:function(a){return L(a)},deletedMessages:function(a){return n(a)},deviceChangeAlerts:function(a){return i(a)},dualSendMedia:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},dyiBatch:function(a){return G(a)},ebMessageRestoreTasks:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ebMsgRanges:function(a){return H(a)},ebRestoreQueue:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ebUploadQueue:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},editMsgHistory:function(a){return O(a)},encryptionMetaV3:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ephemeralSettings:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},existingUsers:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ftsBackloggedMessages:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ftsEncryptionMeta:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ftsIndexV3:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ftsPurgeBacklog:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},ftsPurgeThreadBacklog:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},groupInfo:function(a){return q(a)},groupInvites:function(a){return x(a)},historySyncQRCodeData:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},historySyncQRCodeSecretKey:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},igMessageAuxiliaryInfo:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},isDualSend:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},media:function(a){return E(a)},mediaBackup:function(a){return D(a)},mediaKeys:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},messages:function(a){return m(a)},missingKeys:function(a){return J(a)},participants:function(a){return w(a)},pendingMessageStanzaQueue:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},pendingMutations:function(a){return K(a)},pendingReceipts:function(a){return u(a)},pendingStanzas:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},personalSenderKeyStatuses:function(a){return z(a)},poll:function(a){return Q(a)},reactions:function(a){return F(a)},receipts:function(a){return t(a)},receiverFetchInfo:function(a){return P(a)},sentBytesCache:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},staleQueue:function(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for decryption")},syncActions:function(a){return I(a)},syncKeys:function(a){return M(a)},tasks:function(a){return y(a)},threads:function(a){return v(a)},unrenderedMessages:function(a){return o(a)},xma:function(a){return N(a)}};function a(a,b){if(Object.prototype.hasOwnProperty.call(h,b))b=h[b](a);else throw c("FBLogger")("messenger_web").mustfixThrow("not a valid table name");return b}function i(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloDeviceChangeAlertsTableSchema.pb").DeviceChangeAlertsTableSchemaProtoSpec,a);return{action:a.action,deviceJid:a.deviceJid,identity:a.identity,isArchived:a.isArchived,latitude:a.latitude,location:a.location,loggedOut:a.loggedOut,longitude:a.longitude,model:a.model,platform:a.platform,ts:a.ts}}function j(a){a=a.quote;var b;if(a!=null){if(a.content==null)throw c("FBLogger")("messenger_web").mustfixThrow("QuotedMsgContent missing upon decoding");var d=a.content,e=d.author,f=d.expirationTs,g=d.externalId,h=d.mediaId,i=d.msgContent,j=d.msgId,k=d.plaintextHash,l=d.sourceId,m=d.specialTextSize,n=d.ts,o=d.type;d=d.xmaMessageType;b={content:babelHelpers["extends"]({},a.content,{author:e,expirationTs:f,externalId:g,mediaId:h,msgContent:i,msgId:j,plaintextHash:k,sourceId:l,specialTextSize:m,ts:n,type:o,xmaMessageType:d}),remoteJid:a.remoteJid}}return b}function k(a){if(a==null)return a;else return new Uint8Array(a)}function l(a){if(a==null||a.length===0)return new Set();else return new Set(a)}function m(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMessagesTableSchema.pb").MessagesTableSchemaProtoSpec,a);var b=a.msgContent;if(a.type===d("MAWMsgType").MSG_TYPE.FUTUREPROOF){if(b==null)throw c("FBLogger")("messenger_web").mustfixThrow("MsgContent missing upon decoding futureproof message");b.subtype=b.subtype}var e=j(a),f=p(a.reportingMeta);return babelHelpers["extends"]({},a,{msgContent:b,quote:e,reportingMeta:f})}function n(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloDeletedMessagesTableSchema.pb").DeletedMessagesTableSchemaProtoSpec,a);return babelHelpers["extends"]({},a)}function o(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloUnrenderedMessagesTableSchema.pb").UnrenderedMessagesTableSchemaProtoSpec,a);var b=j(a),c=p(a.reportingMeta);return babelHelpers["extends"]({},a,{quote:b,reportingMeta:c})}function p(a){if(a==null)return;return{frankingKey:a.frankingKey!=null?new Uint8Array(a.frankingKey):a.frankingKey,frankingTag:a.frankingTag!=null?new Uint8Array(a.frankingTag):a.frankingTag,frankingVersion:a.frankingVersion,reportingContent:a.reportingContent,reportingTag:a.reportingTag!=null?new Uint8Array(a.reportingTag):a.reportingTag}}function q(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloGroupInfoTableSchema.pb").GroupInfoSchemaProtoSpec,a);return{creationTs:a.creationTs,creator:a.creator,inviter:a.inviter,memberAddMode:a.memberAddMode,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion}}function r(a){if(a.length===0)return null;else return new Map(a.map(function(a){var b=a.deviceJid;if(b==null||a.serializedPubKey==null)throw c("FBLogger")("messenger_web").mustfixThrow("Expected deviceJid or serializedPubKey are missing ");var d=new Uint8Array(a.serializedPubKey);a=k(a.baseKey);a={baseKey:a,pubKey:d};return[b,a]}))}function s(a){if(a==null)return null;else return new Map(a.map(function(a){if(a.deviceJid==null)throw c("FBLogger")("messenger_web").mustfixThrow("Expected deviceJID is missing ");return[a.deviceJid,(a=a.count)!=null?a:0]}))}function t(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").ReceiptsTableSchemaProtoSpec,a);var b=a.recipientDevices;b=l(b);return{permittedIdentitiesPerDevice:r(a.permittedIdentitiesPerDevice),recipientDevices:b,retryCountsPerDevice:s(a.retryCountsPerDevice)}}function u(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").PendingReceiptsTableSchemaProtoSpec,a)}function v(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloThreadsTableSchema.pb").ThreadsTableSchemaProtoSpec,a);return{archived:a.archived,cannotReplyReason:a.cannotReplyReason,didInsertDualThreadCutoverAdminMsg:a.didInsertDualThreadCutoverAdminMsg,folder:a.folder,isMigratedLocally:a.isMigratedLocally,lastReadMsg:a.lastReadMsg,lastReadMsgReceiptSent:a.lastReadMsgReceiptSent,muteCallsExpireTimeMs:a.muteCallsExpireTimeMs,muteExpireTimeMs:a.muteExpireTimeMs,newestMsg:a.newestMsg,newestMsgTs:a.newestMsgTs,oldestMsg:a.oldestMsg,optimisticThreadKey:a.optimisticThreadKey,snippetMsg:a.snippetMsg,snippetMsgTs:a.snippetMsgTs}}function w(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloParticipantsTableSchema.pb").ParticipantsTableSchemaProtoSpec,a)}function x(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloGroupInvitesTableSchema.pb").GroupInvitesTableSchemaProtoSpec,a)}function y(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloTasksTableSchema.pb").TasksTableSchemaProtoSpec,a)}function z(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloPersonalSenderKeyStatusTableSchema.pb").PersonalSenderKeyStatusTableSchemaProtoSpec,a);var b=a.hasSenderKey;b=l(b);return{hasSenderKey:b,rotateSenderKey:a.rotateSenderKey,senderKeyId:a.senderKeyId,senderKeyTs:a.senderKeyTs}}function A(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloAppDataTableSchema.pb").AppDataTableSchemaProtoSpec,a);return{ack:a.ack,contents:a.contents,permittedIdentitiesPerDevice:r(a.permittedIdentitiesPerDevice),recipientDevices:new Set(a.recipientDevices),sendPartial:a.sendPartial,ts:a.ts}}function B(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloAppMetaTableSchema.pb").AppMetaTableSchemaProtoSpec,a)}function C(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").ChunkTableSchemaProtoSpec,a)}function D(a){return d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaBackupSchemaProtoSpec,a)}function E(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaTableSchemaProtoSpec,a);var b,e=a.mediaEntries;e==null?b=new Map():b=new Map(e.map(function(a){if(a.msgId==null||a.mediaEntryData==null)throw c("FBLogger")("messenger_web").mustfixThrow("Expected msgId or mediaEntryData are missing ");return[a.msgId,new Uint8Array(a.mediaEntryData)]}));return{accessibilitySummaryText:a.accessibilitySummaryText,mediaEntries:b,mediaType:a.mediaType,plaintextHash:a.plaintextHash,size:a.size,ts:a.ts,validatedAudioInfo:a.validatedAudioInfo,validatedDocumentFileInfo:a.validatedDocumentFileInfo,validatedImageInfo:a.validatedImageInfo,validatedResult:a.validatedResult,validatedVideoInfo:a.validatedVideoInfo}}function F(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReactionsTableSchema.pb").ReactionsTableSchemaProtoSpec,a);a.ts!=null&&d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_MIGRATE_REACTION_TS_AS_INDEX,key:"reaction_ts_encrypted"});return babelHelpers["extends"]({ack:a.ack,author:a.author,groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,senderTimestampMs:a.senderTimestampMs},a.ts!=null?{ts:a.ts}:{})}function G(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloDyiBatchTableSchema.pb").DyiBatchTableSchemaProtoSpec,a);return{isThread:a.isThread,numMessages:a.numMessages,numMessagesRestored:a.numMessagesRestored,numThreadsRestored:a.numThreadsRestored,oldestTs:a.oldestTs,qplFlowDescriptor:a.qplFlowDescriptor,qplInstanceKeyE2E:a.qplInstanceKeyE2E,qplInstanceKeyForThread:a.qplInstanceKeyForThread,threadId:a.threadId}}function H(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloEBMsgRangesTableSchema.pb").EBMsgRangesTableSchemaProtoSpec,a);return{creationTime:a.creationTime,maxMsgExternalId:a.maxMsgExternalId,maxMsgSortOrderMs:a.maxMsgSortOrderMs,minMsgExternalId:a.minMsgExternalId,minMsgSortOrderMs:a.minMsgSortOrderMs}}function I(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSyncActionsTableSchema.pb").SyncActionsTableSchemaProtoSpec,a);return{binarySyncData:a.binarySyncData,keyId:a.keyId,timestamp:a.timestamp,valueMac:a.valueMac,version:a.version}}function J(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloMissingKeysTableSchema.pb").MissingKeysTableSchemaProtoSpec,a);var b;a.deviceResponses==null?b=new Map():b=new Map(a.deviceResponses.map(function(a){if(a.deviceId==null)throw c("FBLogger")("messenger_web").mustfixThrow("Expected deviceId is missing");else return[a.deviceId,a.deviceResponse]}));return{deviceResponses:b,keyId:a.keyId,timestamp:a.timestamp}}function K(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloPendingMutationsTableSchema.pb").PendingMutationsTableSchemaProtoSpec,a);var b;switch(a.operation){case d("MAWArmadilloPendingMutationsTableSchema.pb").SYNCD_MUTATION_SYNCD_OPERATION.SET:b=d("WAServerSync.pb").SyncdMutation$SyncdOperation.SET;break;case d("MAWArmadilloPendingMutationsTableSchema.pb").SYNCD_MUTATION_SYNCD_OPERATION.REMOVE:b=d("WAServerSync.pb").SyncdMutation$SyncdOperation.REMOVE;break;default:throw c("FBLogger")("messenger_web").mustfixThrow("operation missing when decoding PendingMutation")}return{binarySyncAction:a.binarySyncAction,operation:b,timestamp:a.timestamp,version:a.version}}function L(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloCollectionVersionsTableSchema.pb").CollectionVersionsTableSchemaProtoSpec,a);return{finiteFailureStartTime:a.finiteFailureStartTime,isCollectionInMacMismatchFatal:a.isCollectionInMacMismatchFatal,isCollectionLthashInconsistent:a.isCollectionLthashInconsistent,ltHash:a.ltHash,state:a.state,version:a.version}}function M(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloSyncKeysTableSchema.pb").SyncKeysTableSchemaProtoSpec,a);return{fingerprint:a.fingerprint,keyData:a.keyData,timestamp:a.timestamp}}function N(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloXMATableSchema.pb").XMATableSchemaProtoSpec,a);return{author:a.author,ctas:a.ctas.map(function(a){return d("MAWXMACTAUtil").fromMAWCTAEncode(a)}),defaultCTA:a.defaultCTA==null?a.defaultCTA:d("MAWXMACTAUtil").fromMAWCTAEncode(a.defaultCTA),defaultPreviewMediaPlaintextHash:a.defaultPreviewMediaPlaintextHash,faviconPlaintextHash:a.faviconPlaintextHash,headerMediaPlaintextHash:a.headerMediaPlaintextHash,headerTitle:a.headerTitle,isTombstoned:a.isTombstoned,maxSubtitleNumOfLines:a.maxSubtitleNumOfLines,maxTitleNumOfLines:a.maxTitleNumOfLines,msgId:a.msgId,overlayDescription:a.overlayDescription,overlayIconGlyph:a.overlayIconGlyph,overlayTitle:a.overlayTitle,previewMediaIds:a.previewMediaIds,subtitleText:a.subtitleText,targetId:a.targetId,targetType:a.targetType,targetUsername:a.targetUsername,threadJid:a.threadJid,titleText:a.titleText,xmaLayoutType:a.xmaLayoutType}}function O(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloEditMsgHistoryTableSchema.pb").EditMsgHistoryTableSchemaProtoSpec,a);return{author:a.author,editExternalId:a.editExternalId,editTs:a.editTs,msgContent:a.msgContent,sendStatus:a.sendStatus,specialTextSize:a.specialTextSize}}function P(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloReceiverFetchInfoTableSchema.pb").ReceiverFetchInfoTableSchemaProtoSpec,a);return{accessibilitySummaryText:a.accessibilitySummaryText,mimetype:a.mimetype,previewHeight:a.previewHeight,previewUrl:a.previewUrl,previewUrlExpirationTimestampMs:a.previewUrlExpirationTimestampMs,previewWidth:a.previewWidth,type:a.type}}function Q(a){a=d("decodeProtobuf").decodeProtobuf(d("MAWArmadilloPollTableSchema.pb").PollTableSchemaProtoSpec,a);var b=new Map(a.pollOptions.map(function(a){var b=a.pollOptionHash;if(b==null||a.pollOption==null)throw c("FBLogger")("messenger_web").mustfixThrow("Expected pollOptionHash or pollOption is missing");return[b,{optionText:a.pollOption.optionText,voteAuthors:new Set(a.pollOption.voteAuthors)}]}).filter(Boolean)),e=new Map(a.latestSenderTimestampsMs.map(function(a){if(a.author==null||a.latestSenderTimestampMs==null)throw c("FBLogger")("messenger_web").mustfixThrow("Expected author or latestSenderTimestampMs are missing");return[a.author,a.latestSenderTimestampMs]}));return{encKey:a.encKey,latestSenderTimestampsMs:e,pollAuthor:a.pollAuthor,pollOptions:b,pollParticipantCount:a.pollParticipantCount,pollState:a.pollState,selectableOptionsCount:a.selectableOptionsCount,title:a.title}}g.decodeDbObj=a}),98);
__d("WASyncdKeyTypes",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}function b(a){return a}function c(a){return a}function d(a){return a}f.toSyncKeyId=a;f.fromSyncKeyId=b;f.toSyncKeyData=c;f.fromSyncKeyData=d}),66);
__d("MAWDbObjEncode",["FBLogger","MAWArmadilloAppDataTableSchema.pb","MAWArmadilloAppMetaTableSchema.pb","MAWArmadilloDeletedMessagesTableSchema.pb","MAWArmadilloDeviceChangeAlertsTableSchema.pb","MAWArmadilloDyiBatchTableSchema.pb","MAWArmadilloEBMsgRangesTableSchema.pb","MAWArmadilloEditMsgHistoryTableSchema.pb","MAWArmadilloGroupInfoTableSchema.pb","MAWArmadilloGroupInvitesTableSchema.pb","MAWArmadilloMediaTablesSchema.pb","MAWArmadilloMessagesTableSchema.pb","MAWArmadilloParticipantsTableSchema.pb","MAWArmadilloPersonalSenderKeyStatusTableSchema.pb","MAWArmadilloPollTableSchema.pb","MAWArmadilloReactionsTableSchema.pb","MAWArmadilloReceiptTablesSchema.pb","MAWArmadilloReceiverFetchInfoTableSchema.pb","MAWArmadilloTasksTableSchema.pb","MAWArmadilloThreadsTableSchema.pb","MAWArmadilloUnrenderedMessagesTableSchema.pb","MAWArmadilloXMATableSchema.pb","MAWMsgType","MAWXMACTAUtil","WASyncdKeyTypes","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h=["ack","altIndex","collapsibleId","externalId","messageDeleteTs","messageExpirationTs","msgId","pollStanzaId","protocolMsgId","quoteExpirationTs","quoteExternalId","revokedExternalId","rowId","serverTs","sortOrderMs","threadJid","unsendMsgContentDeleteTs"],i=["author","chat","externalId","rowId"],j={appData:w,appMeta:x,chunk:y,deletedMessages:k,deviceChangeAlerts:a,dualSendMedia:b,dyiBatch:C,ebMessageRestoreTasks:b,ebMsgRanges:D,ebRestoreQueue:b,ebUploadQueue:b,editMsgHistory:F,encryptionMetaV3:b,ephemeralSettings:b,existingUsers:b,ftsBackloggedMessages:b,ftsEncryptionMeta:b,ftsIndexV3:b,ftsPurgeBacklog:b,ftsPurgeThreadBacklog:b,groupInfo:m,groupInvites:t,historySyncQRCodeData:b,historySyncQRCodeSecretKey:b,igMessageAuxiliaryInfo:b,isDualSend:b,media:A,mediaBackup:z,mediaKeys:b,messages:f,participants:s,pendingMessageStanzaQueue:b,pendingReceipts:q,pendingStanzas:b,personalSenderKeyStatuses:v,poll:H,reactions:B,receipts:p,receiverFetchInfo:G,sentBytesCache:b,staleQueue:b,tasks:u,threads:r,unrenderedMessages:l,xma:E};function a(a){a={action:a.action,deviceJid:a.deviceJid,identity:a.identity,isArchived:a.isArchived,latitude:a.latitude,location:a.location,loggedOut:a.loggedOut,longitude:a.longitude,model:a.model,platform:a.platform,ts:a.ts};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloDeviceChangeAlertsTableSchema.pb").DeviceChangeAlertsTableSchemaProtoSpec,a).readByteArrayView()}}function b(a){throw c("FBLogger")("messenger_web").mustfixThrow("unexpected table for encryption")}function e(a,b){if(Object.prototype.hasOwnProperty.call(j,b))b=j[b](a);else throw c("FBLogger")("messenger_web").mustfixThrow("not a valid table name");return b}function f(a){a.ack;a.altIndex;a.collapsibleId;a.externalId;a.messageDeleteTs;a.messageExpirationTs;a.msgId;a.pollStanzaId;a.protocolMsgId;a.quoteExpirationTs;a.quoteExternalId;a.revokedExternalId;a.rowId;a.serverTs;a.sortOrderMs;a.threadJid;a.unsendMsgContentDeleteTs;a=babelHelpers.objectWithoutPropertiesLoose(a,h);a=a;var b;if(a.quote==null)b=a.quote;else{var c;c={author:a.quote.content.author,expirationTs:a.quote.content.expirationTs,externalId:(c=a.quote)==null?void 0:c.content.externalId,mediaId:a.quote.content.mediaId,msgContent:a.quote.content.msgContent,msgId:a.quote.content.msgId,plaintextHash:a.quote.content.plaintextHash,sourceId:a.quote.content.sourceId,specialTextSize:a.quote.content.specialTextSize,ts:a.quote.content.ts,type:a.quote.content.type,xmaMessageType:a.quote.content.xmaMessageType};c={content:c,remoteJid:a.quote.remoteJid};b=c}c=a.msgContent;a.type===d("MAWMsgType").MSG_TYPE.FUTUREPROOF&&(c={protobuf:a.msgContent.protobuf,subtype:a.msgContent.subtype});var e=a.ravenEphemeralType,f=a.ravenEphemeralMediaState;e=e!=null?e:null;f=f!=null?f:null;c={applicationErrorCode:a.applicationErrorCode,author:a.author,editCount:a.editCount,ephemeralCounterStarted:a.ephemeralCounterStarted,ephemeralMsgDisappeared:a.ephemeralMsgDisappeared,ephemeralSetting:a.ephemeralSetting,forwardingScore:a.forwardingScore,groupId:a.groupId,groupIndex:a.groupIndex,groupSize:a.groupSize,hdType:a.hdType,isCollapsed:a.isCollapsed,isExpiredXmaMsg:a.isExpiredXmaMsg,isForwarded:a.isForwarded,mediaId:a.mediaId,msgContent:c,originalTs:a.originalTs,quote:b,ravenEphemeralMediaState:f,ravenEphemeralType:e,receiverFetchId:a.receiverFetchId,reportingMeta:a.reportingMeta,resendCount:a.resendCount,source:a.source,specialTextSize:a.specialTextSize,ts:a.ts,type:a.type,xmaMessageType:a.xmaMessageType};return{encodedFields:c,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMessagesTableSchema.pb").MessagesTableSchemaProtoSpec,c).readByteArrayView()}}function k(a){a.author;a.chat;a.externalId;a.rowId;a=babelHelpers.objectWithoutPropertiesLoose(a,i);a={reason:String(a.reason)};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloDeletedMessagesTableSchema.pb").DeletedMessagesTableSchemaProtoSpec,a).readByteArrayView()}}function l(a){var b;if(a.quote==null)b=a.quote;else{var c;c={author:a.quote.content.author,expirationTs:a.quote.content.expirationTs,externalId:(c=a.quote)==null?void 0:c.content.externalId,mediaId:a.quote.content.mediaId,msgContent:a.quote.content.msgContent,msgId:a.quote.content.msgId,plaintextHash:a.quote.content.plaintextHash,sourceId:a.quote.content.sourceId,ts:a.quote.content.ts,type:a.quote.content.type,xmaMessageType:a.quote.content.xmaMessageType};c={content:c,remoteJid:a.quote.remoteJid};b=c}c={ack:a.ack,author:a.author,ephemeralSetting:a.ephemeralSetting,groupName:a.groupName,invitedParticipantUserJid:a.invitedParticipantUserJid,mediaId:a.mediaId,msgContent:a.msgContent,quote:b,reportingMeta:a.reportingMeta,resendCount:a.resendCount,ts:a.ts,type:a.type,xmaMessageType:a.xmaMessageType};return{encodedFields:c,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloUnrenderedMessagesTableSchema.pb").UnrenderedMessagesTableSchemaProtoSpec,c).readByteArrayView()}}function m(a){a={creationTs:a.creationTs,creator:a.creator,inviter:a.inviter,memberAddMode:a.memberAddMode,msgExpiration:a.msgExpiration,name:a.name,nameOwner:a.nameOwner,nameTs:a.nameTs,participantVersion:a.participantVersion};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloGroupInfoTableSchema.pb").GroupInfoSchemaProtoSpec,a).readByteArrayView()}}function n(a){if(a==null)return a;else return Array.from(a,function(a){var b=a[0];a=a[1];return{baseKey:a.baseKey,deviceJid:b,serializedPubKey:a.pubKey}})}function o(a){if(a==null)return null;else return Array.from(a,function(a){var b=a[0];a=a[1];return{count:a,deviceJid:b}})}function p(a){var b=Array.from(a.recipientDevices);b={permittedIdentitiesPerDevice:n(a.permittedIdentitiesPerDevice),recipientDevices:b,retryCountsPerDevice:o(a.retryCountsPerDevice)};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").ReceiptsTableSchemaProtoSpec,b).readByteArrayView()}}function q(a){a={author:a.author,deliveryReceipts:a.deliveryReceipts,externalId:a.externalId,readReceipts:a.readReceipts,thread:a.thread};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReceiptTablesSchema.pb").PendingReceiptsTableSchemaProtoSpec,a).readByteArrayView()}}function r(a){a={archived:a.archived,cannotReplyReason:a.cannotReplyReason,didInsertDualThreadCutoverAdminMsg:a.didInsertDualThreadCutoverAdminMsg,folder:a.folder,isMigratedLocally:a.isMigratedLocally,lastReadMsg:a.lastReadMsg,lastReadMsgReceiptSent:a.lastReadMsgReceiptSent,newestMsgTs:a.newestMsgTs,oldestMsg:a.oldestMsg,optimisticThreadKey:a.optimisticThreadKey,snippetMsg:a.snippetMsg,snippetMsgTs:a.snippetMsgTs};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloThreadsTableSchema.pb").ThreadsTableSchemaProtoSpec,a).readByteArrayView()}}function s(a){a={addressable:a.addressable,deliveredWatermarkTs:a.deliveredWatermarkTs,lastReadActionTs:a.lastReadActionTs,lastReadWatermarkTs:a.lastReadWatermarkTs,type:a.type};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloParticipantsTableSchema.pb").ParticipantsTableSchemaProtoSpec,a).readByteArrayView()}}function t(a){a={caption:a.caption,inviteCode:a.inviteCode,inviteExpirationTs:a.inviteExpirationTs};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloGroupInvitesTableSchema.pb").GroupInvitesTableSchemaProtoSpec,a).readByteArrayView()}}function u(a){a={scheduledTime:a.scheduledTime};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloTasksTableSchema.pb").TasksTableSchemaProtoSpec,a).readByteArrayView()}}function v(a){var b=Array.from(a.hasSenderKey);b={hasSenderKey:b,rotateSenderKey:a.rotateSenderKey,senderKeyId:a.senderKeyId,senderKeyTs:a.senderKeyTs};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloPersonalSenderKeyStatusTableSchema.pb").PersonalSenderKeyStatusTableSchemaProtoSpec,b).readByteArrayView()}}function w(a){var b;switch(a.contents.type){case"meta_sync":var e=[];for(var f of a.contents.actions)f.chatAction?e.push({chatAction:f.chatAction}):f.messageAction&&e.push({messageAction:f.messageAction});b={actions:e,type:"meta_sync"};break;case"backups_secrets":b={encryptedBackupsSecrets:a.contents.encryptedBackupsSecrets,type:"backups_secrets"};break;case"sync_key_share":b={syncKeyShare:{keys:a.contents.syncKeyShare.keys,orphanKeys:(f=a.contents.syncKeyShare)==null||(f=f.orphanKeys)==null?void 0:f.map(d("WASyncdKeyTypes").fromSyncKeyId)},type:"sync_key_share"};break;case"sync_key_request":b={syncKeyRequest:{keyIds:a.contents.syncKeyRequest.keyIds.map(d("WASyncdKeyTypes").fromSyncKeyId)},type:"sync_key_request"};break;default:a.contents.type;throw c("FBLogger")("messenger_web").mustfixThrow("Unknown appdata type: "+a.contents.type)}e={ack:a.ack,contents:b,permittedIdentitiesPerDevice:n(a.permittedIdentitiesPerDevice),recipientDevices:Array.from(a.recipientDevices),sendPartial:a.sendPartial,ts:a.ts};return{encodedFields:e,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloAppDataTableSchema.pb").AppDataTableSchemaProtoSpec,e).readByteArrayView()}}function x(a){a={value:a.value};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloAppMetaTableSchema.pb").AppMetaTableSchemaProtoSpec,a).readByteArrayView()}}function y(a){a={blobData:a.blobData,mimetype:a.mimetype,plaintextHash:a.plaintextHash};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").ChunkTableSchemaProtoSpec,a).readByteArrayView()}}function z(a){a={fbid:a.fbid};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaBackupSchemaProtoSpec,a).readByteArrayView()}}function A(a){var b=Array.from(a.mediaEntries,function(a){var b=a[0];a=a[1];return{mediaEntryData:a,msgId:b}});b={accessibilitySummaryText:a.accessibilitySummaryText,mediaEntries:b,mediaType:a.mediaType,plaintextHash:a.plaintextHash,size:a.size,ts:a.ts,validatedAudioInfo:a.validatedAudioInfo,validatedDocumentFileInfo:a.validatedDocumentFileInfo,validatedImageInfo:a.validatedImageInfo,validatedResult:a.validatedResult,validatedVideoInfo:a.validatedVideoInfo};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloMediaTablesSchema.pb").MediaTableSchemaProtoSpec,b).readByteArrayView()}}function B(a){a={ack:a.ack,author:a.author,groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,senderTimestampMs:a.senderTimestampMs};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReactionsTableSchema.pb").ReactionsTableSchemaProtoSpec,a).readByteArrayView()}}function C(a){a={isThread:a.isThread,numMessages:a.numMessages,numMessagesRestored:a.numMessagesRestored,numThreadsRestored:a.numThreadsRestored,oldestTs:a.oldestTs,qplFlowDescriptor:a.qplFlowDescriptor,qplInstanceKeyE2E:a.qplInstanceKeyE2E,qplInstanceKeyForThread:a.qplInstanceKeyForThread,threadId:a.threadId};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloDyiBatchTableSchema.pb").DyiBatchTableSchemaProtoSpec,a).readByteArrayView()}}function D(a){a={creationTime:a.creationTime,maxMsgExternalId:a.maxMsgExternalId,maxMsgSortOrderMs:a.maxMsgSortOrderMs,minMsgExternalId:a.minMsgExternalId,minMsgSortOrderMs:a.minMsgSortOrderMs};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloEBMsgRangesTableSchema.pb").EBMsgRangesTableSchemaProtoSpec,a).readByteArrayView()}}function E(a){var b=a.ctas==null?[]:a.ctas.map(function(a){return d("MAWXMACTAUtil").toMAWCTAEncode(a)});b={author:a.author,ctas:b,defaultCTA:a.defaultCTA==null?a.defaultCTA:d("MAWXMACTAUtil").toMAWCTAEncode(a.defaultCTA),defaultPreviewMediaPlaintextHash:a.defaultPreviewMediaPlaintextHash,faviconPlaintextHash:a.faviconPlaintextHash,headerMediaPlaintextHash:a.headerMediaPlaintextHash,headerTitle:a.headerTitle,isTombstoned:a.isTombstoned,maxSubtitleNumOfLines:a.maxSubtitleNumOfLines,maxTitleNumOfLines:a.maxTitleNumOfLines,msgId:a.msgId,overlayDescription:a.overlayDescription,overlayIconGlyph:a.overlayIconGlyph,overlayTitle:a.overlayTitle,previewMediaIds:a.previewMediaIds,subtitleText:a.subtitleText,targetId:a.targetId,targetType:a.targetType,targetUsername:a.targetUsername,threadJid:a.threadJid,titleText:a.titleText,xmaLayoutType:a.xmaLayoutType};return{encodedFields:b,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloXMATableSchema.pb").XMATableSchemaProtoSpec,b).readByteArrayView()}}function F(a){a={author:a.author,editExternalId:a.editExternalId,editTs:a.editTs,msgContent:a.msgContent,sendStatus:a.sendStatus,specialTextSize:a.specialTextSize};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloEditMsgHistoryTableSchema.pb").EditMsgHistoryTableSchemaProtoSpec,a).readByteArrayView()}}function G(a){a={accessibilitySummaryText:a.accessibilitySummaryText,mimetype:a.mimetype,previewHeight:a.previewHeight,previewUrl:a.previewUrl,previewUrlExpirationTimestampMs:a.previewUrlExpirationTimestampMs,previewWidth:a.previewWidth,type:a.type};return{encodedFields:a,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloReceiverFetchInfoTableSchema.pb").ReceiverFetchInfoTableSchemaProtoSpec,a).readByteArrayView()}}function H(a){var b=Array.from(a.pollOptions,function(a){var b=a[0];a=a[1];return{pollOption:{optionText:a.optionText,voteAuthors:Array.from(a.voteAuthors)},pollOptionHash:b}}),c=Array.from(a.latestSenderTimestampsMs,function(a){var b=a[0];a=a[1];return{author:b,latestSenderTimestampMs:a}});c={encKey:a.encKey,latestSenderTimestampsMs:c,pollAuthor:a.pollAuthor,pollOptions:b,pollParticipantCount:a.pollParticipantCount,pollState:a.pollState,selectableOptionsCount:a.selectableOptionsCount,title:a.title};return{encodedFields:c,proto:d("encodeProtobuf").encodeProtobuf(d("MAWArmadilloPollTableSchema.pb").PollTableSchemaProtoSpec,c).readByteArrayView()}}g.encodeDbObj=e;g.encodeDbPollForEncryption=H}),98);
__d("MAWDbObjEncryption",["ExecutionEnvironment","FBLogger","MAWBridge","MAWCryptoConsts","MAWDbEncryptObjContent","MAWDbObjDecode","MAWDbObjEncode","MAWDexieTable","MAWIndexedDb","MAWKeychainCrypto","MAWKeychainNaClCrypto","MAWKeychainUtil","MAWQplProxy","MAWUnrecoverableDbErrors","MWEARKeychainV3","MWEARKeychainV3Errors","ODS","WABase64","WATimeUtils","getErrorSafe","gkx","isEncryptionAtRestEnabled","justknobx","pageID","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j="_encryptedContent",k=new Set(["threads","messages","participants"]);function a(a,b,e){if(!(c("isEncryptionAtRestEnabled")()||c("gkx")("23910")===!0)||!d("MAWIndexedDb").TABLES_TO_ENCRYPT.includes(b))return a;var f=d("MAWQplProxy").startQplUserFlow(c("qpl")._(25300256,"115"),{bool:{isWorker:(i||(i=c("ExecutionEnvironment"))).isInWorker,useMawEar:d("MWEARKeychainV3").isKeychainSettled("maw_ear")},string:{pageID:c("pageID"),tableName:b}});try{var g=babelHelpers["extends"]({},a);e=e(d("MWEARKeychainV3").isKeychainSettled("maw_ear")?"maw_ear":"global_ear");var h=e.keys;h=h[0];var l=e.version;e=e.randomisedVersion;d("MWEARKeychainV3").isKeychainSettled("maw_ear")===!1&&c("FBLogger")("messenger_web").mustfix("[EAR] Encrypting %s data with global ear. Transactor: %s",b,d("MAWDexieTable").getDexiePSDItem("transactorName"));f.addAnnotations({"int":{keyVersion:l,randomisedVersion:e}});var m=d("MAWKeychainUtil").makeAAD(l,d("MAWCryptoConsts").CIPHER_ID),n=d("MAWDbObjEncode").encodeDbObj(a,b),o=n.encodedFields;n=n.proto;Object.keys(o).forEach(function(b){Object.prototype.hasOwnProperty.call(a,b)&&delete g[b]});o=d("MAWDbEncryptObjContent").encryptContent(h,n,m);g[j]=o;k.has(b)&&(g.updatedAt_S456130=Date.now(),g.randomisedVersion_S456130=e,g.encryptedWith_S456130=d("MWEARKeychainV3").isKeychainSettled("maw_ear")?"maw_ear":"global_ear",g.keyVersion_S456130=l);f==null||f.endSuccess();return g}catch(a){f==null||f.endFail("ear_encrypt_fail");throw c("FBLogger")("messenger_web").catching(a).mustfixThrow("[%s] %s - Encrypted dexie was unable to encrypt an entity for table %s",a.name,a.message,b)}}function b(a,b,e){if(!d("MAWIndexedDb").TABLES_TO_ENCRYPT.includes(b)||!Object.prototype.hasOwnProperty.call(a,j))return a;var f=(i||(i=c("ExecutionEnvironment"))).isInMainThread&&c("justknobx")._("3378")?null:d("MAWQplProxy").startQplUserFlow(c("qpl")._(25313004,"118"));f==null||f.addAnnotations({bool:{isWorker:(i||(i=c("ExecutionEnvironment"))).isInWorker,useMawEar:d("MWEARKeychainV3").isKeychainSettled("maw_ear")},string:{pageID:c("pageID"),tableName:b}});var g;try{var n=a[j],o=babelHelpers["extends"]({},a);(h||(h=d("ODS"))).bumpEntityKey(3185,"maw_db_ear_decryption","encrypted_content_type."+b+"."+(n instanceof ArrayBuffer?"ArrayBuffer":"string"));n=n instanceof ArrayBuffer?n:d("WABase64").decodeB64(n);var p=d("MAWKeychainCrypto").getKeyVersionFromCipherDataString(n),q=p.aadLengthInBytes;p=p.keyVersion;e=e(d("MWEARKeychainV3").isKeychainSettled("maw_ear")?"maw_ear":"global_ear",p);g=e;var r=e.dbEntry,s=e.keys;e=e.randomisedVersion;f==null||f.addAnnotations({"int":{contentVersion:a==null?void 0:a.keyVersion_S456130,keyVersion:p,randomisedVersion:e},string:{encryptedWith:a==null?void 0:a.encryptedWith_S456130,randomisedVersionEncryption:a==null?void 0:a.randomisedVersion_S456130}});var t={},u,v;for(e of s)try{u=d("MAWKeychainNaClCrypto").decryptArrayBuffer(e,n,p,r.formatVersion,q);break}catch(a){v=a}if(u==null)throw c("getErrorSafe")(v);var w=d("MAWDbObjDecode").decodeDbObj(u,b);Object.keys(w).forEach(function(a){t[a]=w[a]});delete o[j];s=babelHelpers["extends"]({},o,t);f==null||f.endSuccess();return s}catch(h){if(k.has(b)){f==null||f.addAnnotations({"int":{updatedAt:(q=a==null?void 0:a.updatedAt_S456130)!=null?q:-1}})}c("justknobx")._("3208")&&(i||(i=c("ExecutionEnvironment"))).isInWorker&&(h instanceof d("MAWKeychainNaClCrypto").EARDecryptionError||h instanceof d("MWEARKeychainV3Errors").EARKeychainNotFoundError)&&(f==null||f.addAnnotations({bool:{unrecoverableDbError:!0}}),d("MAWBridge").getBridge().fireAndForget("event","unrecoverableDbError",{error:new(d("MAWUnrecoverableDbErrors").EarRuntimeError)()}));f==null||f.markError("ear_decrypt_exception",null,h);f==null||f.endFail("ear_decrypt_fail");throw c("FBLogger")("messenger_web").catching(h).mustfixThrow("[%s] %s - (v2) Encrypted dexie was unable to decrypt an entity for table %s. UpdatedAt: %s. KeyStatus: %s. Signature matches: %s. Key source: %s. Using MAW EAR: %s. Worker: %s. Encrypted With: %s. PageID: %s. Source: %s",h.name,h.message,b,l(a==null?void 0:a.updatedAt_S456130),m(a,g),(a==null?void 0:a.randomisedVersion_S456130)!=null&&((r=g)==null?void 0:r.randomisedVersion)!=null?a.randomisedVersion_S456130===g.randomisedVersion:null,(e=(n=g)==null?void 0:n.dbEntry.source)!=null?e:"-1",d("MWEARKeychainV3").isKeychainSettled("maw_ear"),(i||(i=c("ExecutionEnvironment"))).isInWorker,a==null?void 0:a.encryptedWith_S456130,c("pageID"),d("MAWDexieTable").getDexiePSDItem("transactorName"))}}function l(a){if(a==null)return"unknown";a=Date.now()-a;a=Math.floor(a/(1e3*60*60*24));if(a<1)return"0-1 days";else if(a<7)return"1-7 days";else if(a<14)return"7-14 days";else if(a<30)return"14-30 days";else return"30+ days"}function m(a,b){if((a==null?void 0:a.updatedAt_S456130)==null||b==null)return null;a=d("WATimeUtils").castToUnixTime(a.updatedAt_S456130/1e3);b=b.dbEntry.expiration-d("MAWCryptoConsts").ENC_KEY_TTL;if(a===b)return"same";else if(a>b)return"key_older";else return"key_newer"}g.ENCRYPTED_COLUMN_NAME=j;g.encryptDbObj=a;g.decryptDbObj=b}),98);
__d("MAWHMACKey",["MAWCryptoConsts","MAWDbMsgTypeVersionTxns","MAWIndexedDb","MAWKeychainUtil","MAWSubtleCrypto","MAWTransactionMode","WABase64","tweetnacl-auth"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES);return i(a).then(function(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.exportKey("raw",a)})}function a(a,b){a=new TextEncoder().encode(a);b=new Uint8Array(b);a=c("tweetnacl-auth")(a,b);return d("WABase64").encodeB64UrlSafe(a)}function b(){return h().then(function(a){return d("MAWIndexedDb").makeMsgrTransactor({appMeta:d("MAWTransactionMode").READWRITE},"generateAndInsertHMACKey",function(b){return function(){return d("MAWDbMsgTypeVersionTxns").getHMACKey(b).then(function(c){return c!=null?c:d("MAWDbMsgTypeVersionTxns").addHMACKey(b,a).then(function(){return a})})}})()})}function i(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",a,{hash:"SHA-256",name:"HMAC"},!0,["sign"])}g.genHMACKey=h;g.hmacTweetNaCl=a;g.generateAndInsertHMACKey=b}),98);
__d("MAWMediaUtils",["FBLogger","MAWDbMedia","MAWDexieTable","MAWHMACKey","MAWImageUtils","MAWMsgType","WABlobToArrayBuffer","WAGlobals","WAHashUtils","WAMsgType","WATimeUtils","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b===void 0&&(b="media");switch(a){case d("MAWDbMedia").MEDIA_TYPE.IMAGE:return b==="xma-media"?"xma-image":"image";case d("MAWDbMedia").MEDIA_TYPE.VIDEO:return"video";case d("MAWDbMedia").MEDIA_TYPE.PTT:return"ptt";case d("MAWDbMedia").MEDIA_TYPE.GIF:return"gif";case d("MAWDbMedia").MEDIA_TYPE.STICKER:return"sticker";case d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE:return"document";default:throw c("FBLogger")("messenger_web").mustfixThrow("get a wrong media file with type "+a)}}function h(a){try{return d("WABlobToArrayBuffer").blobToArrayBuffer(a).then(i)}catch(a){throw c("FBLogger")("messenger_web").mustfixThrow("Got "+a+" when convert the blob to Uint8Array")}}function i(a){return self.crypto.subtle.digest("SHA-256",a).then(function(a){return new Uint8Array(a)})}async function b(a){a=await h(a);a=d("WAHashUtils").toPlaintextHash(a);var b=j(a);return[a,b]}async function e(a){a=await i(a);a=d("WAHashUtils").toPlaintextHash(a);return a}function j(a){var b=d("WAGlobals").getHMACKey();return d("WAHashUtils").toHashedPlaintextHash(d("MAWHMACKey").hmacTweetNaCl(a,b))}function f(a){if(a==null)return null;var b="preview-"+d("WATimeUtils").unixTime().toString()+".jpeg";return k(a,b,"image/jpeg")}function k(a,b,c){return new File([new Blob([new Uint8Array(a)],{type:c})],b,{type:c})}function l(a,b,c){var e=function(){return c!=null?d("MAWDexieTable").dexieResolve(c.filter(function(a){return a.type!==d("WAMsgType").REVOKED&&b.msgIds.includes(a.msgId)})):a.messages.where("msgId").anyOf(b.msgIds).filter(function(a){return a.type!==d("WAMsgType").REVOKED}).toArray()};return e().then(function(a){return n(b,a)})}function m(a){return a.reduce(function(a,b){var c=b.hdType;c!=null&&(a[b.msgId]=c);return a},{})}function n(a,b){b=b.filter(function(b){return b.type!==d("WAMsgType").REVOKED&&a.msgIds.includes(b.msgId)});var e=b.map(function(a){return a.msgId});e=babelHelpers.extends({},a,{msgIds:e});var f=b.reduce(function(a,b){a[b.msgId]=d("WATimeUtils").castToMillisTime(b.sortOrderMs!=null?b.sortOrderMs:b.ts*1e3);return a},{});e=babelHelpers.extends({},e,{messagesSortOrderMs:f});if(b.every(function(a){return a.type===d("WAMsgType").STICKER})&&c("justknobx")._("2932")){f=d("MAWImageUtils").boundHeightWidth(e.previewHeight,e.previewWidth,d("MAWImageUtils").STICKER_THUMBNAIL_MAX_SIZE);var g=f.height;f=f.width;e=babelHelpers.extends({},e,{mediaType:d("MAWDbMedia").MEDIA_TYPE.STICKER,previewHeight:g,previewHeightLarge:g,previewWidth:f,previewWidthLarge:f})}g=new Set(b.map(function(a){return a.type}));g.forEach(function(b){if(b===d("MAWMsgType").MSG_TYPE.RAVEN)return;a.mediaType!==o(b)&&c("FBLogger")("messenger_web").mustfix("Message and media type mismatch: message with type %s is associated with media with type %s",b,a.mediaType)});return e}function o(a){switch(a){case d("MAWMsgType").MSG_TYPE.IMAGE:return d("MAWDbMedia").MEDIA_TYPE.IMAGE;case d("MAWMsgType").MSG_TYPE.VIDEO:return d("MAWDbMedia").MEDIA_TYPE.VIDEO;case d("MAWMsgType").MSG_TYPE.PTT:return d("MAWDbMedia").MEDIA_TYPE.PTT;case d("MAWMsgType").MSG_TYPE.GIF:return d("MAWDbMedia").MEDIA_TYPE.GIF;case d("MAWMsgType").MSG_TYPE.STICKER:return d("MAWDbMedia").MEDIA_TYPE.STICKER;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return d("MAWDbMedia").MEDIA_TYPE.DOCUMENT_FILE}}g.getServerMediaTypeFromMediaType=a;g.hashBlob=h;g.hashArrayBuffer=i;g.genBlobHashes=b;g.genHashFromArrayBuffer=e;g.genHMACPlaintextHash=j;g.convertJpegThumbnailArrayBufferToFile=f;g.getBridgeMediaAnnotatedForDisplay=l;g.createHdTypesForBridgeMedia=m;g.annotateBridgeMediaForDisplay=n;g.getMediaTypeFromMsgType=o}),98);
__d("MawMpsDropDeviceNotificationsForTurnedOffSecurityAlertsPreprocessor",["MAWDbMsgTypeVersionTxns","MAWMpsGating","MAWProtobufDeserializers","WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(a){h=a}b={name:"MawMpsDropDeviceNotificationsForTurnedOffSecurityAlertsPreprocessor",processAsync:async function(a,b){if(!d("MAWMpsGating").isMpsWaAdminMsgsEnabled()&&!d("MAWMpsGating").isFullMpsEnabled())return{errors:new Map(),payload:a};b.metric.addPoint("maybe_drop_security_alerts_start");var c=[];for(a of a){var e,f=a.directive,g=a.insertionSource,i=a.message,j=d("MAWProtobufDeserializers").DeserializedBackupMessage.create(i.payload);e=(e=j.payload().proto)==null||(e=e.event)==null?void 0:e.deviceChange;if(e==null){c.push({directive:f,insertionSource:g,message:i});continue}if(((e=j.proto.metadata)==null?void 0:e.senderId)===d("WAGlobals").getMyUserJid())continue;h===null&&(h=await d("MAWDbMsgTypeVersionTxns").getSecuritySettingForContactTxn());h===!0&&c.push({directive:f,insertionSource:g,message:i})}b.metric.addPoint("maybe_drop_security_alerts_end");return{errors:new Map(),payload:c}}};g.setCachedShouldSaveSecurityAlert=a;g.MawMpsDropDeviceNotificationsForTurnedOffSecurityAlertsPreprocessor=b}),98);
__d("RavenMessagingState",[],(function(a,b,c,d,e,f){a=Object.freeze({PERMANENT:0,UNSEEN:1,SEEN:2,REPLAYED:3,EXPIRED:4});f["default"]=a}),66);
__d("WAAckLevel",[],(function(a,b,c,d,e,f){"use strict";a={SENDER_BACKFILL_SENT:-7,INACTIVE_RECEIVED:-6,CONTENT_UNUPLOADABLE:-5,CONTENT_TOO_BIG:-4,CONTENT_GONE:-3,EXPIRED:-2,FAILED:-1,CLOCK:0,SENT:1,RECEIVED:2,READ:3,PLAYED:4};f.ACK=a}),66);
__d("WAIsOgg",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a.length<4)return!1;return a[0]!==79||a[1]!==103||a[2]!==103||a[3]!==83?!1:!0}f.isOgg=a}),66);
__d("WAMessageKey",["WAGlobals","WAJids","WAStanzaUtils","err"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a===d("WAJids").AUTHOR_ME||a==d("WAGlobals").getMyUserJid()}function a(a,b,e){if(e==null)throw c("err")("messageKey is null");var f=e.id,g=e.remoteJid;if(f==null)throw c("err")("messageKey.id is null");else if(g==null)throw c("err")("messageKey.remoteJid is null");g=d("WAJids").interpretAndValidateJid(g);if(g.jidType==="unknown")throw c("err")("messageKey.remoteJid is invalid");var i,j=d("WAJids").AUTHOR_ME;if(g.jidType==="group"){i=g.groupJid;if(h(b)&&e.fromMe===!0)j=d("WAJids").AUTHOR_ME;else if(e.fromMe==!0)j=b;else{var k=e.participant;if(k==null)throw c("err")("key.participant is null");k=d("WAJids").interpretAndValidateJid(k);if(k.jidType==="msgrUser")j=k.userJid;else throw c("err")("key.participant is invalid")}}else if(g.jidType==="msgrUser"||g.jidType==="msgrDevice"){k=d("WAJids").interpretAndValidateJid(a);if(k.jidType!=="msgrUser")throw c("err")("expected user type jid.");i=k.userJid;h(b)?e.fromMe===!0?j=d("WAJids").AUTHOR_ME:j=k.userJid:e.fromMe===!0&&(j=k.userJid)}else throw c("err")("Unsupported jidtype type");return{chat:i,author:h(j)?d("WAJids").AUTHOR_ME:j,externalId:d("WAStanzaUtils").toStanzaId(f)}}g.extractProtocolMessageId=a}),98);
__d("WAParseConsumerMessagePollCreation",["WAGlobals","WAHex","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){a={unstoredMsg:{type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(a),subtype:"pollCreationMessage"},id:b.id,ts:b.ts,sentTs:b.sentTs,serverTs:b.serverTs,ack:b.ack,reportingMeta:c},unstoredMedia:null,unstoredQuotedMedia:null};if(!e||!d("WAGlobals").getConfig().isPollsEnabled())return a;c=e.encKey;var f=e.options,g=e.name;e=e.selectableOptionsCount;var h=b.id,i=b.ts;b=b.ack;if(c==null||g==null||e==null)return a;a=f.map(function(a){return a.optionName}).filter(Boolean);return{unstoredMsg:{ack:b,id:h,ts:i,type:d("WAMsgType").MSG_TYPE.GROUP_POLL_CREATE},unstoredGroupPollCreateInfo:{encKey:c,name:g,selectableOptionsCount:e,options:a},unstoredMedia:null,unstoredQuotedMedia:null}}g["default"]=a}),98);
__d("WAParseConsumerMessagePollUpdate",["WAGlobals","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c,e){a=b.id;c=b.ts;b=b.ack;return e==null||!d("WAGlobals").getConfig().isPollsEnabled()?{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}:{unstoredMsg:{ack:b,id:a,ts:c,type:d("WAMsgType").MSG_TYPE.GROUP_POLL_UPDATE},unstoredGroupPollUpdateInfo:{pollUpdateMessage:e,type:d("WAMsgType").MSG_TYPE.GROUP_POLL_UPDATE},unstoredMedia:null,unstoredQuotedMedia:null}}g["default"]=a}),98);
__d("WAParseProtocolUtils",["WAGlobals","WALogger","WALongInt","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){b=i(b,a.serverTs);a=b==null?void 0:b.expirationTs;var c=b==null?void 0:b.deleteTs;b=b==null?void 0:b.ephemeralSetting;return{expirationTs:a,deleteTs:c,ephemeralSetting:b}}function b(a,b){b=j(b);b!=null&&(a.reportingMeta=b);return b}function i(a,b){var c,e,f=a==null||(c=a.chatEphemeralSetting)==null?void 0:c.ephemeralExpiration;a=a==null||(e=a.chatEphemeralSetting)==null?void 0:e.ephemeralSettingTimestamp;if(f==null||a==null||f===0||!d("WAGlobals").getConfig().isEphemeralMessagesEnabled())return null;b=d("WATimeUtils").castToUnixTime(b+d("WAGlobals").getDependencies().ephemeralMaxDeletionWindowForUnseenMessage());var g=b,h=null;try{a=d("WALongInt").numberOrThrowIfTooLarge(a)/1e3;h=d("WATimeUtils").castToUnixTime(a)}catch(a){return null}return{expirationTs:b,deleteTs:g,ephemeralSetting:{expirationTs:f,updatedTs:h}}}function j(a){a=a==null?void 0:a.frankingVersion;a!=null&&a!==0&&d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Unsupported franking version ",""])),a);return{frankingKey:void 0,frankingTag:void 0,frankingVersion:a,reportingContent:void 0,reportingTag:void 0}}g.parseEphemerality=a;g.enhanceReportingMeta=b}),98);
__d("WAParseReadOnlyMetadataDataclassToUnsafeObject",["err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if((a==null?void 0:a.readonlyMetadataDataclass)!=null)try{a=JSON.parse(a==null?void 0:a.readonlyMetadataDataclass);return a}catch(a){throw c("err")("Failed to parse readonly metadata dataclass JSON")}return null}g["default"]=a}),98);
__d("WAParseConsumerMessageProtocol",["WACommon.pb","WAConsumerApplication.pb","WAGlobals","WAHex","WAJids","WALogger","WAMediaTransport.pb","WAMessageKey","WAMsgType","WAParseConsumerMessagePollCreation","WAParseConsumerMessagePollUpdate","WAParseMediaTransportProtocol","WAParseProtocolUtils","WAParseReadOnlyMetadataDataclassToUnsafeObject","WAResultOrError","WAStanzaUtils","WATimeUtils","decodeProtobuf","err","maybeConvertMessageTextMentionsV2ToV1"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=90*d("WATimeUtils").DAY_SECONDS;b=1;e=0;f=1;f=d("WAGlobals").getConfig().armadilloWebProcessFutureproof()?f+1:f;function a(a,b,e,f,g,k){var l;b=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAConsumerApplication.pb").ConsumerApplicationSpec,b);l=(l=b.payload)==null||(l=l.applicationData)==null||(l=l.revoke)==null||(l=l.key)==null?void 0:l.id;if(l!=null)return{unstoredMsg:{type:d("WAMsgType").MSG_TYPE.REVOKED,id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:e.reportingMeta,revokedExternalId:d("WAStanzaUtils").toStanzaId(l),unsendMsgContentDeleteTs:null,msgContent:null,ebTimestampMs:k},unstoredMedia:null,unstoredQuotedMedia:null};var m=(g==null?void 0:g.isForwarded)||!1;l=d("WAParseProtocolUtils").parseEphemerality(e,g);var x=l.expirationTs,y=l.deleteTs,z=l.ephemeralSetting;if(z!=null&&(z.expirationTs<0||z.expirationTs>j)){l=d("WAJids").interpretAndValidateJid(a);l=l.jidType;var A=z.expirationTs;d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["WAParseConsumerMessageProtocol - ephemeralSetting duration is invalid ",", jidType: ",""])),A,l)}var B=d("WAParseProtocolUtils").enhanceReportingMeta(e,g),C=(A=o(g))!=null?A:void 0,D=(l=b.payload)==null?void 0:l.content;if(!D)return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null};var E=(A=b.metadata)==null?void 0:A.specialTextSize,F=t(D),G={contentTypeForLogging:F,unstoredMsg:{type:d("WAMsgType").MSG_TYPE.FUTUREPROOF,msgContent:{protobuf:d("WAHex").bytesToBuffer(f),subtype:null},id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:B},unstoredMedia:null,unstoredQuotedMedia:null},H=function(a){return babelHelpers["extends"]({},G,{unstoredMsg:babelHelpers["extends"]({},G.unstoredMsg,{msgContent:babelHelpers["extends"]({},G.unstoredMsg.msgContent,{subtype:a})})})};l=function(){try{switch(F){case"messageText":var b,h=D[F]&&c("maybeConvertMessageTextMentionsV2ToV1")(D[F]);if(h==null)throw c("err")("consumerMessage has no messageText");b=((b=h.commands)==null?void 0:b.some(function(a){return a.commandType===d("WACommon.pb").COMMAND_COMMAND_TYPE.AI}))===!0;if(b&&!d("WAGlobals").getConfig().isMetaAiInvocationMessageRenderEnabled())return H("metaAiMessage");if(w(g))return H("noteMention");if(h.text==null)throw c("err")("consumerMessage has no messageText");return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:h.text,mentionedJids:h.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean),commands:h.commands},quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m},e,{specialTextSize:E,ebTimestampMs:k}),unstoredMedia:null,unstoredQuotedMedia:null};case"reactionMessage":return{unstoredMsg:n(a,e,D[F]),unstoredMedia:null,unstoredQuotedMedia:null};case"imageMessage":b=p(D,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.IMAGE,quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,mediaId:b.plaintextHash},e,{ebTimestampMs:k}),unstoredMedia:b,unstoredQuotedMedia:null};case"videoMessage":var j,l,o,t;h=D[F];if(h==null)throw c("err")("consumerMessage has no videoMessage");b=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").VideoTransportSpec,h==null||(j=h.video)==null?void 0:j.payload);var A=b==null||(l=b.integral)==null||(l=l.transport)==null||(l=l.ancillary)==null?void 0:l.mimetype;A=(b==null||(o=b.ancillary)==null?void 0:o.gifPlayback)===!0&&A==="image/gif";if(A&&!d("WAGlobals").getConfig().isGifEnabled())return G;b=d("WAParseMediaTransportProtocol").parseVideoMsg(b,e.ts,A);if(b==null)throw c("err")("consumerMessage has no video media info");if(v(g)&&((t=h.caption)==null?void 0:t.text)!=null){return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.TEXT,msgContent:{content:(t=h.caption)==null?void 0:t.text,mentionedJids:h.caption.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean)},quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m},e,{specialTextSize:E,ebTimestampMs:k}),unstoredMedia:null,unstoredQuotedMedia:null}}return{unstoredMsg:A?babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.GIF},e,{quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,reportingMeta:B,mediaId:b.plaintextHash}):babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.VIDEO},e,{quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,mediaId:b.plaintextHash}),unstoredMedia:b,unstoredQuotedMedia:null};case"audioMessage":t=q(D,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.PTT,quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,mediaId:t.plaintextHash},e,{ebTimestampMs:k}),unstoredMedia:t,unstoredQuotedMedia:null};case"stickerMessage":if(d("WAGlobals").getConfig().isStickerEnabled()){h=r(D);A=d("WAParseMediaTransportProtocol").parseStickerMsg(h,e.ts);b=((b=h.integral)==null?void 0:b.receiverFetchId)!=null||((t=h.ancillary)==null?void 0:t.receiverFetchId)!=null;t=d("WAGlobals").getConfig().isStickerReceiverFetchEnabled();if(A==null){if(b){if(t){b=d("WAParseMediaTransportProtocol").parseStickerReceiverFetchInfo(h);if(b==null)throw c("err")("consumerMessage has no sticker receiver fetch info");return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.RECEIVER_FETCH,quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,reportingMeta:B},e,{ebTimestampMs:k}),unstoredMedia:null,unstoredQuotedMedia:null,unstoredReceiverFetchInfo:b}}return H("stickerReceiverFetchMessage")}throw c("err")("consumerMessage has no sticker media info")}return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.STICKER,quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,reportingMeta:B,mediaId:A.plaintextHash},e,{ebTimestampMs:k}),unstoredMedia:A,unstoredQuotedMedia:null}}return G;case"documentMessage":if(d("WAGlobals").getConfig().isDocumentReceiveEnabled()){t=s(D,e.ts);return{unstoredMsg:babelHelpers["extends"]({type:d("WAMsgType").MSG_TYPE.DOCUMENT_FILE,quote:C,expirationTs:x,deleteTs:y,ephemeralSetting:z,isForwarded:m,reportingMeta:B,mediaId:t.plaintextHash},e,{ebTimestampMs:k}),unstoredMedia:t,unstoredQuotedMedia:null}}return G;case"groupInviteMessage":return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null,unstoredIncomingGroupInvite:u(e,D)};case"editMessage":var I;h=D[F];b=h==null?void 0:h.message;A=b==null?void 0:b.text;t=h==null||(I=h.key)==null?void 0:I.id;if(h==null||b==null||A==null)throw c("err")("consumerMessage with editMessage type has no editMessage");if(t==null)throw c("err")("consumerMessage with editMessage type has no original Msg External Id.");h=d("WAStanzaUtils").toStanzaId(t);return{unstoredEditMsg:{type:d("WAMsgType").MSG_TYPE.EDIT_ACTION,editMsgContent:{content:A,mentionedJids:b.mentionedJid.map(d("WAJids").validateUserJid).filter(Boolean),commands:b.commands},originalMsgExternalId:h,id:e.id,ts:e.ts,sentTs:e.sentTs,serverTs:e.serverTs,ack:e.ack,reportingMeta:B,specialTextSize:E},unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null};case"pollCreationMessage":return c("WAParseConsumerMessagePollCreation")(f,e,B,D[F]);case"pollUpdateMessage":return c("WAParseConsumerMessagePollUpdate")(f,e,B,D[F]);case"contactMessage":case"locationMessage":case"extendedTextMessage":case"statusTextMessage":case"contactsArrayMessage":case"liveLocationMessage":case"viewOnceMessage":default:return G}}catch(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["parseConsumerMessageProtocol error :",""])),a);return{unstoredMsg:null,unstoredMedia:null,unstoredQuotedMedia:null}}}();return babelHelpers["extends"]({},l,{contentTypeForLogging:F})}function k(a){if(d("WAJids").isAuthorSystem(a))throw c("err")("Got system author");return a}var l=30;function m(a){if(a==null)return d("WAResultOrError").makeResult(null);return a.length>l?d("WAResultOrError").makeError("invalid-reaction-text-length"):d("WAResultOrError").makeResult(a)}function n(a,b,e){if(e==null)throw c("err")("consumerMessage has no reactionMessage");var f=k(b.id.author);a=d("WAMessageKey").extractProtocolMessageId(a,f,e.key);f=e.text;var g=e.groupingKey;e=e.senderTimestampMs;var h=m(f);if(!h.success)throw c("err")('"'+(f!=null?f:"")+'" is not a valid reaction ['+h.error+"]");return{type:d("WAMsgType").MSG_TYPE.REACTION,ack:b.ack,id:b.id,reactToExternalId:a.externalId,reactToAuthor:a.author,reaction:h.value,groupingKey:g,ts:b.ts,senderTimestampMs:e}}function o(a){var b,e,f,g=a==null||(b=a.quotedMessage)==null?void 0:b.stanzaId,h=a==null||(e=a.quotedMessage)==null?void 0:e.participant;a=a==null||(f=a.quotedMessage)==null?void 0:f.remoteJid;h=h!=null?d("WAJids").interpretAndValidateJid(h):null;var i;(h==null?void 0:h.jidType)==="msgrUser"&&h.userJid===d("WAGlobals").getMyUserJid()?i=d("WAJids").AUTHOR_ME:(h==null?void 0:h.jidType)==="msgrUser"?i=h.userJid:i=d("WAJids").AUTHOR_ME;if(g==null)return null;h={type:d("WAMsgType").MSG_TYPE.UNAVAILABLE,author:i,externalId:d("WAStanzaUtils").toStanzaId(g),ts:null};if(a!=null){i=d("WAJids").interpretAndValidateJid(a);if(i.jidType==="group")return{remoteJid:i.groupJid,content:h};else throw c("err")("not supported")}else return{remoteJid:null,content:h}}function p(a,b){var e;a=a.imageMessage;if(a==null)throw c("err")("consumerMessage has no imageMessage");return d("WAParseMediaTransportProtocol").decodeImageTransport(a==null||(e=a.image)==null?void 0:e.payload,b,"image")}function q(a,b){var e;a=a.audioMessage;if(a==null)throw c("err")("consumerMessage has no audioMessage");var f=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").AudioTransportSpec,a==null||(e=a.audio)==null?void 0:e.payload);f=d("WAParseMediaTransportProtocol").parseAudioMsg(f,(a==null?void 0:a.ptt)||!1,b);if(f==null)throw c("err")("consumerMessage has no audio media info");return f}function r(a){var b;a=a.stickerMessage;if(a==null)throw c("err")("consumerMessage has no stickerMessage");return d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").StickerTransportSpec,a==null||(b=a.sticker)==null?void 0:b.payload)}function s(a,b){var e;a=a.documentMessage;if(a==null)throw c("err")("consumerMessage has no documentMessage");var f=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").DocumentTransportSpec,a==null||(e=a.document)==null?void 0:e.payload);a=a==null?void 0:a.fileName;f=d("WAParseMediaTransportProtocol").parseDocumentMsg(f,a,b);if(f==null)throw c("err")("consumerMessage has no document media info");return f}function t(a){var b=Object.keys(a).filter(function(a){return a!=="$$unknownFieldCount"});if(b.length!==1)throw c("err")(JSON.stringify(a)+" consumerMessage payload content should have exactly one field, instead found "+JSON.stringify(b));return b[0]}function u(a,b){b=b.groupInviteMessage;if(b==null)throw c("err")("consumerMessage has no GroupInvite Data");return babelHelpers["extends"]({ack:a.ack,author:a.id.author,externalId:a.id.externalId,ts:a.ts},b)}function v(a){var b;a=c("WAParseReadOnlyMetadataDataclassToUnsafeObject")(a);return(a==null||(b=a.power_up)==null?void 0:b.power_up_style)!=null}function w(a){var b;a=c("WAParseReadOnlyMetadataDataclassToUnsafeObject")(a);return(a==null||(b=a.note_metadata)==null?void 0:b.message_type)==="MENTION"}g.MINIMAL_MEDIA_DURATION=b;g.DEFAULT_FILE_SIZE=e;g.SUPPORTED_TYPES_VERSION=f;g.parseConsumerMessageProtocol=a;g.interpretAsNonSystemAuthor=k;g.validReactionMessageText=m;g.parseReactionMessage=n;g.parsedQuotedConsumerMessage=o;g.parseOneOfContentType=t}),98);
__d("WAParseMediaTransportProtocol",["WAHashUtils","WALogger","WALongInt","WAMedia","WAMediaHdType","WAMediaTransport.pb","WAMediaUtils","WAMsgMap","WAParseConsumerMessageProtocol","WAProgressiveJpegGetScanLengths","WATimeUtils","decodeProtobuf","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,c,e){var f,g,k;if(!((f=a.integral)!=null&&f.transport))return null;f=(f=a.integral)==null?void 0:f.transport;if(d("decodeProtobuf").getUnknownFields(f.integral)!=null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["There is unknown fileds in integral of VideoTransport"])));return null}g=(g=f.integral)==null?void 0:g.fileSha256;if(!g){c||d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["protobuf msg with no plaintext hash"])));return null}c=null;if(((k=a.ancillary)==null?void 0:k.scansSidecar)!=null&&((k=a.ancillary)==null?void 0:k.scanLengths)!=null){c={sidecar:(k=a.ancillary)==null?void 0:k.scansSidecar,scanLengths:(k=a.ancillary)==null||(k=k.scanLengths)==null?void 0:k.map(d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength)}}if(((a=f.integral)==null?void 0:a.fileSha256)==null||((k=f.integral)==null?void 0:k.fileEncSha256)==null||((a=f.integral)==null?void 0:a.mediaKey)==null||((k=f.integral)==null?void 0:k.directPath)==null||((a=f.integral)==null?void 0:a.mediaKeyTimestamp)==null||((k=f.ancillary)==null?void 0:k.objectId)==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["cannot compose mediaEntry with the media message"])));return null}k=(a=f.ancillary)==null?void 0:a.fileLength;a=(a=f.ancillary.thumbnail)==null?void 0:a.downloadableThumbnail;f=d("WAMediaUtils").rawDataToMediaEntry({fileSha256:f.integral.fileSha256,fileEncSha256:f.integral.fileEncSha256,mediaKey:f.integral.mediaKey,directPath:f.integral.directPath,mediaKeyTimestamp:d("WATimeUtils").castLongIntToUnixTime(f.integral.mediaKeyTimestamp),serverMediaType:b,objectId:(b=f.ancillary)==null?void 0:b.objectId,fbid:void 0,downloadableThumbnail:{directPath:a==null?void 0:a.directPath,fileEncSha256:a==null?void 0:a.fileEncSha256,fileSha256:a==null?void 0:a.fileSha256,mediaKey:a==null?void 0:a.mediaKey,mediaKeyTimestamp:(a==null?void 0:a.mediaKeyTimestamp)==null?null:d("WATimeUtils").castLongIntToUnixTime(a==null?void 0:a.mediaKeyTimestamp),objectId:a==null?void 0:a.objectId},filename:e,progressiveJpegDetails:c,size:k==null?k:d("WALongInt").numberOrThrowIfTooLarge(k)});return{size:k==null?d("WAParseConsumerMessageProtocol").DEFAULT_FILE_SIZE:d("WALongInt").numberOrThrowIfTooLarge(k),plaintextHash:d("WAHashUtils").toPlaintextHash(new Uint8Array(g)),mediaEntry:f}}function l(a){switch(a){case d("WAMediaTransport.pb").IMAGE_TRANSPORT_ANCILLARY_HD_TYPE.NONE:return d("WAMediaHdType").HD_TYPE_NONE;case d("WAMediaTransport.pb").IMAGE_TRANSPORT_ANCILLARY_HD_TYPE.LQ_4K:return d("WAMediaHdType").HD_TYPE_LQ_4K;case d("WAMediaTransport.pb").IMAGE_TRANSPORT_ANCILLARY_HD_TYPE.HQ_4K:return d("WAMediaHdType").HD_TYPE_HQ_4K;default:a;return d("WAMediaHdType").HD_TYPE_NONE}}function m(a,b,c){var e;c=k(a,c,!1);if(!c)return null;c=p(c,b);b=(b=a.ancillary)==null?void 0:b.width;e=(e=a.ancillary)==null?void 0:e.height;a.ancillary!=null&&(a.ancillary.width!=null&&a.ancillary.width===4294967295&&(b=void 0),a.ancillary.height!=null&&a.ancillary.height===4294967295&&(e=void 0));b=babelHelpers["extends"]({},c,{mediaType:d("WAMedia").MEDIA_TYPE.IMAGE,validatedVideoInfo:null,validatedImageInfo:{width:b,height:e,jpegThumbnail:(c=a.integral)==null||(c=c.transport)==null||(c=c.ancillary)==null||(c=c.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null||(b=b.transport)==null||(b=b.ancillary)==null||(b=b.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(e=a.integral)==null||(e=e.transport)==null||(e=e.ancillary)==null||(e=e.thumbnail)==null?void 0:e.thumbnailWidth,hdType:l((c=a.ancillary)==null?void 0:c.hdType)},validatedAudioInfo:null,validatedDocumentFileInfo:null});return b}function a(a,b,e){a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,a);a=m(a,b,e);if(a==null)throw c("err")("consumerMessage has no image media info");return a}function b(a,b,c){var e,f,g,h,i,j,l;if(!((e=a.integral)!=null&&e.transport))return null;e=k(a,c?"gif":"video",!1);if(!e)return null;e=p(e,b);c=babelHelpers["extends"]({},e,{accessibilitySummaryText:(b=a.ancillary)==null?void 0:b.accessibilityLabel,mediaType:c?d("WAMedia").MEDIA_TYPE.GIF:d("WAMedia").MEDIA_TYPE.VIDEO,validatedVideoInfo:c?null:{duration:(a==null||(f=a.ancillary)==null?void 0:f.seconds)!=null&&(a==null||(g=a.ancillary)==null?void 0:g.seconds)>d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION?a==null||(h=a.ancillary)==null?void 0:h.seconds:d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION,width:a==null||(i=a.ancillary)==null?void 0:i.width,height:a==null||(j=a.ancillary)==null?void 0:j.height,mimetype:a==null||(l=a.integral)==null||(l=l.transport)==null||(l=l.ancillary)==null?void 0:l.mimetype,jpegThumbnail:(e=a.integral)==null||(e=e.transport)==null||(e=e.ancillary)==null||(e=e.thumbnail)==null?void 0:e.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null||(b=b.transport)==null||(b=b.ancillary)==null||(b=b.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(e=a.integral)==null||(e=e.transport)==null||(e=e.ancillary)==null||(e=e.thumbnail)==null?void 0:e.thumbnailWidth},validatedImageInfo:c?{width:(b=a.ancillary)==null?void 0:b.width,height:(e=a.ancillary)==null?void 0:e.height,jpegThumbnail:(c=a.integral)==null||(c=c.transport)==null||(c=c.ancillary)==null||(c=c.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null||(b=b.transport)==null||(b=b.ancillary)==null||(b=b.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(e=a.integral)==null||(e=e.transport)==null||(e=e.ancillary)==null||(e=e.thumbnail)==null?void 0:e.thumbnailWidth}:null,validatedAudioInfo:null,validatedDocumentFileInfo:null});return c}function e(a,b,c){var e,f,g,h;if(!((b=a.integral)!=null&&b.transport))return null;b=k(a,"ptt",!1);if(!b)return null;b=p(b,c);c=babelHelpers["extends"]({},b,{mediaType:d("WAMedia").MEDIA_TYPE.PTT,validatedVideoInfo:null,validatedImageInfo:null,validatedDocumentFileInfo:null,validatedAudioInfo:{duration:(a==null||(e=a.ancillary)==null?void 0:e.seconds)!=null&&(a==null||(f=a.ancillary)==null?void 0:f.seconds)>d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION?a==null||(g=a.ancillary)==null?void 0:g.seconds:d("WAParseConsumerMessageProtocol").MINIMAL_MEDIA_DURATION,mimetype:a==null||(h=a.integral)==null||(h=h.transport)==null||(h=h.ancillary)==null?void 0:h.mimetype,played:!1}});return c}function f(a,b){var c;if(!((c=a.integral)!=null&&c.transport))return null;c=((c=a.integral)==null?void 0:c.receiverFetchId)!=null;c=k(a,"sticker",c);if(!c)return null;c=p(c,b);b=babelHelpers["extends"]({},c,{accessibilitySummaryText:(b=a.ancillary)==null?void 0:b.accessibilityLabel,mediaType:d("WAMedia").MEDIA_TYPE.STICKER,validatedVideoInfo:null,validatedImageInfo:{width:(c=a.ancillary)==null?void 0:c.width,height:(b=a.ancillary)==null?void 0:b.height,jpegThumbnail:(c=a.integral)==null||(c=c.transport)==null||(c=c.ancillary)==null||(c=c.thumbnail)==null?void 0:c.jpegThumbnail,jpegThumbnailHeight:(b=a.integral)==null||(b=b.transport)==null||(b=b.ancillary)==null||(b=b.thumbnail)==null?void 0:b.thumbnailHeight,jpegThumbnailWidth:(c=a.integral)==null||(c=c.transport)==null||(c=c.ancillary)==null||(c=c.thumbnail)==null?void 0:c.thumbnailWidth},validatedAudioInfo:null,validatedDocumentFileInfo:null});return b}function n(a){var b,c,d,e;if(!((b=a.integral)!=null&&b.transport))return null;b=(b=a.ancillary)==null?void 0:b.width;c=(c=a.ancillary)==null?void 0:c.height;d=(d=(d=a.integral)==null?void 0:d.receiverFetchId)!=null?d:(d=a.ancillary)==null?void 0:d.receiverFetchId;a=a==null||(e=a.integral)==null||(e=e.transport)==null||(e=e.ancillary)==null?void 0:e.mimetype;if(b==null||c==null||d==null||a==null)return null;d={receiverFetchId:d,previewWidth:b,previewHeight:c,mimetype:a,type:"sticker"};return d}function o(a,b,c){var e,f;if(!((e=a.integral)!=null&&e.transport))return null;e=k(a,"document",!1,b);if(!e)return null;e=p(e,c);return babelHelpers["extends"]({},e,{mediaType:d("WAMedia").MEDIA_TYPE.DOCUMENT_FILE,validatedVideoInfo:null,validatedImageInfo:null,validatedAudioInfo:null,validatedDocumentFileInfo:{mimetype:a==null||(f=a.integral)==null||(f=f.transport)==null||(f=f.ancillary)==null?void 0:f.mimetype,filename:b!=null?b:void 0}})}function p(a,b){return{mediaEntry:a.mediaEntry,plaintextHash:a.plaintextHash,size:a.size,msgIds:[],mediaEntries:new(d("WAMsgMap").MsgMap)(),ts:b}}g.getMediaMeta=k;g.decodeImageTransport=a;g.parseVideoMsg=b;g.parseAudioMsg=e;g.parseStickerMsg=f;g.parseStickerReceiverFetchInfo=n;g.parseDocumentMsg=o}),98);/*FB_PKG_DELIM*/
__d("TCompactProtocol",["StringToUtf8","ThriftTypes","Utf8ToString"],(function(a,b,c,d,e,f,g){var h,i=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),j=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:i.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:i.CT_BOOLEAN_FALSE}),k=[i.CT_STOP,0,i.CT_BOOLEAN_TRUE,i.CT_BYTE,i.CT_DOUBLE,0,i.CT_I16,0,i.CT_I32,0,i.CT_I64,i.CT_BINARY,i.CT_STRUCT,i.CT_MAP,i.CT_SET,i.CT_LIST,0,0,0,i.CT_FLOAT],l=Math.pow(2,7)-1,m=-1*Math.pow(2,7),n=Math.pow(2,15)-1,o=-1*Math.pow(2,15),p=Math.pow(2,31)-1,q=-1*Math.pow(2,31),r=Math.pow(2,32)-1,s=BigInt("9223372036854775807"),t=BigInt("-9223372036854775808"),u=BigInt("18446744073709551615"),v=BigInt(63),w=BigInt(1),x=BigInt(7),y=BigInt("0x7f"),z=BigInt("0x80"),A=Math.pow(2,4);a=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var b=a.prototype;b.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};b.readStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};b.writeStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeFieldBegin=function(a){if(a.ftype===(h||(h=c("ThriftTypes"))).BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,j.NONE)};b.writeListBegin=function(a){return this.$8(a)};b.writeListEnd=function(){return 0};b.writeSetBegin=function(a){return this.$8(a)};b.writeSetEnd=function(){return 0};b.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};b.writeMapEnd=function(){return 0};b.$7=function(a,b){var c=0;b=b===j.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=A-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};b.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=A-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};b.readFieldBegin=function(){var a=this.$1.readByte(),b=a&15;if(b===(h||(h=c("ThriftTypes"))).STOP)return{ftype:(h||(h=c("ThriftTypes"))).STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(b);(b===i.CT_BOOLEAN_TRUE||b===i.CT_BOOLEAN_FALSE)&&(this.$5=b===i.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};b.readListBegin=function(){return this.$11()};b.readListEnd=function(){return 0};b.readSetBegin=function(){return this.$11()};b.readSetEnd=function(){return 0};b.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};b.readMapEnd=function(){return 0};b.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};b.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};b.readFieldEnd=function(){return 0};b.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};b.writeByte=function(a){if(a<m||a>l)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};b.readFloat=function(){return this.$1.readFloatBE()};b.writeFloat=function(a){return this.$1.writeFloatBE(a)};b.readDouble=function(){return this.$1.readDoubleBE()};b.writeDouble=function(a){return this.$1.writeDoubleBE(a)};b.writeString=function(a){return this.writeBinary(d("StringToUtf8").StringToUtf8(a))};b.skip=function(a){switch(a){case(h||(h=c("ThriftTypes"))).STOP:return;case(h||(h=c("ThriftTypes"))).BOOL:this.readBool();break;case(h||(h=c("ThriftTypes"))).BYTE:this.readByte();break;case(h||(h=c("ThriftTypes"))).DOUBLE:this.readDouble();break;case(h||(h=c("ThriftTypes"))).I16:this.readI16();break;case(h||(h=c("ThriftTypes"))).I32:this.readI32();break;case(h||(h=c("ThriftTypes"))).I64:this.readI64();break;case(h||(h=c("ThriftTypes"))).STRING:this.readString();break;case(h||(h=c("ThriftTypes"))).STRUCT:this.readStructBegin();var b;while(!0){b=this.readFieldBegin();if(b.ftype===(h||(h=c("ThriftTypes"))).STOP)break;this.skip(b.ftype)}this.readStructEnd();break;case(h||(h=c("ThriftTypes"))).MAP:b=this.readMapBegin();if(b.size>0&&b.ktype!=null&&b.vtype!=null){var d=b.ktype,e=b.vtype;for(var f=0;f<b.size;f++)this.skip(d),this.skip(e)}break;case(h||(h=c("ThriftTypes"))).SET:case(h||(h=c("ThriftTypes"))).LIST:f=this.$11();for(d=0;d<f.size;d++)this.skip(f.etype);break;case(h||(h=c("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};b.toByteArray=function(){return this.$1.toByteArray()};b.writeFieldEnd=function(){return 0};b.writeFieldStop=function(){return this.$1.writeByte((h||(h=c("ThriftTypes"))).STOP)};b.writeI16=function(a){if(a<o||a>n)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<o||a>n)throw new Error("read invalid i16: "+a);return a};b.writeI32=function(a){if(a<q||a>p)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI32=function(){return this.zigzagToI32(this.readVarint32())};b.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};b.readI64=function(){return this.zigzagToI64(this.readVarint64())};b.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===i.CT_BOOLEAN_TRUE;return a};b.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?j.CT_BOOLEAN_TRUE:j.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?i.CT_BOOLEAN_TRUE:i.CT_BOOLEAN_FALSE);return b};b.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};b.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};b.i32ToZigzag=function(a){if(a<q||a>p)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};b.zigzagToI32=function(a){if(a<0||a>r)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};b.i64ToZigzag=function(a){if(a>s||a<t)throw new Error("i64 out of range: "+a.toString());return a>>v^a<<w};b.zigzagToI64=function(a){if(a<0||a>u)throw new Error("invalid uint64: "+a.toString());return(a&w)===w?~(a>>w):a>>w};b.writeVarint32=function(a){if(a<0||a>r)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};b.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};b.writeVarint64=function(a){if(a<0||a>u)throw new Error("invalid uint64: "+a.toString());a=a;var b=0;while(!0)if(a>>x==0){this.$1.writeByte(Number(a));b++;break}else this.$1.writeByte(Number(a&y|z)),b++,a>>=x;return b};b.readVarint64=function(){var a=BigInt(0),b=BigInt(0),c;while(!0){c=BigInt(this.$1.readByte());a|=(c&y)<<b;b+=x;if((c&z)==0){if(b==70&&c!==w)throw new Error("result exceeded 64 bit limit");break}if(b>63)throw new Error("result exceeded 64 bit limit")}return a};b.readString=function(){return d("Utf8ToString").Utf8ToString(this.readBinary())};b.getLastFieldId=function(){return this.$3};b.getLastField=function(){return this.$2};b.getBooleanFieldInfo=function(){return this.$4};b.getBooleanValue=function(){return this.$5};b.$9=function(a){return k[a]};b.$10=function(a){switch(a){case i.CT_STOP:return(h||(h=c("ThriftTypes"))).STOP;case i.CT_BOOLEAN_FALSE:case i.CT_BOOLEAN_TRUE:return(h||(h=c("ThriftTypes"))).BOOL;case i.CT_BYTE:return(h||(h=c("ThriftTypes"))).BYTE;case i.CT_I16:return(h||(h=c("ThriftTypes"))).I16;case i.CT_I32:return(h||(h=c("ThriftTypes"))).I32;case i.CT_I64:return(h||(h=c("ThriftTypes"))).I64;case i.CT_DOUBLE:return(h||(h=c("ThriftTypes"))).DOUBLE;case i.CT_FLOAT:return(h||(h=c("ThriftTypes"))).FLOAT;case i.CT_BINARY:return(h||(h=c("ThriftTypes"))).STRING;case i.CT_LIST:return(h||(h=c("ThriftTypes"))).LIST;case i.CT_SET:return(h||(h=c("ThriftTypes"))).SET;case i.CT_MAP:return(h||(h=c("ThriftTypes"))).MAP;case i.CT_STRUCT:return(h||(h=c("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}};return a}();g["default"]=a}),98);
__d("CompactSerializer",["TCompactProtocol","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(a,b,c,d,e,f,g){function a(a,b,c){try{return h(a,b)}catch(a){c!=null&&c(a)}return null}function h(a,b){a=new(c("TReadBuffer"))(a);a=new(c("TCompactProtocol"))(a);return b(a)}function b(a,b,c,d){c===void 0&&(c=!1);try{return i(a,b,c)}catch(a){d!=null&&d(a)}return null}function i(a,b,d){d===void 0&&(d=!1);if(d){d=new(c("TNoOpWriteBuffer"))();var e=new(c("TCompactProtocol"))(d);b(a,e);e=new(c("TWriteBuffer"))(d.currentSize())}else e=new(c("TWriteBuffer"))();d=new(c("TCompactProtocol"))(e);b(a,d);return d.toByteArray()}g.deserializeNoThrow=a;g.deserialize=h;g.serializeNoThrow=b;g.serialize=i}),98);
__d("MultiwaySharedTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({UNKNOWN:0,SFU:1,P2P:2});d=a({UNKNOWN:0,IGVIDEOCALL:9,ROOM:15,CRUCIBLE:20,MBS_WA:21,BOT:22,HORIZON:23,ULLC:24});f=a({OFFER:0,PRANSWER:1,ANSWER:2,PROFFER:3});b=a({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4});var g=a({E2EE_NOT_MANDATED:0,DEPRECATED_NO_REQUIREMENT:1,E2EE_MANDATED:2}),h=a({NOT_SET:0,CONTROL:1,TEST:2}),i=a({NOT_SET:0,CONTROL:1,TEST:2}),j=a({NotPaused:0,Paused:1}),k=a({AUDIO:0,VIDEO:1,DATA:2}),l=a({UNKNOWN:0,COMPOSITING_SERVICE:1,MEDIA_SERVER:2,CATHODE_AMBISONIC:3,CATHODE_CAPTIONS:4,CATHODE_MEETING_SUMMARIZER:5,CATHODE_REALTIME_SHARED_STATE:6,RP_GENAI_SERVICE:7,SMART_GLASSES_ASSISTANT:8}),m=a({CNAME:0,TRACK:1,DOMINANT_SPEAKER:2}),n=a({UNKNOWN:0,DEFAULT:1,SCREEN_SHARE:2}),o=a({UNSPECIFIED:0,FNA:1,FNA_PREFERRED:2}),p=a({NONE:0,EXTENSION_SELF_PARTICIPANT:1});a=a({IntValue:"intValue",StringValue:"stringValue"});e.exports={ConferenceType:d,CustomMediaRoutingType:p,E2eeInfraMandatedExpStatus:h,E2eeMode:g,EdgerayType:o,EndpointServiceType:l,MediaPath:c,MediaPauseStatus:j,MediaType:k,P2PSFrameExpStatus:i,QuickExperimentValue$Types:a,RenderedStreamType:n,SdpType:f,SubscriptionType:m,VideoQuality:b}}),null);
__d("WebrtcSignalingCommonTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({DEFAULT_AUDIO:0,DEFAULT_VIDEO:1,SCREEN_AUDIO:2,SCREEN_VIDEO:3,CUSTOM_VIDEO:4,CUSTOM_AUDIO:5});d=a({OLD_CLIENT_PLATFORM_STACK:0,RSYS_X:1,IG_OLD_STACK:2,MLITE_OLD_STACK:3,SCOTCH:4,ZENON:5});f=a({NONE:0,AVATAR:1,AUGMENTED_CALLING:2,SCENE_COMPOSITION:3,STEREO_VIDEO:4,SHARED_STATE:5,CODEC_AVATAR_2D:6});b=a({NONE:0,AMBISONIC:1,CONVERSATION_BOT:2,MONOMIX:3});e.exports={ClientStack:d,CustomAudioContentType:b,CustomVideoContentType:f,TrackLabel:c}}),null);
__d("MultiwaySharedSerializers",["MultiwaySharedTypes","ThriftTypes","WebrtcSignalingCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{cluster:"",nonce:""}}function b(){return{cluster:"",conferenceName:"",nonce:"",userId:"",clientSessionId:""}}function e(){return{userId:"",deviceId:"",appId:"",appVersion:"",appBuildNumber:""}}function f(){return{mode:d("MultiwaySharedTypes").E2eeMode.cast(0),preventSfuMode:!1,infraMandatedExpStatus:d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(0),p2pSFrameExpStatus:d("MultiwaySharedTypes").P2PSFrameExpStatus.cast(0)}}function i(){return{semantics:"",ssrcs:[]}}function j(){return{type:d("MultiwaySharedTypes").MediaType.cast(0),id:"",ssrcs:[],enabled:!1,customVideoContentType:d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0),customAudioContentType:d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0)}}function k(){return{parameters:{},conditionFbid:"0",exposureHasBeenLogged:!1,canExposureLog:!1,universeShortName:"",userFbid:"0",unitId:""}}function l(){return{experiments:{},userFbid:"0"}}function m(){return{conditionFbid:"0",userFbid:"0",universeName:"",unitId:""}}function n(){return{enabled:!1,customVideoContentType:d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0),customAudioContentType:d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0)}}function o(){return{tracks:{}}}function p(){return{videoQuality:d("MultiwaySharedTypes").VideoQuality.cast(0)}}function q(){return{cname:"",type:d("MultiwaySharedTypes").SubscriptionType.cast(0)}}function r(){return{restrictiveLogging:!0,verboseLogging:!1}}function s(){return{userId:"",streamId:"",streamType:0,renderWidth:0,renderHeight:0}}function t(){return{}}function u(){return{}}function v(){return{}}function w(){return{host:Uint8Array.of(),port:0}}function x(){return{}}function y(a,b){b.writeStructBegin("ServerInfo");b.writeFieldBegin({fname:"cluster",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.cluster!=null)b.writeString(a.cluster);else{var d="";b.writeString(d)}b.writeFieldEnd();a.conferenceName_deprecated!=null&&(b.writeFieldBegin({fname:"conferenceName_deprecated",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.conferenceName_deprecated),b.writeFieldEnd());b.writeFieldBegin({fname:"nonce",ftype:h.STRING,fid:3});if(a.nonce!=null)b.writeString(a.nonce);else{d="";b.writeString(d)}b.writeFieldEnd();a.conferenceId!=null&&(b.writeFieldBegin({fname:"conferenceId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:4}),b.writeI64(BigInt(a.conferenceId)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function z(a,b){b.writeStructBegin("ClientSessionInfo");b.writeFieldBegin({fname:"cluster",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.cluster!=null)b.writeString(a.cluster);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"conferenceName",ftype:h.STRING,fid:2});if(a.conferenceName!=null)b.writeString(a.conferenceName);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"nonce",ftype:h.STRING,fid:3});if(a.nonce!=null)b.writeString(a.nonce);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"userId",ftype:h.STRING,fid:4});if(a.userId!=null)b.writeString(a.userId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"clientSessionId",ftype:h.STRING,fid:5});if(a.clientSessionId!=null)b.writeString(a.clientSessionId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function A(a,b){b.writeStructBegin("Endpoint");b.writeFieldBegin({fname:"userId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.userId!=null)b.writeString(a.userId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"deviceId",ftype:h.STRING,fid:2});if(a.deviceId!=null)b.writeString(a.deviceId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"appId",ftype:h.STRING,fid:3});if(a.appId!=null)b.writeString(a.appId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"appVersion",ftype:h.STRING,fid:4});if(a.appVersion!=null)b.writeString(a.appVersion);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"appBuildNumber",ftype:h.STRING,fid:5});if(a.appBuildNumber!=null)b.writeString(a.appBuildNumber);else{d="";b.writeString(d)}b.writeFieldEnd();a.clientStackInfo!=null&&(b.writeFieldBegin({fname:"clientStackInfo",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.clientStackInfo),b.writeFieldEnd());a.familyDeviceId!=null&&(b.writeFieldBegin({fname:"familyDeviceId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.familyDeviceId),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function B(a,b){b.writeStructBegin("E2eeEnforcement");b.writeFieldBegin({fname:"mode",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.mode!=null){var e;b.writeI32((e=a.mode)!=null?e:0)}else{e=d("MultiwaySharedTypes").E2eeMode.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"preventSfuMode",ftype:h.BOOL,fid:2});if(a.preventSfuMode!=null)b.writeBool(a.preventSfuMode);else{e=!1;b.writeBool(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"infraMandatedExpStatus",ftype:h.I32,fid:3});if(a.infraMandatedExpStatus!=null){b.writeI32((e=a.infraMandatedExpStatus)!=null?e:0)}else{e=d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"p2pSFrameExpStatus",ftype:h.I32,fid:4});if(a.p2pSFrameExpStatus!=null){b.writeI32((e=a.p2pSFrameExpStatus)!=null?e:0)}else{a=d("MultiwaySharedTypes").P2PSFrameExpStatus.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function C(a,b){b.writeStructBegin("SsrcGroup");b.writeFieldBegin({fname:"semantics",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.semantics!=null)b.writeString(a.semantics);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"ssrcs",ftype:h.LIST,fid:2});if(a.ssrcs!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).I64,size:a.ssrcs.length});for(d of a.ssrcs)b.writeI64(BigInt(d));b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).I64,size:a.length});for(d of a)b.writeI64(BigInt(d));b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function D(a,b){b.writeStructBegin("Media");b.writeFieldBegin({fname:"type",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.type!=null){var e;b.writeI32((e=a.type)!=null?e:0)}else{e=d("MultiwaySharedTypes").MediaType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"id",ftype:h.STRING,fid:2});if(a.id!=null)b.writeString(a.id);else{e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"ssrcs",ftype:h.LIST,fid:3});if(a.ssrcs!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).I64,size:a.ssrcs.length});for(e of a.ssrcs)b.writeI64(BigInt(e));b.writeListEnd()}else{e=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).I64,size:e.length});for(e of e)b.writeI64(BigInt(e));b.writeListEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"enabled",ftype:h.BOOL,fid:4});if(a.enabled!=null)b.writeBool(a.enabled);else{e=!1;b.writeBool(e)}b.writeFieldEnd();if(a.pausedDownlink!=null){b.writeFieldBegin({fname:"pausedDownlink",ftype:(h||(h=c("ThriftTypes"))).I32,fid:5});b.writeI32((e=a.pausedDownlink)!=null?e:0);b.writeFieldEnd()}if(a.pausedUplink!=null){b.writeFieldBegin({fname:"pausedUplink",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6});b.writeI32((e=a.pausedUplink)!=null?e:0);b.writeFieldEnd()}a.owner!=null&&(b.writeFieldBegin({fname:"owner",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.owner),b.writeFieldEnd());if(a.label!=null){b.writeFieldBegin({fname:"label",ftype:(h||(h=c("ThriftTypes"))).I32,fid:8});b.writeI32((e=a.label)!=null?e:0);b.writeFieldEnd()}b.writeFieldBegin({fname:"customVideoContentType",ftype:h.I32,fid:9});if(a.customVideoContentType!=null){b.writeI32((e=a.customVideoContentType)!=null?e:0)}else{e=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.name!=null&&(b.writeFieldBegin({fname:"name",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:10}),b.writeString(a.name),b.writeFieldEnd());b.writeFieldBegin({fname:"customAudioContentType",ftype:h.I32,fid:11});if(a.customAudioContentType!=null){b.writeI32((e=a.customAudioContentType)!=null?e:0)}else{a=d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function E(a,b){b.writeStructBegin("QuickExperiment");b.writeFieldBegin({fname:"parameters",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.parameters!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(a.parameters).length});for(var d of Object.entries(a.parameters)){var e=d[0],f=d[1];b.writeString(e);R(f,b)}b.writeMapEnd()}else{e={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(e).length});for(f of Object.entries(e)){d=f[0];e=f[1];b.writeString(d);R(e,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"conditionFbid",ftype:h.I64,fid:2});if(a.conditionFbid!=null)b.writeI64(BigInt(a.conditionFbid));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"exposureHasBeenLogged",ftype:h.BOOL,fid:3});if(a.exposureHasBeenLogged!=null)b.writeBool(a.exposureHasBeenLogged);else{e=!1;b.writeBool(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"canExposureLog",ftype:h.BOOL,fid:4});if(a.canExposureLog!=null)b.writeBool(a.canExposureLog);else{f=!1;b.writeBool(f)}b.writeFieldEnd();b.writeFieldBegin({fname:"universeShortName",ftype:h.STRING,fid:5});if(a.universeShortName!=null)b.writeString(a.universeShortName);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"userFbid",ftype:h.I64,fid:6});if(a.userFbid!=null)b.writeI64(BigInt(a.userFbid));else{e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"unitId",ftype:h.STRING,fid:7});if(a.unitId!=null)b.writeString(a.unitId);else{f="";b.writeString(f)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function F(a,b){b.writeStructBegin("QuickExperimentResult");b.writeFieldBegin({fname:"experiments",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.experiments!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(a.experiments).length});for(var d of Object.entries(a.experiments)){var e=d[0],f=d[1];b.writeString(e);E(f,b)}b.writeMapEnd()}else{e={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(e).length});for(f of Object.entries(e)){d=f[0];e=f[1];b.writeString(d);E(e,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"userFbid",ftype:h.I64,fid:2});if(a.userFbid!=null)b.writeI64(BigInt(a.userFbid));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function G(a,b){b.writeStructBegin("QuickExperimentExposureLoggingEvent");b.writeFieldBegin({fname:"conditionFbid",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.conditionFbid!=null)b.writeI64(BigInt(a.conditionFbid));else{var d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"userFbid",ftype:h.I64,fid:2});if(a.userFbid!=null)b.writeI64(BigInt(a.userFbid));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"universeName",ftype:h.STRING,fid:3});if(a.universeName!=null)b.writeString(a.universeName);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"unitId",ftype:h.STRING,fid:4});if(a.unitId!=null)b.writeString(a.unitId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function H(a,b){b.writeStructBegin("ClientTrackInfo");b.writeFieldBegin({fname:"enabled",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:1});if(a.enabled!=null)b.writeBool(a.enabled);else{var e=!1;b.writeBool(e)}b.writeFieldEnd();if(a.pausedUplink!=null){b.writeFieldBegin({fname:"pausedUplink",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});b.writeI32((e=a.pausedUplink)!=null?e:0);b.writeFieldEnd()}if(a.pausedDownlink!=null){b.writeFieldBegin({fname:"pausedDownlink",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3});b.writeI32((e=a.pausedDownlink)!=null?e:0);b.writeFieldEnd()}a.owner!=null&&(b.writeFieldBegin({fname:"owner",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.owner),b.writeFieldEnd());if(a.label!=null){b.writeFieldBegin({fname:"label",ftype:(h||(h=c("ThriftTypes"))).I32,fid:5});b.writeI32((e=a.label)!=null?e:0);b.writeFieldEnd()}b.writeFieldBegin({fname:"customVideoContentType",ftype:h.I32,fid:6});if(a.customVideoContentType!=null){b.writeI32((e=a.customVideoContentType)!=null?e:0)}else{e=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.name!=null&&(b.writeFieldBegin({fname:"name",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.name),b.writeFieldEnd());b.writeFieldBegin({fname:"customAudioContentType",ftype:h.I32,fid:8});if(a.customAudioContentType!=null){b.writeI32((e=a.customAudioContentType)!=null?e:0)}else{e=d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.nodeId!=null&&(b.writeFieldBegin({fname:"nodeId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:9}),b.writeI64(BigInt(a.nodeId)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function I(a,b){b.writeStructBegin("ClientMediaStatus");b.writeFieldBegin({fname:"tracks",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.tracks!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(a.tracks).length});for(a of Object.entries(a.tracks)){var d=a[0],e=a[1];b.writeString(d);H(e,b)}b.writeMapEnd()}else{d={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(d).length});for(e of Object.entries(d)){a=e[0];d=e[1];b.writeString(a);H(d,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function J(a,b){b.writeStructBegin("SubscriptionOptions");b.writeFieldBegin({fname:"videoQuality",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.videoQuality!=null){var e;b.writeI32((e=a.videoQuality)!=null?e:0)}else{e=d("MultiwaySharedTypes").VideoQuality.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.qualityIndex!=null&&(b.writeFieldBegin({fname:"qualityIndex",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2}),b.writeI32(a.qualityIndex),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function K(a,b){b.writeStructBegin("Subscription");b.writeFieldBegin({fname:"cname",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.cname!=null)b.writeString(a.cname);else{var e="";b.writeString(e)}b.writeFieldEnd();a.options!=null&&(b.writeFieldBegin({fname:"options",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),J(a.options,b),b.writeFieldEnd());b.writeFieldBegin({fname:"type",ftype:h.I32,fid:3});if(a.type!=null){b.writeI32((e=a.type)!=null?e:0)}else{e=d("MultiwaySharedTypes").SubscriptionType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.trackId!=null&&(b.writeFieldBegin({fname:"trackId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.trackId),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function L(a,b){b.writeStructBegin("LoggingOptions");b.writeFieldBegin({fname:"restrictiveLogging",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:1});if(a.restrictiveLogging!=null)b.writeBool(a.restrictiveLogging);else{var d=!0;b.writeBool(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"verboseLogging",ftype:h.BOOL,fid:2});if(a.verboseLogging!=null)b.writeBool(a.verboseLogging);else{d=!1;b.writeBool(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function M(a,b){b.writeStructBegin("ResolutionData");b.writeFieldBegin({fname:"userId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.userId!=null)b.writeString(a.userId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"streamId",ftype:h.STRING,fid:2});if(a.streamId!=null)b.writeString(a.streamId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"streamType",ftype:h.I32,fid:3});if(a.streamType!=null)b.writeI32(a.streamType);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"renderWidth",ftype:h.I32,fid:4});if(a.renderWidth!=null)b.writeI32(a.renderWidth);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"renderHeight",ftype:h.I32,fid:5});if(a.renderHeight!=null)b.writeI32(a.renderHeight);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function N(a,b){b.writeStructBegin("TurnInfo"),a.ipv4!=null&&(b.writeFieldBegin({fname:"ipv4",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeBinary(a.ipv4),b.writeFieldEnd()),a.ipv6!=null&&(b.writeFieldBegin({fname:"ipv6",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.ipv6),b.writeFieldEnd()),a.udpPort!=null&&(b.writeFieldBegin({fname:"udpPort",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3}),b.writeI32(a.udpPort),b.writeFieldEnd()),a.tcpPort!=null&&(b.writeFieldBegin({fname:"tcpPort",ftype:(h||(h=c("ThriftTypes"))).I32,fid:4}),b.writeI32(a.tcpPort),b.writeFieldEnd()),a.sslTcpPort!=null&&(b.writeFieldBegin({fname:"sslTcpPort",ftype:(h||(h=c("ThriftTypes"))).I32,fid:5}),b.writeI32(a.sslTcpPort),b.writeFieldEnd()),a.portInfoIdx!=null&&(b.writeFieldBegin({fname:"portInfoIdx",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6}),b.writeI32(a.portInfoIdx),b.writeFieldEnd()),a.tlsPort!=null&&(b.writeFieldBegin({fname:"tlsPort",ftype:(h||(h=c("ThriftTypes"))).I32,fid:7}),b.writeI32(a.tlsPort),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function O(a,b){b.writeStructBegin("EdgerayInfo");if(a.edgerayType!=null){var d;b.writeFieldBegin({fname:"edgerayType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((d=a.edgerayType)!=null?d:0);b.writeFieldEnd()}a.ipv4!=null&&(b.writeFieldBegin({fname:"ipv4",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.ipv4),b.writeFieldEnd());a.ipv6!=null&&(b.writeFieldBegin({fname:"ipv6",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.ipv6),b.writeFieldEnd());a.token!=null&&(b.writeFieldBegin({fname:"token",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.token),b.writeFieldEnd());a.tokenIdx!=null&&(b.writeFieldBegin({fname:"tokenIdx",ftype:(h||(h=c("ThriftTypes"))).I32,fid:5}),b.writeI32(a.tokenIdx),b.writeFieldEnd());a.secret!=null&&(b.writeFieldBegin({fname:"secret",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeBinary(a.secret),b.writeFieldEnd());a.secretIdx!=null&&(b.writeFieldBegin({fname:"secretIdx",ftype:(h||(h=c("ThriftTypes"))).I32,fid:7}),b.writeI32(a.secretIdx),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function P(a,b){b.writeStructBegin("RelayInfo");if(a.turns!=null){b.writeFieldBegin({fname:"turns",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});b.writeListBegin({etype:h.STRUCT,size:a.turns.length});for(var d of a.turns)N(d,b);b.writeListEnd();b.writeFieldEnd()}if(a.edgerays!=null){b.writeFieldBegin({fname:"edgerays",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.edgerays.length});for(d of a.edgerays)O(d,b);b.writeListEnd();b.writeFieldEnd()}a.turnUsername!=null&&(b.writeFieldBegin({fname:"turnUsername",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.turnUsername),b.writeFieldEnd());a.turnPassword!=null&&(b.writeFieldBegin({fname:"turnPassword",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.turnPassword),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function Q(a,b){b.writeStructBegin("TSocketAddress");b.writeFieldBegin({fname:"host",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.host!=null)b.writeBinary(a.host);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"port",ftype:h.I16,fid:2});if(a.port!=null)b.writeI16(a.port);else{d=0;b.writeI16(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function R(a,b){b.writeStructBegin("QuickExperimentValue");if(a.intValue!=null){b.writeFieldBegin({fname:"intValue",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});b.writeI64(BigInt(a.intValue));b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.stringValue!=null){b.writeFieldBegin({fname:"stringValue",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});b.writeString(a.stringValue);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function S(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.cluster=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.conferenceName_deprecated=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.nonce=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I64?b.conferenceId=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.cluster===void 0&&(b.cluster="");b.nonce===void 0&&(b.nonce="");return b}function T(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.cluster=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.conferenceName=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.nonce=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.userId=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.clientSessionId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.cluster===void 0&&(b.cluster="");b.conferenceName===void 0&&(b.conferenceName="");b.nonce===void 0&&(b.nonce="");b.userId===void 0&&(b.userId="");b.clientSessionId===void 0&&(b.clientSessionId="");return b}function U(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.userId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.deviceId=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.appId=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.appVersion=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.appBuildNumber=a.readString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRING?b.clientStackInfo=a.readString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRING?b.familyDeviceId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.userId===void 0&&(b.userId="");b.deviceId===void 0&&(b.deviceId="");b.appId===void 0&&(b.appId="");b.appVersion===void 0&&(b.appVersion="");b.appBuildNumber===void 0&&(b.appBuildNumber="");return b}function aa(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.mode=d("MultiwaySharedTypes").E2eeMode.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).BOOL?b.preventSfuMode=a.readBool():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.infraMandatedExpStatus=d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.p2pSFrameExpStatus=d("MultiwaySharedTypes").P2PSFrameExpStatus.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.mode===void 0&&(b.mode=d("MultiwaySharedTypes").E2eeMode.cast(0));b.preventSfuMode===void 0&&(b.preventSfuMode=!1);b.infraMandatedExpStatus===void 0&&(b.infraMandatedExpStatus=d("MultiwaySharedTypes").E2eeInfraMandatedExpStatus.cast(0));b.p2pSFrameExpStatus===void 0&&(b.p2pSFrameExpStatus=d("MultiwaySharedTypes").P2PSFrameExpStatus.cast(0));return b}function ba(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.semantics=a.readString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.ssrcs=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();b.ssrcs.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.semantics===void 0&&(b.semantics="");b.ssrcs===void 0&&(b.ssrcs=[]);return b}function ca(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.type=d("MultiwaySharedTypes").MediaType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.id=a.readString():a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).LIST){b.ssrcs=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=a.readI64().toString();b.ssrcs.push(i)}}else a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).BOOL?b.enabled=a.readBool():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.pausedDownlink=d("MultiwaySharedTypes").MediaPauseStatus.cast(a.readI32()):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.pausedUplink=d("MultiwaySharedTypes").MediaPauseStatus.cast(a.readI32()):a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRING?b.owner=a.readString():a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).I32?b.label=d("WebrtcSignalingCommonTypes").TrackLabel.cast(a.readI32()):a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).I32?b.customVideoContentType=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(a.readI32()):a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).STRING?b.name=a.readString():a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).I32?b.customAudioContentType=d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.type===void 0&&(b.type=d("MultiwaySharedTypes").MediaType.cast(0));b.id===void 0&&(b.id="");b.ssrcs===void 0&&(b.ssrcs=[]);b.enabled===void 0&&(b.enabled=!1);b.customVideoContentType===void 0&&(b.customVideoContentType=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0));b.customAudioContentType===void 0&&(b.customAudioContentType=d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0));return b}function V(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).MAP){b.parameters={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readString(),i=$(a);b.parameters[g]=i}}else a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.conditionFbid=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).BOOL?b.exposureHasBeenLogged=a.readBool():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).BOOL?b.canExposureLog=a.readBool():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.universeShortName=a.readString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).I64?b.userFbid=a.readI64().toString():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).STRING?b.unitId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.parameters===void 0&&(b.parameters={});b.conditionFbid===void 0&&(b.conditionFbid="0");b.exposureHasBeenLogged===void 0&&(b.exposureHasBeenLogged=!1);b.canExposureLog===void 0&&(b.canExposureLog=!1);b.universeShortName===void 0&&(b.universeShortName="");b.userFbid===void 0&&(b.userFbid="0");b.unitId===void 0&&(b.unitId="");return b}function da(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).MAP){b.experiments={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readString(),i=V(a);b.experiments[g]=i}}else a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.userFbid=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.experiments===void 0&&(b.experiments={});b.userFbid===void 0&&(b.userFbid="0");return b}function ea(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.conditionFbid=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.userFbid=a.readI64().toString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.universeName=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.unitId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.conditionFbid===void 0&&(b.conditionFbid="0");b.userFbid===void 0&&(b.userFbid="0");b.universeName===void 0&&(b.universeName="");b.unitId===void 0&&(b.unitId="");return b}function W(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).BOOL?b.enabled=a.readBool():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.pausedUplink=d("MultiwaySharedTypes").MediaPauseStatus.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.pausedDownlink=d("MultiwaySharedTypes").MediaPauseStatus.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.owner=a.readString():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.label=d("WebrtcSignalingCommonTypes").TrackLabel.cast(a.readI32()):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.customVideoContentType=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(a.readI32()):a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRING?b.name=a.readString():a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).I32?b.customAudioContentType=d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(a.readI32()):a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).I64?b.nodeId=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.enabled===void 0&&(b.enabled=!1);b.customVideoContentType===void 0&&(b.customVideoContentType=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(0));b.customAudioContentType===void 0&&(b.customAudioContentType=d("WebrtcSignalingCommonTypes").CustomAudioContentType.cast(0));return b}function fa(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).MAP){b.tracks={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readString(),i=W(a);b.tracks[g]=i}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.tracks===void 0&&(b.tracks={});return b}function X(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.videoQuality=d("MultiwaySharedTypes").VideoQuality.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.qualityIndex=a.readI32():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.videoQuality===void 0&&(b.videoQuality=d("MultiwaySharedTypes").VideoQuality.cast(0));return b}function ga(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.cname=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.options=X(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.type=d("MultiwaySharedTypes").SubscriptionType.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.trackId=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.cname===void 0&&(b.cname="");b.type===void 0&&(b.type=d("MultiwaySharedTypes").SubscriptionType.cast(0));return b}function ha(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).BOOL?b.restrictiveLogging=a.readBool():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).BOOL?b.verboseLogging=a.readBool():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.restrictiveLogging===void 0&&(b.restrictiveLogging=!0);b.verboseLogging===void 0&&(b.verboseLogging=!1);return b}function ia(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.userId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.streamId=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.streamType=a.readI32():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I32?b.renderWidth=a.readI32():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).I32?b.renderHeight=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.userId===void 0&&(b.userId="");b.streamId===void 0&&(b.streamId="");b.streamType===void 0&&(b.streamType=0);b.renderWidth===void 0&&(b.renderWidth=0);b.renderHeight===void 0&&(b.renderHeight=0);return b}function Y(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.ipv4=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.ipv6=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.udpPort=a.readI32():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I32?b.tcpPort=a.readI32():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).I32?b.sslTcpPort=a.readI32():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).I32?b.portInfoIdx=a.readI32():a.skip(e);break;case 7:e===(h||(h=c("ThriftTypes"))).I32?b.tlsPort=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Z(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.edgerayType=d("MultiwaySharedTypes").EdgerayType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.ipv4=a.readBinary():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.ipv6=a.readBinary():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.token=a.readBinary():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.tokenIdx=a.readI32():a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRING?b.secret=a.readBinary():a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).I32?b.secretIdx=a.readI32():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function ja(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.turns=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=Y(a);b.turns.push(g)}}else a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.edgerays=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=Z(a);b.edgerays.push(d)}}else a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.turnUsername=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.turnPassword=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function ka(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.host=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I16?b.port=a.readI16():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.host===void 0&&(b.host=Uint8Array.of());b.port===void 0&&(b.port=0);return b}function $(a){var b,d={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).I64)if(b==null)d.intValue=a.readI64().toString(),b="intValue";else throw new Error("more than one field have been deserialized in union type: QuickExperimentValue; current field: intValue, previous deserialized field: "+b);else a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).STRING)if(b==null)d.stringValue=a.readString(),b="stringValue";else throw new Error("more than one field have been deserialized in union type: QuickExperimentValue; current field: stringValue, previous deserialized field: "+b);else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return d}g.ServerInfo$DefaultConstructor=a;g.ClientSessionInfo$DefaultConstructor=b;g.Endpoint$DefaultConstructor=e;g.E2eeEnforcement$DefaultConstructor=f;g.SsrcGroup$DefaultConstructor=i;g.Media$DefaultConstructor=j;g.QuickExperiment$DefaultConstructor=k;g.QuickExperimentResult$DefaultConstructor=l;g.QuickExperimentExposureLoggingEvent$DefaultConstructor=m;g.ClientTrackInfo$DefaultConstructor=n;g.ClientMediaStatus$DefaultConstructor=o;g.SubscriptionOptions$DefaultConstructor=p;g.Subscription$DefaultConstructor=q;g.LoggingOptions$DefaultConstructor=r;g.ResolutionData$DefaultConstructor=s;g.TurnInfo$DefaultConstructor=t;g.EdgerayInfo$DefaultConstructor=u;g.RelayInfo$DefaultConstructor=v;g.TSocketAddress$DefaultConstructor=w;g.QuickExperimentValue$DefaultConstructor=x;g.serializeServerInfo=y;g.serializeClientSessionInfo=z;g.serializeEndpoint=A;g.serializeE2eeEnforcement=B;g.serializeSsrcGroup=C;g.serializeMedia=D;g.serializeQuickExperiment=E;g.serializeQuickExperimentResult=F;g.serializeQuickExperimentExposureLoggingEvent=G;g.serializeClientTrackInfo=H;g.serializeClientMediaStatus=I;g.serializeSubscriptionOptions=J;g.serializeSubscription=K;g.serializeLoggingOptions=L;g.serializeResolutionData=M;g.serializeTurnInfo=N;g.serializeEdgerayInfo=O;g.serializeRelayInfo=P;g.serializeTSocketAddress=Q;g.serializeQuickExperimentValue=R;g.deserializeServerInfo=S;g.deserializeClientSessionInfo=T;g.deserializeEndpoint=U;g.deserializeE2eeEnforcement=aa;g.deserializeSsrcGroup=ba;g.deserializeMedia=ca;g.deserializeQuickExperiment=V;g.deserializeQuickExperimentResult=da;g.deserializeQuickExperimentExposureLoggingEvent=ea;g.deserializeClientTrackInfo=W;g.deserializeClientMediaStatus=fa;g.deserializeSubscriptionOptions=X;g.deserializeSubscription=ga;g.deserializeLoggingOptions=ha;g.deserializeResolutionData=ia;g.deserializeTurnInfo=Y;g.deserializeEdgerayInfo=Z;g.deserializeRelayInfo=ja;g.deserializeTSocketAddress=ka;g.deserializeQuickExperimentValue=$}),98);
__d("WebrtcSignalingCommonSerializers",["ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{topic:"",data:Uint8Array.of()}}function b(a,b){b.writeStructBegin("GenericDataMessage");b.writeFieldBegin({fname:"topic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.topic!=null)b.writeString(a.topic);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"data",ftype:h.STRING,fid:2});if(a.data!=null)b.writeBinary(a.data);else{d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.e2eEncryptedData!=null&&(b.writeFieldBegin({fname:"e2eEncryptedData",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.e2eEncryptedData),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function d(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.data=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.e2eEncryptedData=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.topic===void 0&&(b.topic="");b.data===void 0&&(b.data=Uint8Array.of());return b}g.GenericDataMessage$DefaultConstructor=a;g.serializeGenericDataMessage=b;g.deserializeGenericDataMessage=d}),98);
__d("DataMessageSerializers",["MultiwaySharedSerializers","MultiwaySharedTypes","ThriftTypes","WebrtcSignalingCommonSerializers"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){return{topic_DEPRECATED:""}}function a(){return{userId:""}}function b(){return{userId:"",cname:"",trackIds:[],transactionId:"0"}}function e(){return{cname:"",quality_DEPRECATED:d("MultiwaySharedTypes").VideoQuality.cast(0)}}function f(){return{userId:"",bottleneckBps:0}}function j(){return{bottleneckUplinksByLayer:{}}}function k(){return{duplicationAmount:0,delayMs:0}}function l(){return{}}function m(){return{}}function n(){return{primarySpeakerUserId:"",transactionId:"0"}}function o(){return{}}function p(){return{signalingMessagePayload:Uint8Array.of()}}function q(){return{signalingMessagePayload:Uint8Array.of()}}function r(){return{subscriptionMessagePayload:[]}}function s(){return{}}function t(){return{}}function u(){return{nodeIdToUserIdMap:{},nodeIdToServiceTypeMap:{}}}function v(){return{}}function w(){return{header:i()}}function x(a,b){b.writeStructBegin("DataHeader");a.sender!=null&&(b.writeFieldBegin({fname:"sender",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.sender),b.writeFieldEnd());b.writeFieldBegin({fname:"topic_DEPRECATED",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.topic_DEPRECATED!=null)b.writeString(a.topic_DEPRECATED);else{var d="";b.writeString(d)}b.writeFieldEnd();if(a.recipients!=null){b.writeFieldBegin({fname:"recipients",ftype:(h||(h=c("ThriftTypes"))).SET,fid:3});b.writeSetBegin({etype:h.STRING,size:a.recipients.size});for(d of a.recipients)b.writeString(d);b.writeSetEnd();b.writeFieldEnd()}if(a.serviceSender!=null){b.writeFieldBegin({fname:"serviceSender",ftype:(h||(h=c("ThriftTypes"))).I32,fid:4});b.writeI32((d=a.serviceSender)!=null?d:0);b.writeFieldEnd()}if(a.serviceRecipients!=null){b.writeFieldBegin({fname:"serviceRecipients",ftype:(h||(h=c("ThriftTypes"))).SET,fid:5});b.writeSetBegin({etype:h.I32,size:a.serviceRecipients.size});for(d of a.serviceRecipients)b.writeI32(d!=null?d:0);b.writeSetEnd();b.writeFieldEnd()}a.shouldSendToAllUsers!=null&&(b.writeFieldBegin({fname:"shouldSendToAllUsers",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:6}),b.writeBool(a.shouldSendToAllUsers),b.writeFieldEnd());a.senderE2eeId!=null&&(b.writeFieldBegin({fname:"senderE2eeId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeBinary(a.senderE2eeId),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function y(a,b){b.writeStructBegin("SpeakerDetail");b.writeFieldBegin({fname:"userId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.userId!=null)b.writeString(a.userId);else{a="";b.writeString(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function z(a,b){b.writeStructBegin("DominantSpeakerNotification");b.writeFieldBegin({fname:"userId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.userId!=null)b.writeString(a.userId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"cname",ftype:h.STRING,fid:2});if(a.cname!=null)b.writeString(a.cname);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"trackIds",ftype:h.LIST,fid:4});if(a.trackIds!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.trackIds.length});for(d of a.trackIds)b.writeString(d);b.writeListEnd()}else{d=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:d.length});for(d of d)b.writeString(d);b.writeListEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"transactionId",ftype:h.I64,fid:5});if(a.transactionId!=null)b.writeI64(BigInt(a.transactionId));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();if(a.dominantSpeakers!=null){b.writeFieldBegin({fname:"dominantSpeakers",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:6});b.writeListBegin({etype:h.STRUCT,size:a.dominantSpeakers.length});for(d of a.dominantSpeakers)y(d,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function A(a,b){b.writeStructBegin("VideoUploadRequest");b.writeFieldBegin({fname:"cname",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.cname!=null)b.writeString(a.cname);else{var e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"quality_DEPRECATED",ftype:h.I32,fid:2});if(a.quality_DEPRECATED!=null){b.writeI32((e=a.quality_DEPRECATED)!=null?e:0)}else{e=d("MultiwaySharedTypes").VideoQuality.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.qualityMask!=null&&(b.writeFieldBegin({fname:"qualityMask",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3}),b.writeI32(a.qualityMask),b.writeFieldEnd());if(a.perSsrcTargetBitrateBpsMap!=null){b.writeFieldBegin({fname:"perSsrcTargetBitrateBpsMap",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:4});b.writeMapBegin({ktype:h.I64,vtype:h.I64,size:Object.keys(a.perSsrcTargetBitrateBpsMap).length});for(e of Object.entries(a.perSsrcTargetBitrateBpsMap)){a=e[0];var f=e[1];b.writeI64(BigInt(a));b.writeI64(BigInt(f))}b.writeMapEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function B(a,b){b.writeStructBegin("ReceiverBottleneck");b.writeFieldBegin({fname:"userId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.userId!=null)b.writeString(a.userId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"bottleneckBps",ftype:h.I32,fid:2});if(a.bottleneckBps!=null)b.writeI32(a.bottleneckBps);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function C(a,b){b.writeStructBegin("BweDebugInfo");b.writeFieldBegin({fname:"bottleneckUplinksByLayer",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.bottleneckUplinksByLayer!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(a.bottleneckUplinksByLayer).length});for(a of Object.entries(a.bottleneckUplinksByLayer)){var d=a[0],e=a[1];b.writeI32(Number(d));B(e,b)}b.writeMapEnd()}else{d={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(d).length});for(e of Object.entries(d)){a=e[0];d=e[1];b.writeI32(Number(a));B(d,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function D(a,b){b.writeStructBegin("AudioDuplicationDebugInfo");b.writeFieldBegin({fname:"duplicationAmount",ftype:(h||(h=c("ThriftTypes"))).I16,fid:1});if(a.duplicationAmount!=null)b.writeI16(a.duplicationAmount);else{var d=0;b.writeI16(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"delayMs",ftype:h.I16,fid:2});if(a.delayMs!=null)b.writeI16(a.delayMs);else{d=0;b.writeI16(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function E(a,b){b.writeStructBegin("ReceiveTrackDebugInfo"),a.trackId!=null&&(b.writeFieldBegin({fname:"trackId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.trackId),b.writeFieldEnd()),a.numSimulcastLayersSupported!=null&&(b.writeFieldBegin({fname:"numSimulcastLayersSupported",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2}),b.writeI32(a.numSimulcastLayersSupported),b.writeFieldEnd()),a.numSimulcastLayersAllocated!=null&&(b.writeFieldBegin({fname:"numSimulcastLayersAllocated",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3}),b.writeI32(a.numSimulcastLayersAllocated),b.writeFieldEnd()),a.spatialLayerIndex!=null&&(b.writeFieldBegin({fname:"spatialLayerIndex",ftype:(h||(h=c("ThriftTypes"))).I32,fid:4}),b.writeI32(a.spatialLayerIndex),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function F(a,b){b.writeStructBegin("DebugInfo");a.audioDuplicationDebugInfo!=null&&(b.writeFieldBegin({fname:"audioDuplicationDebugInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),D(a.audioDuplicationDebugInfo,b),b.writeFieldEnd());if(a.receiveTrackDebugInfo!=null){b.writeFieldBegin({fname:"receiveTrackDebugInfo",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.receiveTrackDebugInfo.length});for(a of a.receiveTrackDebugInfo)E(a,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function G(a,b){b.writeStructBegin("DominantSpeakerInfo");b.writeFieldBegin({fname:"primarySpeakerUserId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.primarySpeakerUserId!=null)b.writeString(a.primarySpeakerUserId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"transactionId",ftype:h.I64,fid:2});if(a.transactionId!=null)b.writeI64(BigInt(a.transactionId));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function H(a,b){b.writeStructBegin("VideoUploadInfo");a.qualityMask!=null&&(b.writeFieldBegin({fname:"qualityMask",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1}),b.writeI32(a.qualityMask),b.writeFieldEnd());if(a.perSsrcTargetBitrateBpsMap!=null){b.writeFieldBegin({fname:"perSsrcTargetBitrateBpsMap",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:2});b.writeMapBegin({ktype:h.I64,vtype:h.I64,size:Object.keys(a.perSsrcTargetBitrateBpsMap).length});for(a of Object.entries(a.perSsrcTargetBitrateBpsMap)){var d=a[0],e=a[1];b.writeI64(BigInt(d));b.writeI64(BigInt(e))}b.writeMapEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function I(a,b){b.writeStructBegin("SignalingMessageToClient");b.writeFieldBegin({fname:"signalingMessagePayload",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.signalingMessagePayload!=null)b.writeBinary(a.signalingMessagePayload);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.version!=null&&(b.writeFieldBegin({fname:"version",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.version)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function J(a,b){b.writeStructBegin("SignalingMessageFromClient");b.writeFieldBegin({fname:"signalingMessagePayload",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.signalingMessagePayload!=null)b.writeBinary(a.signalingMessagePayload);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.version!=null&&(b.writeFieldBegin({fname:"version",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.version)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function K(a,b){b.writeStructBegin("SubscriptionMessageFromClient");b.writeFieldBegin({fname:"subscriptionMessagePayload",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});if(a.subscriptionMessagePayload!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.subscriptionMessagePayload.length});for(a of a.subscriptionMessagePayload)d("MultiwaySharedSerializers").serializeSubscription(a,b);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.length});for(a of a)d("MultiwaySharedSerializers").serializeSubscription(a,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function L(a,b){b.writeStructBegin("RenderResolutionMessageFromClient");if(a.renderResolutionMap!=null){b.writeFieldBegin({fname:"renderResolutionMap",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});b.writeMapBegin({ktype:h.STRING,vtype:h.MAP,size:Object.keys(a.renderResolutionMap).length});for(a of Object.entries(a.renderResolutionMap)){var e=a[0],f=a[1];b.writeString(e);b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(f).length});for(e of Object.entries(f)){f=e[0];var g=e[1];b.writeI32((f=Number(f))!=null?f:0);d("MultiwaySharedSerializers").serializeResolutionData(g,b)}b.writeMapEnd()}b.writeMapEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function aa(a,b){b.writeStructBegin("RenderResolutionMessageToClient");if(a.renderResolutionMap!=null){b.writeFieldBegin({fname:"renderResolutionMap",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});b.writeMapBegin({ktype:h.STRING,vtype:h.MAP,size:Object.keys(a.renderResolutionMap).length});for(a of Object.entries(a.renderResolutionMap)){var e=a[0],f=a[1];b.writeString(e);b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(f).length});for(e of Object.entries(f)){f=e[0];var g=e[1];b.writeI32((f=Number(f))!=null?f:0);d("MultiwaySharedSerializers").serializeResolutionData(g,b)}b.writeMapEnd()}b.writeMapEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function ba(a,b){b.writeStructBegin("NodeIdNotification");b.writeFieldBegin({fname:"nodeIdToUserIdMap",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.nodeIdToUserIdMap!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I64,vtype:h.I64,size:Object.keys(a.nodeIdToUserIdMap).length});for(var d of Object.entries(a.nodeIdToUserIdMap)){var e=d[0],f=d[1];b.writeI64(BigInt(e));b.writeI64(BigInt(f))}b.writeMapEnd()}else{e={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I64,vtype:h.I64,size:Object.keys(e).length});for(f of Object.entries(e)){d=f[0];e=f[1];b.writeI64(BigInt(d));b.writeI64(BigInt(e))}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"nodeIdToServiceTypeMap",ftype:h.MAP,fid:2});if(a.nodeIdToServiceTypeMap!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I64,vtype:h.I32,size:Object.keys(a.nodeIdToServiceTypeMap).length});for(d of Object.entries(a.nodeIdToServiceTypeMap)){e=d[0];f=d[1];b.writeI64(BigInt(e));b.writeI32(f!=null?f:0)}b.writeMapEnd()}else{a={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I64,vtype:h.I32,size:Object.keys(a).length});for(e of Object.entries(a)){f=e[0];d=e[1];b.writeI64(BigInt(f));b.writeI32(d!=null?d:0)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function M(a,b){b.writeStructBegin("DataMessageBody"),a.genericMessage!=null&&(b.writeFieldBegin({fname:"genericMessage",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),d("WebrtcSignalingCommonSerializers").serializeGenericDataMessage(a.genericMessage,b),b.writeFieldEnd()),a.dominantSpeakerNotification!=null&&(b.writeFieldBegin({fname:"dominantSpeakerNotification",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),z(a.dominantSpeakerNotification,b),b.writeFieldEnd()),a.videoUploadRequest!=null&&(b.writeFieldBegin({fname:"videoUploadRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),A(a.videoUploadRequest,b),b.writeFieldEnd()),a.dominantSpeakerSignalingInfo!=null&&(b.writeFieldBegin({fname:"dominantSpeakerSignalingInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),G(a.dominantSpeakerSignalingInfo,b),b.writeFieldEnd()),a.bweDebugInfo!=null&&(b.writeFieldBegin({fname:"bweDebugInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),C(a.bweDebugInfo,b),b.writeFieldEnd()),a.debugInfo!=null&&(b.writeFieldBegin({fname:"debugInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),F(a.debugInfo,b),b.writeFieldEnd()),a.videoUploadSignalingInfo!=null&&(b.writeFieldBegin({fname:"videoUploadSignalingInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7}),H(a.videoUploadSignalingInfo,b),b.writeFieldEnd()),a.signalingMessageToClient!=null&&(b.writeFieldBegin({fname:"signalingMessageToClient",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:8}),I(a.signalingMessageToClient,b),b.writeFieldEnd()),a.signalingMessageFromClient!=null&&(b.writeFieldBegin({fname:"signalingMessageFromClient",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:9}),J(a.signalingMessageFromClient,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function ca(a,b){b.writeStructBegin("DataMessage");b.writeFieldBegin({fname:"header",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.header!=null)x(a.header,b);else{var d=i();x(d,b)}b.writeFieldEnd();a.data_DEPRECATED!=null&&(b.writeFieldBegin({fname:"data_DEPRECATED",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.data_DEPRECATED),b.writeFieldEnd());a.body!=null&&(b.writeFieldBegin({fname:"body",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),M(a.body,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function N(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.sender=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.topic_DEPRECATED=a.readString():a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).SET){b.recipients=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.recipients.add(i)}}else a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.serviceSender=d("MultiwaySharedTypes").EndpointServiceType.cast(a.readI32()):a.skip(f);break;case 5:if(f===(h||(h=c("ThriftTypes"))).SET){b.serviceRecipients=new Set();i=a.readSetBegin();for(g=0;g<i.size;g++){e=d("MultiwaySharedTypes").EndpointServiceType.cast(a.readI32());b.serviceRecipients.add(e)}}else a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).BOOL?b.shouldSendToAllUsers=a.readBool():a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRING?b.senderE2eeId=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.topic_DEPRECATED===void 0&&(b.topic_DEPRECATED="");return b}function O(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.userId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.userId===void 0&&(b.userId="");return b}function P(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.userId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.cname=a.readString():a.skip(e);break;case 4:if(e===(h||(h=c("ThriftTypes"))).LIST){b.trackIds=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.trackIds.push(g)}}else a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).I64?b.transactionId=a.readI64().toString():a.skip(e);break;case 6:if(e===(h||(h=c("ThriftTypes"))).LIST){b.dominantSpeakers=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=O(a);b.dominantSpeakers.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.userId===void 0&&(b.userId="");b.cname===void 0&&(b.cname="");b.trackIds===void 0&&(b.trackIds=[]);b.transactionId===void 0&&(b.transactionId="0");return b}function Q(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.cname=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.quality_DEPRECATED=d("MultiwaySharedTypes").VideoQuality.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.qualityMask=a.readI32():a.skip(f);break;case 4:if(f===(h||(h=c("ThriftTypes"))).MAP){b.perSsrcTargetBitrateBpsMap={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readI64().toString(),j=a.readI64().toString();b.perSsrcTargetBitrateBpsMap[i]=j}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.cname===void 0&&(b.cname="");b.quality_DEPRECATED===void 0&&(b.quality_DEPRECATED=d("MultiwaySharedTypes").VideoQuality.cast(0));return b}function R(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.userId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I32?b.bottleneckBps=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.userId===void 0&&(b.userId="");b.bottleneckBps===void 0&&(b.bottleneckBps=0);return b}function S(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).MAP){b.bottleneckUplinksByLayer={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readI32(),i=R(a);b.bottleneckUplinksByLayer[g]=i}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.bottleneckUplinksByLayer===void 0&&(b.bottleneckUplinksByLayer={});return b}function T(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I16?b.duplicationAmount=a.readI16():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I16?b.delayMs=a.readI16():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.duplicationAmount===void 0&&(b.duplicationAmount=0);b.delayMs===void 0&&(b.delayMs=0);return b}function U(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.trackId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I32?b.numSimulcastLayersSupported=a.readI32():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.numSimulcastLayersAllocated=a.readI32():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).I32?b.spatialLayerIndex=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function V(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.audioDuplicationDebugInfo=T(a):a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.receiveTrackDebugInfo=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=U(a);b.receiveTrackDebugInfo.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function W(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.primarySpeakerUserId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.transactionId=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.primarySpeakerUserId===void 0&&(b.primarySpeakerUserId="");b.transactionId===void 0&&(b.transactionId="0");return b}function X(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I32?b.qualityMask=a.readI32():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).MAP){b.perSsrcTargetBitrateBpsMap={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString(),i=a.readI64().toString();b.perSsrcTargetBitrateBpsMap[g]=i}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Y(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.signalingMessagePayload=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.version=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.signalingMessagePayload===void 0&&(b.signalingMessagePayload=Uint8Array.of());return b}function Z(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.signalingMessagePayload=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.version=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.signalingMessagePayload===void 0&&(b.signalingMessagePayload=Uint8Array.of());return b}function da(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).LIST){b.subscriptionMessagePayload=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("MultiwaySharedSerializers").deserializeSubscription(a);b.subscriptionMessagePayload.push(i)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.subscriptionMessagePayload===void 0&&(b.subscriptionMessagePayload=[]);return b}function ea(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).MAP){b.renderResolutionMap={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j={},k=a.readMapBegin();for(var l=0;l<k.size;l++){var m=d("MultiwaySharedTypes").RenderedStreamType.cast(a.readI32()),n=d("MultiwaySharedSerializers").deserializeResolutionData(a);m!=null&&(j[m]=n)}b.renderResolutionMap[i]=j}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function fa(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).MAP){b.renderResolutionMap={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j={},k=a.readMapBegin();for(var l=0;l<k.size;l++){var m=d("MultiwaySharedTypes").RenderedStreamType.cast(a.readI32()),n=d("MultiwaySharedSerializers").deserializeResolutionData(a);m!=null&&(j[m]=n)}b.renderResolutionMap[i]=j}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function ga(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).MAP){b.nodeIdToUserIdMap={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readI64().toString(),j=a.readI64().toString();b.nodeIdToUserIdMap[i]=j}}else a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).MAP){b.nodeIdToServiceTypeMap={};i=a.readMapBegin();for(j=0;j<i.size;j++){g=a.readI64().toString();e=d("MultiwaySharedTypes").EndpointServiceType.cast(a.readI32());b.nodeIdToServiceTypeMap[g]=e}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.nodeIdToUserIdMap===void 0&&(b.nodeIdToUserIdMap={});b.nodeIdToServiceTypeMap===void 0&&(b.nodeIdToServiceTypeMap={});return b}function $(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.genericMessage=d("WebrtcSignalingCommonSerializers").deserializeGenericDataMessage(a):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.dominantSpeakerNotification=P(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRUCT?b.videoUploadRequest=Q(a):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRUCT?b.dominantSpeakerSignalingInfo=W(a):a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRUCT?b.bweDebugInfo=S(a):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRUCT?b.debugInfo=V(a):a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRUCT?b.videoUploadSignalingInfo=X(a):a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).STRUCT?b.signalingMessageToClient=Y(a):a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).STRUCT?b.signalingMessageFromClient=Z(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function ha(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.header=N(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.data_DEPRECATED=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRUCT?b.body=$(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.header===void 0&&(b.header=i());return b}g.DataHeader$DefaultConstructor=i;g.SpeakerDetail$DefaultConstructor=a;g.DominantSpeakerNotification$DefaultConstructor=b;g.VideoUploadRequest$DefaultConstructor=e;g.ReceiverBottleneck$DefaultConstructor=f;g.BweDebugInfo$DefaultConstructor=j;g.AudioDuplicationDebugInfo$DefaultConstructor=k;g.ReceiveTrackDebugInfo$DefaultConstructor=l;g.DebugInfo$DefaultConstructor=m;g.DominantSpeakerInfo$DefaultConstructor=n;g.VideoUploadInfo$DefaultConstructor=o;g.SignalingMessageToClient$DefaultConstructor=p;g.SignalingMessageFromClient$DefaultConstructor=q;g.SubscriptionMessageFromClient$DefaultConstructor=r;g.RenderResolutionMessageFromClient$DefaultConstructor=s;g.RenderResolutionMessageToClient$DefaultConstructor=t;g.NodeIdNotification$DefaultConstructor=u;g.DataMessageBody$DefaultConstructor=v;g.DataMessage$DefaultConstructor=w;g.serializeDataHeader=x;g.serializeSpeakerDetail=y;g.serializeDominantSpeakerNotification=z;g.serializeVideoUploadRequest=A;g.serializeReceiverBottleneck=B;g.serializeBweDebugInfo=C;g.serializeAudioDuplicationDebugInfo=D;g.serializeReceiveTrackDebugInfo=E;g.serializeDebugInfo=F;g.serializeDominantSpeakerInfo=G;g.serializeVideoUploadInfo=H;g.serializeSignalingMessageToClient=I;g.serializeSignalingMessageFromClient=J;g.serializeSubscriptionMessageFromClient=K;g.serializeRenderResolutionMessageFromClient=L;g.serializeRenderResolutionMessageToClient=aa;g.serializeNodeIdNotification=ba;g.serializeDataMessageBody=M;g.serializeDataMessage=ca;g.deserializeDataHeader=N;g.deserializeSpeakerDetail=O;g.deserializeDominantSpeakerNotification=P;g.deserializeVideoUploadRequest=Q;g.deserializeReceiverBottleneck=R;g.deserializeBweDebugInfo=S;g.deserializeAudioDuplicationDebugInfo=T;g.deserializeReceiveTrackDebugInfo=U;g.deserializeDebugInfo=V;g.deserializeDominantSpeakerInfo=W;g.deserializeVideoUploadInfo=X;g.deserializeSignalingMessageToClient=Y;g.deserializeSignalingMessageFromClient=Z;g.deserializeSubscriptionMessageFromClient=da;g.deserializeRenderResolutionMessageFromClient=ea;g.deserializeRenderResolutionMessageToClient=fa;g.deserializeNodeIdNotification=ga;g.deserializeDataMessageBody=$;g.deserializeDataMessage=ha}),98);
__d("DataMessageTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({OK:200,NOT_FOUND:404});e.exports={DataMessageStatusCode:a}}),null);
__d("HorizonWebMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();function h(){var a;d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);return new(c("MqttChannel"))({appId:(a=c("MqttWebConfig")).appID,capabilities:a.capabilities,chatVisibility:!0,clientCapabilities:a.clientCapabilities,endpoint:a.endpoint,initialSubscribedTopics:a.subscribedTopics,pageId:null,phpOverride:a.hostNameOverride,pollingEndpoint:a.pollingEndpoint,userFbid:a.fbid})}var i=null;function a(){i==null&&(i=h());return i}function b(){i!=null&&(i.shutdown(),i=null)}g.getHorizonWebMqttChannelInstance=a;g.shutdownAndClear=b}),98);
__d("IGDOverLSMqttChannel",["CurrentUser","Env","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i;c("MqttEnvInitializer").initialize();function j(a){d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);var b=c("CurrentUser").getAppID()==null?936619743392459:Number(c("CurrentUser").getAppID());return new(c("MqttChannel"))({appId:b,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:c("MqttWebConfig").clientCapabilities,clientType:"cookie_auth",deviceId:a,endpoint:(i||(i=c("Env"))).ig_mqtt_wss_endpoint||"wss://edge-chat.instagram.com/chat",initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:(i||(i=c("Env"))).ig_mqtt_polling_endpoint||"https://edge-chat.instagram.com/mqtt/pull",userFbid:c("CurrentUser").getPossiblyNonFacebookUserID()})}var k=null,l;function m(a){k==null&&(k=j(a));a=k;l==null||l(a);return a}function a(){return new(h||(h=b("Promise")))(function(a){k?a(m()):l=function(b){a(b)}})}function e(){k!=null&&(k.shutdown(),k=null)}g.getInstance=m;g.waitAndGetInstance=a;g.shutdownAndClear=e}),98);
__d("LiveChatWidgetMqttChannel",["MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();function h(){var a;d("MqttEnv").setIsUserLoggedInNow(function(){return!0});return new(c("MqttChannel"))({appId:1971595283112096,capabilities:(a=c("MqttWebConfig")).capabilities,chatVisibility:!1,clientCapabilities:a.clientCapabilities,endpoint:a.endpoint,initialSubscribedTopics:a.subscribedTopics,pageId:null,phpOverride:a.hostNameOverride,pollingEndpoint:a.pollingEndpoint,userFbid:a.fbid})}var i=null;function a(){i==null&&(i=h());return i}function b(){i!=null&&(i.shutdown(),i=null)}g.getLiveChatWidgetMqttChannelInstance=a;g.shutdownAndClear=b}),98);
__d("MDCMqttChannel",["CurrentUser","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();function h(a){d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);a=c("CurrentUser").getAppID()==null?218968626708284:Number(c("CurrentUser").getAppID());return new(c("MqttChannel"))({appId:a,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:c("MqttWebConfig").clientCapabilities,clientType:"websocket",deviceId:c("uuidv4")(),endpoint:c("MqttWebConfig").endpoint,initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:c("MqttWebConfig").pollingEndpoint,userFbid:c("CurrentUser").getPossiblyNonFacebookUserID()})}var i=null;function a(a){i==null&&(i=h(a));return i}function b(){return i}function e(){i!=null&&(i.shutdown(),i=null)}g.getMDCMqttChannelInstance=a;g.getMDCMqttChannelInstanceDoNotCreate=b;g.shutdownAndClear=e}),98);
__d("MqttThriftHeaderSerializers",["ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(a,b){b.writeStructBegin("MqttThriftHeader"),a.traceInfo!=null&&(b.writeFieldBegin({fname:"traceInfo",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.traceInfo),b.writeFieldEnd()),a.coreContextRequestId!=null&&(b.writeFieldBegin({fname:"coreContextRequestId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.coreContextRequestId),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function d(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.traceInfo=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.coreContextRequestId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}g.MqttThriftHeader$DefaultConstructor=a;g.serializeMqttThriftHeader=b;g.deserializeMqttThriftHeader=d}),98);
__d("MultiwayCommonTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({STRING:0,THRIFT:1,BOTH:2});d=a({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503});f=a({UNKNOWN:1e3,EXCEEDED_MAX_ALLOWED_PARTICIPANTS:1001,MEMBERSHIP_CHECK_FAIL:1002,CONFERENCE_THROTTLED:1003,ENDPOINT_THROTTLED:1004,MWS_MESSAGE_SENT_TO_INCORRECT_REGION:1005,UNSUPPORTED_REQUEST_TYPE:2e3,CLIENT_REQUEST_UNACCEPTABLE:2001,CLIENT_RESPONSE_UNACCEPTABLE:2002,RING_RESPONSE_BODY_NOT_SET:2004,SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:2005,INVALID_SDP:2006,INVALID_CONFERENCE_NAME:2007,SERVER_INFO_CONFERENCE_NAME_MISMATCH:2008,INVALID_USER_ID:2009,INCORRECT_VERSION_RANGE:2010,SENDER_ID_MISMATCH:2011,RECIPIENT_NOT_SPECIFIED:2012,FIELD_NOT_ALLOWED:2013,USERS_NOT_SPECIFIED:2015,REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:2016,INVALID_CALL_ID:2017,SESSION_DESCRIPTION_ID_MISMATCH:2018,EMPTY_CLIENT_MEDIA_UPDATES:2019,INVALID_SERVER_INFO_DATA:2020,INCORRECT_STATE_VERSION:2021,MISMATCHED_STATE_FOR_VERSION:2022,INVALID_STATE_VERSION:2023,NO_RESOLVER_FOUND:2024,MISSING_APPROVERLIST:2025,FULL_SDP_REQUIRED_IN_APPROVED_STATE:2026,INVALID_BROADCAST_ID:2027,INVALID_ENDPOINT_CONFIG:2028,INVALID_E2EE_STATE:2029,SFU_MODE_PREVENTED:2030,INVALID_CONFERENCE_STATE:2031,JOIN_REQUEST_DENIED:2032,EMPTY_USER_IDS:2033,MISSING_SDP_CONNECT_REQUEST:2034,CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:2035,MISSING_BODY_ENDPOINT:2101,MISSING_BODY_HEADER:2102,MISSING_BODY_BODY:2103,MISSING_BODY_PARAMS:2104,MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:2105,MISSING_BODY_DATA_MESSAGE_REQUEST:2106,MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:2107,MISSING_BODY_ADD_PARTICIPANTS_REQUEST:2108,MISSING_BODY_SUBSCRIPTION_REQUEST:2110,MISSING_BODY_JOIN_REQUEST:2111,MISSING_BODY_HANGUP_REQUEST:2112,MISSING_BODY_ICE_CANDIDATE_REQUEST:2113,MISSING_BODY_P2P_MESSAGE_REQUEST:2114,MISSING_BODY_UPDATE_REQUEST:2115,MISSING_BODY_CLIENT_EVENT_REQUEST:2116,MISSING_BODY_CONNECT_REQUEST:2117,MISSING_BODY_UNSUBSCRIBE_REQUEST:2118,MISSING_BODY_APPROVAL_REQUEST:2119,MISSING_ENDPOINT_USER_ID:2120,EMPTY_ENDPOINT_USER_ID:2121,MISSING_BODY_TRANSFER_REQUEST:2122,MISSING_BODY_GENERIC:2199,REQUESTOR_NOT_MEMBER_CONFERENCE:3002,NOT_BROADCAST_OWNER:3003,GUEST_NOT_INVITED:3004,GUEST_DISCONNECTED:3005,GUEST_INVITATION_EXPIRED:3006,PARTICIPANT_IN_PENDING_APPROVAL_STATE:3008,INVALID_MULTIWAY_PARAMS:3009,BROADCAST_ALREADY_STOPPED:4002,FAILED_TO_GENERATE_SDP_ANSWER:4003,FAILED_GENERATE_SESSION_DESCRIPTION:4004,SDP_SESSION_ID_MISMATCH:4005,MEDIA_ENDPOINT_GONE:4007,MEDIA_ENDPOINT_ALREADY_EXISTS:4008,MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:4009,LEGACY_MESSENGER_SENDER_UNSET:4010,FAILED_TO_SET_TRANSPORT_INFO:4011,NON_PRIMARY_MULTIWAY_SERVER:4012,FAILED_TO_GET_REMOTE_DESCRIPTION:4013,LOCAL_DESCRIPTION_NOT_SET:4014,INVALID_SDP_TYPE:4015,CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:4016,SDP_UNSET_ON_P2P_ANSWER:4017,MISSING_ICE_CANDIDATE_PAYLOAD:4018,P2P_PROTOCOL_UNSET:4019,CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:4020,LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:4021,CONNECT_UNSUPPORTED_IN_SFU_MODE:4022,CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:4023,RESOLVE_STATE_API_ERROR:4024,EXTERNAL_RESOLUTION_ERROR:4025,INTERNAL_RESOLUTION_ERROR:4026,RESOLUTION_DISABLED:4027,BROADCAST_ID_MISSING:4028,SDP_UNSET_ON_P2P_OFFER:4029,LEGACY_OFFER_MISSING_REQUIRED_VALUE:4031,MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:4032,CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:4033,OTHER_USER_ANSWERED_THE_CALL:4034,MEDIA_SERVER_DESERIALIZATION_ERROR:4035,REMOTE_SDP_TRACKID_MISMATCH:4036,SIGNALING_MESSAGE_TO_CLIENT_DROPPED:4037,DATA_CHANNEL_ENDPOINT_GONE:4038,DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:4039,CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:4040,P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:4041,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:4042,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:4043,REQUEST_TIMEOUT:4044,TOO_MANY_MEDIA_TRACKS_IN_SDP:4045,CONFERENCE_NOT_FOUND:5001,CONFERENCE_IS_TERMINATING:5002,CONFERENCE_IS_TERMINATED:5003,CONFERENCE_NAME_EMPTY:5004,NONCE_EMPTY:5005,NONCE_MISMATCH:5006,CONFERENCE_HAS_GONE:5007,PARTICIPANT_HAS_GONE:5008,MEDIA_SERVER_NOT_FOUND:5009,CLIENT_TERMINATED:5010,JOIN_SESSION_RESULT_MISSING:5012,LOGGING_POLICY_RESULT_MISSING:5013,INVITE_USERS_RESULT_MISSING:5014,STATE_SYNC_RESULT_MISSING:5015,ENDPOINT_INFO_RESULT_MISSING:5016,CONFERENCE_NAME_MISMATCH:5017,UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME:5018,SESSION_CONFIGURATION_RESULT_MISSING:5019,MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:6001,CONFERENCE_INCAPABLE_RENEGOTIATION:6002,REJECTING_CMU_WHEN_SMU_PENDING:6003,PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:6004,PARTICIPANT_ALREADY_IN_WAITING_ROOM:6005,PARTICIPANT_NOT_IN_PENDING_APPROVAL:6006,USER_NOT_APPROVER_FOR_TARGET_USER:6007,UNSUPPORTED_CAPABILITIES:6008,PRODUCT_SERVER_DEFINED_END_REASON:6009,WWW_KILLSWITCHED_REQUEST:6010,CONFLICTING_MEDIA_PATH:6011,CONFLICTING_MEDIA_STATUS:6012,CONFLICTING_SESSION_DESCRIPTION:6013,OK:9e3});b=a({NONE:0,INFO:1,ERROR:2});var g=a({SUCCESS:0,ERROR:1,SESSION_NOT_FOUND:10,SESSION_MISMATCH:11,SESSION_TERMINATING:12,CONNECTION_ALREADY_EXIST:20,CONNECTION_OLD_EXIST:21,CONNECTION_NOT_FOUND:23,CONNECTION_MISMATCH:24,SDP_INVALID:30,SDP_NEGOTIATION_FAILED:31,EXCEEDED_MAX_PARTICIPANT_COUNT:40,UNAUTHORIZED:50}),h=a({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26,TRANSFER:27,WAKEUP:28}),i=a({IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:7,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:8,WEBRTC_ERROR:9,CONNECTION_DROPPED:10}),j=a({CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,CALL_ENDED_BY_PRODUCT:9,JOIN_APPROVAL_DENIED:10,JOIN_APPROVAL_TIMEDOUT:11,UNSUPPORTED_VERSION:12,LIVE_NOT_ACKED:13,TX_ACK_TIMEDOUT:14,ANSWERED_BY_OTHER_USER:15,PARTICIPANT_SELF_TERMINATION:16,PARTICIPANT_REJOIN:17,LONG_LASTING_AUDIO_ISSUE:18,PRIMARY_ENDPOINT_HANGUP:19,RECONNECT_FAILED:20,E2EE_HARDENING_ERROR:21,CALL_ENDED_BY_EXTENSION:22,CALL_ENDED_BY_OVER_CAPACITY:23}),k=a({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8,SUPPORT_PARTICIPANT_STATE_UNCALLABLE:9,SUPPORT_MULTIPLE_VIDEO_STREAMS:10,REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED:11,SUPPORT_MULTISTREAM_FEC:12,SUPPORT_DELTA_SMU:13,REQUIRE_DEFAULT_CHANNEL_SCREENSHARE:14,SUPPORT_SCREENSHARE_FLAG_IN_JOIN_RESPONSE_AND_SMU:15,SUPPORT_TEMPORAL_LAYER_JBE:16,REQUIRES_P2P_RELAY_INFO_VIA_SIGNALING:17,SUPPORT_NUMERIC_TOPICS:18,SUPPORT_PSEUDO_QUIC_CONNECTION:19,SUPPORT_SDP_SENDRECV:20}),l=a({GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6,LIVE_AUDIO_ROOM:7,LIVE_WITH_ROOM:8}),m=a({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10}),n=a({ACTIVE:0,TERMINATED:1}),o=a({UNKNOWN:0,ACTIVE:1,TERMINATED:2}),p=a({DENIED:0,APPROVED:1}),q=a({UNKNOWN:0,SIGNALING_DATA_MESSAGE:1,STATE_SYNC_UPDATE:2,STATE_SYNC_SNAPSHOT:3}),r=a({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11,RING_TYPE_UNSUPPORTED:12,PENDING_APPROVAL:13,APPROVED:14,FAILED_APPROVAL:15,HANGUP_IN_WAITING_ROOM:16,UNCALLABLE:17,UNCALLABLE_DELAYED:18}),s=a({PRANSWER:1001,INITIAL_ANSWER_TO_P2P_CALLER:1002,DEESCALATE_OFFER_TO_P2P_CALLEE:1003,DEESCALATE_ANSWER_TO_P2P_CALLER:1004,REQUEST_DEESCALATE_TO_P2P_CALLER:1005,REQUEST_ESCALATE:1006,REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:1007,REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:1008,PARTICIPANT_ADDED:1009,PARTICIPANT_REMOVED:1010,FIRST_REMOTE_ALERTED_FOR_INITIATOR:2001,FIRST_REMOTE_ANSWERED_FOR_INITIATOR:2002,CONTAIN_PENDING_APPROVAL_PARTICIPANTS:2003,KEEP_ALIVE_PING:3001,IS_INITIATOR:4001,PREGEN_SDP:4002}),t=a({PRIMARY:0,SECONDARY:1}),u=a({UNKNOWN:0,MEDIA_CONNECTED:1});a=a({JoinRequest:"joinRequest",JoinResponse:"joinResponse",ServerMediaUpdateRequest:"serverMediaUpdateRequest",ServerMediaUpdateResponse:"serverMediaUpdateResponse",HangupRequest:"hangupRequest",IceCandidateRequest:"iceCandidateRequest",RingRequest:"ringRequest",RingResponse:"ringResponse",DismissRequest:"dismissRequest",ConferenceStateRequest:"conferenceStateRequest",ConferenceStateResponse:"conferenceStateResponse",AddParticipantsRequest:"addParticipantsRequest",SubscriptionRequest:"subscriptionRequest",ClientMediaUpdateRequest:"clientMediaUpdateRequest",ClientMediaUpdateResponse:"clientMediaUpdateResponse",DataMessageRequest:"dataMessageRequest",RemoveParticipantsRequest:"removeParticipantsRequest",DataMessageResponse:"dataMessageResponse",UpdateRequest:"updateRequest",UpdateResponse:"updateResponse",NotifyRequest:"notifyRequest",NotifyResponse:"notifyResponse",ConnectRequest:"connectRequest",ConnectResponse:"connectResponse",ClientEventRequest:"clientEventRequest",ClientEventResponse:"clientEventResponse",UnsubscribeRequest:"unsubscribeRequest",UnsubscribeResponse:"unsubscribeResponse",ApprovalRequest:"approvalRequest",TransferRequest:"transferRequest"});e.exports={ApprovalStatus:p,Capability:k,ClientEventType:u,DeviceStatus:m,DismissReason:j,E2eeDataMessageType:q,ExtensionSessionStatus:o,HangupReason:i,JoinMode:t,MediaConnectionStatus:n,MessageTag:s,MessageType:h,ParticipantCallState:r,RingType:l,RtcApiStatusCode:g,RtcLogSeverity:b,RtcMessageBodyVariant$Types:a,RtcResponseStatusCode:d,RtcResponseSubCode:f,SdpPayloadType:c}}),null);
__d("StateSyncSerializers",["ThriftTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{version:0}}function b(){return{stateStore:{}}}function i(a,b){b.writeStructBegin("State");b.writeFieldBegin({fname:"version",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.version!=null)b.writeI32(a.version);else{var d=0;b.writeI32(d)}b.writeFieldEnd();a.data!=null&&(b.writeFieldBegin({fname:"data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function d(a,b){b.writeStructBegin("Snapshot");b.writeFieldBegin({fname:"stateStore",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.stateStore!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(a.stateStore).length});for(a of Object.entries(a.stateStore)){var d=a[0],e=a[1];b.writeString(d);i(e,b)}b.writeMapEnd()}else{d={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(d).length});for(e of Object.entries(d)){a=e[0];d=e[1];b.writeString(a);i(d,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function j(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.version===void 0&&(b.version=0);return b}function e(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).MAP){b.stateStore={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readString(),i=j(a);b.stateStore[g]=i}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.stateStore===void 0&&(b.stateStore={});return b}g.State$DefaultConstructor=a;g.Snapshot$DefaultConstructor=b;g.serializeState=i;g.serializeSnapshot=d;g.deserializeState=j;g.deserializeSnapshot=e}),98);
__d("StateSyncTopicsConfigTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({UNKNOWN:0,INTERNAL:1,EXTERNAL:2});d=a({UNKNOWN:0,PARTICIPANT_JOIN:100,PARTICIPANT_UPDATE:101,PARTICIPANT_LEAVE:102,PARTICIPANT_NEGOTIATED:103,PARTICIPANT_SDP_CHANGED:104,EXTENSION_CREATION:201,EXTENSION_JOIN:202,EXTENSION_UPDATE:203,EXTENSION_LEAVE:204,EXTENSION_REQUEST:205,CONFERENCE_UPDATE:501,DOMINANT_SPEAKER_UPDATE:1001,MEDIA_ASPECT_RATIO_UPDATE:1002,TIMER_FIRED:1003,MEDIA_PATH_CHANGED:1004,PARTICIPANTS_ACKED_MEDIA:1005});f=a({UNKNOWN:0,ANY_PARTICIPANT_SUBSCRIBED:1,ALWAYS_RESOLVE:2});b=a({CACHIUS:1,IRIS:2});a=a({Config_engine:1,E2eeState:2,Media_information:3,Breakout:4,Countdown_timer:5,Effect_match:6,Emoji_reactions:7,Entered_avatars_mode:8,Moderator_controls:9,Polls:10,Raised_hands_queue:11,Xac_calling:12,Action_items:13,Can_you_see_my_screen:14,Collage:15,Companion:16,Coplay:17,Coview:18,Custom_video_capabilities:19,Dropin:20,Dtmf:21,E2ee_v2_msg:22,Effect_sync:23,Et_pluto_activity:24,Et_pluto_session:25,Et_test_activity:26,Et_test_session:27,Et_tubi_activity:28,Et_tubi_session:29,External_resolution_enabled:30,Hyperspace_copresence_state:31,Hyperspace_mic_state:32,Intenticons:33,Live_stream:34,Live_stream_app_message:35,Max_video_subscriptions:36,Media_sync:37,Media_sync_autoplay:38,Meeting_assistant:39,Meeting_transcription:40,Morpheo_grid:41,Multipeer_ar:42,Number_of_people:43,Opaque_blob:44,Photo_booth:45,Qna:46,Quizzes:47,Reactions:48,Role_assignments:49,Room_features_availability:50,Rooms_notes:51,Screenshare_floor_control:52,Screenshare_single_floor_control:53,Sctp_negotiation:54,Sideband:55,Simple:56,Simple_external:57,Simple_pass_through:58,Simple_passthrough:59,Snippets:60,Sound_effects:61,Whiteboard:62,Whiteboard_messenger:63,Workroom:64,Workrooms_ask_everyone_to_open:65,Workrooms_vr:66,Avatar_transport_state:67,Ambisonic:68,Cathode_extension:69,Biz_calling:70,Work_costreaming:71,Conversation_bot:72,Voip_zone:73,Admin_initiated_casting:74,Smart_glasses_assistant:75,Codec_avatar_2d:76,Custom_media_routing:77});e.exports={CryptoAuthVerifierIdentity:b,DataSource:d,DataSourceCondition:f,ResolutionPath:c,TopicId:a}}),null);
__d("WebrtcEnumsTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({OFFER:0,ANSWER:1,ICE_CANDIDATE:2,OK:3,HANG_UP:4,OTHER_DISMISS:5,PRANSWER:7,PING:8,PING_ACK:9,ICE_RESTART_OFFER:10,ICE_RESTART_ANSWER:11,OFFER_ACK:12,ANSWER_ACK:13,NOTIFY_MEDIA_STATE:14,ACK:15,INVALID:16,OFFER_NACK:17,NACK:18,VIDEO_REQUEST:19,SDP_UPDATE:20,SWITCH_TO_MULTIWAY:28,NEGOTIATE:30,PR_OFFER_ACK:32,CLIENT_REPORTED_EVENT:33});d=a({OFFER:0,ANSWER:1});f=a({LL_NIL:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5});b=a({IGNORE_CALL:0,HANGUP_CALL:1,IN_ANOTHER_CALL:2,ACCEPT_AFTER_HANGUP:3,NO_ANSWER_TIMEOUT:4,INCOMING_TIMEOUT:5,OTHER_INSTANCE_HANDLED:6,SIGNALING_MESSAGE_FAILED:7,CONNECTION_DROPPED:8,CLIENT_INTERRUPTED:9,WEBRTC_ERROR:10,CLIENT_ERROR:11,NO_PERMISSION:12,OTHER_NOT_CAPABLE:13,NO_UI_ERROR:14,UNSUPPORTED_VERSION:15,CALLER_NOT_VISIBLE:16,CARRIER_BLOCKED:17,OTHER_CARRIER_BLOCKED:18,CLIENT_ENCRYPTION_ERROR:19,MICROPHONE_PERMISSION_DENIED:20,CAMERA_PERMISSION_DENIED:21,SESSION_MIGRATED:22,RING_MUTED:23,MAX_ALLOWED_PARTICIPANTS_REACHED:24,CALLEE_REQUIRES_MULTIWAY:25,LIVE_NOT_ACKED:26,TX_ACK_TIMEDOUT:27,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:28,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:29,ANSWERED_BY_OTHER_USER:30,LONG_LASTING_AUDIO_ISSUE:31,ADMIN_CALLING_OWN_PAGE:32,PAGE_CALLS_BLOCKED:33});var g=a({UDP:0,TCP:1,SSLTCP:2}),h=a({HOST:0,SERVER_REFLEXIVE:1,PEER_REFLEXIVE:2,RELAY:3}),i=a({TCPTYPE_NONE:0,TCPTYPE_PASSIVE:1,TCPTYPE_ACTIVE:2,TCPTYPE_SIMOPEN:3}),j=a({SENDONLY:0,SENDRECV:1,RECVONLY:2,INACTIVE:3}),k=a({AUDIO:0,VIDEO:1,DATA:2}),l=a({AUDIO:0,VIDEO:1,SCREEN:2}),m=a({AES_CM_128_HMAC_SHA1_80:0,AES_CM_128_HMAC_SHA1_32:1,F8_128_HMAC_SHA1_80:2,AEAD_AES_256_GCM:8}),n=a({RTP_SAVPF:0,DTLS_SCTP:1,SCTP:2}),o=a({URN_IETF_PARAMS_RTP_HDREXT_SSRC_AUDIO_LEVEL:0,URN_IETF_PARAMS_RTP_HDREXT_TOFFSET:1,IETF_DRAFT_HOLMER_RMCAT_TRANSPORT_WIDE_CC_01:2,URN_3GPP_VIDEO_ORIENTATION:3,ABS_SEND_TIME:4,PLAYOUT_DELAY:5,VIDEO_CONTENT_TYPE:6,VIDEO_TIMING:7,RTP_MID:8,RTP_STREAM_ID:9,RTP_REPAIRED_STREAM_ID:10,ENCRYPT_EXTENSIONS:11,FRAME_MARKING:12,GENERIC_FRAME_DESCRIPTOR:13,RTP_LOSS_INFO:14,RTP_CONGESTION_INFO:15,RTP_AUDIO_DROP_INFO:16,FRAME_ENCRYPTION_INFO:17,GENERIC_FRAME_DESCRIPTOR_01:18,DEPENDENCY_DESCRIPTOR:19,COLOR_SPACE:20,ABS_CAPTURE_TIME:21,VIDEO_FRAME_TRACKING_ID:22}),p=a({ISAC:0,SPEEX_ISAC_OBSOLETE:1,SPEEX:2,OPUS:3,PCMU_OBSOLETE:4,PCMA_OBSOLETE:5,CN:6,TELEPHONE_EVENT:7,VP8:8,RED:9,ULPFEC:10,H264:17,ISPX_WB_2:32,GOOGLE_DATA:33,AAC:36,AAC_LD:37,VP9:96,GOOGLE_SCTP_DATA:97,H265:98,RTX:99,FLEXFEC:100,MULTIPLEX:101,VIDEO_DATA:102,AV1:103}),q=a({SILENCEBIT_OBSOLETE:0,SPEEXUSEJITTERBIT_OBSOLETE:1,USEINBANDFEC:2,USEADAPTIVEFEC_OBSOLETE:3,EXTERNALBWE_OBSOLETE:4,FEC_BEI_OBSOLETE:5,ISPX_ADAPTIVE_FEC:6,CBR:7,USEDTX:8}),r=a({MINPTIME:0,MAXAVERAGEBITRATE:1,SPROP_STEREO:2,STEREO:3,MAXPTIME:4,PTIME:5,FEC_BEI_OBSOLETE:6,PORT:7,H264PROFILELEVELID:8,PACKETIZATION_MODE:9,LEVEL_ASYMMETRY_ALLOWED:10,APT:11,MAXPLAYBACKRATE:12,REPAIR_WINDOW:13,EMPTY_KEY:14}),s=a({CR_NONE:0,CR_ACTIVE:1,CR_PASSIVE:2,CR_ACTPASS:3,CR_HOLDCONN:4});a=a({EVENT_NONE:0,EVENT_MEDIA_CONNECTED:1});e.exports={CallEndReason:b,ClientReportedEventType:a,CodecName:p,CodecOption:r,CodecOptionBoolean:q,ConnectionRole:s,CryptoSuite:m,ExtmapUris:o,IceCandidateProtocolType:h,IceCandidateTcpType:i,IceCandidateTransport:g,MediaProtocol:n,MediaType:k,PayloadType:c,SdpNegotiateType:d,SendRecvMode:j,StreamType:l,UploadLogLevel:f}}),null);
__d("WebrtcSdpSerializers",["ThriftTypes","WebrtcEnumsTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{msid:"stream_label"}}function e(){return{id:""}}function f(){return{bwtype:"",bw:0}}function i(){return{numAudioChannels:1}}function j(){return{id:1,extensionAttributes:[]}}function k(){return{}}function l(){return{componentId:1,transport:d("WebrtcEnumsTypes").IceCandidateTransport.cast(0),generation:0}}function m(){return{port:1,protocol:d("WebrtcEnumsTypes").MediaProtocol.cast(0),sendRecvMode:d("WebrtcEnumsTypes").SendRecvMode.cast(1),hasRtcpMux:!0}}function n(){return{supportsMsid:!0}}function o(){return{}}function p(a,b){b.writeStructBegin("SsrcGroup");a.semantics!=null&&(b.writeFieldBegin({fname:"semantics",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.semantics),b.writeFieldEnd());if(a.ssrcIds!=null){b.writeFieldBegin({fname:"ssrcIds",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.I32,size:a.ssrcIds.length});for(a of a.ssrcIds)b.writeI32(a);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function q(a,b){b.writeStructBegin("SsrcObject");a.ssrcId!=null&&(b.writeFieldBegin({fname:"ssrcId",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1}),b.writeI32(a.ssrcId),b.writeFieldEnd());a.cname!=null&&(b.writeFieldBegin({fname:"cname",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.cname),b.writeFieldEnd());b.writeFieldBegin({fname:"msid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3});if(a.msid!=null)b.writeString(a.msid);else{var d="stream_label";b.writeString(d)}b.writeFieldEnd();a.msidAppData!=null&&(b.writeFieldBegin({fname:"msidAppData",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.msidAppData),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function r(a,b){b.writeStructBegin("RtcpFbVal");b.writeFieldBegin({fname:"id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.id!=null)b.writeString(a.id);else{var d="";b.writeString(d)}b.writeFieldEnd();a.param!=null&&(b.writeFieldBegin({fname:"param",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.param),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function s(a,b){b.writeStructBegin("Bandwidth");b.writeFieldBegin({fname:"bwtype",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.bwtype!=null)b.writeString(a.bwtype);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"bw",ftype:h.I32,fid:2});if(a.bw!=null)b.writeI32(a.bw);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function t(a,b){b.writeStructBegin("CodecDescription");a.payloadType!=null&&(b.writeFieldBegin({fname:"payloadType",ftype:(h||(h=c("ThriftTypes"))).BYTE,fid:1}),b.writeByte(a.payloadType),b.writeFieldEnd());if(a.encodingName!=null){var d;b.writeFieldBegin({fname:"encodingName",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});b.writeI32((d=a.encodingName)!=null?d:0);b.writeFieldEnd()}a.clockRateKhz!=null&&(b.writeFieldBegin({fname:"clockRateKhz",ftype:(h||(h=c("ThriftTypes"))).BYTE,fid:3}),b.writeByte(a.clockRateKhz),b.writeFieldEnd());b.writeFieldBegin({fname:"numAudioChannels",ftype:(h||(h=c("ThriftTypes"))).BYTE,fid:4});if(a.numAudioChannels!=null)b.writeByte(a.numAudioChannels);else{d=1;b.writeByte(d)}b.writeFieldEnd();if(a.fmtParameters!=null){b.writeFieldBegin({fname:"fmtParameters",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:5});b.writeMapBegin({ktype:h.I32,vtype:h.STRING,size:Object.keys(a.fmtParameters).length});for(d of Object.entries(a.fmtParameters)){var e=d[0],f=d[1];b.writeI32((e=Number(e))!=null?e:0);b.writeString(f)}b.writeMapEnd();b.writeFieldEnd()}if(a.enabledOptions!=null){b.writeFieldBegin({fname:"enabledOptions",ftype:(h||(h=c("ThriftTypes"))).SET,fid:6});b.writeSetBegin({etype:h.I32,size:a.enabledOptions.size});for(e of a.enabledOptions)b.writeI32(e!=null?e:0);b.writeSetEnd();b.writeFieldEnd()}if(a.rtcpFbParameters!=null){b.writeFieldBegin({fname:"rtcpFbParameters",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:7});b.writeMapBegin({ktype:h.STRING,vtype:h.STRING,size:Object.keys(a.rtcpFbParameters).length});for(f of Object.entries(a.rtcpFbParameters)){d=f[0];e=f[1];b.writeString(d);b.writeString(e)}b.writeMapEnd();b.writeFieldEnd()}if(a.rtcpFbParamList!=null){b.writeFieldBegin({fname:"rtcpFbParamList",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:10});b.writeListBegin({etype:h.STRUCT,size:a.rtcpFbParamList.length});for(d of a.rtcpFbParamList)r(d,b);b.writeListEnd();b.writeFieldEnd()}a.videoWidth!=null&&(b.writeFieldBegin({fname:"videoWidth",ftype:(h||(h=c("ThriftTypes"))).I32,fid:8}),b.writeI32(a.videoWidth),b.writeFieldEnd());a.videoHeight!=null&&(b.writeFieldBegin({fname:"videoHeight",ftype:(h||(h=c("ThriftTypes"))).I32,fid:9}),b.writeI32(a.videoHeight),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function u(a,b){b.writeStructBegin("Extmap");b.writeFieldBegin({fname:"id",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.id!=null)b.writeI32(a.id);else{var d=1;b.writeI32(d)}b.writeFieldEnd();if(a.uri!=null){b.writeFieldBegin({fname:"uri",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});b.writeI32((d=a.uri)!=null?d:0);b.writeFieldEnd()}b.writeFieldBegin({fname:"extensionAttributes",ftype:h.LIST,fid:3});if(a.extensionAttributes!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).I32,size:a.extensionAttributes.length});for(d of a.extensionAttributes)b.writeI32(d!=null?d:0);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).I32,size:a.length});for(d of a)b.writeI32(d!=null?d:0);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function v(a,b){b.writeStructBegin("CryptoParam");a.tag!=null&&(b.writeFieldBegin({fname:"tag",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1}),b.writeI32(a.tag),b.writeFieldEnd());if(a.suite!=null){var d;b.writeFieldBegin({fname:"suite",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});b.writeI32((d=a.suite)!=null?d:0);b.writeFieldEnd()}a.keyParams!=null&&(b.writeFieldBegin({fname:"keyParams",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.keyParams),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function w(a,b){b.writeStructBegin("IceCandidateSdp");a.foundation!=null&&(b.writeFieldBegin({fname:"foundation",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.foundation),b.writeFieldEnd());b.writeFieldBegin({fname:"componentId",ftype:(h||(h=c("ThriftTypes"))).BYTE,fid:2});if(a.componentId!=null)b.writeByte(a.componentId);else{var e=1;b.writeByte(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"transport",ftype:h.I32,fid:3});if(a.transport!=null){b.writeI32((e=a.transport)!=null?e:0)}else{e=d("WebrtcEnumsTypes").IceCandidateTransport.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.priority!=null&&(b.writeFieldBegin({fname:"priority",ftype:(h||(h=c("ThriftTypes"))).I32,fid:4}),b.writeI32(a.priority),b.writeFieldEnd());a.address!=null&&(b.writeFieldBegin({fname:"address",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.address),b.writeFieldEnd());a.port!=null&&(b.writeFieldBegin({fname:"port",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6}),b.writeI32(a.port),b.writeFieldEnd());if(a.protocolType!=null){b.writeFieldBegin({fname:"protocolType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:7});b.writeI32((e=a.protocolType)!=null?e:0);b.writeFieldEnd()}a.relatedAddress!=null&&(b.writeFieldBegin({fname:"relatedAddress",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:8}),b.writeString(a.relatedAddress),b.writeFieldEnd());a.relatedPort!=null&&(b.writeFieldBegin({fname:"relatedPort",ftype:(h||(h=c("ThriftTypes"))).I32,fid:9}),b.writeI32(a.relatedPort),b.writeFieldEnd());a.username!=null&&(b.writeFieldBegin({fname:"username",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:10}),b.writeString(a.username),b.writeFieldEnd());a.password!=null&&(b.writeFieldBegin({fname:"password",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:11}),b.writeString(a.password),b.writeFieldEnd());b.writeFieldBegin({fname:"generation",ftype:h.I32,fid:12});if(a.generation!=null)b.writeI32(a.generation);else{e=0;b.writeI32(e)}b.writeFieldEnd();if(a.tcptype!=null){b.writeFieldBegin({fname:"tcptype",ftype:(h||(h=c("ThriftTypes"))).I32,fid:13});b.writeI32((e=a.tcptype)!=null?e:0);b.writeFieldEnd()}a.networkId!=null&&(b.writeFieldBegin({fname:"networkId",ftype:(h||(h=c("ThriftTypes"))).I16,fid:14}),b.writeI16(a.networkId),b.writeFieldEnd());a.networkCost!=null&&(b.writeFieldBegin({fname:"networkCost",ftype:(h||(h=c("ThriftTypes"))).I16,fid:15}),b.writeI16(a.networkCost),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function x(a,b){b.writeStructBegin("MediaDescription");if(a.mediaType!=null){var e;b.writeFieldBegin({fname:"mediaType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((e=a.mediaType)!=null?e:0);b.writeFieldEnd()}b.writeFieldBegin({fname:"port",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});if(a.port!=null)b.writeI32(a.port);else{e=1;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"protocol",ftype:h.I32,fid:3});if(a.protocol!=null){b.writeI32((e=a.protocol)!=null?e:0)}else{e=d("WebrtcEnumsTypes").MediaProtocol.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.fmt!=null&&(b.writeFieldBegin({fname:"fmt",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:22}),b.writeString(a.fmt),b.writeFieldEnd());a.mediaIceUserFrag!=null&&(b.writeFieldBegin({fname:"mediaIceUserFrag",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.mediaIceUserFrag),b.writeFieldEnd());a.mediaIcePassword!=null&&(b.writeFieldBegin({fname:"mediaIcePassword",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.mediaIcePassword),b.writeFieldEnd());if(a.mediaIceOptions!=null){b.writeFieldBegin({fname:"mediaIceOptions",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:6});b.writeListBegin({etype:h.STRING,size:a.mediaIceOptions.length});for(e of a.mediaIceOptions)b.writeString(e);b.writeListEnd();b.writeFieldEnd()}a.mediaSslFingerprintHash!=null&&(b.writeFieldBegin({fname:"mediaSslFingerprintHash",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:7}),b.writeString(a.mediaSslFingerprintHash),b.writeFieldEnd());a.mediaSslFingerprintDigest!=null&&(b.writeFieldBegin({fname:"mediaSslFingerprintDigest",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:8}),b.writeString(a.mediaSslFingerprintDigest),b.writeFieldEnd());if(a.extmaps!=null){b.writeFieldBegin({fname:"extmaps",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:9});b.writeListBegin({etype:h.STRUCT,size:a.extmaps.length});for(e of a.extmaps)u(e,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldBegin({fname:"sendRecvMode",ftype:h.I32,fid:10});if(a.sendRecvMode!=null){b.writeI32((e=a.sendRecvMode)!=null?e:0)}else{e=d("WebrtcEnumsTypes").SendRecvMode.cast(1);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"hasRtcpMux",ftype:h.BOOL,fid:11});if(a.hasRtcpMux!=null)b.writeBool(a.hasRtcpMux);else{e=!0;b.writeBool(e)}b.writeFieldEnd();a.rtcpReducedSize!=null&&(b.writeFieldBegin({fname:"rtcpReducedSize",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:25}),b.writeBool(a.rtcpReducedSize),b.writeFieldEnd());if(a.cryptoParams!=null){b.writeFieldBegin({fname:"cryptoParams",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:12});b.writeListBegin({etype:h.STRUCT,size:a.cryptoParams.length});for(e of a.cryptoParams)v(e,b);b.writeListEnd();b.writeFieldEnd()}if(a.codecs!=null){b.writeFieldBegin({fname:"codecs",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:13});b.writeListBegin({etype:h.STRUCT,size:a.codecs.length});for(e of a.codecs)t(e,b);b.writeListEnd();b.writeFieldEnd()}a.maxPTime!=null&&(b.writeFieldBegin({fname:"maxPTime",ftype:(h||(h=c("ThriftTypes"))).I32,fid:14}),b.writeI32(a.maxPTime),b.writeFieldEnd());a.pTime!=null&&(b.writeFieldBegin({fname:"pTime",ftype:(h||(h=c("ThriftTypes"))).I32,fid:15}),b.writeI32(a.pTime),b.writeFieldEnd());if(a.ssrcObjects!=null){b.writeFieldBegin({fname:"ssrcObjects",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:16});b.writeListBegin({etype:h.STRUCT,size:a.ssrcObjects.length});for(e of a.ssrcObjects)q(e,b);b.writeListEnd();b.writeFieldEnd()}if(a.candidates!=null){b.writeFieldBegin({fname:"candidates",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:17});b.writeListBegin({etype:h.STRUCT,size:a.candidates.length});for(e of a.candidates)w(e,b);b.writeListEnd();b.writeFieldEnd()}a.conferenceMode!=null&&(b.writeFieldBegin({fname:"conferenceMode",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:18}),b.writeBool(a.conferenceMode),b.writeFieldEnd());if(a.ssrcGroups!=null){b.writeFieldBegin({fname:"ssrcGroups",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:19});b.writeListBegin({etype:h.STRUCT,size:a.ssrcGroups.length});for(e of a.ssrcGroups)p(e,b);b.writeListEnd();b.writeFieldEnd()}if(a.connectionRole!=null){b.writeFieldBegin({fname:"connectionRole",ftype:(h||(h=c("ThriftTypes"))).I32,fid:20});b.writeI32((e=a.connectionRole)!=null?e:0);b.writeFieldEnd()}a.mid!=null&&(b.writeFieldBegin({fname:"mid",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:21}),b.writeString(a.mid),b.writeFieldEnd());a.bandwidth!=null&&(b.writeFieldBegin({fname:"bandwidth",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:23}),s(a.bandwidth,b),b.writeFieldEnd());a.sctpPort!=null&&(b.writeFieldBegin({fname:"sctpPort",ftype:(h||(h=c("ThriftTypes"))).I32,fid:24}),b.writeI32(a.sctpPort),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function y(a,b){b.writeStructBegin("SessionDescription");a.sessionId!=null&&(b.writeFieldBegin({fname:"sessionId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.sessionId),b.writeFieldEnd());a.sessionVersion!=null&&(b.writeFieldBegin({fname:"sessionVersion",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.sessionVersion),b.writeFieldEnd());b.writeFieldBegin({fname:"supportsMsid",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:3});if(a.supportsMsid!=null)b.writeBool(a.supportsMsid);else{var d=!0;b.writeBool(d)}b.writeFieldEnd();a.useIceLite!=null&&(b.writeFieldBegin({fname:"useIceLite",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:4}),b.writeBool(a.useIceLite),b.writeFieldEnd());if(a.features!=null){b.writeFieldBegin({fname:"features",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:5});b.writeListBegin({etype:h.STRING,size:a.features.length});for(d of a.features)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}if(a.connectionRole!=null){b.writeFieldBegin({fname:"connectionRole",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6});b.writeI32((d=a.connectionRole)!=null?d:0);b.writeFieldEnd()}a.bandwidth!=null&&(b.writeFieldBegin({fname:"bandwidth",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7}),s(a.bandwidth,b),b.writeFieldEnd());if(a.transportBundle!=null){b.writeFieldBegin({fname:"transportBundle",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:8});b.writeListBegin({etype:h.STRING,size:a.transportBundle.length});for(d of a.transportBundle)b.writeString(d);b.writeListEnd();b.writeFieldEnd()}if(a.commonCryptos!=null){b.writeFieldBegin({fname:"commonCryptos",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:9});b.writeListBegin({etype:h.STRUCT,size:a.commonCryptos.length});for(d of a.commonCryptos)v(d,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function z(a,b){b.writeStructBegin("Sdp");a.sessionDescription!=null&&(b.writeFieldBegin({fname:"sessionDescription",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),y(a.sessionDescription,b),b.writeFieldEnd());if(a.mediaDescriptions!=null){b.writeFieldBegin({fname:"mediaDescriptions",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.mediaDescriptions.length});for(a of a.mediaDescriptions)x(a,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function A(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.semantics=a.readString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.ssrcIds=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI32();b.ssrcIds.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function B(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I32?b.ssrcId=a.readI32():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.cname=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.msid=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.msidAppData=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.msid===void 0&&(b.msid="stream_label");return b}function C(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.id=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.param=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.id===void 0&&(b.id="");return b}function D(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.bwtype=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I32?b.bw=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.bwtype===void 0&&(b.bwtype="");b.bw===void 0&&(b.bw=0);return b}function E(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).BYTE?b.payloadType=a.readByte():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.encodingName=d("WebrtcEnumsTypes").CodecName.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).BYTE?b.clockRateKhz=a.readByte():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).BYTE?b.numAudioChannels=a.readByte():a.skip(f);break;case 5:if(f===(h||(h=c("ThriftTypes"))).MAP){b.fmtParameters={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=d("WebrtcEnumsTypes").CodecOption.cast(a.readI32()),j=a.readString();i!=null&&(b.fmtParameters[i]=j)}}else a.skip(f);break;case 6:if(f===(h||(h=c("ThriftTypes"))).SET){b.enabledOptions=new Set();i=a.readSetBegin();for(j=0;j<i.size;j++){g=d("WebrtcEnumsTypes").CodecOptionBoolean.cast(a.readI32());b.enabledOptions.add(g)}}else a.skip(f);break;case 7:if(f===(h||(h=c("ThriftTypes"))).MAP){b.rtcpFbParameters={};e=a.readMapBegin();for(g=0;g<e.size;g++){j=a.readString();i=a.readString();b.rtcpFbParameters[j]=i}}else a.skip(f);break;case 10:if(f===(h||(h=c("ThriftTypes"))).LIST){b.rtcpFbParamList=[];j=a.readListBegin();for(i=0;i<j.size;i++){g=C(a);b.rtcpFbParamList.push(g)}}else a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).I32?b.videoWidth=a.readI32():a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).I32?b.videoHeight=a.readI32():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.numAudioChannels===void 0&&(b.numAudioChannels=1);return b}function F(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.id=a.readI32():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.uri=d("WebrtcEnumsTypes").ExtmapUris.cast(a.readI32()):a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).LIST){b.extensionAttributes=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("WebrtcEnumsTypes").ExtmapUris.cast(a.readI32());b.extensionAttributes.push(i)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.id===void 0&&(b.id=1);b.extensionAttributes===void 0&&(b.extensionAttributes=[]);return b}function G(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.tag=a.readI32():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.suite=d("WebrtcEnumsTypes").CryptoSuite.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.keyParams=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function H(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.foundation=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).BYTE?b.componentId=a.readByte():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.transport=d("WebrtcEnumsTypes").IceCandidateTransport.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.priority=a.readI32():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.address=a.readString():a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.port=a.readI32():a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).I32?b.protocolType=d("WebrtcEnumsTypes").IceCandidateProtocolType.cast(a.readI32()):a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).STRING?b.relatedAddress=a.readString():a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).I32?b.relatedPort=a.readI32():a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).STRING?b.username=a.readString():a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).STRING?b.password=a.readString():a.skip(f);break;case 12:f===(h||(h=c("ThriftTypes"))).I32?b.generation=a.readI32():a.skip(f);break;case 13:f===(h||(h=c("ThriftTypes"))).I32?b.tcptype=d("WebrtcEnumsTypes").IceCandidateTcpType.cast(a.readI32()):a.skip(f);break;case 14:f===(h||(h=c("ThriftTypes"))).I16?b.networkId=a.readI16():a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).I16?b.networkCost=a.readI16():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.componentId===void 0&&(b.componentId=1);b.transport===void 0&&(b.transport=d("WebrtcEnumsTypes").IceCandidateTransport.cast(0));b.generation===void 0&&(b.generation=0);return b}function I(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.mediaType=d("WebrtcEnumsTypes").MediaType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.port=a.readI32():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.protocol=d("WebrtcEnumsTypes").MediaProtocol.cast(a.readI32()):a.skip(f);break;case 22:f===(h||(h=c("ThriftTypes"))).STRING?b.fmt=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.mediaIceUserFrag=a.readString():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.mediaIcePassword=a.readString():a.skip(f);break;case 6:if(f===(h||(h=c("ThriftTypes"))).LIST){b.mediaIceOptions=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.mediaIceOptions.push(i)}}else a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRING?b.mediaSslFingerprintHash=a.readString():a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).STRING?b.mediaSslFingerprintDigest=a.readString():a.skip(f);break;case 9:if(f===(h||(h=c("ThriftTypes"))).LIST){b.extmaps=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=F(a);b.extmaps.push(e)}}else a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).I32?b.sendRecvMode=d("WebrtcEnumsTypes").SendRecvMode.cast(a.readI32()):a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).BOOL?b.hasRtcpMux=a.readBool():a.skip(f);break;case 25:f===(h||(h=c("ThriftTypes"))).BOOL?b.rtcpReducedSize=a.readBool():a.skip(f);break;case 12:if(f===(h||(h=c("ThriftTypes"))).LIST){b.cryptoParams=[];e=a.readListBegin();for(g=0;g<e.size;g++){i=G(a);b.cryptoParams.push(i)}}else a.skip(f);break;case 13:if(f===(h||(h=c("ThriftTypes"))).LIST){b.codecs=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=E(a);b.codecs.push(e)}}else a.skip(f);break;case 14:f===(h||(h=c("ThriftTypes"))).I32?b.maxPTime=a.readI32():a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).I32?b.pTime=a.readI32():a.skip(f);break;case 16:if(f===(h||(h=c("ThriftTypes"))).LIST){b.ssrcObjects=[];e=a.readListBegin();for(g=0;g<e.size;g++){i=B(a);b.ssrcObjects.push(i)}}else a.skip(f);break;case 17:if(f===(h||(h=c("ThriftTypes"))).LIST){b.candidates=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=H(a);b.candidates.push(e)}}else a.skip(f);break;case 18:f===(h||(h=c("ThriftTypes"))).BOOL?b.conferenceMode=a.readBool():a.skip(f);break;case 19:if(f===(h||(h=c("ThriftTypes"))).LIST){b.ssrcGroups=[];e=a.readListBegin();for(g=0;g<e.size;g++){i=A(a);b.ssrcGroups.push(i)}}else a.skip(f);break;case 20:f===(h||(h=c("ThriftTypes"))).I32?b.connectionRole=d("WebrtcEnumsTypes").ConnectionRole.cast(a.readI32()):a.skip(f);break;case 21:f===(h||(h=c("ThriftTypes"))).STRING?b.mid=a.readString():a.skip(f);break;case 23:f===(h||(h=c("ThriftTypes"))).STRUCT?b.bandwidth=D(a):a.skip(f);break;case 24:f===(h||(h=c("ThriftTypes"))).I32?b.sctpPort=a.readI32():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.port===void 0&&(b.port=1);b.protocol===void 0&&(b.protocol=d("WebrtcEnumsTypes").MediaProtocol.cast(0));b.sendRecvMode===void 0&&(b.sendRecvMode=d("WebrtcEnumsTypes").SendRecvMode.cast(1));b.hasRtcpMux===void 0&&(b.hasRtcpMux=!0);return b}function J(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.sessionId=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.sessionVersion=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).BOOL?b.supportsMsid=a.readBool():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).BOOL?b.useIceLite=a.readBool():a.skip(f);break;case 5:if(f===(h||(h=c("ThriftTypes"))).LIST){b.features=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.features.push(i)}}else a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.connectionRole=d("WebrtcEnumsTypes").ConnectionRole.cast(a.readI32()):a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRUCT?b.bandwidth=D(a):a.skip(f);break;case 8:if(f===(h||(h=c("ThriftTypes"))).LIST){b.transportBundle=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=a.readString();b.transportBundle.push(e)}}else a.skip(f);break;case 9:if(f===(h||(h=c("ThriftTypes"))).LIST){b.commonCryptos=[];e=a.readListBegin();for(g=0;g<e.size;g++){i=G(a);b.commonCryptos.push(i)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.supportsMsid===void 0&&(b.supportsMsid=!0);return b}function K(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.sessionDescription=J(a):a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.mediaDescriptions=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=I(a);b.mediaDescriptions.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}g.SsrcGroup$DefaultConstructor=a;g.SsrcObject$DefaultConstructor=b;g.RtcpFbVal$DefaultConstructor=e;g.Bandwidth$DefaultConstructor=f;g.CodecDescription$DefaultConstructor=i;g.Extmap$DefaultConstructor=j;g.CryptoParam$DefaultConstructor=k;g.IceCandidateSdp$DefaultConstructor=l;g.MediaDescription$DefaultConstructor=m;g.SessionDescription$DefaultConstructor=n;g.Sdp$DefaultConstructor=o;g.serializeSsrcGroup=p;g.serializeSsrcObject=q;g.serializeRtcpFbVal=r;g.serializeBandwidth=s;g.serializeCodecDescription=t;g.serializeExtmap=u;g.serializeCryptoParam=v;g.serializeIceCandidateSdp=w;g.serializeMediaDescription=x;g.serializeSessionDescription=y;g.serializeSdp=z;g.deserializeSsrcGroup=A;g.deserializeSsrcObject=B;g.deserializeRtcpFbVal=C;g.deserializeBandwidth=D;g.deserializeCodecDescription=E;g.deserializeExtmap=F;g.deserializeCryptoParam=G;g.deserializeIceCandidateSdp=H;g.deserializeMediaDescription=I;g.deserializeSessionDescription=J;g.deserializeSdp=K}),98);
__d("MultiwayCommonSerializers",["DataMessageSerializers","DataMessageTypes","MultiwayCommonTypes","MultiwaySharedSerializers","MultiwaySharedTypes","StateSyncSerializers","StateSyncTopicsConfigTypes","ThriftTypes","Utf8ToString","WebrtcSdpSerializers","WebrtcSignalingCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a;return{message:"",responseStatusCode:(a=d("MultiwayCommonTypes")).RtcResponseStatusCode.cast(0),responseSubCode:a.RtcResponseSubCode.cast(0),apiStatusCode:a.RtcApiStatusCode.cast(0),rtcLogSeverity:a.RtcLogSeverity.cast(0)}}function i(){return{}}function b(){return{media:{}}}function e(){return{body:"",msid:"",mid:""}}function f(){return{sourceKey:"",media:[],ssrcGroups:[]}}function j(){return{mediaStatus:{}}}function k(){return{sdpMLineIndex:"0",sdpMid:""}}function l(){return{stateStore:{},stateStoreV2:{}}}function aa(){return{version:0}}function ba(){return{encryptedTopic:"",encryptedData:Uint8Array.of(),senderId:Uint8Array.of(),messageType:d("MultiwayCommonTypes").E2eeDataMessageType.cast(0)}}function ca(){return{fromVersion:"0",toVersion:"0",mediaUpdates:[]}}function da(){return{currentVersion:"0",mediaPath:d("MultiwaySharedTypes").MediaPath.cast(0)}}function ea(){return{callerUserId:"",calleeUserId:"",sessionId:""}}function fa(){return{fromVersion:"0",toVersion:"0",mediaUpdates:[],renegotiationRequested:!1,multipleVideoStreamsAllowed:!1,mediaPath:d("MultiwaySharedTypes").MediaPath.cast(0),screenShareStreamAllowed:!1}}function ga(){return{currentVersion:"0"}}function ha(){return{}}function ia(){return{reason:d("MultiwayCommonTypes").HangupReason.cast(0),detailedReasonString:""}}function ja(){return{iceCandidateSdps:[]}}function ka(){return{reason:d("MultiwayCommonTypes").DismissReason.cast(0),detailedReasonString:""}}function la(){return{joinMode:d("MultiwayCommonTypes").JoinMode.cast(0)}}function ma(){return{state:d("MultiwayCommonTypes").ParticipantCallState.cast(0)}}function na(){return{}}function oa(){return{}}function pa(){return{}}function qa(){return{version:"0",participantStates:{},groupsOfUsers:[]}}function ra(){return{currentVersion:"0"}}function sa(){return{subscriptions:[]}}function ta(){return{message:d("DataMessageSerializers").DataMessage$DefaultConstructor()}}function ua(){return{deliveryResult:{}}}function va(){return{usersToInvite:new Set()}}function wa(){return{smcTier:"",region:"",isUsfu:!1,isEdge:!1}}function xa(){return{offer:i(),deviceCapabilities:new Set()}}function ya(){return{answer:i(),mediaStatus:{},initiator:"",isPendingApproval:!1,multipleVideoStreamsAllowed:!1,mediaPath:d("MultiwaySharedTypes").MediaPath.cast(0),groupsOfUsers:[],screenShareStreamAllowed:!1}}function za(){return{deviceCapabilities:new Set()}}function Aa(){return{}}function Ba(){return{type:d("MultiwayCommonTypes").ClientEventType.cast(0)}}function Ca(){return{clientEvents:[]}}function Da(){return{}}function Ea(){return{}}function Fa(){return{caller:"",otherParticipants:new Set(),ringType:d("MultiwayCommonTypes").RingType.cast(0),mediaPath:d("MultiwaySharedTypes").MediaPath.cast(0),isTransferCall:!1}}function Ga(){return{deviceStatus:d("MultiwayCommonTypes").DeviceStatus.cast(0)}}function Ha(){return{usersToRemove:new Set()}}function Ia(){return{topic:"",version:0,topicId:d("StateSyncTopicsConfigTypes").TopicId.cast(0)}}function Ja(){return{topic:"",version:0}}function Ka(){return{syncPayload:l(),topic:"",version:0,topicId:d("StateSyncTopicsConfigTypes").TopicId.cast(0)}}function La(){return{topic:"",version:0}}function Ma(){return{topic:"",version:0,data:Uint8Array.of()}}function Na(){return{topic:"",version:0}}function Oa(){return{approvalStatus:d("MultiwayCommonTypes").ApprovalStatus.cast(0),targetUsers:new Set()}}function Pa(){return{id:""}}function Qa(){return{actorId:"",baseId:""}}function m(){return{type:d("MultiwayCommonTypes").MessageType.cast(0),conferenceName:"",transactionId:"",retryCount:0}}function n(){return{}}function Ra(){return{messageHeader:m(),messageBody:n()}}function Sa(){return{users:new Set(),allowMultipleJoins:!1,dismissOthersOnFirstJoin:!1,aliasId:""}}function Ta(){return{}}function Ua(a,b){b.writeStructBegin("RtcException");b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.message!=null)b.writeString(a.message);else{var e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"responseStatusCode",ftype:h.I32,fid:2});if(a.responseStatusCode!=null){b.writeI32((e=a.responseStatusCode)!=null?e:0)}else{e=d("MultiwayCommonTypes").RtcResponseStatusCode.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"responseSubCode",ftype:h.I32,fid:3});if(a.responseSubCode!=null){b.writeI32((e=a.responseSubCode)!=null?e:0)}else{e=d("MultiwayCommonTypes").RtcResponseSubCode.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"apiStatusCode",ftype:h.I32,fid:4});if(a.apiStatusCode!=null){b.writeI32((e=a.apiStatusCode)!=null?e:0)}else{e=d("MultiwayCommonTypes").RtcApiStatusCode.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"rtcLogSeverity",ftype:h.I32,fid:5});if(a.rtcLogSeverity!=null){b.writeI32((e=a.rtcLogSeverity)!=null?e:0)}else{a=d("MultiwayCommonTypes").RtcLogSeverity.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function o(a,b){b.writeStructBegin("SessionDescription"),a.sdpString!=null&&(b.writeFieldBegin({fname:"sdpString",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.sdpString),b.writeFieldEnd()),a.sdpThrift!=null&&(b.writeFieldBegin({fname:"sdpThrift",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),d("WebrtcSdpSerializers").serializeSdp(a.sdpThrift,b),b.writeFieldEnd()),a.sdpCompressionVersion!=null&&(b.writeFieldBegin({fname:"sdpCompressionVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.sdpCompressionVersion)),b.writeFieldEnd()),a.sdpCompressedData!=null&&(b.writeFieldBegin({fname:"sdpCompressedData",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.sdpCompressedData),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function Va(a,b){b.writeStructBegin("SessionDescriptionUpdate");b.writeFieldBegin({fname:"media",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.media!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(a.media).length});for(a of Object.entries(a.media)){var d=a[0],e=a[1];b.writeI32(Number(d));p(e,b)}b.writeMapEnd()}else{d={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(d).length});for(e of Object.entries(d)){a=e[0];d=e[1];b.writeI32(Number(a));p(d,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function p(a,b){b.writeStructBegin("MediaDescriptionUpdate");b.writeFieldBegin({fname:"body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.body!=null)b.writeString(a.body);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"msid",ftype:h.STRING,fid:2});if(a.msid!=null)b.writeString(a.msid);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"mid",ftype:h.STRING,fid:3});if(a.mid!=null)b.writeString(a.mid);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function q(a,b){b.writeStructBegin("ServerMediaUpdate");b.writeFieldBegin({fname:"sourceKey",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.sourceKey!=null)b.writeString(a.sourceKey);else{var e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"media",ftype:h.LIST,fid:2});if(a.media!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.media.length});for(e of a.media)d("MultiwaySharedSerializers").serializeMedia(e,b);b.writeListEnd()}else{e=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:e.length});for(e of e)d("MultiwaySharedSerializers").serializeMedia(e,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"ssrcGroups",ftype:h.LIST,fid:3});if(a.ssrcGroups!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.ssrcGroups.length});for(e of a.ssrcGroups)d("MultiwaySharedSerializers").serializeSsrcGroup(e,b);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.length});for(e of a)d("MultiwaySharedSerializers").serializeSsrcGroup(e,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function r(a,b){b.writeStructBegin("ClientMediaUpdate");b.writeFieldBegin({fname:"mediaStatus",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.mediaStatus!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.BOOL,size:Object.keys(a.mediaStatus).length});for(var e of Object.entries(a.mediaStatus)){var f=e[0],g=e[1];b.writeString(f);b.writeBool(g)}b.writeMapEnd()}else{f={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.BOOL,size:Object.keys(f).length});for(g of Object.entries(f)){e=g[0];f=g[1];b.writeString(e);b.writeBool(f)}b.writeMapEnd()}b.writeFieldEnd();a.mediaStatusEx!=null&&(b.writeFieldBegin({fname:"mediaStatusEx",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatusEx,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function s(a,b){b.writeStructBegin("IceCandidate");a.candidateSdpString!=null&&(b.writeFieldBegin({fname:"candidateSdpString",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.candidateSdpString),b.writeFieldEnd());b.writeFieldBegin({fname:"sdpMLineIndex",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2});if(a.sdpMLineIndex!=null)b.writeI64(BigInt(a.sdpMLineIndex));else{var e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"sdpMid",ftype:h.STRING,fid:3});if(a.sdpMid!=null)b.writeString(a.sdpMid);else{e="";b.writeString(e)}b.writeFieldEnd();a.candidateSdpThrift!=null&&(b.writeFieldBegin({fname:"candidateSdpThrift",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),d("WebrtcSdpSerializers").serializeIceCandidateSdp(a.candidateSdpThrift,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function t(a,b){b.writeStructBegin("SyncPayload");b.writeFieldBegin({fname:"stateStore",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.stateStore!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(a.stateStore).length});for(var e of Object.entries(a.stateStore)){var f=e[0],g=e[1];b.writeString(f);d("StateSyncSerializers").serializeState(g,b)}b.writeMapEnd()}else{f={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(f).length});for(g of Object.entries(f)){e=g[0];f=g[1];b.writeString(e);d("StateSyncSerializers").serializeState(f,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"stateStoreV2",ftype:h.MAP,fid:4});if(a.stateStoreV2!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(a.stateStoreV2).length});for(e of Object.entries(a.stateStoreV2)){f=e[0];g=e[1];b.writeI32((a=Number(f))!=null?a:0);d("StateSyncSerializers").serializeState(g,b)}b.writeMapEnd()}else{f={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).I32,vtype:h.STRUCT,size:Object.keys(f).length});for(a of Object.entries(f)){g=a[0];e=a[1];b.writeI32((f=Number(g))!=null?f:0);d("StateSyncSerializers").serializeState(e,b)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function Wa(a,b){b.writeStructBegin("SyncAck");b.writeFieldBegin({fname:"version",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.version!=null)b.writeI32(a.version);else{a=0;b.writeI32(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function Xa(a,b){b.writeStructBegin("E2eeData");b.writeFieldBegin({fname:"encryptedTopic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.encryptedTopic!=null)b.writeString(a.encryptedTopic);else{var e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"encryptedData",ftype:h.STRING,fid:2});if(a.encryptedData!=null)b.writeBinary(a.encryptedData);else{e=Uint8Array.of();b.writeBinary(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"senderId",ftype:h.STRING,fid:3});if(a.senderId!=null)b.writeBinary(a.senderId);else{e=Uint8Array.of();b.writeBinary(e)}b.writeFieldEnd();if(a.targetIds!=null){b.writeFieldBegin({fname:"targetIds",ftype:(h||(h=c("ThriftTypes"))).SET,fid:4});b.writeSetBegin({etype:h.STRING,size:a.targetIds.size});for(e of a.targetIds)b.writeBinary(e);b.writeSetEnd();b.writeFieldEnd()}b.writeFieldBegin({fname:"messageType",ftype:h.I32,fid:5});if(a.messageType!=null){b.writeI32((e=a.messageType)!=null?e:0)}else{a=d("MultiwayCommonTypes").E2eeDataMessageType.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function u(a,b){b.writeStructBegin("ClientMediaUpdateRequest");b.writeFieldBegin({fname:"fromVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.fromVersion!=null)b.writeI64(BigInt(a.fromVersion));else{var d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"toVersion",ftype:h.I64,fid:2});if(a.toVersion!=null)b.writeI64(BigInt(a.toVersion));else{d="0";b.writeI64(BigInt(d))}b.writeFieldEnd();b.writeFieldBegin({fname:"mediaUpdates",ftype:h.LIST,fid:3});if(a.mediaUpdates!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.mediaUpdates.length});for(d of a.mediaUpdates)r(d,b);b.writeListEnd()}else{d=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:d.length});for(d of d)r(d,b);b.writeListEnd()}b.writeFieldEnd();a.offer!=null&&(b.writeFieldBegin({fname:"offer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),o(a.offer,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function v(a,b){b.writeStructBegin("ClientMediaUpdateResponse");b.writeFieldBegin({fname:"currentVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.currentVersion!=null)b.writeI64(BigInt(a.currentVersion));else{var e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();a.answer!=null&&(b.writeFieldBegin({fname:"answer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),o(a.answer,b),b.writeFieldEnd());a.mediaStatus!=null&&(b.writeFieldBegin({fname:"mediaStatus",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatus,b),b.writeFieldEnd());a.sdpOriginLocalId!=null&&(b.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.sdpOriginLocalId),b.writeFieldEnd());a.renegotiationOffer!=null&&(b.writeFieldBegin({fname:"renegotiationOffer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),o(a.renegotiationOffer,b),b.writeFieldEnd());b.writeFieldBegin({fname:"mediaPath",ftype:h.I32,fid:6});if(a.mediaPath!=null){b.writeI32((e=a.mediaPath)!=null?e:0)}else{e=d("MultiwaySharedTypes").MediaPath.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();if(a.stateStore!=null){b.writeFieldBegin({fname:"stateStore",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:7});b.writeMapBegin({ktype:h.STRING,vtype:h.STRUCT,size:Object.keys(a.stateStore).length});for(e of Object.entries(a.stateStore)){var f=e[0],g=e[1];b.writeString(f);d("StateSyncSerializers").serializeState(g,b)}b.writeMapEnd();b.writeFieldEnd()}if(a.stateStoreV2!=null){b.writeFieldBegin({fname:"stateStoreV2",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:8});b.writeMapBegin({ktype:h.I32,vtype:h.STRUCT,size:Object.keys(a.stateStoreV2).length});for(f of Object.entries(a.stateStoreV2)){g=f[0];e=f[1];b.writeI32((a=Number(g))!=null?a:0);d("StateSyncSerializers").serializeState(e,b)}b.writeMapEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function Ya(a,b){b.writeStructBegin("MultipleRelaysAllocationParameters");b.writeFieldBegin({fname:"callerUserId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.callerUserId!=null)b.writeString(a.callerUserId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"calleeUserId",ftype:h.STRING,fid:2});if(a.calleeUserId!=null)b.writeString(a.calleeUserId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"sessionId",ftype:h.STRING,fid:3});if(a.sessionId!=null)b.writeString(a.sessionId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function w(a,b){b.writeStructBegin("ServerMediaUpdateRequest");b.writeFieldBegin({fname:"fromVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.fromVersion!=null)b.writeI64(BigInt(a.fromVersion));else{var e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"toVersion",ftype:h.I64,fid:2});if(a.toVersion!=null)b.writeI64(BigInt(a.toVersion));else{e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"mediaUpdates",ftype:h.LIST,fid:3});if(a.mediaUpdates!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.mediaUpdates.length});for(e of a.mediaUpdates)q(e,b);b.writeListEnd()}else{e=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:e.length});for(e of e)q(e,b);b.writeListEnd()}b.writeFieldEnd();a.offer!=null&&(b.writeFieldBegin({fname:"offer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),o(a.offer,b),b.writeFieldEnd());a.answer!=null&&(b.writeFieldBegin({fname:"answer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),o(a.answer,b),b.writeFieldEnd());a.mediaStatus!=null&&(b.writeFieldBegin({fname:"mediaStatus",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatus,b),b.writeFieldEnd());b.writeFieldBegin({fname:"renegotiationRequested",ftype:h.BOOL,fid:8});if(a.renegotiationRequested!=null)b.writeBool(a.renegotiationRequested);else{e=!1;b.writeBool(e)}b.writeFieldEnd();a.prAnswer!=null&&(b.writeFieldBegin({fname:"prAnswer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:9}),o(a.prAnswer,b),b.writeFieldEnd());if(a.stateStore!=null){b.writeFieldBegin({fname:"stateStore",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:10});b.writeMapBegin({ktype:h.STRING,vtype:h.STRUCT,size:Object.keys(a.stateStore).length});for(e of Object.entries(a.stateStore)){var f=e[0],g=e[1];b.writeString(f);d("StateSyncSerializers").serializeState(g,b)}b.writeMapEnd();b.writeFieldEnd()}a.sdpOriginLocalId!=null&&(b.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:11}),b.writeString(a.sdpOriginLocalId),b.writeFieldEnd());a.multipleRelaysParameters!=null&&(b.writeFieldBegin({fname:"multipleRelaysParameters",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:12}),Ya(a.multipleRelaysParameters,b),b.writeFieldEnd());b.writeFieldBegin({fname:"multipleVideoStreamsAllowed",ftype:h.BOOL,fid:13});if(a.multipleVideoStreamsAllowed!=null)b.writeBool(a.multipleVideoStreamsAllowed);else{f=!1;b.writeBool(f)}b.writeFieldEnd();a.renegotiationOffer!=null&&(b.writeFieldBegin({fname:"renegotiationOffer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:14}),o(a.renegotiationOffer,b),b.writeFieldEnd());b.writeFieldBegin({fname:"mediaPath",ftype:h.I32,fid:15});if(a.mediaPath!=null){b.writeI32((g=a.mediaPath)!=null?g:0)}else{e=d("MultiwaySharedTypes").MediaPath.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.update!=null&&(b.writeFieldBegin({fname:"update",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:16}),Va(a.update,b),b.writeFieldEnd());b.writeFieldBegin({fname:"screenShareStreamAllowed",ftype:h.BOOL,fid:17});if(a.screenShareStreamAllowed!=null)b.writeBool(a.screenShareStreamAllowed);else{f=!1;b.writeBool(f)}b.writeFieldEnd();if(a.stateStoreV2!=null){b.writeFieldBegin({fname:"stateStoreV2",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:18});b.writeMapBegin({ktype:h.I32,vtype:h.STRUCT,size:Object.keys(a.stateStoreV2).length});for(g of Object.entries(a.stateStoreV2)){e=g[0];f=g[1];b.writeI32((e=Number(e))!=null?e:0);d("StateSyncSerializers").serializeState(f,b)}b.writeMapEnd();b.writeFieldEnd()}if(a.allowedCustomVideoContentTypes!=null){b.writeFieldBegin({fname:"allowedCustomVideoContentTypes",ftype:(h||(h=c("ThriftTypes"))).SET,fid:19});b.writeSetBegin({etype:h.I32,size:a.allowedCustomVideoContentTypes.size});for(e of a.allowedCustomVideoContentTypes)b.writeI32(e!=null?e:0);b.writeSetEnd();b.writeFieldEnd()}a.relayInfo!=null&&(b.writeFieldBegin({fname:"relayInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:20}),d("MultiwaySharedSerializers").serializeRelayInfo(a.relayInfo,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function x(a,b){b.writeStructBegin("ServerMediaUpdateResponse");b.writeFieldBegin({fname:"currentVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.currentVersion!=null)b.writeI64(BigInt(a.currentVersion));else{var e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();a.answer!=null&&(b.writeFieldBegin({fname:"answer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),o(a.answer,b),b.writeFieldEnd());a.mediaStatus!=null&&(b.writeFieldBegin({fname:"mediaStatus",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatus,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function y(a,b){b.writeStructBegin("TransferRequest"),b.writeFieldStop(),b.writeStructEnd()}function z(a,b){b.writeStructBegin("HangupRequest");b.writeFieldBegin({fname:"reason",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reason!=null){var e;b.writeI32((e=a.reason)!=null?e:0)}else{e=d("MultiwayCommonTypes").HangupReason.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"detailedReasonString",ftype:h.STRING,fid:2});if(a.detailedReasonString!=null)b.writeString(a.detailedReasonString);else{e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function A(a,b){b.writeStructBegin("IceCandidateRequest");b.writeFieldBegin({fname:"iceCandidateSdps",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});if(a.iceCandidateSdps!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.iceCandidateSdps.length});for(a of a.iceCandidateSdps)s(a,b);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.length});for(a of a)s(a,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function B(a,b){b.writeStructBegin("DismissRequest");b.writeFieldBegin({fname:"reason",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reason!=null){var e;b.writeI32((e=a.reason)!=null?e:0)}else{e=d("MultiwayCommonTypes").DismissReason.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"detailedReasonString",ftype:h.STRING,fid:2});if(a.detailedReasonString!=null)b.writeString(a.detailedReasonString);else{e="";b.writeString(e)}b.writeFieldEnd();a.callabilityResultErrorCode!=null&&(b.writeFieldBegin({fname:"callabilityResultErrorCode",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.callabilityResultErrorCode)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function Za(a,b){b.writeStructBegin("EndpointSettings");b.writeFieldBegin({fname:"joinMode",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.joinMode!=null){b.writeI32((a=a.joinMode)!=null?a:0)}else{a=d("MultiwayCommonTypes").JoinMode.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function C(a,b){b.writeStructBegin("ParticipantState");b.writeFieldBegin({fname:"state",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.state!=null){var e;b.writeI32((e=a.state)!=null?e:0)}else{e=d("MultiwayCommonTypes").ParticipantCallState.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.userCapabilities!=null&&(b.writeFieldBegin({fname:"userCapabilities",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.userCapabilities),b.writeFieldEnd());a.sctpNodeId!=null&&(b.writeFieldBegin({fname:"sctpNodeId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(BigInt(a.sctpNodeId)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function $a(a,b){b.writeStructBegin("ServerOnlyParticipantState"),a.userCountry!=null&&(b.writeFieldBegin({fname:"userCountry",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.userCountry),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function D(a,b){b.writeStructBegin("UserProfile"),a.name!=null&&(b.writeFieldBegin({fname:"name",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.name),b.writeFieldEnd()),a.profilePictureUri!=null&&(b.writeFieldBegin({fname:"profilePictureUri",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.profilePictureUri),b.writeFieldEnd()),a.aliasId!=null&&(b.writeFieldBegin({fname:"aliasId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.aliasId),b.writeFieldEnd()),a.thirdPartyId!=null&&(b.writeFieldBegin({fname:"thirdPartyId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.thirdPartyId),b.writeFieldEnd()),a.groupId!=null&&(b.writeFieldBegin({fname:"groupId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.groupId),b.writeFieldEnd()),a.avatarImageUri!=null&&(b.writeFieldBegin({fname:"avatarImageUri",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.avatarImageUri),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function ab(a,b){b.writeStructBegin("ProductMetadata"),a.callerInfo!=null&&(b.writeFieldBegin({fname:"callerInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),D(a.callerInfo,b),b.writeFieldEnd()),a.liveBroadcastId!=null&&(b.writeFieldBegin({fname:"liveBroadcastId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.liveBroadcastId),b.writeFieldEnd()),a.callingTags!=null&&(b.writeFieldBegin({fname:"callingTags",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3}),b.writeI32(a.callingTags),b.writeFieldEnd()),a.backingIdentifier!=null&&(b.writeFieldBegin({fname:"backingIdentifier",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.backingIdentifier),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function E(a,b){b.writeStructBegin("ConferenceStateRequest");b.writeFieldBegin({fname:"version",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.version!=null)b.writeI64(BigInt(a.version));else{var e="0";b.writeI64(BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"participantStates",ftype:h.MAP,fid:2});if(a.participantStates!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(a.participantStates).length});for(e of Object.entries(a.participantStates)){var f=e[0],g=e[1];b.writeString(f);C(g,b)}b.writeMapEnd()}else{f={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.STRUCT,size:Object.keys(f).length});for(g of Object.entries(f)){e=g[0];f=g[1];b.writeString(e);C(f,b)}b.writeMapEnd()}b.writeFieldEnd();if(a.userProfiles!=null){b.writeFieldBegin({fname:"userProfiles",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:3});b.writeMapBegin({ktype:h.STRING,vtype:h.STRUCT,size:Object.keys(a.userProfiles).length});for(e of Object.entries(a.userProfiles)){f=e[0];g=e[1];b.writeString(f);D(g,b)}b.writeMapEnd();b.writeFieldEnd()}if(a.appMessages!=null){b.writeFieldBegin({fname:"appMessages",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:4});b.writeListBegin({etype:h.STRUCT,size:a.appMessages.length});for(f of a.appMessages)d("DataMessageSerializers").serializeDataMessage(f,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldBegin({fname:"groupsOfUsers",ftype:h.LIST,fid:5});if(a.groupsOfUsers!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.groupsOfUsers.length});for(g of a.groupsOfUsers)Y(g,b);b.writeListEnd()}else{e=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:e.length});for(f of e)Y(f,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function F(a,b){b.writeStructBegin("ConferenceStateResponse");b.writeFieldBegin({fname:"currentVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.currentVersion!=null)b.writeI64(BigInt(a.currentVersion));else{a="0";b.writeI64(BigInt(a))}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function G(a,b){b.writeStructBegin("SubscriptionRequest");b.writeFieldBegin({fname:"subscriptions",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});if(a.subscriptions!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.subscriptions.length});for(a of a.subscriptions)d("MultiwaySharedSerializers").serializeSubscription(a,b);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.length});for(a of a)d("MultiwaySharedSerializers").serializeSubscription(a,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function H(a,b){b.writeStructBegin("DataMessageRequest");b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.message!=null)d("DataMessageSerializers").serializeDataMessage(a.message,b);else{a=d("DataMessageSerializers").DataMessage$DefaultConstructor();d("DataMessageSerializers").serializeDataMessage(a,b)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function I(a,b){b.writeStructBegin("DataMessageResponse");b.writeFieldBegin({fname:"deliveryResult",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:1});if(a.deliveryResult!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.I32,size:Object.keys(a.deliveryResult).length});for(var d of Object.entries(a.deliveryResult)){var e=d[0],f=d[1];b.writeString(e);b.writeI32(f!=null?f:0)}b.writeMapEnd()}else{e={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.I32,size:Object.keys(e).length});for(f of Object.entries(e)){d=f[0];e=f[1];b.writeString(d);b.writeI32(e!=null?e:0)}b.writeMapEnd()}b.writeFieldEnd();if(a.serviceTypeDeliveryResult!=null){b.writeFieldBegin({fname:"serviceTypeDeliveryResult",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:2});b.writeMapBegin({ktype:h.I32,vtype:h.I32,size:Object.keys(a.serviceTypeDeliveryResult).length});for(d of Object.entries(a.serviceTypeDeliveryResult)){e=d[0];f=d[1];b.writeI32((a=Number(e))!=null?a:0);b.writeI32(f!=null?f:0)}b.writeMapEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function J(a,b){b.writeStructBegin("AddParticipantsRequest");b.writeFieldBegin({fname:"usersToInvite",ftype:(h||(h=c("ThriftTypes"))).SET,fid:1});if(a.usersToInvite!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.usersToInvite.size});for(var e of a.usersToInvite)b.writeString(e);b.writeSetEnd()}else{e=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:e.size});for(e of e)b.writeString(e);b.writeSetEnd()}b.writeFieldEnd();if(a.appMessages!=null){b.writeFieldBegin({fname:"appMessages",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.appMessages.length});for(e of a.appMessages)d("DataMessageSerializers").serializeDataMessage(e,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function K(a,b){b.writeStructBegin("SfuAllocation");b.writeFieldBegin({fname:"smcTier",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.smcTier!=null)b.writeString(a.smcTier);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"region",ftype:h.STRING,fid:2});if(a.region!=null)b.writeString(a.region);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"isUsfu",ftype:h.BOOL,fid:3});if(a.isUsfu!=null)b.writeBool(a.isUsfu);else{d=!1;b.writeBool(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"isEdge",ftype:h.BOOL,fid:4});if(a.isEdge!=null)b.writeBool(a.isEdge);else{d=!1;b.writeBool(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function L(a,b){b.writeStructBegin("JoinRequest");b.writeFieldBegin({fname:"offer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.offer!=null)o(a.offer,b);else{var e=i();o(e,b)}b.writeFieldEnd();b.writeFieldBegin({fname:"deviceCapabilities",ftype:h.SET,fid:2});if(a.deviceCapabilities!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).I32,size:a.deviceCapabilities.size});for(e of a.deviceCapabilities)b.writeI32(e!=null?e:0);b.writeSetEnd()}else{e=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).I32,size:e.size});for(e of e)b.writeI32(e!=null?e:0);b.writeSetEnd()}b.writeFieldEnd();if(a.usersToCall!=null){b.writeFieldBegin({fname:"usersToCall",ftype:(h||(h=c("ThriftTypes"))).SET,fid:3});b.writeSetBegin({etype:h.STRING,size:a.usersToCall.size});for(e of a.usersToCall)b.writeString(e);b.writeSetEnd();b.writeFieldEnd()}if(a.mediaStatus!=null){b.writeFieldBegin({fname:"mediaStatus",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:4});b.writeMapBegin({ktype:h.STRING,vtype:h.BOOL,size:Object.keys(a.mediaStatus).length});for(e of Object.entries(a.mediaStatus)){var f=e[0],g=e[1];b.writeString(f);b.writeBool(g)}b.writeMapEnd();b.writeFieldEnd()}a.userCapabilities!=null&&(b.writeFieldBegin({fname:"userCapabilities",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeBinary(a.userCapabilities),b.writeFieldEnd());a.supportedExperiments!=null&&(b.writeFieldBegin({fname:"supportedExperiments",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:6}),b.writeString(a.supportedExperiments),b.writeFieldEnd());if(a.appMessages!=null){b.writeFieldBegin({fname:"appMessages",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:9});b.writeListBegin({etype:h.STRUCT,size:a.appMessages.length});for(f of a.appMessages)d("DataMessageSerializers").serializeDataMessage(f,b);b.writeListEnd();b.writeFieldEnd()}a.userToEscalate!=null&&(b.writeFieldBegin({fname:"userToEscalate",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:10}),b.writeString(a.userToEscalate),b.writeFieldEnd());a.escalatingCallId!=null&&(b.writeFieldBegin({fname:"escalatingCallId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:11}),b.writeI64(BigInt(a.escalatingCallId)),b.writeFieldEnd());if(a.conferenceType!=null){b.writeFieldBegin({fname:"conferenceType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:12});b.writeI32((g=a.conferenceType)!=null?g:0);b.writeFieldEnd()}a.mediaStatusEx!=null&&(b.writeFieldBegin({fname:"mediaStatusEx",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:13}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatusEx,b),b.writeFieldEnd());a.answer!=null&&(b.writeFieldBegin({fname:"answer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:14}),o(a.answer,b),b.writeFieldEnd());a.syncPayload!=null&&(b.writeFieldBegin({fname:"syncPayload",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:15}),t(a.syncPayload,b),b.writeFieldEnd());if(a.usersToApproveFromWaitingRoom!=null){b.writeFieldBegin({fname:"usersToApproveFromWaitingRoom",ftype:(h||(h=c("ThriftTypes"))).SET,fid:16});b.writeSetBegin({etype:h.STRING,size:a.usersToApproveFromWaitingRoom.size});for(e of a.usersToApproveFromWaitingRoom)b.writeString(e);b.writeSetEnd();b.writeFieldEnd()}a.e2eeEnforcement!=null&&(b.writeFieldBegin({fname:"e2eeEnforcement",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:17}),d("MultiwaySharedSerializers").serializeE2eeEnforcement(a.e2eeEnforcement,b),b.writeFieldEnd());a.sfuAllocation!=null&&(b.writeFieldBegin({fname:"sfuAllocation",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:18}),K(a.sfuAllocation,b),b.writeFieldEnd());if(a.clientMediaMode!=null){b.writeFieldBegin({fname:"clientMediaMode",ftype:(h||(h=c("ThriftTypes"))).I32,fid:19});b.writeI32((f=a.clientMediaMode)!=null?f:0);b.writeFieldEnd()}a.endpointSettings!=null&&(b.writeFieldBegin({fname:"endpointSettings",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:20}),Za(a.endpointSettings,b),b.writeFieldEnd());a.backupSfuAllocation!=null&&(b.writeFieldBegin({fname:"backupSfuAllocation",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:21}),K(a.backupSfuAllocation,b),b.writeFieldEnd());if(a.supportedCustomVideoContentTypes!=null){b.writeFieldBegin({fname:"supportedCustomVideoContentTypes",ftype:(h||(h=c("ThriftTypes"))).SET,fid:22});b.writeSetBegin({etype:h.I32,size:a.supportedCustomVideoContentTypes.size});for(g of a.supportedCustomVideoContentTypes)b.writeI32(g!=null?g:0);b.writeSetEnd();b.writeFieldEnd()}a.configIntegrityOpaqueToken!=null&&(b.writeFieldBegin({fname:"configIntegrityOpaqueToken",ftype:(h||(h=c("ThriftTypes"))).I32,fid:23}),b.writeI32(a.configIntegrityOpaqueToken),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function M(a,b){b.writeStructBegin("JoinResponse");b.writeFieldBegin({fname:"answer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.answer!=null)o(a.answer,b);else{var e=i();o(e,b)}b.writeFieldEnd();b.writeFieldBegin({fname:"mediaStatus",ftype:h.MAP,fid:2});if(a.mediaStatus!=null){b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.BOOL,size:Object.keys(a.mediaStatus).length});for(e of Object.entries(a.mediaStatus)){var f=e[0],g=e[1];b.writeString(f);b.writeBool(g)}b.writeMapEnd()}else{f={};b.writeMapBegin({ktype:(h||(h=c("ThriftTypes"))).STRING,vtype:h.BOOL,size:Object.keys(f).length});for(g of Object.entries(f)){e=g[0];f=g[1];b.writeString(e);b.writeBool(f)}b.writeMapEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"initiator",ftype:h.STRING,fid:3});if(a.initiator!=null)b.writeString(a.initiator);else{e="";b.writeString(e)}b.writeFieldEnd();a.negotiatedExperiments!=null&&(b.writeFieldBegin({fname:"negotiatedExperiments",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeString(a.negotiatedExperiments),b.writeFieldEnd());a.mediaStatusEx!=null&&(b.writeFieldBegin({fname:"mediaStatusEx",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatusEx,b),b.writeFieldEnd());if(a.appMessages!=null){b.writeFieldBegin({fname:"appMessages",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:7});b.writeListBegin({etype:h.STRUCT,size:a.appMessages.length});for(f of a.appMessages)d("DataMessageSerializers").serializeDataMessage(f,b);b.writeListEnd();b.writeFieldEnd()}if(a.stateStore!=null){b.writeFieldBegin({fname:"stateStore",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:8});b.writeMapBegin({ktype:h.STRING,vtype:h.STRUCT,size:Object.keys(a.stateStore).length});for(g of Object.entries(a.stateStore)){e=g[0];f=g[1];b.writeString(e);d("StateSyncSerializers").serializeState(f,b)}b.writeMapEnd();b.writeFieldEnd()}a.sdpOriginLocalId!=null&&(b.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:9}),b.writeString(a.sdpOriginLocalId),b.writeFieldEnd());b.writeFieldBegin({fname:"isPendingApproval",ftype:h.BOOL,fid:10});if(a.isPendingApproval!=null)b.writeBool(a.isPendingApproval);else{e=!1;b.writeBool(e)}b.writeFieldEnd();a.renegotiationOffer!=null&&(b.writeFieldBegin({fname:"renegotiationOffer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:11}),o(a.renegotiationOffer,b),b.writeFieldEnd());b.writeFieldBegin({fname:"multipleVideoStreamsAllowed",ftype:h.BOOL,fid:12});if(a.multipleVideoStreamsAllowed!=null)b.writeBool(a.multipleVideoStreamsAllowed);else{f=!1;b.writeBool(f)}b.writeFieldEnd();b.writeFieldBegin({fname:"mediaPath",ftype:h.I32,fid:13});if(a.mediaPath!=null){b.writeI32((g=a.mediaPath)!=null?g:0)}else{e=d("MultiwaySharedTypes").MediaPath.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"groupsOfUsers",ftype:h.LIST,fid:14});if(a.groupsOfUsers!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.groupsOfUsers.length});for(f of a.groupsOfUsers)Y(f,b);b.writeListEnd()}else{g=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:g.length});for(e of g)Y(e,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"screenShareStreamAllowed",ftype:h.BOOL,fid:15});if(a.screenShareStreamAllowed!=null)b.writeBool(a.screenShareStreamAllowed);else{f=!1;b.writeBool(f)}b.writeFieldEnd();a.relayInfo!=null&&(b.writeFieldBegin({fname:"relayInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:16}),d("MultiwaySharedSerializers").serializeRelayInfo(a.relayInfo,b),b.writeFieldEnd());a.selfSctpNodeId!=null&&(b.writeFieldBegin({fname:"selfSctpNodeId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:17}),b.writeI64(BigInt(a.selfSctpNodeId)),b.writeFieldEnd());if(a.stateStoreV2!=null){b.writeFieldBegin({fname:"stateStoreV2",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:18});b.writeMapBegin({ktype:h.I32,vtype:h.STRUCT,size:Object.keys(a.stateStoreV2).length});for(g of Object.entries(a.stateStoreV2)){e=g[0];f=g[1];b.writeI32((e=Number(e))!=null?e:0);d("StateSyncSerializers").serializeState(f,b)}b.writeMapEnd();b.writeFieldEnd()}if(a.allowedCustomVideoContentTypes!=null){b.writeFieldBegin({fname:"allowedCustomVideoContentTypes",ftype:(h||(h=c("ThriftTypes"))).SET,fid:19});b.writeSetBegin({etype:h.I32,size:a.allowedCustomVideoContentTypes.size});for(e of a.allowedCustomVideoContentTypes)b.writeI32(e!=null?e:0);b.writeSetEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function N(a,b){b.writeStructBegin("ConnectRequest");a.sdp!=null&&(b.writeFieldBegin({fname:"sdp",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),o(a.sdp,b),b.writeFieldEnd());b.writeFieldBegin({fname:"deviceCapabilities",ftype:(h||(h=c("ThriftTypes"))).SET,fid:3});if(a.deviceCapabilities!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).I32,size:a.deviceCapabilities.size});for(var e of a.deviceCapabilities)b.writeI32(e!=null?e:0);b.writeSetEnd()}else{e=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).I32,size:e.size});for(e of e)b.writeI32(e!=null?e:0);b.writeSetEnd()}b.writeFieldEnd();if(a.supportedCustomVideoContentTypes!=null){b.writeFieldBegin({fname:"supportedCustomVideoContentTypes",ftype:(h||(h=c("ThriftTypes"))).SET,fid:5});b.writeSetBegin({etype:h.I32,size:a.supportedCustomVideoContentTypes.size});for(e of a.supportedCustomVideoContentTypes)b.writeI32(e!=null?e:0);b.writeSetEnd();b.writeFieldEnd()}a.prOffer!=null&&(b.writeFieldBegin({fname:"prOffer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),o(a.prOffer,b),b.writeFieldEnd());a.e2eeEnforcement!=null&&(b.writeFieldBegin({fname:"e2eeEnforcement",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7}),d("MultiwaySharedSerializers").serializeE2eeEnforcement(a.e2eeEnforcement,b),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function O(a,b){b.writeStructBegin("ConnectResponse"),a.sdp!=null&&(b.writeFieldBegin({fname:"sdp",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),o(a.sdp,b),b.writeFieldEnd()),a.sdpOriginLocalId!=null&&(b.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.sdpOriginLocalId),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function P(a,b){b.writeStructBegin("ClientEvent");b.writeFieldBegin({fname:"type",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.type!=null){var e;b.writeI32((e=a.type)!=null?e:0)}else{e=d("MultiwayCommonTypes").ClientEventType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.time!=null&&(b.writeFieldBegin({fname:"time",ftype:(h||(h=c("ThriftTypes"))).I64,fid:2}),b.writeI64(BigInt(a.time)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function Q(a,b){b.writeStructBegin("ClientEventRequest");b.writeFieldBegin({fname:"clientEvents",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:1});if(a.clientEvents!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.clientEvents.length});for(a of a.clientEvents)P(a,b);b.writeListEnd()}else{a=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.length});for(a of a)P(a,b);b.writeListEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function bb(a,b){b.writeStructBegin("ThreadIdInfo"),a.groupThreadId!=null&&(b.writeFieldBegin({fname:"groupThreadId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.groupThreadId),b.writeFieldEnd()),a.peerId!=null&&(b.writeFieldBegin({fname:"peerId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.peerId),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function R(a,b){b.writeStructBegin("ClientEventResponse"),b.writeFieldStop(),b.writeStructEnd()}function S(a,b){b.writeStructBegin("RingRequest");b.writeFieldBegin({fname:"caller",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.caller!=null)b.writeString(a.caller);else{var e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"otherParticipants",ftype:h.SET,fid:2});if(a.otherParticipants!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.otherParticipants.size});for(e of a.otherParticipants)b.writeString(e);b.writeSetEnd()}else{e=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:e.size});for(e of e)b.writeString(e);b.writeSetEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"ringType",ftype:h.I32,fid:4});if(a.ringType!=null){b.writeI32((e=a.ringType)!=null?e:0)}else{e=d("MultiwayCommonTypes").RingType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.offeredExperiments!=null&&(b.writeFieldBegin({fname:"offeredExperiments",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.offeredExperiments),b.writeFieldEnd());a.isScheduledCall!=null&&(b.writeFieldBegin({fname:"isScheduledCall",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:6}),b.writeBool(a.isScheduledCall),b.writeFieldEnd());if(a.appMessages!=null){b.writeFieldBegin({fname:"appMessages",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:8});b.writeListBegin({etype:h.STRUCT,size:a.appMessages.length});for(e of a.appMessages)d("DataMessageSerializers").serializeDataMessage(e,b);b.writeListEnd();b.writeFieldEnd()}a.offer!=null&&(b.writeFieldBegin({fname:"offer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:10}),o(a.offer,b),b.writeFieldEnd());a.mediaStatusEx!=null&&(b.writeFieldBegin({fname:"mediaStatusEx",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:11}),d("MultiwaySharedSerializers").serializeClientMediaStatus(a.mediaStatusEx,b),b.writeFieldEnd());a.isPreconnectSupported!=null&&(b.writeFieldBegin({fname:"isPreconnectSupported",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:12}),b.writeBool(a.isPreconnectSupported),b.writeFieldEnd());a.sdpOriginLocalId!=null&&(b.writeFieldBegin({fname:"sdpOriginLocalId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:13}),b.writeString(a.sdpOriginLocalId),b.writeFieldEnd());a.unifiedOffer!=null&&(b.writeFieldBegin({fname:"unifiedOffer",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:14}),o(a.unifiedOffer,b),b.writeFieldEnd());b.writeFieldBegin({fname:"mediaPath",ftype:h.I32,fid:15});if(a.mediaPath!=null){b.writeI32((e=a.mediaPath)!=null?e:0)}else{e=d("MultiwaySharedTypes").MediaPath.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.e2eeEnforcement!=null&&(b.writeFieldBegin({fname:"e2eeEnforcement",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:16}),d("MultiwaySharedSerializers").serializeE2eeEnforcement(a.e2eeEnforcement,b),b.writeFieldEnd());a.isLegacyCall!=null&&(b.writeFieldBegin({fname:"isLegacyCall",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:17}),b.writeBool(a.isLegacyCall),b.writeFieldEnd());b.writeFieldBegin({fname:"isTransferCall",ftype:h.BOOL,fid:18});if(a.isTransferCall!=null)b.writeBool(a.isTransferCall);else{e=!1;b.writeBool(e)}b.writeFieldEnd();a.relayInfo!=null&&(b.writeFieldBegin({fname:"relayInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:20}),d("MultiwaySharedSerializers").serializeRelayInfo(a.relayInfo,b),b.writeFieldEnd());if(a.overlayConfigs!=null){b.writeFieldBegin({fname:"overlayConfigs",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:21});b.writeMapBegin({ktype:h.I32,vtype:h.I32,size:Object.keys(a.overlayConfigs).length});for(e of Object.entries(a.overlayConfigs)){var f=e[0],g=e[1];b.writeI32(Number(f));b.writeI32(g)}b.writeMapEnd();b.writeFieldEnd()}a.productMetadata!=null&&(b.writeFieldBegin({fname:"productMetadata",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:22}),ab(a.productMetadata,b),b.writeFieldEnd());a.callerClientSessionId!=null&&(b.writeFieldBegin({fname:"callerClientSessionId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:23}),b.writeString(a.callerClientSessionId),b.writeFieldEnd());a.threadIdInfo!=null&&(b.writeFieldBegin({fname:"threadIdInfo",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:24}),bb(a.threadIdInfo,b),b.writeFieldEnd());a.linkUrl!=null&&(b.writeFieldBegin({fname:"linkUrl",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:25}),b.writeString(a.linkUrl),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function T(a,b){b.writeStructBegin("RingResponse");b.writeFieldBegin({fname:"deviceStatus",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});if(a.deviceStatus!=null){b.writeI32((a=a.deviceStatus)!=null?a:0)}else{a=d("MultiwayCommonTypes").DeviceStatus.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function U(a,b){b.writeStructBegin("RemoveParticipantsRequest");b.writeFieldBegin({fname:"usersToRemove",ftype:(h||(h=c("ThriftTypes"))).SET,fid:1});if(a.usersToRemove!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.usersToRemove.size});for(a of a.usersToRemove)b.writeString(a);b.writeSetEnd()}else{a=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.size});for(a of a)b.writeString(a);b.writeSetEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function V(a,b){b.writeStructBegin("UnsubscribeRequest");b.writeFieldBegin({fname:"topic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.topic!=null)b.writeString(a.topic);else{var e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"version",ftype:h.I32,fid:2});if(a.version!=null)b.writeI32(a.version);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"topicId",ftype:h.I32,fid:3});if(a.topicId!=null){b.writeI32((e=a.topicId)!=null?e:0)}else{a=d("StateSyncTopicsConfigTypes").TopicId.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function W(a,b){b.writeStructBegin("UnsubscribeResponse");b.writeFieldBegin({fname:"topic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.topic!=null)b.writeString(a.topic);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"version",ftype:h.I32,fid:2});if(a.version!=null)b.writeI32(a.version);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function X(a,b){b.writeStructBegin("UpdateRequest");b.writeFieldBegin({fname:"syncPayload",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.syncPayload!=null)t(a.syncPayload,b);else{var e=l();t(e,b)}b.writeFieldEnd();b.writeFieldBegin({fname:"topic",ftype:h.STRING,fid:2});if(a.topic!=null)b.writeString(a.topic);else{e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"version",ftype:h.I32,fid:3});if(a.version!=null)b.writeI32(a.version);else{e=0;b.writeI32(e)}b.writeFieldEnd();a.data!=null&&(b.writeFieldBegin({fname:"data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.data),b.writeFieldEnd());b.writeFieldBegin({fname:"topicId",ftype:h.I32,fid:5});if(a.topicId!=null){b.writeI32((e=a.topicId)!=null?e:0)}else{a=d("StateSyncTopicsConfigTypes").TopicId.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function cb(a,b){b.writeStructBegin("UpdateResponse");b.writeFieldBegin({fname:"topic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.topic!=null)b.writeString(a.topic);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"version",ftype:h.I32,fid:3});if(a.version!=null)b.writeI32(a.version);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function db(a,b){b.writeStructBegin("NotifyRequest");b.writeFieldBegin({fname:"topic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.topic!=null)b.writeString(a.topic);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"version",ftype:h.I32,fid:3});if(a.version!=null)b.writeI32(a.version);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"data",ftype:h.STRING,fid:4});if(a.data!=null)b.writeBinary(a.data);else{d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.syncPayload!=null&&(b.writeFieldBegin({fname:"syncPayload",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),t(a.syncPayload,b),b.writeFieldEnd());if(a.topicId!=null){b.writeFieldBegin({fname:"topicId",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6});b.writeI32((d=a.topicId)!=null?d:0);b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function eb(a,b){b.writeStructBegin("NotifyResponse");b.writeFieldBegin({fname:"topic",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.topic!=null)b.writeString(a.topic);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"version",ftype:h.I32,fid:3});if(a.version!=null)b.writeI32(a.version);else{d=0;b.writeI32(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function fb(a,b){b.writeStructBegin("ApprovalRequest");b.writeFieldBegin({fname:"approvalStatus",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});if(a.approvalStatus!=null){var e;b.writeI32((e=a.approvalStatus)!=null?e:0)}else{e=d("MultiwayCommonTypes").ApprovalStatus.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"targetUsers",ftype:h.SET,fid:3});if(a.targetUsers!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.targetUsers.size});for(e of a.targetUsers)b.writeString(e);b.writeSetEnd()}else{a=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.size});for(e of a)b.writeString(e);b.writeSetEnd()}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function gb(a,b){b.writeStructBegin("RtcSender");b.writeFieldBegin({fname:"id",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.id!=null)b.writeString(a.id);else{a="";b.writeString(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function hb(a,b){b.writeStructBegin("RtcReceiver");b.writeFieldBegin({fname:"actorId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.actorId!=null)b.writeString(a.actorId);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"baseId",ftype:h.STRING,fid:2});if(a.baseId!=null)b.writeString(a.baseId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function ib(a,b){b.writeStructBegin("RtcMessageHeader");b.writeFieldBegin({fname:"type",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.type!=null){var e;b.writeI32((e=a.type)!=null?e:0)}else{e=d("MultiwayCommonTypes").MessageType.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();b.writeFieldBegin({fname:"conferenceName",ftype:h.STRING,fid:2});if(a.conferenceName!=null)b.writeString(a.conferenceName);else{e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"transactionId",ftype:h.STRING,fid:3});if(a.transactionId!=null)b.writeString(a.transactionId);else{e="";b.writeString(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"retryCount",ftype:h.I16,fid:4});if(a.retryCount!=null)b.writeI16(a.retryCount);else{e=0;b.writeI16(e)}b.writeFieldEnd();a.serverInfoData!=null&&(b.writeFieldBegin({fname:"serverInfoData",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeString(a.serverInfoData),b.writeFieldEnd());if(a.responseStatusCode!=null){b.writeFieldBegin({fname:"responseStatusCode",ftype:(h||(h=c("ThriftTypes"))).I32,fid:6});b.writeI32((e=a.responseStatusCode)!=null?e:0);b.writeFieldEnd()}if(a.extensions!=null){b.writeFieldBegin({fname:"extensions",ftype:(h||(h=c("ThriftTypes"))).MAP,fid:7});b.writeMapBegin({ktype:h.STRING,vtype:h.STRING,size:Object.keys(a.extensions).length});for(e of Object.entries(a.extensions)){var f=e[0],g=e[1];b.writeString(f);b.writeString(g)}b.writeMapEnd();b.writeFieldEnd()}a.sequenceNumber!=null&&(b.writeFieldBegin({fname:"sequenceNumber",ftype:(h||(h=c("ThriftTypes"))).I64,fid:8}),b.writeI64(BigInt(a.sequenceNumber)),b.writeFieldEnd());a.clientSessionId!=null&&(b.writeFieldBegin({fname:"clientSessionId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:9}),b.writeString(a.clientSessionId),b.writeFieldEnd());a.responseStatusMessage!=null&&(b.writeFieldBegin({fname:"responseStatusMessage",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:10}),b.writeString(a.responseStatusMessage),b.writeFieldEnd());if(a.responseSubCode!=null){b.writeFieldBegin({fname:"responseSubCode",ftype:(h||(h=c("ThriftTypes"))).I32,fid:11});b.writeI32((f=a.responseSubCode)!=null?f:0);b.writeFieldEnd()}a.collisionKey!=null&&(b.writeFieldBegin({fname:"collisionKey",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:12}),b.writeString(a.collisionKey),b.writeFieldEnd());if(a.conferenceType!=null){b.writeFieldBegin({fname:"conferenceType",ftype:(h||(h=c("ThriftTypes"))).I32,fid:13});b.writeI32((g=a.conferenceType)!=null?g:0);b.writeFieldEnd()}a.serverSessionId!=null&&(b.writeFieldBegin({fname:"serverSessionId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:14}),b.writeString(a.serverSessionId),b.writeFieldEnd());a.rtcHandle!=null&&(b.writeFieldBegin({fname:"rtcHandle",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:15}),b.writeString(a.rtcHandle),b.writeFieldEnd());a.retryAfterMsec!=null&&(b.writeFieldBegin({fname:"retryAfterMsec",ftype:(h||(h=c("ThriftTypes"))).I32,fid:16}),b.writeI32(a.retryAfterMsec),b.writeFieldEnd());a.receiverUserId!=null&&(b.writeFieldBegin({fname:"receiverUserId",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:17}),b.writeString(a.receiverUserId),b.writeFieldEnd());if(a.clientStack!=null){b.writeFieldBegin({fname:"clientStack",ftype:(h||(h=c("ThriftTypes"))).I32,fid:18});b.writeI32((e=a.clientStack)!=null?e:0);b.writeFieldEnd()}a.serverMsgTime!=null&&(b.writeFieldBegin({fname:"serverMsgTime",ftype:(h||(h=c("ThriftTypes"))).I64,fid:19}),b.writeI64(BigInt(a.serverMsgTime)),b.writeFieldEnd());a.sender!=null&&(b.writeFieldBegin({fname:"sender",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:20}),gb(a.sender,b),b.writeFieldEnd());a.receiver!=null&&(b.writeFieldBegin({fname:"receiver",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:21}),hb(a.receiver,b),b.writeFieldEnd());if(a.messageTags!=null){b.writeFieldBegin({fname:"messageTags",ftype:(h||(h=c("ThriftTypes"))).SET,fid:22});b.writeSetBegin({etype:h.I32,size:a.messageTags.size});for(f of a.messageTags)b.writeI32(f!=null?f:0);b.writeSetEnd();b.writeFieldEnd()}a.conferenceId!=null&&(b.writeFieldBegin({fname:"conferenceId",ftype:(h||(h=c("ThriftTypes"))).I64,fid:23}),b.writeI64(BigInt(a.conferenceId)),b.writeFieldEnd());a.protocolVersion!=null&&(b.writeFieldBegin({fname:"protocolVersion",ftype:(h||(h=c("ThriftTypes"))).I32,fid:24}),b.writeI32(a.protocolVersion),b.writeFieldEnd());a.bodyCompressionVersion!=null&&(b.writeFieldBegin({fname:"bodyCompressionVersion",ftype:(h||(h=c("ThriftTypes"))).I64,fid:25}),b.writeI64(BigInt(a.bodyCompressionVersion)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function jb(a,b){b.writeStructBegin("RtcMessageBody"),a.joinRequest!=null&&(b.writeFieldBegin({fname:"joinRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1}),L(a.joinRequest,b),b.writeFieldEnd()),a.joinResponse!=null&&(b.writeFieldBegin({fname:"joinResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2}),M(a.joinResponse,b),b.writeFieldEnd()),a.serverMediaUpdateRequest!=null&&(b.writeFieldBegin({fname:"serverMediaUpdateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3}),w(a.serverMediaUpdateRequest,b),b.writeFieldEnd()),a.serverMediaUpdateResponse!=null&&(b.writeFieldBegin({fname:"serverMediaUpdateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4}),x(a.serverMediaUpdateResponse,b),b.writeFieldEnd()),a.hangupRequest!=null&&(b.writeFieldBegin({fname:"hangupRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5}),z(a.hangupRequest,b),b.writeFieldEnd()),a.iceCandidateRequest!=null&&(b.writeFieldBegin({fname:"iceCandidateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),A(a.iceCandidateRequest,b),b.writeFieldEnd()),a.ringRequest!=null&&(b.writeFieldBegin({fname:"ringRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:8}),S(a.ringRequest,b),b.writeFieldEnd()),a.ringResponse!=null&&(b.writeFieldBegin({fname:"ringResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:9}),T(a.ringResponse,b),b.writeFieldEnd()),a.dismissRequest!=null&&(b.writeFieldBegin({fname:"dismissRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:10}),B(a.dismissRequest,b),b.writeFieldEnd()),a.conferenceStateRequest!=null&&(b.writeFieldBegin({fname:"conferenceStateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:11}),E(a.conferenceStateRequest,b),b.writeFieldEnd()),a.conferenceStateResponse!=null&&(b.writeFieldBegin({fname:"conferenceStateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:12}),F(a.conferenceStateResponse,b),b.writeFieldEnd()),a.addParticipantsRequest!=null&&(b.writeFieldBegin({fname:"addParticipantsRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:13}),J(a.addParticipantsRequest,b),b.writeFieldEnd()),a.subscriptionRequest!=null&&(b.writeFieldBegin({fname:"subscriptionRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:14}),G(a.subscriptionRequest,b),b.writeFieldEnd()),a.clientMediaUpdateRequest!=null&&(b.writeFieldBegin({fname:"clientMediaUpdateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:15}),u(a.clientMediaUpdateRequest,b),b.writeFieldEnd()),a.clientMediaUpdateResponse!=null&&(b.writeFieldBegin({fname:"clientMediaUpdateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:16}),v(a.clientMediaUpdateResponse,b),b.writeFieldEnd()),a.dataMessageRequest!=null&&(b.writeFieldBegin({fname:"dataMessageRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:17}),H(a.dataMessageRequest,b),b.writeFieldEnd()),a.removeParticipantsRequest!=null&&(b.writeFieldBegin({fname:"removeParticipantsRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:18}),U(a.removeParticipantsRequest,b),b.writeFieldEnd()),a.dataMessageResponse!=null&&(b.writeFieldBegin({fname:"dataMessageResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:19}),I(a.dataMessageResponse,b),b.writeFieldEnd()),a.updateRequest!=null&&(b.writeFieldBegin({fname:"updateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:30}),X(a.updateRequest,b),b.writeFieldEnd()),a.updateResponse!=null&&(b.writeFieldBegin({fname:"updateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:31}),cb(a.updateResponse,b),b.writeFieldEnd()),a.notifyRequest!=null&&(b.writeFieldBegin({fname:"notifyRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:32}),db(a.notifyRequest,b),b.writeFieldEnd()),a.notifyResponse!=null&&(b.writeFieldBegin({fname:"notifyResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:33}),eb(a.notifyResponse,b),b.writeFieldEnd()),a.connectRequest!=null&&(b.writeFieldBegin({fname:"connectRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:34}),N(a.connectRequest,b),b.writeFieldEnd()),a.connectResponse!=null&&(b.writeFieldBegin({fname:"connectResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:35}),O(a.connectResponse,b),b.writeFieldEnd()),a.clientEventRequest!=null&&(b.writeFieldBegin({fname:"clientEventRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:36}),Q(a.clientEventRequest,b),b.writeFieldEnd()),a.clientEventResponse!=null&&(b.writeFieldBegin({fname:"clientEventResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:37}),R(a.clientEventResponse,b),b.writeFieldEnd()),a.unsubscribeRequest!=null&&(b.writeFieldBegin({fname:"unsubscribeRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:40}),V(a.unsubscribeRequest,b),b.writeFieldEnd()),a.unsubscribeResponse!=null&&(b.writeFieldBegin({fname:"unsubscribeResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:41}),W(a.unsubscribeResponse,b),b.writeFieldEnd()),a.approvalRequest!=null&&(b.writeFieldBegin({fname:"approvalRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:42}),fb(a.approvalRequest,b),b.writeFieldEnd()),a.transferRequest!=null&&(b.writeFieldBegin({fname:"transferRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:43}),y(a.transferRequest,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function kb(a,b){b.writeStructBegin("RtcMultiwayMessage");b.writeFieldBegin({fname:"messageHeader",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});if(a.messageHeader!=null)ib(a.messageHeader,b);else{var d=m();ib(d,b)}b.writeFieldEnd();b.writeFieldBegin({fname:"messageBody",ftype:h.STRUCT,fid:2});if(a.messageBody!=null)jb(a.messageBody,b);else{d=n();jb(d,b)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function Y(a,b){b.writeStructBegin("GroupOfUsers");b.writeFieldBegin({fname:"users",ftype:(h||(h=c("ThriftTypes"))).SET,fid:1});if(a.users!=null){b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:a.users.size});for(var d of a.users)b.writeString(d);b.writeSetEnd()}else{d=new Set();b.writeSetBegin({etype:(h||(h=c("ThriftTypes"))).STRING,size:d.size});for(d of d)b.writeString(d);b.writeSetEnd()}b.writeFieldEnd();b.writeFieldBegin({fname:"allowMultipleJoins",ftype:h.BOOL,fid:2});if(a.allowMultipleJoins!=null)b.writeBool(a.allowMultipleJoins);else{d=!1;b.writeBool(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"dismissOthersOnFirstJoin",ftype:h.BOOL,fid:3});if(a.dismissOthersOnFirstJoin!=null)b.writeBool(a.dismissOthersOnFirstJoin);else{d=!1;b.writeBool(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"aliasId",ftype:h.STRING,fid:4});if(a.aliasId!=null)b.writeString(a.aliasId);else{d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function lb(a,b){b.writeStructBegin("RtcMessageBodyVariant");if(a.joinRequest!=null){b.writeFieldBegin({fname:"joinRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});L(a.joinRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.joinResponse!=null){b.writeFieldBegin({fname:"joinResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});M(a.joinResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.serverMediaUpdateRequest!=null){b.writeFieldBegin({fname:"serverMediaUpdateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});w(a.serverMediaUpdateRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.serverMediaUpdateResponse!=null){b.writeFieldBegin({fname:"serverMediaUpdateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});x(a.serverMediaUpdateResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.hangupRequest!=null){b.writeFieldBegin({fname:"hangupRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});z(a.hangupRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.iceCandidateRequest!=null){b.writeFieldBegin({fname:"iceCandidateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});A(a.iceCandidateRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ringRequest!=null){b.writeFieldBegin({fname:"ringRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:8});S(a.ringRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ringResponse!=null){b.writeFieldBegin({fname:"ringResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:9});T(a.ringResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.dismissRequest!=null){b.writeFieldBegin({fname:"dismissRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:10});B(a.dismissRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.conferenceStateRequest!=null){b.writeFieldBegin({fname:"conferenceStateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:11});E(a.conferenceStateRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.conferenceStateResponse!=null){b.writeFieldBegin({fname:"conferenceStateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:12});F(a.conferenceStateResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.addParticipantsRequest!=null){b.writeFieldBegin({fname:"addParticipantsRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:13});J(a.addParticipantsRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.subscriptionRequest!=null){b.writeFieldBegin({fname:"subscriptionRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:14});G(a.subscriptionRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.clientMediaUpdateRequest!=null){b.writeFieldBegin({fname:"clientMediaUpdateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:15});u(a.clientMediaUpdateRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.clientMediaUpdateResponse!=null){b.writeFieldBegin({fname:"clientMediaUpdateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:16});v(a.clientMediaUpdateResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.dataMessageRequest!=null){b.writeFieldBegin({fname:"dataMessageRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:17});H(a.dataMessageRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.removeParticipantsRequest!=null){b.writeFieldBegin({fname:"removeParticipantsRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:18});U(a.removeParticipantsRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.dataMessageResponse!=null){b.writeFieldBegin({fname:"dataMessageResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:19});I(a.dataMessageResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.updateRequest!=null){b.writeFieldBegin({fname:"updateRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:30});X(a.updateRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.updateResponse!=null){b.writeFieldBegin({fname:"updateResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:31});cb(a.updateResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.notifyRequest!=null){b.writeFieldBegin({fname:"notifyRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:32});db(a.notifyRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.notifyResponse!=null){b.writeFieldBegin({fname:"notifyResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:33});eb(a.notifyResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.connectRequest!=null){b.writeFieldBegin({fname:"connectRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:34});N(a.connectRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.connectResponse!=null){b.writeFieldBegin({fname:"connectResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:35});O(a.connectResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.clientEventRequest!=null){b.writeFieldBegin({fname:"clientEventRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:36});Q(a.clientEventRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.clientEventResponse!=null){b.writeFieldBegin({fname:"clientEventResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:37});R(a.clientEventResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.unsubscribeRequest!=null){b.writeFieldBegin({fname:"unsubscribeRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:40});V(a.unsubscribeRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.unsubscribeResponse!=null){b.writeFieldBegin({fname:"unsubscribeResponse",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:41});W(a.unsubscribeResponse,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.approvalRequest!=null){b.writeFieldBegin({fname:"approvalRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:42});fb(a.approvalRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.transferRequest!=null){b.writeFieldBegin({fname:"transferRequest",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:43});y(a.transferRequest,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function mb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.responseStatusCode=d("MultiwayCommonTypes").RtcResponseStatusCode.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.responseSubCode=d("MultiwayCommonTypes").RtcResponseSubCode.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.apiStatusCode=d("MultiwayCommonTypes").RtcApiStatusCode.cast(a.readI32()):a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.rtcLogSeverity=d("MultiwayCommonTypes").RtcLogSeverity.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.message===void 0&&(b.message="");b.responseStatusCode===void 0&&(b.responseStatusCode=d("MultiwayCommonTypes").RtcResponseStatusCode.cast(0));b.responseSubCode===void 0&&(b.responseSubCode=d("MultiwayCommonTypes").RtcResponseSubCode.cast(0));b.apiStatusCode===void 0&&(b.apiStatusCode=d("MultiwayCommonTypes").RtcApiStatusCode.cast(0));b.rtcLogSeverity===void 0&&(b.rtcLogSeverity=d("MultiwayCommonTypes").RtcLogSeverity.cast(0));return b}function Z(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpString=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.sdpThrift=d("WebrtcSdpSerializers").deserializeSdp(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I64?b.sdpCompressionVersion=a.readI64().toString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpCompressedData=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return b}function nb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).MAP){b.media={};d=a.readMapBegin();for(var f=0;f<d.size;f++){var g=a.readI32(),i=ob(a);b.media[g]=i}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.media===void 0&&(b.media={});return b}function ob(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.body=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.msid=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.mid=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.body===void 0&&(b.body="");b.msid===void 0&&(b.msid="");b.mid===void 0&&(b.mid="");return b}function pb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.sourceKey=a.readString():a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).LIST){b.media=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("MultiwaySharedSerializers").deserializeMedia(a);b.media.push(i)}}else a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).LIST){b.ssrcGroups=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=d("MultiwaySharedSerializers").deserializeSsrcGroup(a);b.ssrcGroups.push(e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.sourceKey===void 0&&(b.sourceKey="");b.media===void 0&&(b.media=[]);b.ssrcGroups===void 0&&(b.ssrcGroups=[]);return b}function qb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).MAP){b.mediaStatus={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j=a.readBool();b.mediaStatus[i]=j}}else a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatusEx=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.mediaStatus===void 0&&(b.mediaStatus={});return b}function rb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.candidateSdpString=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I64?b.sdpMLineIndex=a.readI64().toString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpMid=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRUCT?b.candidateSdpThrift=d("WebrtcSdpSerializers").deserializeIceCandidateSdp(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.sdpMLineIndex===void 0&&(b.sdpMLineIndex="0");b.sdpMid===void 0&&(b.sdpMid="");return b}function $(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStore={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j=d("StateSyncSerializers").deserializeState(a);b.stateStore[i]=j}}else a.skip(f);break;case 4:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStoreV2={};i=a.readMapBegin();for(j=0;j<i.size;j++){g=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32());e=d("StateSyncSerializers").deserializeState(a);g!=null&&(b.stateStoreV2[g]=e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.stateStore===void 0&&(b.stateStore={});b.stateStoreV2===void 0&&(b.stateStoreV2={});return b}function sb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.version===void 0&&(b.version=0);return b}function tb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.encryptedTopic=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.encryptedData=a.readBinary():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.senderId=a.readBinary():a.skip(f);break;case 4:if(f===(h||(h=c("ThriftTypes"))).SET){b.targetIds=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var i=d("Utf8ToString").Utf8ToString(a.readBinary());b.targetIds.add(i)}}else a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.messageType=d("MultiwayCommonTypes").E2eeDataMessageType.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.encryptedTopic===void 0&&(b.encryptedTopic="");b.encryptedData===void 0&&(b.encryptedData=Uint8Array.of());b.senderId===void 0&&(b.senderId=Uint8Array.of());b.messageType===void 0&&(b.messageType=d("MultiwayCommonTypes").E2eeDataMessageType.cast(0));return b}function ub(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.fromVersion=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I64?b.toVersion=a.readI64().toString():a.skip(e);break;case 3:if(e===(h||(h=c("ThriftTypes"))).LIST){b.mediaUpdates=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=qb(a);b.mediaUpdates.push(g)}}else a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRUCT?b.offer=Z(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.fromVersion===void 0&&(b.fromVersion="0");b.toVersion===void 0&&(b.toVersion="0");b.mediaUpdates===void 0&&(b.mediaUpdates=[]);return b}function vb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.currentVersion=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.answer=Z(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatus=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpOriginLocalId=a.readString():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRUCT?b.renegotiationOffer=Z(a):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(a.readI32()):a.skip(f);break;case 7:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStore={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j=d("StateSyncSerializers").deserializeState(a);b.stateStore[i]=j}}else a.skip(f);break;case 8:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStoreV2={};i=a.readMapBegin();for(j=0;j<i.size;j++){g=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32());e=d("StateSyncSerializers").deserializeState(a);g!=null&&(b.stateStoreV2[g]=e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.currentVersion===void 0&&(b.currentVersion="0");b.mediaPath===void 0&&(b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(0));return b}function wb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.callerUserId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.calleeUserId=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.sessionId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.callerUserId===void 0&&(b.callerUserId="");b.calleeUserId===void 0&&(b.calleeUserId="");b.sessionId===void 0&&(b.sessionId="");return b}function xb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.fromVersion=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I64?b.toVersion=a.readI64().toString():a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).LIST){b.mediaUpdates=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=pb(a);b.mediaUpdates.push(i)}}else a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRUCT?b.offer=Z(a):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRUCT?b.answer=Z(a):a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatus=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).BOOL?b.renegotiationRequested=a.readBool():a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).STRUCT?b.prAnswer=Z(a):a.skip(f);break;case 10:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStore={};i=a.readMapBegin();for(g=0;g<i.size;g++){e=a.readString();var j=d("StateSyncSerializers").deserializeState(a);b.stateStore[e]=j}}else a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpOriginLocalId=a.readString():a.skip(f);break;case 12:f===(h||(h=c("ThriftTypes"))).STRUCT?b.multipleRelaysParameters=wb(a):a.skip(f);break;case 13:f===(h||(h=c("ThriftTypes"))).BOOL?b.multipleVideoStreamsAllowed=a.readBool():a.skip(f);break;case 14:f===(h||(h=c("ThriftTypes"))).STRUCT?b.renegotiationOffer=Z(a):a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).I32?b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(a.readI32()):a.skip(f);break;case 16:f===(h||(h=c("ThriftTypes"))).STRUCT?b.update=nb(a):a.skip(f);break;case 17:f===(h||(h=c("ThriftTypes"))).BOOL?b.screenShareStreamAllowed=a.readBool():a.skip(f);break;case 18:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStoreV2={};e=a.readMapBegin();for(j=0;j<e.size;j++){g=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32());i=d("StateSyncSerializers").deserializeState(a);g!=null&&(b.stateStoreV2[g]=i)}}else a.skip(f);break;case 19:if(f===(h||(h=c("ThriftTypes"))).SET){b.allowedCustomVideoContentTypes=new Set();g=a.readSetBegin();for(i=0;i<g.size;i++){j=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(a.readI32());b.allowedCustomVideoContentTypes.add(j)}}else a.skip(f);break;case 20:f===(h||(h=c("ThriftTypes"))).STRUCT?b.relayInfo=d("MultiwaySharedSerializers").deserializeRelayInfo(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.fromVersion===void 0&&(b.fromVersion="0");b.toVersion===void 0&&(b.toVersion="0");b.mediaUpdates===void 0&&(b.mediaUpdates=[]);b.renegotiationRequested===void 0&&(b.renegotiationRequested=!1);b.multipleVideoStreamsAllowed===void 0&&(b.multipleVideoStreamsAllowed=!1);b.mediaPath===void 0&&(b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(0));b.screenShareStreamAllowed===void 0&&(b.screenShareStreamAllowed=!1);return b}function yb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.currentVersion=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRUCT?b.answer=Z(a):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatus=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.currentVersion===void 0&&(b.currentVersion="0");return b}function zb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ab(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.reason=d("MultiwayCommonTypes").HangupReason.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.detailedReasonString=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.reason===void 0&&(b.reason=d("MultiwayCommonTypes").HangupReason.cast(0));b.detailedReasonString===void 0&&(b.detailedReasonString="");return b}function Bb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.iceCandidateSdps=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=rb(a);b.iceCandidateSdps.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.iceCandidateSdps===void 0&&(b.iceCandidateSdps=[]);return b}function Cb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.reason=d("MultiwayCommonTypes").DismissReason.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.detailedReasonString=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I64?b.callabilityResultErrorCode=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.reason===void 0&&(b.reason=d("MultiwayCommonTypes").DismissReason.cast(0));b.detailedReasonString===void 0&&(b.detailedReasonString="");return b}function Db(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.joinMode=d("MultiwayCommonTypes").JoinMode.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.joinMode===void 0&&(b.joinMode=d("MultiwayCommonTypes").JoinMode.cast(0));return b}function Eb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.state=d("MultiwayCommonTypes").ParticipantCallState.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.userCapabilities=a.readBinary():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I64?b.sctpNodeId=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.state===void 0&&(b.state=d("MultiwayCommonTypes").ParticipantCallState.cast(0));return b}function Fb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.userCountry=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Gb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.name=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.profilePictureUri=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.aliasId=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.thirdPartyId=a.readString():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRING?b.groupId=a.readString():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRING?b.avatarImageUri=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Hb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.callerInfo=Gb(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.liveBroadcastId=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.callingTags=a.readI32():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.backingIdentifier=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Ib(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.version=a.readI64().toString():a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).MAP){b.participantStates={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j=Eb(a);b.participantStates[i]=j}}else a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).MAP){b.userProfiles={};i=a.readMapBegin();for(j=0;j<i.size;j++){g=a.readString();e=Gb(a);b.userProfiles[g]=e}}else a.skip(f);break;case 4:if(f===(h||(h=c("ThriftTypes"))).LIST){b.appMessages=[];g=a.readListBegin();for(e=0;e<g.size;e++){j=d("DataMessageSerializers").deserializeDataMessage(a);b.appMessages.push(j)}}else a.skip(f);break;case 5:if(f===(h||(h=c("ThriftTypes"))).LIST){b.groupsOfUsers=[];i=a.readListBegin();for(j=0;j<i.size;j++){e=lc(a);b.groupsOfUsers.push(e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.version===void 0&&(b.version="0");b.participantStates===void 0&&(b.participantStates={});b.groupsOfUsers===void 0&&(b.groupsOfUsers=[]);return b}function Jb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.currentVersion=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.currentVersion===void 0&&(b.currentVersion="0");return b}function Kb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).LIST){b.subscriptions=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("MultiwaySharedSerializers").deserializeSubscription(a);b.subscriptions.push(i)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.subscriptions===void 0&&(b.subscriptions=[]);return b}function Lb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.message=d("DataMessageSerializers").deserializeDataMessage(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.message===void 0&&(b.message=d("DataMessageSerializers").DataMessage$DefaultConstructor());return b}function Mb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).MAP){b.deliveryResult={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j=d("DataMessageTypes").DataMessageStatusCode.cast(a.readI32());b.deliveryResult[i]=j}}else a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).MAP){b.serviceTypeDeliveryResult={};i=a.readMapBegin();for(j=0;j<i.size;j++){g=d("MultiwaySharedTypes").EndpointServiceType.cast(a.readI32());e=d("DataMessageTypes").DataMessageStatusCode.cast(a.readI32());g!=null&&(b.serviceTypeDeliveryResult[g]=e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.deliveryResult===void 0&&(b.deliveryResult={});return b}function Nb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).SET){b.usersToInvite=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.usersToInvite.add(i)}}else a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).LIST){b.appMessages=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=d("DataMessageSerializers").deserializeDataMessage(a);b.appMessages.push(e)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.usersToInvite===void 0&&(b.usersToInvite=new Set());return b}function Ob(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.smcTier=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.region=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).BOOL?b.isUsfu=a.readBool():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).BOOL?b.isEdge=a.readBool():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.smcTier===void 0&&(b.smcTier="");b.region===void 0&&(b.region="");b.isUsfu===void 0&&(b.isUsfu=!1);b.isEdge===void 0&&(b.isEdge=!1);return b}function Pb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.offer=Z(a):a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).SET){b.deviceCapabilities=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var j=d("MultiwayCommonTypes").Capability.cast(a.readI32());b.deviceCapabilities.add(j)}}else a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).SET){b.usersToCall=new Set();j=a.readSetBegin();for(g=0;g<j.size;g++){e=a.readString();b.usersToCall.add(e)}}else a.skip(f);break;case 4:if(f===(h||(h=c("ThriftTypes"))).MAP){b.mediaStatus={};e=a.readMapBegin();for(g=0;g<e.size;g++){j=a.readString();var k=a.readBool();b.mediaStatus[j]=k}}else a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.userCapabilities=a.readBinary():a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRING?b.supportedExperiments=a.readString():a.skip(f);break;case 9:if(f===(h||(h=c("ThriftTypes"))).LIST){b.appMessages=[];j=a.readListBegin();for(k=0;k<j.size;k++){g=d("DataMessageSerializers").deserializeDataMessage(a);b.appMessages.push(g)}}else a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).STRING?b.userToEscalate=a.readString():a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).I64?b.escalatingCallId=a.readI64().toString():a.skip(f);break;case 12:f===(h||(h=c("ThriftTypes"))).I32?b.conferenceType=d("MultiwaySharedTypes").ConferenceType.cast(a.readI32()):a.skip(f);break;case 13:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatusEx=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;case 14:f===(h||(h=c("ThriftTypes"))).STRUCT?b.answer=Z(a):a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).STRUCT?b.syncPayload=$(a):a.skip(f);break;case 16:if(f===(h||(h=c("ThriftTypes"))).SET){b.usersToApproveFromWaitingRoom=new Set();e=a.readSetBegin();for(g=0;g<e.size;g++){k=a.readString();b.usersToApproveFromWaitingRoom.add(k)}}else a.skip(f);break;case 17:f===(h||(h=c("ThriftTypes"))).STRUCT?b.e2eeEnforcement=d("MultiwaySharedSerializers").deserializeE2eeEnforcement(a):a.skip(f);break;case 18:f===(h||(h=c("ThriftTypes"))).STRUCT?b.sfuAllocation=Ob(a):a.skip(f);break;case 19:f===(h||(h=c("ThriftTypes"))).I32?b.clientMediaMode=d("MultiwaySharedTypes").MediaPath.cast(a.readI32()):a.skip(f);break;case 20:f===(h||(h=c("ThriftTypes"))).STRUCT?b.endpointSettings=Db(a):a.skip(f);break;case 21:f===(h||(h=c("ThriftTypes"))).STRUCT?b.backupSfuAllocation=Ob(a):a.skip(f);break;case 22:if(f===(h||(h=c("ThriftTypes"))).SET){b.supportedCustomVideoContentTypes=new Set();j=a.readSetBegin();for(k=0;k<j.size;k++){g=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(a.readI32());b.supportedCustomVideoContentTypes.add(g)}}else a.skip(f);break;case 23:f===(h||(h=c("ThriftTypes"))).I32?b.configIntegrityOpaqueToken=a.readI32():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.offer===void 0&&(b.offer=i());b.deviceCapabilities===void 0&&(b.deviceCapabilities=new Set());return b}function Qb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.answer=Z(a):a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).MAP){b.mediaStatus={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var j=a.readString(),k=a.readBool();b.mediaStatus[j]=k}}else a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.initiator=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.negotiatedExperiments=a.readString():a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatusEx=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;case 7:if(f===(h||(h=c("ThriftTypes"))).LIST){b.appMessages=[];j=a.readListBegin();for(k=0;k<j.size;k++){g=d("DataMessageSerializers").deserializeDataMessage(a);b.appMessages.push(g)}}else a.skip(f);break;case 8:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStore={};e=a.readMapBegin();for(g=0;g<e.size;g++){k=a.readString();j=d("StateSyncSerializers").deserializeState(a);b.stateStore[k]=j}}else a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpOriginLocalId=a.readString():a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).BOOL?b.isPendingApproval=a.readBool():a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).STRUCT?b.renegotiationOffer=Z(a):a.skip(f);break;case 12:f===(h||(h=c("ThriftTypes"))).BOOL?b.multipleVideoStreamsAllowed=a.readBool():a.skip(f);break;case 13:f===(h||(h=c("ThriftTypes"))).I32?b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(a.readI32()):a.skip(f);break;case 14:if(f===(h||(h=c("ThriftTypes"))).LIST){b.groupsOfUsers=[];k=a.readListBegin();for(j=0;j<k.size;j++){g=lc(a);b.groupsOfUsers.push(g)}}else a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).BOOL?b.screenShareStreamAllowed=a.readBool():a.skip(f);break;case 16:f===(h||(h=c("ThriftTypes"))).STRUCT?b.relayInfo=d("MultiwaySharedSerializers").deserializeRelayInfo(a):a.skip(f);break;case 17:f===(h||(h=c("ThriftTypes"))).I64?b.selfSctpNodeId=a.readI64().toString():a.skip(f);break;case 18:if(f===(h||(h=c("ThriftTypes"))).MAP){b.stateStoreV2={};e=a.readMapBegin();for(g=0;g<e.size;g++){j=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32());k=d("StateSyncSerializers").deserializeState(a);j!=null&&(b.stateStoreV2[j]=k)}}else a.skip(f);break;case 19:if(f===(h||(h=c("ThriftTypes"))).SET){b.allowedCustomVideoContentTypes=new Set();j=a.readSetBegin();for(k=0;k<j.size;k++){g=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(a.readI32());b.allowedCustomVideoContentTypes.add(g)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.answer===void 0&&(b.answer=i());b.mediaStatus===void 0&&(b.mediaStatus={});b.initiator===void 0&&(b.initiator="");b.isPendingApproval===void 0&&(b.isPendingApproval=!1);b.multipleVideoStreamsAllowed===void 0&&(b.multipleVideoStreamsAllowed=!1);b.mediaPath===void 0&&(b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(0));b.groupsOfUsers===void 0&&(b.groupsOfUsers=[]);b.screenShareStreamAllowed===void 0&&(b.screenShareStreamAllowed=!1);return b}function Rb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.sdp=Z(a):a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).SET){b.deviceCapabilities=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var i=d("MultiwayCommonTypes").Capability.cast(a.readI32());b.deviceCapabilities.add(i)}}else a.skip(f);break;case 5:if(f===(h||(h=c("ThriftTypes"))).SET){b.supportedCustomVideoContentTypes=new Set();i=a.readSetBegin();for(g=0;g<i.size;g++){e=d("WebrtcSignalingCommonTypes").CustomVideoContentType.cast(a.readI32());b.supportedCustomVideoContentTypes.add(e)}}else a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).STRUCT?b.prOffer=Z(a):a.skip(f);break;case 7:f===(h||(h=c("ThriftTypes"))).STRUCT?b.e2eeEnforcement=d("MultiwaySharedSerializers").deserializeE2eeEnforcement(a):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.deviceCapabilities===void 0&&(b.deviceCapabilities=new Set());return b}function Sb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.sdp=Z(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.sdpOriginLocalId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Tb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.type=d("MultiwayCommonTypes").ClientEventType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I64?b.time=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.type===void 0&&(b.type=d("MultiwayCommonTypes").ClientEventType.cast(0));return b}function Ub(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).LIST){b.clientEvents=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=Tb(a);b.clientEvents.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.clientEvents===void 0&&(b.clientEvents=[]);return b}function Vb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.groupThreadId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.peerId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Wb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function Xb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.caller=a.readString():a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).SET){b.otherParticipants=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.otherParticipants.add(i)}}else a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.ringType=d("MultiwayCommonTypes").RingType.cast(a.readI32()):a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.offeredExperiments=a.readString():a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).BOOL?b.isScheduledCall=a.readBool():a.skip(f);break;case 8:if(f===(h||(h=c("ThriftTypes"))).LIST){b.appMessages=[];i=a.readListBegin();for(g=0;g<i.size;g++){e=d("DataMessageSerializers").deserializeDataMessage(a);b.appMessages.push(e)}}else a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).STRUCT?b.offer=Z(a):a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).STRUCT?b.mediaStatusEx=d("MultiwaySharedSerializers").deserializeClientMediaStatus(a):a.skip(f);break;case 12:f===(h||(h=c("ThriftTypes"))).BOOL?b.isPreconnectSupported=a.readBool():a.skip(f);break;case 13:f===(h||(h=c("ThriftTypes"))).STRING?b.sdpOriginLocalId=a.readString():a.skip(f);break;case 14:f===(h||(h=c("ThriftTypes"))).STRUCT?b.unifiedOffer=Z(a):a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).I32?b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(a.readI32()):a.skip(f);break;case 16:f===(h||(h=c("ThriftTypes"))).STRUCT?b.e2eeEnforcement=d("MultiwaySharedSerializers").deserializeE2eeEnforcement(a):a.skip(f);break;case 17:f===(h||(h=c("ThriftTypes"))).BOOL?b.isLegacyCall=a.readBool():a.skip(f);break;case 18:f===(h||(h=c("ThriftTypes"))).BOOL?b.isTransferCall=a.readBool():a.skip(f);break;case 20:f===(h||(h=c("ThriftTypes"))).STRUCT?b.relayInfo=d("MultiwaySharedSerializers").deserializeRelayInfo(a):a.skip(f);break;case 21:if(f===(h||(h=c("ThriftTypes"))).MAP){b.overlayConfigs={};e=a.readMapBegin();for(g=0;g<e.size;g++){i=a.readI32();var j=a.readI32();b.overlayConfigs[i]=j}}else a.skip(f);break;case 22:f===(h||(h=c("ThriftTypes"))).STRUCT?b.productMetadata=Hb(a):a.skip(f);break;case 23:f===(h||(h=c("ThriftTypes"))).STRING?b.callerClientSessionId=a.readString():a.skip(f);break;case 24:f===(h||(h=c("ThriftTypes"))).STRUCT?b.threadIdInfo=Vb(a):a.skip(f);break;case 25:f===(h||(h=c("ThriftTypes"))).STRING?b.linkUrl=a.readString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.caller===void 0&&(b.caller="");b.otherParticipants===void 0&&(b.otherParticipants=new Set());b.ringType===void 0&&(b.ringType=d("MultiwayCommonTypes").RingType.cast(0));b.mediaPath===void 0&&(b.mediaPath=d("MultiwaySharedTypes").MediaPath.cast(0));b.isTransferCall===void 0&&(b.isTransferCall=!1);return b}function Yb(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 2:f===(h||(h=c("ThriftTypes"))).I32?b.deviceStatus=d("MultiwayCommonTypes").DeviceStatus.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.deviceStatus===void 0&&(b.deviceStatus=d("MultiwayCommonTypes").DeviceStatus.cast(0));return b}function Zb(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).SET){b.usersToRemove=new Set();d=a.readSetBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.usersToRemove.add(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.usersToRemove===void 0&&(b.usersToRemove=new Set());return b}function $b(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.topicId=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.topic===void 0&&(b.topic="");b.version===void 0&&(b.version=0);b.topicId===void 0&&(b.topicId=d("StateSyncTopicsConfigTypes").TopicId.cast(0));return b}function ac(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.topic===void 0&&(b.topic="");b.version===void 0&&(b.version=0);return b}function bc(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).STRUCT?b.syncPayload=$(a):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.data=a.readBinary():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).I32?b.topicId=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.syncPayload===void 0&&(b.syncPayload=l());b.topic===void 0&&(b.topic="");b.version===void 0&&(b.version=0);b.topicId===void 0&&(b.topicId=d("StateSyncTopicsConfigTypes").TopicId.cast(0));return b}function cc(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.topic===void 0&&(b.topic="");b.version===void 0&&(b.version=0);return b}function dc(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.data=a.readBinary():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRUCT?b.syncPayload=$(a):a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.topicId=d("StateSyncTopicsConfigTypes").TopicId.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.topic===void 0&&(b.topic="");b.version===void 0&&(b.version=0);b.data===void 0&&(b.data=Uint8Array.of());return b}function ec(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.topic=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).I32?b.version=a.readI32():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.topic===void 0&&(b.topic="");b.version===void 0&&(b.version=0);return b}function fc(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 2:f===(h||(h=c("ThriftTypes"))).I32?b.approvalStatus=d("MultiwayCommonTypes").ApprovalStatus.cast(a.readI32()):a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).SET){b.targetUsers=new Set();e=a.readSetBegin();for(var g=0;g<e.size;g++){var i=a.readString();b.targetUsers.add(i)}}else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.approvalStatus===void 0&&(b.approvalStatus=d("MultiwayCommonTypes").ApprovalStatus.cast(0));b.targetUsers===void 0&&(b.targetUsers=new Set());return b}function gc(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.id=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.id===void 0&&(b.id="");return b}function hc(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.actorId=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.baseId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.actorId===void 0&&(b.actorId="");b.baseId===void 0&&(b.baseId="");return b}function ic(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.type=d("MultiwayCommonTypes").MessageType.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.conferenceName=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.transactionId=a.readString():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I16?b.retryCount=a.readI16():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.serverInfoData=a.readString():a.skip(f);break;case 6:f===(h||(h=c("ThriftTypes"))).I32?b.responseStatusCode=d("MultiwayCommonTypes").RtcResponseStatusCode.cast(a.readI32()):a.skip(f);break;case 7:if(f===(h||(h=c("ThriftTypes"))).MAP){b.extensions={};e=a.readMapBegin();for(var g=0;g<e.size;g++){var i=a.readString(),j=a.readString();b.extensions[i]=j}}else a.skip(f);break;case 8:f===(h||(h=c("ThriftTypes"))).I64?b.sequenceNumber=a.readI64().toString():a.skip(f);break;case 9:f===(h||(h=c("ThriftTypes"))).STRING?b.clientSessionId=a.readString():a.skip(f);break;case 10:f===(h||(h=c("ThriftTypes"))).STRING?b.responseStatusMessage=a.readString():a.skip(f);break;case 11:f===(h||(h=c("ThriftTypes"))).I32?b.responseSubCode=d("MultiwayCommonTypes").RtcResponseSubCode.cast(a.readI32()):a.skip(f);break;case 12:f===(h||(h=c("ThriftTypes"))).STRING?b.collisionKey=a.readString():a.skip(f);break;case 13:f===(h||(h=c("ThriftTypes"))).I32?b.conferenceType=d("MultiwaySharedTypes").ConferenceType.cast(a.readI32()):a.skip(f);break;case 14:f===(h||(h=c("ThriftTypes"))).STRING?b.serverSessionId=a.readString():a.skip(f);break;case 15:f===(h||(h=c("ThriftTypes"))).STRING?b.rtcHandle=a.readString():a.skip(f);break;case 16:f===(h||(h=c("ThriftTypes"))).I32?b.retryAfterMsec=a.readI32():a.skip(f);break;case 17:f===(h||(h=c("ThriftTypes"))).STRING?b.receiverUserId=a.readString():a.skip(f);break;case 18:f===(h||(h=c("ThriftTypes"))).I32?b.clientStack=d("WebrtcSignalingCommonTypes").ClientStack.cast(a.readI32()):a.skip(f);break;case 19:f===(h||(h=c("ThriftTypes"))).I64?b.serverMsgTime=a.readI64().toString():a.skip(f);break;case 20:f===(h||(h=c("ThriftTypes"))).STRUCT?b.sender=gc(a):a.skip(f);break;case 21:f===(h||(h=c("ThriftTypes"))).STRUCT?b.receiver=hc(a):a.skip(f);break;case 22:if(f===(h||(h=c("ThriftTypes"))).SET){b.messageTags=new Set();i=a.readSetBegin();for(j=0;j<i.size;j++){g=d("MultiwayCommonTypes").MessageTag.cast(a.readI32());b.messageTags.add(g)}}else a.skip(f);break;case 23:f===(h||(h=c("ThriftTypes"))).I64?b.conferenceId=a.readI64().toString():a.skip(f);break;case 24:f===(h||(h=c("ThriftTypes"))).I32?b.protocolVersion=a.readI32():a.skip(f);break;case 25:f===(h||(h=c("ThriftTypes"))).I64?b.bodyCompressionVersion=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.type===void 0&&(b.type=d("MultiwayCommonTypes").MessageType.cast(0));b.conferenceName===void 0&&(b.conferenceName="");b.transactionId===void 0&&(b.transactionId="");b.retryCount===void 0&&(b.retryCount=0);return b}function jc(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.joinRequest=Pb(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.joinResponse=Qb(a):a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRUCT?b.serverMediaUpdateRequest=xb(a):a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRUCT?b.serverMediaUpdateResponse=yb(a):a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).STRUCT?b.hangupRequest=Ab(a):a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRUCT?b.iceCandidateRequest=Bb(a):a.skip(e);break;case 8:e===(h||(h=c("ThriftTypes"))).STRUCT?b.ringRequest=Xb(a):a.skip(e);break;case 9:e===(h||(h=c("ThriftTypes"))).STRUCT?b.ringResponse=Yb(a):a.skip(e);break;case 10:e===(h||(h=c("ThriftTypes"))).STRUCT?b.dismissRequest=Cb(a):a.skip(e);break;case 11:e===(h||(h=c("ThriftTypes"))).STRUCT?b.conferenceStateRequest=Ib(a):a.skip(e);break;case 12:e===(h||(h=c("ThriftTypes"))).STRUCT?b.conferenceStateResponse=Jb(a):a.skip(e);break;case 13:e===(h||(h=c("ThriftTypes"))).STRUCT?b.addParticipantsRequest=Nb(a):a.skip(e);break;case 14:e===(h||(h=c("ThriftTypes"))).STRUCT?b.subscriptionRequest=Kb(a):a.skip(e);break;case 15:e===(h||(h=c("ThriftTypes"))).STRUCT?b.clientMediaUpdateRequest=ub(a):a.skip(e);break;case 16:e===(h||(h=c("ThriftTypes"))).STRUCT?b.clientMediaUpdateResponse=vb(a):a.skip(e);break;case 17:e===(h||(h=c("ThriftTypes"))).STRUCT?b.dataMessageRequest=Lb(a):a.skip(e);break;case 18:e===(h||(h=c("ThriftTypes"))).STRUCT?b.removeParticipantsRequest=Zb(a):a.skip(e);break;case 19:e===(h||(h=c("ThriftTypes"))).STRUCT?b.dataMessageResponse=Mb(a):a.skip(e);break;case 30:e===(h||(h=c("ThriftTypes"))).STRUCT?b.updateRequest=bc(a):a.skip(e);break;case 31:e===(h||(h=c("ThriftTypes"))).STRUCT?b.updateResponse=cc(a):a.skip(e);break;case 32:e===(h||(h=c("ThriftTypes"))).STRUCT?b.notifyRequest=dc(a):a.skip(e);break;case 33:e===(h||(h=c("ThriftTypes"))).STRUCT?b.notifyResponse=ec(a):a.skip(e);break;case 34:e===(h||(h=c("ThriftTypes"))).STRUCT?b.connectRequest=Rb(a):a.skip(e);break;case 35:e===(h||(h=c("ThriftTypes"))).STRUCT?b.connectResponse=Sb(a):a.skip(e);break;case 36:e===(h||(h=c("ThriftTypes"))).STRUCT?b.clientEventRequest=Ub(a):a.skip(e);break;case 37:e===(h||(h=c("ThriftTypes"))).STRUCT?b.clientEventResponse=Wb(a):a.skip(e);break;case 40:e===(h||(h=c("ThriftTypes"))).STRUCT?b.unsubscribeRequest=$b(a):a.skip(e);break;case 41:e===(h||(h=c("ThriftTypes"))).STRUCT?b.unsubscribeResponse=ac(a):a.skip(e);break;case 42:e===(h||(h=c("ThriftTypes"))).STRUCT?b.approvalRequest=fc(a):a.skip(e);break;case 43:e===(h||(h=c("ThriftTypes"))).STRUCT?b.transferRequest=zb(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function kc(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRUCT?b.messageHeader=ic(a):a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRUCT?b.messageBody=jc(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.messageHeader===void 0&&(b.messageHeader=m());b.messageBody===void 0&&(b.messageBody=n());return b}function lc(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:if(e===(h||(h=c("ThriftTypes"))).SET){b.users=new Set();d=a.readSetBegin();for(var f=0;f<d.size;f++){var g=a.readString();b.users.add(g)}}else a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).BOOL?b.allowMultipleJoins=a.readBool():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).BOOL?b.dismissOthersOnFirstJoin=a.readBool():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.aliasId=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.users===void 0&&(b.users=new Set());b.allowMultipleJoins===void 0&&(b.allowMultipleJoins=!1);b.dismissOthersOnFirstJoin===void 0&&(b.dismissOthersOnFirstJoin=!1);b.aliasId===void 0&&(b.aliasId="");return b}function mc(a){var b,d={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.joinRequest=Pb(a),b="joinRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: joinRequest, previous deserialized field: "+b);else a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.joinResponse=Qb(a),b="joinResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: joinResponse, previous deserialized field: "+b);else a.skip(f);break;case 3:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.serverMediaUpdateRequest=xb(a),b="serverMediaUpdateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: serverMediaUpdateRequest, previous deserialized field: "+b);else a.skip(f);break;case 4:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.serverMediaUpdateResponse=yb(a),b="serverMediaUpdateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: serverMediaUpdateResponse, previous deserialized field: "+b);else a.skip(f);break;case 5:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.hangupRequest=Ab(a),b="hangupRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: hangupRequest, previous deserialized field: "+b);else a.skip(f);break;case 6:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.iceCandidateRequest=Bb(a),b="iceCandidateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: iceCandidateRequest, previous deserialized field: "+b);else a.skip(f);break;case 8:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.ringRequest=Xb(a),b="ringRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: ringRequest, previous deserialized field: "+b);else a.skip(f);break;case 9:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.ringResponse=Yb(a),b="ringResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: ringResponse, previous deserialized field: "+b);else a.skip(f);break;case 10:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.dismissRequest=Cb(a),b="dismissRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: dismissRequest, previous deserialized field: "+b);else a.skip(f);break;case 11:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.conferenceStateRequest=Ib(a),b="conferenceStateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: conferenceStateRequest, previous deserialized field: "+b);else a.skip(f);break;case 12:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.conferenceStateResponse=Jb(a),b="conferenceStateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: conferenceStateResponse, previous deserialized field: "+b);else a.skip(f);break;case 13:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.addParticipantsRequest=Nb(a),b="addParticipantsRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: addParticipantsRequest, previous deserialized field: "+b);else a.skip(f);break;case 14:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.subscriptionRequest=Kb(a),b="subscriptionRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: subscriptionRequest, previous deserialized field: "+b);else a.skip(f);break;case 15:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.clientMediaUpdateRequest=ub(a),b="clientMediaUpdateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientMediaUpdateRequest, previous deserialized field: "+b);else a.skip(f);break;case 16:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.clientMediaUpdateResponse=vb(a),b="clientMediaUpdateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientMediaUpdateResponse, previous deserialized field: "+b);else a.skip(f);break;case 17:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.dataMessageRequest=Lb(a),b="dataMessageRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: dataMessageRequest, previous deserialized field: "+b);else a.skip(f);break;case 18:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.removeParticipantsRequest=Zb(a),b="removeParticipantsRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: removeParticipantsRequest, previous deserialized field: "+b);else a.skip(f);break;case 19:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.dataMessageResponse=Mb(a),b="dataMessageResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: dataMessageResponse, previous deserialized field: "+b);else a.skip(f);break;case 30:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.updateRequest=bc(a),b="updateRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: updateRequest, previous deserialized field: "+b);else a.skip(f);break;case 31:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.updateResponse=cc(a),b="updateResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: updateResponse, previous deserialized field: "+b);else a.skip(f);break;case 32:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.notifyRequest=dc(a),b="notifyRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: notifyRequest, previous deserialized field: "+b);else a.skip(f);break;case 33:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.notifyResponse=ec(a),b="notifyResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: notifyResponse, previous deserialized field: "+b);else a.skip(f);break;case 34:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.connectRequest=Rb(a),b="connectRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: connectRequest, previous deserialized field: "+b);else a.skip(f);break;case 35:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.connectResponse=Sb(a),b="connectResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: connectResponse, previous deserialized field: "+b);else a.skip(f);break;case 36:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.clientEventRequest=Ub(a),b="clientEventRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientEventRequest, previous deserialized field: "+b);else a.skip(f);break;case 37:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.clientEventResponse=Wb(a),b="clientEventResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: clientEventResponse, previous deserialized field: "+b);else a.skip(f);break;case 40:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.unsubscribeRequest=$b(a),b="unsubscribeRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: unsubscribeRequest, previous deserialized field: "+b);else a.skip(f);break;case 41:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.unsubscribeResponse=ac(a),b="unsubscribeResponse";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: unsubscribeResponse, previous deserialized field: "+b);else a.skip(f);break;case 42:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.approvalRequest=fc(a),b="approvalRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: approvalRequest, previous deserialized field: "+b);else a.skip(f);break;case 43:if(f===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)d.transferRequest=zb(a),b="transferRequest";else throw new Error("more than one field have been deserialized in union type: RtcMessageBodyVariant; current field: transferRequest, previous deserialized field: "+b);else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return d}g.RtcException$DefaultConstructor=a;g.SessionDescription$DefaultConstructor=i;g.SessionDescriptionUpdate$DefaultConstructor=b;g.MediaDescriptionUpdate$DefaultConstructor=e;g.ServerMediaUpdate$DefaultConstructor=f;g.ClientMediaUpdate$DefaultConstructor=j;g.IceCandidate$DefaultConstructor=k;g.SyncPayload$DefaultConstructor=l;g.SyncAck$DefaultConstructor=aa;g.E2eeData$DefaultConstructor=ba;g.ClientMediaUpdateRequest$DefaultConstructor=ca;g.ClientMediaUpdateResponse$DefaultConstructor=da;g.MultipleRelaysAllocationParameters$DefaultConstructor=ea;g.ServerMediaUpdateRequest$DefaultConstructor=fa;g.ServerMediaUpdateResponse$DefaultConstructor=ga;g.TransferRequest$DefaultConstructor=ha;g.HangupRequest$DefaultConstructor=ia;g.IceCandidateRequest$DefaultConstructor=ja;g.DismissRequest$DefaultConstructor=ka;g.EndpointSettings$DefaultConstructor=la;g.ParticipantState$DefaultConstructor=ma;g.ServerOnlyParticipantState$DefaultConstructor=na;g.UserProfile$DefaultConstructor=oa;g.ProductMetadata$DefaultConstructor=pa;g.ConferenceStateRequest$DefaultConstructor=qa;g.ConferenceStateResponse$DefaultConstructor=ra;g.SubscriptionRequest$DefaultConstructor=sa;g.DataMessageRequest$DefaultConstructor=ta;g.DataMessageResponse$DefaultConstructor=ua;g.AddParticipantsRequest$DefaultConstructor=va;g.SfuAllocation$DefaultConstructor=wa;g.JoinRequest$DefaultConstructor=xa;g.JoinResponse$DefaultConstructor=ya;g.ConnectRequest$DefaultConstructor=za;g.ConnectResponse$DefaultConstructor=Aa;g.ClientEvent$DefaultConstructor=Ba;g.ClientEventRequest$DefaultConstructor=Ca;g.ThreadIdInfo$DefaultConstructor=Da;g.ClientEventResponse$DefaultConstructor=Ea;g.RingRequest$DefaultConstructor=Fa;g.RingResponse$DefaultConstructor=Ga;g.RemoveParticipantsRequest$DefaultConstructor=Ha;g.UnsubscribeRequest$DefaultConstructor=Ia;g.UnsubscribeResponse$DefaultConstructor=Ja;g.UpdateRequest$DefaultConstructor=Ka;g.UpdateResponse$DefaultConstructor=La;g.NotifyRequest$DefaultConstructor=Ma;g.NotifyResponse$DefaultConstructor=Na;g.ApprovalRequest$DefaultConstructor=Oa;g.RtcSender$DefaultConstructor=Pa;g.RtcReceiver$DefaultConstructor=Qa;g.RtcMessageHeader$DefaultConstructor=m;g.RtcMessageBody$DefaultConstructor=n;g.RtcMultiwayMessage$DefaultConstructor=Ra;g.GroupOfUsers$DefaultConstructor=Sa;g.RtcMessageBodyVariant$DefaultConstructor=Ta;g.serializeRtcException=Ua;g.serializeSessionDescription=o;g.serializeSessionDescriptionUpdate=Va;g.serializeMediaDescriptionUpdate=p;g.serializeServerMediaUpdate=q;g.serializeClientMediaUpdate=r;g.serializeIceCandidate=s;g.serializeSyncPayload=t;g.serializeSyncAck=Wa;g.serializeE2eeData=Xa;g.serializeClientMediaUpdateRequest=u;g.serializeClientMediaUpdateResponse=v;g.serializeMultipleRelaysAllocationParameters=Ya;g.serializeServerMediaUpdateRequest=w;g.serializeServerMediaUpdateResponse=x;g.serializeTransferRequest=y;g.serializeHangupRequest=z;g.serializeIceCandidateRequest=A;g.serializeDismissRequest=B;g.serializeEndpointSettings=Za;g.serializeParticipantState=C;g.serializeServerOnlyParticipantState=$a;g.serializeUserProfile=D;g.serializeProductMetadata=ab;g.serializeConferenceStateRequest=E;g.serializeConferenceStateResponse=F;g.serializeSubscriptionRequest=G;g.serializeDataMessageRequest=H;g.serializeDataMessageResponse=I;g.serializeAddParticipantsRequest=J;g.serializeSfuAllocation=K;g.serializeJoinRequest=L;g.serializeJoinResponse=M;g.serializeConnectRequest=N;g.serializeConnectResponse=O;g.serializeClientEvent=P;g.serializeClientEventRequest=Q;g.serializeThreadIdInfo=bb;g.serializeClientEventResponse=R;g.serializeRingRequest=S;g.serializeRingResponse=T;g.serializeRemoveParticipantsRequest=U;g.serializeUnsubscribeRequest=V;g.serializeUnsubscribeResponse=W;g.serializeUpdateRequest=X;g.serializeUpdateResponse=cb;g.serializeNotifyRequest=db;g.serializeNotifyResponse=eb;g.serializeApprovalRequest=fb;g.serializeRtcSender=gb;g.serializeRtcReceiver=hb;g.serializeRtcMessageHeader=ib;g.serializeRtcMessageBody=jb;g.serializeRtcMultiwayMessage=kb;g.serializeGroupOfUsers=Y;g.serializeRtcMessageBodyVariant=lb;g.deserializeRtcException=mb;g.deserializeSessionDescription=Z;g.deserializeSessionDescriptionUpdate=nb;g.deserializeMediaDescriptionUpdate=ob;g.deserializeServerMediaUpdate=pb;g.deserializeClientMediaUpdate=qb;g.deserializeIceCandidate=rb;g.deserializeSyncPayload=$;g.deserializeSyncAck=sb;g.deserializeE2eeData=tb;g.deserializeClientMediaUpdateRequest=ub;g.deserializeClientMediaUpdateResponse=vb;g.deserializeMultipleRelaysAllocationParameters=wb;g.deserializeServerMediaUpdateRequest=xb;g.deserializeServerMediaUpdateResponse=yb;g.deserializeTransferRequest=zb;g.deserializeHangupRequest=Ab;g.deserializeIceCandidateRequest=Bb;g.deserializeDismissRequest=Cb;g.deserializeEndpointSettings=Db;g.deserializeParticipantState=Eb;g.deserializeServerOnlyParticipantState=Fb;g.deserializeUserProfile=Gb;g.deserializeProductMetadata=Hb;g.deserializeConferenceStateRequest=Ib;g.deserializeConferenceStateResponse=Jb;g.deserializeSubscriptionRequest=Kb;g.deserializeDataMessageRequest=Lb;g.deserializeDataMessageResponse=Mb;g.deserializeAddParticipantsRequest=Nb;g.deserializeSfuAllocation=Ob;g.deserializeJoinRequest=Pb;g.deserializeJoinResponse=Qb;g.deserializeConnectRequest=Rb;g.deserializeConnectResponse=Sb;g.deserializeClientEvent=Tb;g.deserializeClientEventRequest=Ub;g.deserializeThreadIdInfo=Vb;g.deserializeClientEventResponse=Wb;g.deserializeRingRequest=Xb;g.deserializeRingResponse=Yb;g.deserializeRemoveParticipantsRequest=Zb;g.deserializeUnsubscribeRequest=$b;g.deserializeUnsubscribeResponse=ac;g.deserializeUpdateRequest=bc;g.deserializeUpdateResponse=cc;g.deserializeNotifyRequest=dc;g.deserializeNotifyResponse=ec;g.deserializeApprovalRequest=fc;g.deserializeRtcSender=gc;g.deserializeRtcReceiver=hc;g.deserializeRtcMessageHeader=ic;g.deserializeRtcMessageBody=jc;g.deserializeRtcMultiwayMessage=kc;g.deserializeGroupOfUsers=lc;g.deserializeRtcMessageBodyVariant=mc}),98);
__d("OculusMqttChannel",["CurrentUser","HorizonMetaIsCastingRoute","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";c("HorizonMetaIsCastingRoute").getIsCastingRoute()?c("MqttEnvInitializer").initialize(function(a){return new WebSocket(a,"horizon_webcasting")}):c("MqttEnvInitializer").initialize();function h(a){d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);a=c("CurrentUser").getAppID()==null?2763362503905702:Number(c("CurrentUser").getAppID());return new(c("MqttChannel"))({appId:a,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:c("MqttWebConfig").clientCapabilities,clientType:"websocket",deviceId:c("uuidv4")(),endpoint:c("MqttWebConfig").endpoint,initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:c("MqttWebConfig").pollingEndpoint,userFbid:c("CurrentUser").getPossiblyNonFacebookUserID()})}var i=null;function a(a){i==null&&(i=h(a));return i}function b(){return i}function e(){i!=null&&(i.shutdown(),i=null)}g.getOculusMqttChannelInstance=a;g.getOculusMqttChannelInstanceDoNotCreate=b;g.shutdownAndClear=e}),98);
__d("OverlayConfigConstants",[],(function(a,b,c,d,e,f){"use strict";a={OverlayConfigNumParameters:4798,OverlayConfigNotPresentFlagValue:-1};b=a;f["default"]=b}),66);
__d("OverlayConfigLayerSource",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({UNKNOWN:0,DEFAULT:1,MOBILECONFIG:2,APP_CRUCIBLE:3,APP_JNI:4,UNITTEST_CONFIG:5,SERVER:6,PLACEHOLDER:7,LS_MOBILECONFIG:8,APP_LS:9,APP_JS:10,BROWSER:11,APP_OVRRTC:12,APP_IG:13,MLITE4A_LEGACY_QE:14,APP_MLITE4A:15,APP_PORTAL:16,IG_LAUNCHER:17,APP_ARCHON:18,APP_WS:19,APP_NOX:20,APP_WEARABLE_MSNGR:21,APP_WEARABLE_IG:22,APP_ORCA_RSYS:23,APP_WILDE:24,APP_MKIOS:25,APP_MK4A:26,DYNAMIC:27,SDK_DEFAULT:28,APP_FB4A:29,APP_RSYS_SDK_SAMPLE:30,APP_BIZAPP:31,APP_WORKCHAT:32,APP_ARCHON_LOCAL_OVERRIDES:33,APP_CATHODE:34,APP_WR4I:35,APP_WR4A:36,APP_METACAM:37,HORIZON_EMERGENCY:38,APP_SOCIALPLATFORM:39,APP_TWILIGHT:40,APP_AR_CALLING_LOCAL_OVERRIDES:41,APP_TWILIGHT_CASTING:42,TWILIGHT_EMERGENCY:43,METACAM_EMERGENCY:44,CALL_SCOPED:45,APP_CASE50:46});b=a;f["default"]=b}),66);
__d("OverlayConfigServerLayer",["OverlayConfigConstants","OverlayConfigLayerSource"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a}a.createFromHeader=function(b){try{var c;b=b==null||(c=b.extensions)==null?void 0:c.oc1_json;if(b==null)return null;b=JSON.parse(b);b=b==null?void 0:b.values;return b==null?null:new a(b)}catch(a){return null}};var b=a.prototype;b.getLayerSource=function(){return c("OverlayConfigLayerSource").SERVER};b.getValue=function(a){a=this.$1[String(a)];return a!=null?a:c("OverlayConfigConstants").OverlayConfigNotPresentFlagValue};b.logExposure=function(a){};return a}();g["default"]=a}),98);
__d("RequestStreamBodyUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){return g(atob(a))};b=function(a){return btoa(h(a))};c=function(a){a=btoa(a);var b=a.indexOf("=");return b===-1?a:a.substring(0,b)};var g=function(a){a=a;var b=a.length,c=new Uint8Array(b);for(var d=0;d<b;d++)c[d]=a.charCodeAt(d);return c},h=function(a){var b="",c=a.byteLength;for(var d=0;d<c;d++)b+=String.fromCharCode(a[d]);return b};f.base64ToUint8Array=a;f.uint8ArrayToBase64=b;f.stringToBase64WithoutPadding=c;f.stringToUint8Array=g;f.uint8ArrayToString=h}),66);
__d("ZenonIceStatsParser",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=[];a=a.split("\r\n");a.forEach(function(a){g(a)&&b.push({gen:h(a),type:i(a)})});return b}function g(a){return a.indexOf("candidate:")>-1}function h(a){var b=0;a=a.match(/generation (\d+)/);a&&(b=parseInt(a[1],10));return b}function i(a){a=a.match(/typ (host|relay|srflx|prflx)/);if(a)return a[1];else return"unknown"}f.extractIceInfo=a}),66);
__d("ZenonMWThriftMessageMap",["MultiwayCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==null)return"UNKNOWN";switch(a){case d("MultiwayCommonTypes").MessageType.JOIN:return"JOIN";case d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:return"SERVER_MEDIA_UPDATE";case d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:return"ICE_CANDIDATE";case d("MultiwayCommonTypes").MessageType.HANGUP:return"HANGUP";case d("MultiwayCommonTypes").MessageType.RING:return"RING";case d("MultiwayCommonTypes").MessageType.DISMISS:return"DISMISS";case d("MultiwayCommonTypes").MessageType.CONFERENCE_STATE:return"CONFERENCE_STATE";case d("MultiwayCommonTypes").MessageType.ADD_PARTICIPANTS:return"ADD_PARTICIPANTS";case d("MultiwayCommonTypes").MessageType.SUBSCRIPTION:return"SUBSCRIPTION";case d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:return"CLIENT_MEDIA_UPDATE";case d("MultiwayCommonTypes").MessageType.DATA_MESSAGE:return"DATA_MESSAGE";case d("MultiwayCommonTypes").MessageType.REMOVE_PARTICIPANTS:return"REMOVE_PARTICIPANTS";case d("MultiwayCommonTypes").MessageType.PING:return"PING";case d("MultiwayCommonTypes").MessageType.NOTIFY:return"NOTIFY";case d("MultiwayCommonTypes").MessageType.CONNECT:return"CONNECT";case d("MultiwayCommonTypes").MessageType.CLIENT_EVENT:return"CLIENT_EVENT";case d("MultiwayCommonTypes").MessageType.UNSUBSCRIBE:return"UNSUBSCRIBE";case d("MultiwayCommonTypes").MessageType.UPDATE:return"UPDATE";case d("MultiwayCommonTypes").MessageType.APPROVAL:return"APPROVAL";case d("MultiwayCommonTypes").MessageType.WAKEUP:return"WAKEUP";default:return"UNKNOWN"}}function b(a){switch(a.toLowerCase()){case"join":return d("MultiwayCommonTypes").MessageType.JOIN;case"server_media_update":return d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE;case"ice_candidate":return d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE;case"hangup":return d("MultiwayCommonTypes").MessageType.HANGUP;case"ring":return d("MultiwayCommonTypes").MessageType.RING;case"dismiss":return d("MultiwayCommonTypes").MessageType.DISMISS;case"conference_state":return d("MultiwayCommonTypes").MessageType.CONFERENCE_STATE;case"add_participants":return d("MultiwayCommonTypes").MessageType.ADD_PARTICIPANTS;case"subscription":return d("MultiwayCommonTypes").MessageType.SUBSCRIPTION;case"client_media_update":return d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE;case"data_message":return d("MultiwayCommonTypes").MessageType.DATA_MESSAGE;case"remove_participants":return d("MultiwayCommonTypes").MessageType.REMOVE_PARTICIPANTS;case"ping":return d("MultiwayCommonTypes").MessageType.PING;case"notify":return d("MultiwayCommonTypes").MessageType.NOTIFY;case"connect":return d("MultiwayCommonTypes").MessageType.CONNECT;case"client_event":return d("MultiwayCommonTypes").MessageType.CLIENT_EVENT;case"unsubscribe":return d("MultiwayCommonTypes").MessageType.UNSUBSCRIBE;case"update":return d("MultiwayCommonTypes").MessageType.UPDATE;case"approval":return d("MultiwayCommonTypes").MessageType.APPROVAL;case"wakeup":return d("MultiwayCommonTypes").MessageType.WAKEUP;default:return null}}g.messageTypeToString=a;g.messageTypeFromString=b}),98);
__d("ZenonEndCallReason",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({BREAKOUT_SESSION_SWITCH_ROOM:"BreakoutSessionSwitchRoom",CALL_END_ACCEPT_AFTER_HANG_UP:"CallEndAcceptAfterHangUp",CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:"CallerHasAppealableCallingRestriction",CALLER_NOT_VISIBLE:"CallerNotVisible",CAMERA_PERMISSION_DENIED:"CameraPermissionDenied",CARRIER_BLOCKED:"CarrierBlocked",CLIENT_ENCRYPTION_ERROR:"ClientEncryptionError",CLIENT_ERROR:"ClientError",CLIENT_INTERRUPTED:"ClientInterrupted",CONNECTION_DROPPED:"ConnectionDropped",END_TO_END_ENCRYPTION_INVARIANT_VIOLATED:"EndToEndEncryptionInvariantViolated",HANGUP_CALL:"HangupCall",IGNORE_CALL:"IgnoreCall",IN_ANOTHER_CALL:"InAnotherCall",INACTIVE_TIMEOUT:"InactiveTimeout",INCOMING_TIMEOUT:"IncomingTimeout",MAX_ALLOWED_PARTICIPANTS_REACHED:"MaxAllowedParticipantsReached",MICROPHONE_PERMISSION_DENIED:"MicrophonePermissionDenied",NO_ANSWER_TIMEOUT:"NoAnswerTimeout",NO_PERMISSION:"NoPermission",NO_UI_SHOWN:"NoUIShown",OTHER_CARRIER_BLOCKED:"OtherCarrierBlocked",OTHER_INSTANCE_HANDLED:"OtherInstanceHandled",OTHER_NOT_CAPABLE:"OtherNotCapable",PRODUCT_SERVER_DEFINED_END_REASON:"ProductServerDefinedEndReason",REMOVED_BY_PARTICIPANT:"RemovedByParticipant",RING_MUTED:"RingMuted",SESSION_MIGRATED:"SessionMigrated",SIGNALING_MESSAGE_FAILED:"SignalingMessageFailed",TX_ACK_TIMEOUT:"TxAckTimeout",UNEXPECTED_END_OF_CALL:"UnexpectedEndOfCall",UNKNOWN:"Unknown",VERSION_UNSUPPORTED:"VersionUnsupported",WEBRTC_ERROR:"WebRTCError"});c=a;f["default"]=c}),66);
__d("ZenonIncomingRingSDKTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Hangup","OtherDismiss"]);f.ZenonCancelReason=a}),66);
__d("fbwebrtc_ClientStack",[],(function(a,b,c,d,e,f){a=Object.freeze({OLD_CLIENT_PLATFORM_STACK:0,RSYS_X:1,IG_OLD_STACK:2,MLITE_OLD_STACK:3,SCOTCH:4,ZENON:5});f["default"]=a}),66);
__d("multiway_ApprovalStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({DENIED:0,APPROVED:1});f["default"]=a}),66);
__d("multiway_Capability",[],(function(a,b,c,d,e,f){a=Object.freeze({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8,SUPPORT_PARTICIPANT_STATE_UNCALLABLE:9,SUPPORT_MULTIPLE_VIDEO_STREAMS:10,REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED:11,SUPPORT_MULTISTREAM_FEC:12,SUPPORT_DELTA_SMU:13,REQUIRE_DEFAULT_CHANNEL_SCREENSHARE:14,SUPPORT_SCREENSHARE_FLAG_IN_JOIN_RESPONSE_AND_SMU:15,SUPPORT_TEMPORAL_LAYER_JBE:16,REQUIRES_P2P_RELAY_INFO_VIA_SIGNALING:17,SUPPORT_NUMERIC_TOPICS:18,SUPPORT_PSEUDO_QUIC_CONNECTION:19,SUPPORT_SDP_SENDRECV:20});f["default"]=a}),66);
__d("multiway_ClientEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,MEDIA_CONNECTED:1});f["default"]=a}),66);
__d("multiway_ConferenceType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,IGVIDEOCALL:9,ROOM:15,CRUCIBLE:20,MBS_WA:21,BOT:22,HORIZON:23,ULLC:24});f["default"]=a}),66);
__d("multiway_DeviceStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10});f["default"]=a}),66);
__d("multiway_DismissReason",[],(function(a,b,c,d,e,f){a=Object.freeze({CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,CALL_ENDED_BY_PRODUCT:9,JOIN_APPROVAL_DENIED:10,JOIN_APPROVAL_TIMEDOUT:11,UNSUPPORTED_VERSION:12,LIVE_NOT_ACKED:13,TX_ACK_TIMEDOUT:14,ANSWERED_BY_OTHER_USER:15,PARTICIPANT_SELF_TERMINATION:16,PARTICIPANT_REJOIN:17,LONG_LASTING_AUDIO_ISSUE:18,PRIMARY_ENDPOINT_HANGUP:19,RECONNECT_FAILED:20,E2EE_HARDENING_ERROR:21,CALL_ENDED_BY_EXTENSION:22,CALL_ENDED_BY_OVER_CAPACITY:23});f["default"]=a}),66);
__d("multiway_E2eeMode",[],(function(a,b,c,d,e,f){a=Object.freeze({E2EE_NOT_MANDATED:0,DEPRECATED_NO_REQUIREMENT:1,E2EE_MANDATED:2});f["default"]=a}),66);
__d("multiway_EndpointServiceType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,COMPOSITING_SERVICE:1,MEDIA_SERVER:2,CATHODE_AMBISONIC:3,CATHODE_CAPTIONS:4,CATHODE_MEETING_SUMMARIZER:5,CATHODE_REALTIME_SHARED_STATE:6,RP_GENAI_SERVICE:7,SMART_GLASSES_ASSISTANT:8});f["default"]=a}),66);
__d("multiway_HangupReason",[],(function(a,b,c,d,e,f){a=Object.freeze({IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6,E2EE_MANDATED_BUT_OFFER_DID_NOT_CONTAIN_E2EE:7,E2EE_MANDATED_BUT_ANSWER_DID_NOT_NEGOTIATE_E2EE:8,WEBRTC_ERROR:9,CONNECTION_DROPPED:10});f["default"]=a}),66);
__d("multiway_JoinMode",[],(function(a,b,c,d,e,f){a=Object.freeze({PRIMARY:0,SECONDARY:1});f["default"]=a}),66);
__d("multiway_MediaPath",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,SFU:1,P2P:2});f["default"]=a}),66);
__d("multiway_MediaPauseStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({NotPaused:0,Paused:1});f["default"]=a}),66);
__d("multiway_MessageTag",[],(function(a,b,c,d,e,f){a=Object.freeze({PRANSWER:1001,INITIAL_ANSWER_TO_P2P_CALLER:1002,DEESCALATE_OFFER_TO_P2P_CALLEE:1003,DEESCALATE_ANSWER_TO_P2P_CALLER:1004,REQUEST_DEESCALATE_TO_P2P_CALLER:1005,REQUEST_ESCALATE:1006,REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:1007,REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:1008,PARTICIPANT_ADDED:1009,PARTICIPANT_REMOVED:1010,FIRST_REMOTE_ALERTED_FOR_INITIATOR:2001,FIRST_REMOTE_ANSWERED_FOR_INITIATOR:2002,CONTAIN_PENDING_APPROVAL_PARTICIPANTS:2003,KEEP_ALIVE_PING:3001,IS_INITIATOR:4001,PREGEN_SDP:4002});f["default"]=a}),66);
__d("multiway_MessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26,TRANSFER:27,WAKEUP:28});f["default"]=a}),66);
__d("multiway_ParticipantCallState",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11,RING_TYPE_UNSUPPORTED:12,PENDING_APPROVAL:13,APPROVED:14,FAILED_APPROVAL:15,HANGUP_IN_WAITING_ROOM:16,UNCALLABLE:17,UNCALLABLE_DELAYED:18});f["default"]=a}),66);
__d("multiway_RingType",[],(function(a,b,c,d,e,f){a=Object.freeze({GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6,LIVE_AUDIO_ROOM:7,LIVE_WITH_ROOM:8});f["default"]=a}),66);
__d("multiway_RtcResponseStatusCode",[],(function(a,b,c,d,e,f){a=Object.freeze({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503});f["default"]=a}),66);
__d("multiway_RtcResponseSubCode",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:1e3,EXCEEDED_MAX_ALLOWED_PARTICIPANTS:1001,MEMBERSHIP_CHECK_FAIL:1002,CONFERENCE_THROTTLED:1003,ENDPOINT_THROTTLED:1004,MWS_MESSAGE_SENT_TO_INCORRECT_REGION:1005,UNSUPPORTED_REQUEST_TYPE:2e3,CLIENT_REQUEST_UNACCEPTABLE:2001,CLIENT_RESPONSE_UNACCEPTABLE:2002,RING_RESPONSE_BODY_NOT_SET:2004,SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:2005,INVALID_SDP:2006,INVALID_CONFERENCE_NAME:2007,SERVER_INFO_CONFERENCE_NAME_MISMATCH:2008,INVALID_USER_ID:2009,INCORRECT_VERSION_RANGE:2010,SENDER_ID_MISMATCH:2011,RECIPIENT_NOT_SPECIFIED:2012,FIELD_NOT_ALLOWED:2013,USERS_NOT_SPECIFIED:2015,REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:2016,INVALID_CALL_ID:2017,SESSION_DESCRIPTION_ID_MISMATCH:2018,EMPTY_CLIENT_MEDIA_UPDATES:2019,INVALID_SERVER_INFO_DATA:2020,INCORRECT_STATE_VERSION:2021,MISMATCHED_STATE_FOR_VERSION:2022,INVALID_STATE_VERSION:2023,NO_RESOLVER_FOUND:2024,MISSING_APPROVERLIST:2025,FULL_SDP_REQUIRED_IN_APPROVED_STATE:2026,INVALID_BROADCAST_ID:2027,INVALID_ENDPOINT_CONFIG:2028,INVALID_E2EE_STATE:2029,SFU_MODE_PREVENTED:2030,INVALID_CONFERENCE_STATE:2031,JOIN_REQUEST_DENIED:2032,EMPTY_USER_IDS:2033,MISSING_SDP_CONNECT_REQUEST:2034,CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:2035,MISSING_BODY_ENDPOINT:2101,MISSING_BODY_HEADER:2102,MISSING_BODY_BODY:2103,MISSING_BODY_PARAMS:2104,MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:2105,MISSING_BODY_DATA_MESSAGE_REQUEST:2106,MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:2107,MISSING_BODY_ADD_PARTICIPANTS_REQUEST:2108,MISSING_BODY_SUBSCRIPTION_REQUEST:2110,MISSING_BODY_JOIN_REQUEST:2111,MISSING_BODY_HANGUP_REQUEST:2112,MISSING_BODY_ICE_CANDIDATE_REQUEST:2113,MISSING_BODY_P2P_MESSAGE_REQUEST:2114,MISSING_BODY_UPDATE_REQUEST:2115,MISSING_BODY_CLIENT_EVENT_REQUEST:2116,MISSING_BODY_CONNECT_REQUEST:2117,MISSING_BODY_UNSUBSCRIBE_REQUEST:2118,MISSING_BODY_APPROVAL_REQUEST:2119,MISSING_ENDPOINT_USER_ID:2120,EMPTY_ENDPOINT_USER_ID:2121,MISSING_BODY_TRANSFER_REQUEST:2122,MISSING_BODY_GENERIC:2199,REQUESTOR_NOT_MEMBER_CONFERENCE:3002,NOT_BROADCAST_OWNER:3003,GUEST_NOT_INVITED:3004,GUEST_DISCONNECTED:3005,GUEST_INVITATION_EXPIRED:3006,PARTICIPANT_IN_PENDING_APPROVAL_STATE:3008,INVALID_MULTIWAY_PARAMS:3009,BROADCAST_ALREADY_STOPPED:4002,FAILED_TO_GENERATE_SDP_ANSWER:4003,FAILED_GENERATE_SESSION_DESCRIPTION:4004,SDP_SESSION_ID_MISMATCH:4005,MEDIA_ENDPOINT_GONE:4007,MEDIA_ENDPOINT_ALREADY_EXISTS:4008,MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:4009,LEGACY_MESSENGER_SENDER_UNSET:4010,FAILED_TO_SET_TRANSPORT_INFO:4011,NON_PRIMARY_MULTIWAY_SERVER:4012,FAILED_TO_GET_REMOTE_DESCRIPTION:4013,LOCAL_DESCRIPTION_NOT_SET:4014,INVALID_SDP_TYPE:4015,CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:4016,SDP_UNSET_ON_P2P_ANSWER:4017,MISSING_ICE_CANDIDATE_PAYLOAD:4018,P2P_PROTOCOL_UNSET:4019,CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:4020,LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:4021,CONNECT_UNSUPPORTED_IN_SFU_MODE:4022,CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:4023,RESOLVE_STATE_API_ERROR:4024,EXTERNAL_RESOLUTION_ERROR:4025,INTERNAL_RESOLUTION_ERROR:4026,RESOLUTION_DISABLED:4027,BROADCAST_ID_MISSING:4028,SDP_UNSET_ON_P2P_OFFER:4029,LEGACY_OFFER_MISSING_REQUIRED_VALUE:4031,MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:4032,CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:4033,OTHER_USER_ANSWERED_THE_CALL:4034,MEDIA_SERVER_DESERIALIZATION_ERROR:4035,REMOTE_SDP_TRACKID_MISMATCH:4036,SIGNALING_MESSAGE_TO_CLIENT_DROPPED:4037,DATA_CHANNEL_ENDPOINT_GONE:4038,DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:4039,CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:4040,P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:4041,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:4042,CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:4043,REQUEST_TIMEOUT:4044,TOO_MANY_MEDIA_TRACKS_IN_SDP:4045,CONFERENCE_NOT_FOUND:5001,CONFERENCE_IS_TERMINATING:5002,CONFERENCE_IS_TERMINATED:5003,CONFERENCE_NAME_EMPTY:5004,NONCE_EMPTY:5005,NONCE_MISMATCH:5006,CONFERENCE_HAS_GONE:5007,PARTICIPANT_HAS_GONE:5008,MEDIA_SERVER_NOT_FOUND:5009,CLIENT_TERMINATED:5010,JOIN_SESSION_RESULT_MISSING:5012,LOGGING_POLICY_RESULT_MISSING:5013,INVITE_USERS_RESULT_MISSING:5014,STATE_SYNC_RESULT_MISSING:5015,ENDPOINT_INFO_RESULT_MISSING:5016,CONFERENCE_NAME_MISMATCH:5017,UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME:5018,SESSION_CONFIGURATION_RESULT_MISSING:5019,MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:6001,CONFERENCE_INCAPABLE_RENEGOTIATION:6002,REJECTING_CMU_WHEN_SMU_PENDING:6003,PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:6004,PARTICIPANT_ALREADY_IN_WAITING_ROOM:6005,PARTICIPANT_NOT_IN_PENDING_APPROVAL:6006,USER_NOT_APPROVER_FOR_TARGET_USER:6007,UNSUPPORTED_CAPABILITIES:6008,PRODUCT_SERVER_DEFINED_END_REASON:6009,WWW_KILLSWITCHED_REQUEST:6010,CONFLICTING_MEDIA_PATH:6011,CONFLICTING_MEDIA_STATUS:6012,CONFLICTING_SESSION_DESCRIPTION:6013,OK:9e3});f["default"]=a}),66);
__d("multiway_SubscriptionType",[],(function(a,b,c,d,e,f){a=Object.freeze({CNAME:0,TRACK:1,DOMINANT_SPEAKER:2});f["default"]=a}),66);
__d("multiway_VideoQuality",[],(function(a,b,c,d,e,f){a=Object.freeze({LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4});f["default"]=a}),66);
__d("ZenonMWMessageTypes",["$InternalEnum","fbwebrtc_ClientStack","multiway_ApprovalStatus","multiway_Capability","multiway_ClientEventType","multiway_ConferenceType","multiway_DeviceStatus","multiway_DismissReason","multiway_E2eeMode","multiway_EndpointServiceType","multiway_HangupReason","multiway_JoinMode","multiway_MediaPath","multiway_MediaPauseStatus","multiway_MessageTag","multiway_MessageType","multiway_ParticipantCallState","multiway_RingType","multiway_RtcResponseStatusCode","multiway_RtcResponseSubCode","multiway_SubscriptionType","multiway_VideoQuality"],(function(a,b,c,d,e,f,g){"use strict";a=b("$InternalEnum")({DEFAULT_AUDIO:0,DEFAULT_VIDEO:1,SCREEN_AUDIO:2,SCREEN_VIDEO:3});g.ZenonMWClientStack=c("fbwebrtc_ClientStack");g.ZenonMWApprovalStatus=c("multiway_ApprovalStatus");g.ZenonMWCapability=c("multiway_Capability");g.ZenonMWClientEventType=c("multiway_ClientEventType");g.ZenonMWConferenceType=c("multiway_ConferenceType");g.ZenonMWDeviceStatus=c("multiway_DeviceStatus");g.ZenonMWDismissReason=c("multiway_DismissReason");g.ZenonMWE2eeMode=c("multiway_E2eeMode");g.ZenonMWEndpointServiceType=c("multiway_EndpointServiceType");g.ZenonMWHangupReason=c("multiway_HangupReason");g.ZenonMWMediaPath=c("multiway_MediaPath");g.ZenonMWJoinMode=c("multiway_JoinMode");g.ZenonMWMediaPauseStatus=c("multiway_MediaPauseStatus");g.ZenonMWMessageTag=c("multiway_MessageTag");g.ZenonMWSignalingPayloadType=c("multiway_MessageType");g.ZenonMWParticipantCallState=c("multiway_ParticipantCallState");g.ZenonMWRingType=c("multiway_RingType");g.ZenonMWResponseStatusCode=c("multiway_RtcResponseStatusCode");g.ZenonMWResponseSubCode=c("multiway_RtcResponseSubCode");g.ZenonMWSubscriptionType=c("multiway_SubscriptionType");g.ZenonMWVideoQuality=c("multiway_VideoQuality");g.ZenonMWTrackLabel=a}),98);
__d("ZenonMediaError",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["ConnectionClosed","IceDisconnected","IceFailure","SetLocalSdpFailed","SetRemoteSdpFailed","RollbackSdpFailed","UnknownError"]);f.ZenonMediaError=a}),66);
__d("ZenonDismissReason",["$InternalEnum","FBLogger","ZenonIncomingRingSDKTypes","ZenonMWMessageTypes","ZenonMediaError"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("$InternalEnum")({IgnoreCall:0,HangupCall:1,InAnotherCall:2,AcceptAfterHangUp:3,NoAnswerTimeout:4,IncomingTimeout:5,OtherInstanceHandled:6,SignalingMessageFailed:7,ConnectionDropped:8,ClientInterrupted:9,WebRTCError:10,ClientError:11,NoPermission:12,OtherNotCapable:13,NoUIShown:14,VersionUnsupported:15,CallerNotVisible:16,CarrierBlocked:17,OtherCarrierBlocked:18,ClientEncryptionError:19,MicrophonePermissionDenied:20,CameraPermissionDenied:21,SessionMigrated:22,RingMuted:23,JoinApprovalDenied:24,RejectedByCallee:25,CallEndedByProduct:26,CallEnded:27,AnsweredOnAnotherDevice:28,RejectedOnAnotherDevice:29,CallCollision:30,MaxAllowedParticipantsReached:31,UnexpectedEndOfCall:32,TxAckTimeout:33,EndToEndEncryptionInvariantViolated:34,ProductServerDefinedEndReason:35,RemovedByParticipant:39,AnsweredByOtherUser:40,CallerHasAppealableCallingRestriction:41});function a(a){switch(a){case"BreakoutSessionSwitchRoom":return i.HangupCall;case"CallEndAcceptAfterHangUp":return i.AcceptAfterHangUp;case"CallerNotVisible":return i.CallerNotVisible;case"CarrierBlocked":return i.CarrierBlocked;case"ClientEncryptionError":return i.ClientEncryptionError;case"ClientError":return i.ClientError;case"ClientInterrupted":return i.ClientInterrupted;case"ConnectionDropped":return i.ConnectionDropped;case"HangupCall":return i.HangupCall;case"IgnoreCall":return i.IgnoreCall;case"InAnotherCall":return i.InAnotherCall;case"EndToEndEncryptionInvariantViolated":return i.EndToEndEncryptionInvariantViolated;case"InactiveTimeout":return i.CallEnded;case"IncomingTimeout":return i.IncomingTimeout;case"MaxAllowedParticipantsReached":return i.MaxAllowedParticipantsReached;case"NoAnswerTimeout":return i.NoAnswerTimeout;case"NoPermission":return i.NoPermission;case"NoUIShown":return i.NoUIShown;case"OtherCarrierBlocked":return i.OtherCarrierBlocked;case"OtherInstanceHandled":return i.OtherInstanceHandled;case"OtherNotCapable":return i.OtherNotCapable;case"SignalingMessageFailed":return i.SignalingMessageFailed;case"UnexpectedEndOfCall":return i.UnexpectedEndOfCall;case"Unknown":return i.CallEnded;case"VersionUnsupported":return i.VersionUnsupported;case"WebRTCError":return i.WebRTCError;case"MicrophonePermissionDenied":return i.MicrophonePermissionDenied;case"CameraPermissionDenied":return i.CameraPermissionDenied;case"SessionMigrated":return i.SessionMigrated;case"RingMuted":return i.RingMuted;case"TxAckTimeout":return i.TxAckTimeout;case"ProductServerDefinedEndReason":return i.ProductServerDefinedEndReason;case"RemovedByParticipant":return i.RemovedByParticipant;case"CallerHasAppealableCallingRestriction":return i.CallerHasAppealableCallingRestriction}}function e(a){switch(a){case i.CallEnded:case i.CallEndedByProduct:case i.HangupCall:return"HangupCall";case i.IgnoreCall:case i.JoinApprovalDenied:case i.RejectedByCallee:return"IgnoreCall";case i.InAnotherCall:return"InAnotherCall";case i.AcceptAfterHangUp:return"CallEndAcceptAfterHangUp";case i.NoAnswerTimeout:return"NoAnswerTimeout";case i.IncomingTimeout:return"IncomingTimeout";case i.AnsweredOnAnotherDevice:case i.CallCollision:case i.RejectedOnAnotherDevice:case i.OtherInstanceHandled:case i.AnsweredByOtherUser:return"OtherInstanceHandled";case i.SignalingMessageFailed:return"SignalingMessageFailed";case i.ConnectionDropped:return"ConnectionDropped";case i.ClientInterrupted:return"ClientInterrupted";case i.WebRTCError:return"WebRTCError";case i.ClientError:return"ClientError";case i.NoPermission:return"NoPermission";case i.OtherNotCapable:return"OtherNotCapable";case i.NoUIShown:return"NoUIShown";case i.VersionUnsupported:return"VersionUnsupported";case i.CallerNotVisible:return"CallerNotVisible";case i.CarrierBlocked:return"CarrierBlocked";case i.OtherCarrierBlocked:return"OtherCarrierBlocked";case i.ClientEncryptionError:return"ClientEncryptionError";case i.UnexpectedEndOfCall:return"UnexpectedEndOfCall";case i.MaxAllowedParticipantsReached:return"MaxAllowedParticipantsReached";case i.MicrophonePermissionDenied:return"MicrophonePermissionDenied";case i.CameraPermissionDenied:return"CameraPermissionDenied";case i.SessionMigrated:return"SessionMigrated";case i.RingMuted:return"RingMuted";case i.TxAckTimeout:return"TxAckTimeout";case i.EndToEndEncryptionInvariantViolated:return"EndToEndEncryptionInvariantViolated";case i.ProductServerDefinedEndReason:return"ProductServerDefinedEndReason";case i.RemovedByParticipant:return"RemovedByParticipant";case i.CallerHasAppealableCallingRestriction:return"CallerHasAppealableCallingRestriction"}c("FBLogger")("rtc_www").mustfix("Unknown dismiss reason: %s",a);return"Unknown"}function f(a){switch(a){case i.OtherInstanceHandled:case i.AnsweredOnAnotherDevice:case i.AnsweredByOtherUser:case i.RejectedOnAnotherDevice:return d("ZenonIncomingRingSDKTypes").ZenonCancelReason.OtherDismiss;default:return d("ZenonIncomingRingSDKTypes").ZenonCancelReason.Hangup}}function j(a){switch(a){case d("ZenonMediaError").ZenonMediaError.IceDisconnected:return i.ConnectionDropped;case d("ZenonMediaError").ZenonMediaError.ConnectionClosed:return i.HangupCall;case d("ZenonMediaError").ZenonMediaError.IceFailure:case d("ZenonMediaError").ZenonMediaError.SetLocalSdpFailed:case d("ZenonMediaError").ZenonMediaError.SetRemoteSdpFailed:case d("ZenonMediaError").ZenonMediaError.RollbackSdpFailed:return i.WebRTCError;case d("ZenonMediaError").ZenonMediaError.UnknownError:return i.UnexpectedEndOfCall}}function k(a){return l[a]}var l=Object.freeze((b={},b[(h=d("ZenonMWMessageTypes")).ZenonMWDismissReason.CALL_ENDED]=i.CallEnded,b[h.ZenonMWDismissReason.ANSWERED_ON_ANOTHER_DEVICE]=i.AnsweredOnAnotherDevice,b[h.ZenonMWDismissReason.ANSWERED_BY_OTHER_USER]=i.AnsweredByOtherUser,b[h.ZenonMWDismissReason.IN_ANOTHER_CALL]=i.InAnotherCall,b[h.ZenonMWDismissReason.CONNECTION_DROPPED]=i.ConnectionDropped,b[h.ZenonMWDismissReason.REJECTED_ON_ANOTHER_DEVICE]=i.RejectedOnAnotherDevice,b[h.ZenonMWDismissReason.REJECTED_BY_CALLEE]=i.RejectedByCallee,b[h.ZenonMWDismissReason.CALL_ENDED_BY_PRODUCT]=i.CallEndedByProduct,b[h.ZenonMWDismissReason.INTERNAL_ERROR]=i.SignalingMessageFailed,b[h.ZenonMWDismissReason.REMOVED_BY_PARTICIPANT]=i.RemovedByParticipant,b[h.ZenonMWDismissReason.TX_ACK_TIMEDOUT]=i.TxAckTimeout,b));g.ZenonDismissReason=i;g.endCallToDismissReason=a;g.dismissToEndCallReason=e;g.dismissReasonToCancelReason=f;g.mediaErrorToDismissReason=j;g.mwDismissToDmissReason=k}),98);
__d("ZenonMWThriftMessageTagUtils",["MultiwayCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";function h(a){switch(a){case d("MultiwayCommonTypes").MessageTag.PRANSWER:return 1001;case d("MultiwayCommonTypes").MessageTag.INITIAL_ANSWER_TO_P2P_CALLER:return 1002;case d("MultiwayCommonTypes").MessageTag.DEESCALATE_OFFER_TO_P2P_CALLEE:return 1003;case d("MultiwayCommonTypes").MessageTag.DEESCALATE_ANSWER_TO_P2P_CALLER:return 1004;case d("MultiwayCommonTypes").MessageTag.REQUEST_DEESCALATE_TO_P2P_CALLER:return 1005;case d("MultiwayCommonTypes").MessageTag.REQUEST_ESCALATE:return 1006;case d("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM:return 1007;case d("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS:return 1008;case d("MultiwayCommonTypes").MessageTag.PARTICIPANT_ADDED:return 1009;case d("MultiwayCommonTypes").MessageTag.PARTICIPANT_REMOVED:return 1010;case d("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ALERTED_FOR_INITIATOR:return 2001;case d("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ANSWERED_FOR_INITIATOR:return 2002;case d("MultiwayCommonTypes").MessageTag.CONTAIN_PENDING_APPROVAL_PARTICIPANTS:return 2003;case d("MultiwayCommonTypes").MessageTag.KEEP_ALIVE_PING:return 3001;case d("MultiwayCommonTypes").MessageTag.IS_INITIATOR:return 4001;case d("MultiwayCommonTypes").MessageTag.PREGEN_SDP:return 4002}}function a(a){switch(a){case 1001:return d("MultiwayCommonTypes").MessageTag.PRANSWER;case 1002:return d("MultiwayCommonTypes").MessageTag.INITIAL_ANSWER_TO_P2P_CALLER;case 1003:return d("MultiwayCommonTypes").MessageTag.DEESCALATE_OFFER_TO_P2P_CALLEE;case 1004:return d("MultiwayCommonTypes").MessageTag.DEESCALATE_ANSWER_TO_P2P_CALLER;case 1005:return d("MultiwayCommonTypes").MessageTag.REQUEST_DEESCALATE_TO_P2P_CALLER;case 1006:return d("MultiwayCommonTypes").MessageTag.REQUEST_ESCALATE;case 1007:return d("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_TO_ADMIT_FROM_WAITINGROOM;case 1008:return d("MultiwayCommonTypes").MessageTag.REQUEST_CLIENT_FULL_RENEGOTIATION_AGAINST_MWS;case 1009:return d("MultiwayCommonTypes").MessageTag.PARTICIPANT_ADDED;case 1010:return d("MultiwayCommonTypes").MessageTag.PARTICIPANT_REMOVED;case 2001:return d("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ALERTED_FOR_INITIATOR;case 2002:return d("MultiwayCommonTypes").MessageTag.FIRST_REMOTE_ANSWERED_FOR_INITIATOR;case 2003:return d("MultiwayCommonTypes").MessageTag.CONTAIN_PENDING_APPROVAL_PARTICIPANTS;case 3001:return d("MultiwayCommonTypes").MessageTag.KEEP_ALIVE_PING;case 4001:return d("MultiwayCommonTypes").MessageTag.IS_INITIATOR;case 4002:return d("MultiwayCommonTypes").MessageTag.PREGEN_SDP}}function b(a){var b=[];a==null||a.forEach(function(a){a&&b.push(h(a))});return b}g.toThriftMessageTag=a;g.fromThriftMessageTags=b}),98);
__d("ZenonCallsModelTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum")).Mirrored(["Disconnected","Precontacting","Contacting","Ringing","PendingApproval","Approved","FailedApproval","Connecting","Connected","Reconnecting","ProvisionalRinging"]);d=a.Mirrored(["Facebook","Instagram","Messenger","Guest","WhatsApp","Workplace"]);e=a.Mirrored(["New","Connecting","PendingApproval","Connected","Terminating","Terminated"]);b=a.Mirrored(["Unknown","CallsBlocked","PageAdminPressedDecline"]);a=a.Mirrored(["None","PendingPeerFeedback","Declined","RemoteDeclined","LocalDeclined","Cancelled","TimedOut","Accepted","InitiatedFromPeer"]);f.ZenonCallParticipantState=c;f.ZenonCallParticipantType=d;f.ZenonCallState=e;f.ZenonEndCallSubreason=b;f.ZenonVideoEscalationStatus=a}),66);
__d("ZenonParticipantState",["$InternalEnum","ZenonCallsModelTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum")({UNKNOWN:0,ADDING:1,CONTACTING:2,RINGING:3,ACCEPTING:4,PRECONNECTING:5,CONNECTING:6,CONNECTED:7,REMOVING:8,DISCONNECTED:9,NO_ANSWER:10,REJECTED:11,UNREACHABLE:12,CONNECTION_DROPPED:13,PARTICIPANT_LIMIT_REACHED:14,IN_ANOTHER_CALL:15,RING_TYPE_UNSUPPORTED:16,PENDING_APPROVAL:17,APPROVING:18,DENYING:19,APPROVED:20,FAILED_APPROVAL:21,HANGUP_IN_WAITING_ROOM:22,RECONNECTING:23});function a(a){if(a==null)return d("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected;switch(a){case h.CONTACTING:case h.PRECONNECTING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Contacting;case h.RINGING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Ringing;case h.CONNECTING:case h.RECONNECTING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Connecting;case h.CONNECTED:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Connected;case h.PENDING_APPROVAL:case h.APPROVING:case h.DENYING:case h.ACCEPTING:case h.ADDING:case h.REMOVING:return d("ZenonCallsModelTypes").ZenonCallParticipantState.PendingApproval;case h.APPROVED:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Approved;case h.FAILED_APPROVAL:return d("ZenonCallsModelTypes").ZenonCallParticipantState.FailedApproval;case h.HANGUP_IN_WAITING_ROOM:case h.UNKNOWN:case h.DISCONNECTED:case h.NO_ANSWER:case h.REJECTED:case h.UNREACHABLE:case h.CONNECTION_DROPPED:case h.PARTICIPANT_LIMIT_REACHED:case h.IN_ANOTHER_CALL:case h.RING_TYPE_UNSUPPORTED:return d("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}return d("ZenonCallsModelTypes").ZenonCallParticipantState.Disconnected}g.ZenonParticipantState=h;g.toCallParticipantState=a}),98);
__d("ZenonScreenShare",["UserAgent","ZenonAppProvider","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a.length===1&&((a=a[0])==null?void 0:a.contentType)==="screen"}function h(){return!c("UserAgent").isBrowser("Safari")}function i(){return d("ZenonAppProvider").isOculusCastingSite()&&c("justknobx")._("1977")?!1:!0}function b(){return!h()||!i()}g.isScreenSharingTrack=a;g.screenShareWithReplaceTrack=b}),98);
__d("ZenonSignalingTypes",[],(function(a,b,c,d,e,f){"use strict";a={OK:0,REJECTED_FROM_VERSION_DOES_NOT_MATCH:1,METHOD_NOT_ALLOWED:2};b={CLIENT_TERMINATED:0};f.ZenonSignalingStatusCode=a;f.ZenonSignalingStatusSubCode=b}),66);
__d("addDevTierOverridesToHeaderExtensions",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={multiwayCoreTier:"",multiwayWwwTier:""};if(!c("gkx")("25224"))return b;b.multiwayWwwTier=h(a,"multiway_www_tier");b.multiwayCoreTier=h(a,"multiway_core_tier");return b}function h(a,b){b=b+"=";a=a.split(b);return a[1]?a.pop().split("&").shift():""}g["default"]=a}),98);
__d("ZenonMWThriftTranslatorUtils",["MultiwayCommonTypes","MultiwaySharedTypes","OverlayConfigServerLayer","RequestStreamBodyUtils","WebrtcSignalingCommonTypes","ZenonDismissReason","ZenonMWMessageTypes","ZenonMWThriftMessageTagUtils","ZenonParticipantState","ZenonScreenShare","ZenonSignalingProtocol","ZenonSignalingTypes","addDevTierOverridesToHeaderExtensions","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k="signalingDominantSpeakerUpdate",l="signalingVideoUploadUpdate",m="E2eeState",n=new Map(Array.from(d("MultiwaySharedTypes").ConferenceType.members(),function(a){return[d("MultiwaySharedTypes").ConferenceType.getName(a),a]}));function a(a,b,c,d){c===void 0&&(c=!1),a&&Object.keys(a).forEach(function(e){if(e===m&&d)return;var f=a[e],g=f.data;f=f.version;if(g!=null){g={data:g,eventName:"stateSyncNotifyRequest",responseRequired:c,topic:e,version:f};b.push(g)}})}function b(a){if(a){a=a[m];return a==null?void 0:a.data}}function e(a){if(a==null)return d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN;switch(a){case d("MultiwaySharedTypes").MediaPath.SFU:return d("ZenonMWMessageTypes").ZenonMWMediaPath.SFU;case d("MultiwaySharedTypes").MediaPath.P2P:return d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P;default:return d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN}}function f(a){if(a==null)return d("ZenonParticipantState").ZenonParticipantState.UNKNOWN;switch(a){case d("MultiwayCommonTypes").ParticipantCallState.DISCONNECTED:return d("ZenonParticipantState").ZenonParticipantState.DISCONNECTED;case d("MultiwayCommonTypes").ParticipantCallState.NO_ANSWER:return d("ZenonParticipantState").ZenonParticipantState.NO_ANSWER;case d("MultiwayCommonTypes").ParticipantCallState.REJECTED:return d("ZenonParticipantState").ZenonParticipantState.REJECTED;case d("MultiwayCommonTypes").ParticipantCallState.UNREACHABLE:case d("MultiwayCommonTypes").ParticipantCallState.UNCALLABLE:return d("ZenonParticipantState").ZenonParticipantState.UNREACHABLE;case d("MultiwayCommonTypes").ParticipantCallState.CONNECTION_DROPPED:return d("ZenonParticipantState").ZenonParticipantState.CONNECTION_DROPPED;case d("MultiwayCommonTypes").ParticipantCallState.CONTACTING:return d("ZenonParticipantState").ZenonParticipantState.CONTACTING;case d("MultiwayCommonTypes").ParticipantCallState.RINGING:return d("ZenonParticipantState").ZenonParticipantState.RINGING;case d("MultiwayCommonTypes").ParticipantCallState.CONNECTING:return d("ZenonParticipantState").ZenonParticipantState.CONNECTING;case d("MultiwayCommonTypes").ParticipantCallState.CONNECTED:return d("ZenonParticipantState").ZenonParticipantState.CONNECTED;case d("MultiwayCommonTypes").ParticipantCallState.PARTICIPANT_LIMIT_REACHED:return d("ZenonParticipantState").ZenonParticipantState.PARTICIPANT_LIMIT_REACHED;case d("MultiwayCommonTypes").ParticipantCallState.IN_ANOTHER_CALL:return d("ZenonParticipantState").ZenonParticipantState.IN_ANOTHER_CALL;case d("MultiwayCommonTypes").ParticipantCallState.RING_TYPE_UNSUPPORTED:return d("ZenonParticipantState").ZenonParticipantState.RING_TYPE_UNSUPPORTED;case d("MultiwayCommonTypes").ParticipantCallState.PENDING_APPROVAL:return d("ZenonParticipantState").ZenonParticipantState.PENDING_APPROVAL;case d("MultiwayCommonTypes").ParticipantCallState.APPROVED:return d("ZenonParticipantState").ZenonParticipantState.APPROVED;case d("MultiwayCommonTypes").ParticipantCallState.FAILED_APPROVAL:return d("ZenonParticipantState").ZenonParticipantState.FAILED_APPROVAL;case d("MultiwayCommonTypes").ParticipantCallState.HANGUP_IN_WAITING_ROOM:return d("ZenonParticipantState").ZenonParticipantState.HANGUP_IN_WAITING_ROOM;default:return d("ZenonParticipantState").ZenonParticipantState.UNKNOWN}}function o(a){var b=null;a!=null&&a.forEach(function(a){a=(a=a.body)==null?void 0:a.genericMessage;if(a!=null&&a.topic==="collision_context_payload"){a=a.data;if(a!=null){var c;a=JSON.parse(d("RequestStreamBodyUtils").uint8ArrayToString(a));b={groupThreadID:(c=a.group_thread_id)!=null?c:null,peerID:(c=a.peer_id)!=null?c:null,serverInfoData:(c=a.server_info_data)!=null?c:null}}}});return b}function p(a){a=a&&a.length>0?a.find(function(a){return((a=a.body)==null||(a=a.genericMessage)==null?void 0:a.topic)==="room_metadata"}):null;if(a){var b;b=(b=a.body)==null||(b=b.genericMessage)==null?void 0:b.data;if(b!=null){b=JSON.parse(d("RequestStreamBodyUtils").uint8ArrayToString(b));a=(a=a.header)==null?void 0:a.sender;if(b.link_hash!=null&&b.room_name!=null&&a!=null)return{linkHash:b.link_hash,profileURL:b.profile_url,ringSubtitle:b.ring_subtitle,roomName:b.room_name,sender:a}}}return null}function q(a){return a.reduce(function(a,b){var c;c=(c=b.body)==null||(c=c.genericMessage)==null?void 0:c.topic;b=(b=b.body)==null||(b=b.genericMessage)==null?void 0:b.data;c!=null&&b!=null&&(a[c]=d("RequestStreamBodyUtils").uint8ArrayToString(b));return a},{})}function r(a){switch(a){case d("ZenonMWMessageTypes").ZenonMWMediaPath.SFU:return d("MultiwaySharedTypes").MediaPath.SFU;case d("ZenonMWMessageTypes").ZenonMWMediaPath.P2P:return d("MultiwaySharedTypes").MediaPath.P2P;default:return d("MultiwaySharedTypes").MediaPath.UNKNOWN}}function s(a,b,c){c===void 0&&(c=0);var d={fromVersion:b,tracks:[],version:c};a!=null&&Object.keys(a.tracks).forEach(function(b){var c,e=a.tracks[b];c={enabled:e.enabled,name:(c=e.name)!=null?c:"",participantID:(c=e.owner)!=null?c:"0",trackID:b,type:t(e.label)};d.tracks.push(c)});return d}function t(a){if(a==null)return null;switch(a){case d("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_AUDIO:return"audio";case d("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_VIDEO:return"video";case d("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_AUDIO:return"screen_audio";case d("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_VIDEO:return"screen";default:return null}}function u(a,b){b=c("OverlayConfigServerLayer").createFromHeader(b);if(b){b={eventName:"overlayConfigServerUpdateRequest",serverLayer:b};a.push(b)}}function v(a){var b=a.header,c=a.rtcMessageBody;a=a.type;b=A(b,a);a={messageBody:c,messageHeader:b};return a}function w(a){var b=a.header,c=a.rtcMessageBody,d=a.statusCode,e=a.subCode;a=a.type;b=H(b,a,d,e);a={messageBody:c,messageHeader:b};return a}var x={IN_ANOTHER_CALL:(i=d("MultiwayCommonTypes")).DeviceStatus.IN_ANOTHER_CALL,NO_OP:null,NOT_SUPPORTED:i.DeviceStatus.NOT_SUPPORTED,OK:i.DeviceStatus.OK};function y(a,b){return Object.keys(a).map(function(c){var e=a[c];return{body:{genericMessage:{data:d("RequestStreamBodyUtils").stringToUint8Array(e),topic:c}},header:{recipients:new Set(b),topic_DEPRECATED:c}}})}function z(a){var b=a.clientSessionId,e=a.conferenceName,f=a.receiver,g=a.receiverUserId,h=a.sequenceNumber,i=a.serverInfoData,j=a.transactionId;if(g==null)throw c("err")("Incoming Thrift MW messages should have receiverUserId populated.");b=b;var k={userID:"2"};f={actorID:(f=f==null?void 0:f.actorId)!=null?f:null,messageID:j,messageTags:d("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(a.messageTags),protocol:c("ZenonSignalingProtocol").MW,remoteInfo:k,retryCount:a.retryCount,roomInfo:{name:e},sequenceNumber:Number(h),signalingID:b,userInfo:{userID:g!=null?g:"1"}};i!=null&&(f.remoteSignalingID=i);return f}function A(a,b){var e,f=a.messageID,g=a.messageTags,h=a.remoteSignalingID,i=a.roomInfo,j=a.signalingID,k=c("addDevTierOverridesToHeaderExtensions")(window.location.href);e={clientStack:d("WebrtcSignalingCommonTypes").ClientStack.ZENON,conferenceName:(e=i.name)!=null?e:"",conferenceType:I((e=i.name)!=null?e:""),messageTags:new Set(g==null?void 0:g.map(function(a){return d("ZenonMWThriftMessageTagUtils").toThriftMessageTag(a)})),retryCount:a.retryCount,sequenceNumber:(i=a.sequenceNumber)==null?void 0:i.toString(),transactionId:f,type:b};(k.multiwayCoreTier!==""||k.multiwayWwwTier!=="")&&(e.extensions=k);j!=null&&(e.clientSessionId=j);h!=null&&(e.serverInfoData=h);a.actorID!=null&&(e.sender={id:a.actorID});return e}function B(a){switch(a){case d("ZenonDismissReason").ZenonDismissReason.IgnoreCall:return d("MultiwayCommonTypes").HangupReason.IGNORE_CALL;case d("ZenonDismissReason").ZenonDismissReason.HangupCall:return d("MultiwayCommonTypes").HangupReason.HANGUP_CALL;case d("ZenonDismissReason").ZenonDismissReason.NoAnswerTimeout:return d("MultiwayCommonTypes").HangupReason.NO_ANSWER_TIMEOUT;case d("ZenonDismissReason").ZenonDismissReason.ClientError:return d("MultiwayCommonTypes").HangupReason.CLIENT_ERROR;case d("ZenonDismissReason").ZenonDismissReason.InAnotherCall:return d("MultiwayCommonTypes").HangupReason.IN_ANOTHER_CALL;case d("ZenonDismissReason").ZenonDismissReason.ClientInterrupted:return d("MultiwayCommonTypes").HangupReason.CLIENT_INTERRUPTED;case d("ZenonDismissReason").ZenonDismissReason.SessionMigrated:return d("MultiwayCommonTypes").HangupReason.SESSION_MIGRATED;default:return d("MultiwayCommonTypes").HangupReason.HANGUP_CALL}}function C(a){a=(a=a.message.body)!=null?a:{};var b=a.dominantSpeakerSignalingInfo,c=a.genericMessage;a=a.videoUploadSignalingInfo;if(c)return d("RequestStreamBodyUtils").uint8ArrayToString(c.data);else if(b)return JSON.stringify(b);else if(a)return JSON.stringify(a);return null}function D(a){a=(a=a.message.body)!=null?a:{};var b=a.dominantSpeakerSignalingInfo,c=a.genericMessage;a=a.videoUploadSignalingInfo;if(c)return c.topic;else if(b)return k;else if(a)return l;return null}function E(a){if(a==null)return null;if(a===1)return d("MultiwaySharedTypes").EndpointServiceType.COMPOSITING_SERVICE;else return d("MultiwaySharedTypes").EndpointServiceType.UNKNOWN}function F(a){a=G(a);return a!=null?a:d("ZenonDismissReason").ZenonDismissReason.CallEnded}function G(a){if(a==null)return null;switch(a){case d("MultiwayCommonTypes").DismissReason.CALL_ENDED:return d("ZenonDismissReason").ZenonDismissReason.CallEnded;case d("MultiwayCommonTypes").DismissReason.ANSWERED_ON_ANOTHER_DEVICE:return d("ZenonDismissReason").ZenonDismissReason.AnsweredOnAnotherDevice;case d("MultiwayCommonTypes").DismissReason.ANSWERED_BY_OTHER_USER:return d("ZenonDismissReason").ZenonDismissReason.AnsweredByOtherUser;case d("MultiwayCommonTypes").DismissReason.IN_ANOTHER_CALL:return d("ZenonDismissReason").ZenonDismissReason.InAnotherCall;case d("MultiwayCommonTypes").DismissReason.CONNECTION_DROPPED:return d("ZenonDismissReason").ZenonDismissReason.ConnectionDropped;case d("MultiwayCommonTypes").DismissReason.PRIMARY_ENDPOINT_HANGUP:return d("ZenonDismissReason").ZenonDismissReason.HangupCall;case d("MultiwayCommonTypes").DismissReason.REJECTED_ON_ANOTHER_DEVICE:return d("ZenonDismissReason").ZenonDismissReason.RejectedOnAnotherDevice;case d("MultiwayCommonTypes").DismissReason.REMOVED_BY_PARTICIPANT:return d("ZenonDismissReason").ZenonDismissReason.RemovedByParticipant;case d("MultiwayCommonTypes").DismissReason.REJECTED_BY_CALLEE:return d("ZenonDismissReason").ZenonDismissReason.RejectedByCallee;case d("MultiwayCommonTypes").DismissReason.INTERNAL_ERROR:return d("ZenonDismissReason").ZenonDismissReason.SignalingMessageFailed;case d("MultiwayCommonTypes").DismissReason.CALL_ENDED_BY_PRODUCT:return d("ZenonDismissReason").ZenonDismissReason.CallEndedByProduct;case d("MultiwayCommonTypes").DismissReason.TX_ACK_TIMEDOUT:return d("ZenonDismissReason").ZenonDismissReason.TxAckTimeout;default:return null}}function H(a,b,c,e){a=A(a,b);a.responseStatusCode=c!=null?c:d("MultiwayCommonTypes").RtcResponseStatusCode.OK;a.responseSubCode=e;return a}function I(a){var b=a.indexOf(":");if(b===-1)return null;a=a.slice(0,b);return(b=n.get(a))!=null?b:null}function J(a){var b={},c=!d("ZenonScreenShare").screenShareWithReplaceTrack();a.tracks.forEach(function(a){var e={customAudioContentType:d("WebrtcSignalingCommonTypes").CustomAudioContentType.NONE,customVideoContentType:d("WebrtcSignalingCommonTypes").CustomVideoContentType.NONE,enabled:a.enabled},f=c?P(a.type):null;f!=null&&(e.label=f);b[a.trackID]=e});return{tracks:b}}function K(a){a=x[a];return a!=null?a:d("MultiwayCommonTypes").DeviceStatus.OK}function L(a){var b={};a.tracks.forEach(function(a){b[a.trackID]=a.enabled});return b}function M(a){return R[a]}function N(a){return a==null?null:S[a]}function O(a){var b={};a.forEach(function(a,c){b[c]={data:a.data,version:a.version}});return b}function P(a){switch(a){case"audio":return d("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_AUDIO;case"video":return d("WebrtcSignalingCommonTypes").TrackLabel.DEFAULT_VIDEO;case"screen":return d("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_VIDEO;case"screen_audio":return d("WebrtcSignalingCommonTypes").TrackLabel.SCREEN_AUDIO;default:return null}}function Q(a){if(a===d("MultiwaySharedTypes").EndpointServiceType.COMPOSITING_SERVICE)return 1;else return 0}var R=Object.freeze((h={},h[(j=d("ZenonSignalingTypes")).ZenonSignalingStatusCode.OK]=i.RtcResponseStatusCode.OK,h[j.ZenonSignalingStatusCode.REJECTED_FROM_VERSION_DOES_NOT_MATCH]=i.RtcResponseStatusCode.CONDITIONAL_REQUEST_FAILED,h[j.ZenonSignalingStatusCode.METHOD_NOT_ALLOWED]=i.RtcResponseStatusCode.METHOD_NOT_ALLOWED,h)),S=Object.freeze((h={},h[j.ZenonSignalingStatusSubCode.CLIENT_TERMINATED]=i.RtcResponseSubCode.CLIENT_TERMINATED,h));g.addThriftStateStoreSignalingEvents=a;g.fetchE2eeServerState=b;g.fromThriftMediaPath=e;g.fromThriftParticipantState=f;g.getCollisionContextFromThriftAppMessages=o;g.getRoomMetadataFromThriftAppMessages=p;g.mwThriftAppMessagesToSignalingAppMessages=q;g.toThriftMediaPath=r;g.toZenonMediaStatesFromThrift=s;g.toMWClientTrackContentTypeFromThrift=t;g.maybeAddOverlayConfigServerUpdateRequestFromThrift=u;g.createMWThriftRequest=v;g.createMWThriftResponse=w;g.signalingMessageAppMessagesToThriftMWAppMessages=y;g.mwThriftMessageHeaderToSignalingMessageHeader=z;g.toMWThriftHangupReason=B;g.getGenericMWThriftDataMessageData=C;g.getGenericMWThriftDataMessageTopic=D;g.toThriftServiceRecipient=E;g.fromMWThriftDismissReason=F;g.getConferenceTypeFromName=I;g.toThriftMWMediaStatusEx=J;g.toMWThriftDeviceStatus=K;g.toMWThriftMediaStatus=L;g.toMWThriftResponseStatusCode=M;g.toMWThriftResponseStatusSubCode=N;g.toThriftMWSyncStateStore=O;g.toMWThriftTrackLabel=P;g.toServiceRecipientType=Q}),98);
__d("ZenonMWThriftMessageDebugLogger",["Log","LogHistory","MultiwayCommonTypes","ODS","RequestStreamBodyUtils","RpWebStateMachineLoggingBlocklist","ZenonAuditedCheckpointLogId","ZenonIceStatsParser","ZenonInfraActionsLogger","ZenonMWThriftMessageMap","ZenonMWThriftTranslatorUtils","formatDate","isEmployeeTestUserZenonLogging"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){this.$1=d("LogHistory").getInstance("webrtc"),this.$2=new Set(c("RpWebStateMachineLoggingBlocklist").MESSAGE_TYPES)}var b=a.prototype;b.$3=function(a,b,d){b===void 0&&(b=!0);var e=c("formatDate")(new Date(),"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+a);b&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] "+a,messageID:d})};b.$4=function(a){a=a.messageHeader.responseStatusCode;return a!=null};b.logMWThriftMessage=function(a,b,e){this.$5(a,b,e);if(!c("isEmployeeTestUserZenonLogging")())return;var f=e.messageHeader,g=d("ZenonMWThriftMessageMap").messageTypeToString(e.messageHeader.type),h=this.$4(e)?"RESPONSE":"REQUEST";e=this.$6(e);a="[ms] "+a+" ["+b+"] "+g+" "+h+" [retryCount: "+f.retryCount+(e!=null?" details: "+e:"")+"]";this.$2.has(g)||this.$3(a,!0,f.transactionId)};b.$5=function(a,b,c){a=this.$7(a,b,c);a!==null&&(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_signaling",a)};b.$7=function(a,b,c){var e=c.messageBody,f=c.messageHeader,g="";if(f.type!=null)switch(f.type){case d("MultiwayCommonTypes").MessageType.DATA_MESSAGE:if(e.dataMessageRequest){g=(e=d("ZenonMWThriftTranslatorUtils").getGenericMWThriftDataMessageTopic(e.dataMessageRequest))!=null?e:"undefined"}break;default:break}e=this.$4(c)?"RESPONSE":"REQUEST";c=d("ZenonMWThriftMessageMap").messageTypeToString(f.type);if(g==="")return a+"-"+b+"-"+c+"-"+e;else return a+"-"+b+"-"+c+"-"+e+"-"+g};b.$6=function(a){var b=a.messageHeader;if(d("MultiwayCommonTypes").MessageType==null||b.type==null)return null;switch(b.type){case d("MultiwayCommonTypes").MessageType.JOIN:return this.$8(a);case d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:return this.$9(a);case d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:return this.$10(a);case d("MultiwayCommonTypes").MessageType.SUBSCRIPTION:return this.$11(a);case d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:return this.$12(a);default:return null}};b.$8=function(a){var b=a.messageBody,c=a.messageHeader;if(this.$4(a)){return JSON.stringify({hasAnswer:((a=b.joinResponse)==null?void 0:a.answer)!=null,hasRenegotiationOffer:((a=b.joinResponse)==null?void 0:a.renegotiationOffer)!=null,isPendingApproval:(a=b.joinResponse)==null?void 0:a.isPendingApproval,multipleVideoStreamsAllowed:(a=b.joinResponse)==null?void 0:a.multipleVideoStreamsAllowed,statusCode:c.responseStatusCode,subCode:c.responseSubCode})}return JSON.stringify({deviceCapabilities:(a=b.joinRequest)==null?void 0:a.deviceCapabilities,sdpType:((c=b.joinRequest)==null?void 0:c.offer)!=null?"offer":((a=b.joinRequest)==null?void 0:a.answer)!=null?"answer":"null",userCapabilities:(c=b.joinRequest)!=null&&c.userCapabilities?d("RequestStreamBodyUtils").uint8ArrayToString(b.joinRequest.userCapabilities):""})};b.$9=function(a){var b=a.messageBody,c=a.messageHeader;if(this.$4(a)){return JSON.stringify({currentVersion:(a=b.serverMediaUpdateResponse)==null?void 0:a.currentVersion,hasAnswer:((a=b.serverMediaUpdateResponse)==null?void 0:a.answer)!=null,statusCode:c.responseStatusCode,subCode:c.responseSubCode})}return JSON.stringify({fromVersion:(a=b.serverMediaUpdateRequest)==null?void 0:a.fromVersion,messageTags:c.messageTags,renegotiationRequested:(c=(a=b.serverMediaUpdateRequest)==null?void 0:a.renegotiationRequested)!=null?c:!1,sdpType:(a=b.serverMediaUpdateRequest)!=null&&a.offer?"offer":(c=b.serverMediaUpdateRequest)!=null&&c.answer?"answer":(a=b.serverMediaUpdateRequest)!=null&&a.update?"delta":"empty",toVersion:(a=(c=b.serverMediaUpdateRequest)==null?void 0:c.toVersion)!=null?a:""})};b.$10=function(a){var b=a.messageBody,c=a.messageHeader;if(this.$4(a)){return JSON.stringify({currentVersion:(a=(a=b.clientMediaUpdateResponse)==null?void 0:a.currentVersion)!=null?a:"",statusCode:c.responseStatusCode,subCode:c.responseSubCode})}return JSON.stringify({fromVersion:(c=(a=b.clientMediaUpdateRequest)==null?void 0:a.fromVersion)!=null?c:"",toVersion:(c=(a=b.clientMediaUpdateRequest)==null?void 0:a.toVersion)!=null?c:""})};b.$11=function(a){var b=a.messageBody;return this.$4(a)?null:JSON.stringify({subscriptions:(b=(a=b.subscriptionRequest)==null?void 0:a.subscriptions)!=null?b:""})};b.$12=function(a){var b=a.messageBody;if(this.$4(a))return null;b=(a=b.iceCandidateRequest)==null?void 0:a.iceCandidateSdps.map(function(a){a=a.candidateSdpString;if(a!=null)return d("ZenonIceStatsParser").extractIceInfo(a)});return JSON.stringify({iceCandidates:b})};b.logSendMultiwayThriftMessageFailure=function(a,b,e){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","send_message_failure");h.flush();e=e?"Stack Trace: "+e.stack+".":"Error msg: "+a;c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,checkpoint:"Failed to send MW Thrift message of type "+b+". "+e})};return a}();b=new a();g["default"]=b}),98);
__d("ZenonMWMessageReliabilityLogTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["RECEIVED_REQUEST","RECEIVED_RESPONSE","PROCESSING_REQUEST","START_PROCESSING_RESPONSE","PROCESSING_RESPONSE","PROCESSED_REQUEST","PROCESSED_RESPONSE","SENDING_REQUEST","SENDING_RESPONSE","SENT_REQUEST","SENT_REQUEST_FROM_HANDLER","SENT_RESPONSE","SEND_REQUEST_FAILED","SEND_REQUEST_FAILED_FROM_HANDLER","SEND_RESPONSE_FAILED","SENT_SM_EVENT","PROCESSED_SM_EVENT","REQUEST_AFTER_NULL_CHECK","REQUEST_AFTER_TRANSLATION"]);f.ZenonMWMessageReliabilityEvent=a}),66);
__d("ZenonMWThriftResponseStatusCodeUtils",["MultiwayCommonTypes","ZenonMWMessageTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case d("MultiwayCommonTypes").RtcResponseStatusCode.OK:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.OK;case d("MultiwayCommonTypes").RtcResponseStatusCode.BAD_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.BAD_REQUEST;case d("MultiwayCommonTypes").RtcResponseStatusCode.UNAUTHORIZED:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.UNAUTHORIZED;case d("MultiwayCommonTypes").RtcResponseStatusCode.NOT_FOUND:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.NOT_FOUND;case d("MultiwayCommonTypes").RtcResponseStatusCode.METHOD_NOT_ALLOWED:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.METHOD_NOT_ALLOWED;case d("MultiwayCommonTypes").RtcResponseStatusCode.CONFLICT:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONFLICT;case d("MultiwayCommonTypes").RtcResponseStatusCode.CONDITIONAL_REQUEST_FAILED:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.CONDITIONAL_REQUEST_FAILED;case d("MultiwayCommonTypes").RtcResponseStatusCode.SERVER_INTERNAL_ERROR:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.SERVER_INTERNAL_ERROR;case d("MultiwayCommonTypes").RtcResponseStatusCode.SERVICE_UNAVAILABLE:return d("ZenonMWMessageTypes").ZenonMWResponseStatusCode.SERVICE_UNAVAILABLE}}function b(a){switch(a){case d("MultiwayCommonTypes").RtcResponseSubCode.UNKNOWN:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNKNOWN;case d("MultiwayCommonTypes").RtcResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS;case d("MultiwayCommonTypes").RtcResponseSubCode.MEMBERSHIP_CHECK_FAIL:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEMBERSHIP_CHECK_FAIL;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_THROTTLED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_THROTTLED;case d("MultiwayCommonTypes").RtcResponseSubCode.ENDPOINT_THROTTLED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.ENDPOINT_THROTTLED;case d("MultiwayCommonTypes").RtcResponseSubCode.MWS_MESSAGE_SENT_TO_INCORRECT_REGION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MWS_MESSAGE_SENT_TO_INCORRECT_REGION;case d("MultiwayCommonTypes").RtcResponseSubCode.UNSUPPORTED_REQUEST_TYPE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNSUPPORTED_REQUEST_TYPE;case d("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_REQUEST_UNACCEPTABLE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_REQUEST_UNACCEPTABLE;case d("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_RESPONSE_UNACCEPTABLE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_RESPONSE_UNACCEPTABLE;case d("MultiwayCommonTypes").RtcResponseSubCode.RING_RESPONSE_BODY_NOT_SET:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.RING_RESPONSE_BODY_NOT_SET;case d("MultiwayCommonTypes").RtcResponseSubCode.SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_SDP:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_SDP;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_CONFERENCE_NAME:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_CONFERENCE_NAME;case d("MultiwayCommonTypes").RtcResponseSubCode.SERVER_INFO_CONFERENCE_NAME_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SERVER_INFO_CONFERENCE_NAME_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_USER_ID:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_USER_ID;case d("MultiwayCommonTypes").RtcResponseSubCode.INCORRECT_VERSION_RANGE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INCORRECT_VERSION_RANGE;case d("MultiwayCommonTypes").RtcResponseSubCode.SENDER_ID_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SENDER_ID_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.RECIPIENT_NOT_SPECIFIED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.RECIPIENT_NOT_SPECIFIED;case d("MultiwayCommonTypes").RtcResponseSubCode.FIELD_NOT_ALLOWED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.FIELD_NOT_ALLOWED;case d("MultiwayCommonTypes").RtcResponseSubCode.USERS_NOT_SPECIFIED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.USERS_NOT_SPECIFIED;case d("MultiwayCommonTypes").RtcResponseSubCode.REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_CALL_ID:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_CALL_ID;case d("MultiwayCommonTypes").RtcResponseSubCode.SESSION_DESCRIPTION_ID_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SESSION_DESCRIPTION_ID_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.EMPTY_CLIENT_MEDIA_UPDATES:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EMPTY_CLIENT_MEDIA_UPDATES;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_SERVER_INFO_DATA:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_SERVER_INFO_DATA;case d("MultiwayCommonTypes").RtcResponseSubCode.INCORRECT_STATE_VERSION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INCORRECT_STATE_VERSION;case d("MultiwayCommonTypes").RtcResponseSubCode.MISMATCHED_STATE_FOR_VERSION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISMATCHED_STATE_FOR_VERSION;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_STATE_VERSION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_STATE_VERSION;case d("MultiwayCommonTypes").RtcResponseSubCode.NO_RESOLVER_FOUND:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.NO_RESOLVER_FOUND;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_APPROVERLIST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_APPROVERLIST;case d("MultiwayCommonTypes").RtcResponseSubCode.FULL_SDP_REQUIRED_IN_APPROVED_STATE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.FULL_SDP_REQUIRED_IN_APPROVED_STATE;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_BROADCAST_ID:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_BROADCAST_ID;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_ENDPOINT_CONFIG:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_ENDPOINT_CONFIG;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_E2EE_STATE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_E2EE_STATE;case d("MultiwayCommonTypes").RtcResponseSubCode.SFU_MODE_PREVENTED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SFU_MODE_PREVENTED;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_CONFERENCE_STATE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_CONFERENCE_STATE;case d("MultiwayCommonTypes").RtcResponseSubCode.JOIN_REQUEST_DENIED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.JOIN_REQUEST_DENIED;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_ENDPOINT:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_ENDPOINT;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_HEADER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_HEADER;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_BODY:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_BODY;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_PARAMS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_PARAMS;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_DATA_MESSAGE_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_DATA_MESSAGE_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_ADD_PARTICIPANTS_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_ADD_PARTICIPANTS_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_SUBSCRIPTION_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_SUBSCRIPTION_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_JOIN_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_JOIN_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_HANGUP_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_HANGUP_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_ICE_CANDIDATE_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_ICE_CANDIDATE_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_P2P_MESSAGE_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_P2P_MESSAGE_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_UPDATE_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_UPDATE_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_CLIENT_EVENT_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_CLIENT_EVENT_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_CONNECT_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_CONNECT_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_UNSUBSCRIBE_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_UNSUBSCRIBE_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_APPROVAL_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_APPROVAL_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_ENDPOINT_USER_ID:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_ENDPOINT_USER_ID;case d("MultiwayCommonTypes").RtcResponseSubCode.EMPTY_ENDPOINT_USER_ID:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EMPTY_ENDPOINT_USER_ID;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_TRANSFER_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_TRANSFER_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_BODY_GENERIC:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_BODY_GENERIC;case d("MultiwayCommonTypes").RtcResponseSubCode.REQUESTOR_NOT_MEMBER_CONFERENCE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.REQUESTOR_NOT_MEMBER_CONFERENCE;case d("MultiwayCommonTypes").RtcResponseSubCode.NOT_BROADCAST_OWNER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.NOT_BROADCAST_OWNER;case d("MultiwayCommonTypes").RtcResponseSubCode.GUEST_NOT_INVITED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.GUEST_NOT_INVITED;case d("MultiwayCommonTypes").RtcResponseSubCode.GUEST_DISCONNECTED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.GUEST_DISCONNECTED;case d("MultiwayCommonTypes").RtcResponseSubCode.GUEST_INVITATION_EXPIRED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.GUEST_INVITATION_EXPIRED;case d("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_IN_PENDING_APPROVAL_STATE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_IN_PENDING_APPROVAL_STATE;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_MULTIWAY_PARAMS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_MULTIWAY_PARAMS;case d("MultiwayCommonTypes").RtcResponseSubCode.BROADCAST_ALREADY_STOPPED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.BROADCAST_ALREADY_STOPPED;case d("MultiwayCommonTypes").RtcResponseSubCode.FAILED_TO_GENERATE_SDP_ANSWER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_TO_GENERATE_SDP_ANSWER;case d("MultiwayCommonTypes").RtcResponseSubCode.FAILED_GENERATE_SESSION_DESCRIPTION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_GENERATE_SESSION_DESCRIPTION;case d("MultiwayCommonTypes").RtcResponseSubCode.SDP_SESSION_ID_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SDP_SESSION_ID_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_ENDPOINT_GONE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_ENDPOINT_GONE;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_ENDPOINT_ALREADY_EXISTS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_ENDPOINT_ALREADY_EXISTS;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID;case d("MultiwayCommonTypes").RtcResponseSubCode.LEGACY_MESSENGER_SENDER_UNSET:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.LEGACY_MESSENGER_SENDER_UNSET;case d("MultiwayCommonTypes").RtcResponseSubCode.FAILED_TO_SET_TRANSPORT_INFO:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_TO_SET_TRANSPORT_INFO;case d("MultiwayCommonTypes").RtcResponseSubCode.NON_PRIMARY_MULTIWAY_SERVER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.NON_PRIMARY_MULTIWAY_SERVER;case d("MultiwayCommonTypes").RtcResponseSubCode.FAILED_TO_GET_REMOTE_DESCRIPTION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.FAILED_TO_GET_REMOTE_DESCRIPTION;case d("MultiwayCommonTypes").RtcResponseSubCode.LOCAL_DESCRIPTION_NOT_SET:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.LOCAL_DESCRIPTION_NOT_SET;case d("MultiwayCommonTypes").RtcResponseSubCode.INVALID_SDP_TYPE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVALID_SDP_TYPE;case d("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO;case d("MultiwayCommonTypes").RtcResponseSubCode.SDP_UNSET_ON_P2P_ANSWER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SDP_UNSET_ON_P2P_ANSWER;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_ICE_CANDIDATE_PAYLOAD:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_ICE_CANDIDATE_PAYLOAD;case d("MultiwayCommonTypes").RtcResponseSubCode.P2P_PROTOCOL_UNSET:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.P2P_PROTOCOL_UNSET;case d("MultiwayCommonTypes").RtcResponseSubCode.CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CREATE_ACK_FOR_INVALID_MESSAGE_TYPE;case d("MultiwayCommonTypes").RtcResponseSubCode.LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE;case d("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_IN_SFU_MODE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_IN_SFU_MODE;case d("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_DURING_P2P_TO_SFU_ESCALATION;case d("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS;case d("MultiwayCommonTypes").RtcResponseSubCode.RESOLVE_STATE_API_ERROR:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.RESOLVE_STATE_API_ERROR;case d("MultiwayCommonTypes").RtcResponseSubCode.EXTERNAL_RESOLUTION_ERROR:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EXTERNAL_RESOLUTION_ERROR;case d("MultiwayCommonTypes").RtcResponseSubCode.INTERNAL_RESOLUTION_ERROR:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INTERNAL_RESOLUTION_ERROR;case d("MultiwayCommonTypes").RtcResponseSubCode.RESOLUTION_DISABLED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.RESOLUTION_DISABLED;case d("MultiwayCommonTypes").RtcResponseSubCode.BROADCAST_ID_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.BROADCAST_ID_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.SDP_UNSET_ON_P2P_OFFER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SDP_UNSET_ON_P2P_OFFER;case d("MultiwayCommonTypes").RtcResponseSubCode.LEGACY_OFFER_MISSING_REQUIRED_VALUE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.LEGACY_OFFER_MISSING_REQUIRED_VALUE;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_SERVER_STATE_SYNC_DESERIALIZATION_ERROR;case d("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_UNSUPPORTED_FOR_PRECONNECTED_USERS;case d("MultiwayCommonTypes").RtcResponseSubCode.OTHER_USER_ANSWERED_THE_CALL:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.OTHER_USER_ANSWERED_THE_CALL;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_SERVER_DESERIALIZATION_ERROR:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_SERVER_DESERIALIZATION_ERROR;case d("MultiwayCommonTypes").RtcResponseSubCode.REMOTE_SDP_TRACKID_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.REMOTE_SDP_TRACKID_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.SIGNALING_MESSAGE_TO_CLIENT_DROPPED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SIGNALING_MESSAGE_TO_CLIENT_DROPPED;case d("MultiwayCommonTypes").RtcResponseSubCode.DATA_CHANNEL_ENDPOINT_GONE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.DATA_CHANNEL_ENDPOINT_GONE;case d("MultiwayCommonTypes").RtcResponseSubCode.DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.DATA_CHANNEL_ENDPOINT_ALREADY_EXISTS;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_NOT_FOUND:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_NOT_FOUND;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_IS_TERMINATING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_IS_TERMINATING;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_IS_TERMINATED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_IS_TERMINATED;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_NAME_EMPTY:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_NAME_EMPTY;case d("MultiwayCommonTypes").RtcResponseSubCode.NONCE_EMPTY:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.NONCE_EMPTY;case d("MultiwayCommonTypes").RtcResponseSubCode.NONCE_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.NONCE_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_HAS_GONE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_HAS_GONE;case d("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_HAS_GONE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_HAS_GONE;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_SERVER_NOT_FOUND:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_SERVER_NOT_FOUND;case d("MultiwayCommonTypes").RtcResponseSubCode.CLIENT_TERMINATED:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CLIENT_TERMINATED;case d("MultiwayCommonTypes").RtcResponseSubCode.MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_INCAPABLE_RENEGOTIATION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_INCAPABLE_RENEGOTIATION;case d("MultiwayCommonTypes").RtcResponseSubCode.REJECTING_CMU_WHEN_SMU_PENDING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.REJECTING_CMU_WHEN_SMU_PENDING;case d("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC;case d("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_ALREADY_IN_WAITING_ROOM:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_ALREADY_IN_WAITING_ROOM;case d("MultiwayCommonTypes").RtcResponseSubCode.PARTICIPANT_NOT_IN_PENDING_APPROVAL:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PARTICIPANT_NOT_IN_PENDING_APPROVAL;case d("MultiwayCommonTypes").RtcResponseSubCode.USER_NOT_APPROVER_FOR_TARGET_USER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.USER_NOT_APPROVER_FOR_TARGET_USER;case d("MultiwayCommonTypes").RtcResponseSubCode.UNSUPPORTED_CAPABILITIES:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNSUPPORTED_CAPABILITIES;case d("MultiwayCommonTypes").RtcResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON;case d("MultiwayCommonTypes").RtcResponseSubCode.WWW_KILLSWITCHED_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.WWW_KILLSWITCHED_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFLICTING_MEDIA_PATH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_MEDIA_PATH;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFLICTING_MEDIA_STATUS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_MEDIA_STATUS;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFLICTING_SESSION_DESCRIPTION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFLICTING_SESSION_DESCRIPTION;case d("MultiwayCommonTypes").RtcResponseSubCode.EMPTY_USER_IDS:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.EMPTY_USER_IDS;case d("MultiwayCommonTypes").RtcResponseSubCode.MISSING_SDP_CONNECT_REQUEST:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.MISSING_SDP_CONNECT_REQUEST;case d("MultiwayCommonTypes").RtcResponseSubCode.CALLER_HAS_APPEALABLE_CALLING_RESTRICTION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CALLER_HAS_APPEALABLE_CALLING_RESTRICTION;case d("MultiwayCommonTypes").RtcResponseSubCode.P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.P2P_CONNECT_UNSUPPORTED_AFTER_SFU_ESCALATION;case d("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_CONFERENCE;case d("MultiwayCommonTypes").RtcResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONNECT_EXCEEDED_MAX_ALLOWED_ENDPOINTS_PER_USER;case d("MultiwayCommonTypes").RtcResponseSubCode.REQUEST_TIMEOUT:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.REQUEST_TIMEOUT;case d("MultiwayCommonTypes").RtcResponseSubCode.TOO_MANY_MEDIA_TRACKS_IN_SDP:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.TOO_MANY_MEDIA_TRACKS_IN_SDP;case d("MultiwayCommonTypes").RtcResponseSubCode.OK:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.OK;case d("MultiwayCommonTypes").RtcResponseSubCode.ENDPOINT_INFO_RESULT_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.ENDPOINT_INFO_RESULT_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.INVITE_USERS_RESULT_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.INVITE_USERS_RESULT_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.JOIN_SESSION_RESULT_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.JOIN_SESSION_RESULT_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.LOGGING_POLICY_RESULT_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.LOGGING_POLICY_RESULT_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.STATE_SYNC_RESULT_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.STATE_SYNC_RESULT_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.CONFERENCE_NAME_MISMATCH:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.CONFERENCE_NAME_MISMATCH;case d("MultiwayCommonTypes").RtcResponseSubCode.SESSION_CONFIGURATION_RESULT_MISSING:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.SESSION_CONFIGURATION_RESULT_MISSING;case d("MultiwayCommonTypes").RtcResponseSubCode.UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME:return d("ZenonMWMessageTypes").ZenonMWResponseSubCode.UNEXPECTED_TRANSPORT_PARAMS_CONFERENCE_NAME}}g.getResponseStatusCodeFromThrift=a;g.getResponseSubCodeFromThrift=b}),98);
__d("ZenonMqttChannel",["CurrentUser","FBLogger","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=-1;try{c("MqttEnvInitializer").initialize();d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);if(c("gkx")("11152")&&c("CurrentUser").getAppID()===String(1358015658191005))a=949958857019662;else{var b;a=Number((b=c("CurrentUser").getAppID())!=null?b:c("MqttWebConfig").appID)}return new(c("MqttChannel"))({appId:a,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!1,clientCapabilities:c("MqttWebConfig").clientCapabilities,endpoint:c("MqttWebConfig").endpoint,initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:c("MqttWebConfig").pollingEndpoint,userFbid:c("MqttWebConfig").fbid})}catch(b){c("FBLogger")("rtc_www").catching(b).warn("[ZenonMqttChannel][%d] failed to create MqttChannel",a);throw b}}b=a();e=b;g["default"]=e}),98);
__d("getZenonMqttChannel",["CurrentUser","FBMqttChannel","HorizonWebMqttChannel","IGDOverLSMqttChannel","LiveChatWidgetMqttChannel","MDCMqttChannel","OculusMqttChannel","RpWebMqttEnabledAppIds","ZenonAppProvider","ZenonMqttChannel","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(c("RpWebMqttEnabledAppIds").APP_IDS);function a(){if(d("ZenonAppProvider").isInstagramApp())return d("IGDOverLSMqttChannel").getInstance();else if(d("ZenonAppProvider").isOculusCastingSite())return d("OculusMqttChannel").getOculusMqttChannelInstance();else if(d("ZenonAppProvider").isHorizonApp())return d("HorizonWebMqttChannel").getHorizonWebMqttChannelInstance();else if(d("ZenonAppProvider").isMDCApp())return d("MDCMqttChannel").getMDCMqttChannelInstance();else if(d("ZenonAppProvider").isWidgetLiveChatApp()&&c("justknobx")._("2782"))return d("LiveChatWidgetMqttChannel").getLiveChatWidgetMqttChannelInstance();else return h.has(Number(c("CurrentUser").getAppID()))?c("ZenonMqttChannel"):c("FBMqttChannel")}g["default"]=a}),98);
__d("ZenonMWThriftMessageQPLLogger",["DateConsts","QPLMsgTypesSitevarConfig","QPLUserFlow","ZenonLoggingUtils","ZenonMWMessageReliabilityLogTypes","ZenonMWThriftMessageMap","ZenonMWThriftMessageTagUtils","ZenonMWThriftResponseStatusCodeUtils","getZenonMqttChannel","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=30*d("DateConsts").MS_PER_SEC,i=c("getZenonMqttChannel")(),j=new Map();function a(a,b,e){if(!d("ZenonLoggingUtils").shouldAllowLogging())return;var f=a.messageHeader,g=d("ZenonMWThriftMessageMap").messageTypeToString(a.messageHeader.type).toLowerCase();if(!c("QPLMsgTypesSitevarConfig").QPL_MSG_TYPES.includes(g))return;f=k(f.transactionId);switch(b){case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST:l(f,g,{connectionState:(b=e==null?void 0:e.connectionState)!=null?b:"",peerConnectionState:(b=e==null?void 0:e.peerConnectionState)!=null?b:"",signalingState:(b=e==null?void 0:e.signalingState)!=null?b:""},a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST:m(f);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE:n(f,a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE:o(f,a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_RESPONSE_FAILED:p(f,a,e==null?void 0:e.errorMessage);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST:q(f,g,{connectionState:(b=e==null?void 0:e.connectionState)!=null?b:"",peerConnectionState:(g=e==null?void 0:e.peerConnectionState)!=null?g:"",signalingState:(b=e==null?void 0:e.signalingState)!=null?b:""},a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_REQUEST:r(f);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_REQUEST_FAILED:s(f,e==null?void 0:e.errorMessage);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE:t(f,a);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT:u(f,e==null?void 0:e.smEvent);return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT:v(f,e==null?void 0:e.smEvent);return;default:return}}function b(a,b){if(!d("ZenonLoggingUtils").shouldAllowLogging())return;c("QPLUserFlow").addAnnotations(c("qpl")._(398988976,"737"),{string:babelHelpers["extends"]({},b)},{instanceKey:+a})}function k(a){a=isNaN(+a)?0:+a;var b=9223372036854776e3;return Math.round(a%b)}function l(a,b,e,f){c("QPLUserFlow").start(c("qpl")._(398988976,"737"),{annotations:{"int":{retryCount:f.messageHeader.retryCount},int_array:{messageTags:d("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(f.messageHeader.messageTags)},string:babelHelpers["extends"]({},e,{messageType:b,mqttState:i.getConnectionState()})},instanceKey:a,timeoutInMs:h});if(f.messageBody.serverMediaUpdateRequest){e=f.messageBody.serverMediaUpdateRequest;b=e.answer;f=e.offer;e=e.update;c("QPLUserFlow").addAnnotations(c("qpl")._(398988976,"737"),{string:{sdpType:f?"offer":b?"answer":e?"delta":"empty"}},{instanceKey:a})}f={onMQTTStateChanged:function(b){c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"mqtt_"+b,{instanceKey:a})}};i.subscribeChannelEvents(f);j.set(a,f)}function m(a){c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"processed_request",{instanceKey:a})}function n(a,b){b=b.messageHeader;var e=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"sending_response",{instanceKey:a});c("QPLUserFlow").addAnnotations(c("qpl")._(398988976,"737"),{"int":{responseStatusCode:e?d("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(e):200,responseSubCode:b?d("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(b):9e3}},{instanceKey:a})}function o(a,b){b=b.messageHeader;var e=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").endSuccess(c("qpl")._(398988976,"737"),{annotations:{"int":{responseStatusCode:e?d("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(e):200,responseSubCode:b?d("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(b):9e3}},instanceKey:a});e=j.get(a);e&&(i.unsubscribeChannelEvents(e),j["delete"](a))}function p(a,b,e){b=b.messageHeader;var f=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").endFailure(c("qpl")._(398988976,"737"),"send_response_failed",{annotations:{"int":{responseStatusCode:f?d("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(f):200,responseSubCode:b?d("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(b):9e3},string:{errorMessage:e}},instanceKey:a});f=j.get(a);f&&(i.unsubscribeChannelEvents(f),j["delete"](a))}function q(a,b,e,f){c("QPLUserFlow").start(c("qpl")._(398988976,"737"),{annotations:{"int":{retryCount:f.messageHeader.retryCount},int_array:{messageTags:d("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(f.messageHeader.messageTags)},string:babelHelpers["extends"]({},e,{messageType:b,mqttState:i.getConnectionState()})},instanceKey:a,timeoutInMs:h})}function r(a){c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"sending_request",{instanceKey:a})}function s(a,b){c("QPLUserFlow").endFailure(c("qpl")._(398988976,"737"),"send_request_failed",{annotations:{string:{errorMessage:b}},instanceKey:a})}function t(a,b){b=b.messageHeader;var e=b.responseStatusCode;b=b.responseSubCode;c("QPLUserFlow").endSuccess(c("qpl")._(398988976,"737"),{annotations:{"int":{responseStatusCode:e?d("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(e):200,responseSubCode:b?d("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(b):9e3}},instanceKey:a})}function u(a,b){b!=null&&c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"sent_sm_event:"+b,{instanceKey:a})}function v(a,b){b!=null&&c("QPLUserFlow").addPoint(c("qpl")._(398988976,"737"),"processed_sm_event:"+b,{instanceKey:a})}g.log=a;g.updateState=b}),98);
__d("ZenonMWThriftMessageReliabilityLogger",["ODS","ZenonMWMessageReliabilityLogTypes","ZenonMWThriftMessageMap","ZenonMWThriftMessageQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map(),j=new Map(),k=new Map();function a(a){k.set(a,!0)}function b(a,b,c){a=j.get(a);if(!a)return;u(a,b,c)}function c(a){q(a)?u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE):u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST)}function e(a){q(a)?u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_RESPONSE):u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_REQUEST)}function f(a){q(a)||u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_NULL_CHECK)}function l(a){q(a)||u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_TRANSLATION)}function m(a){q(a)?u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_RESPONSE):u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST)}function n(a){q(a)?u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE):u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_REQUEST)}function o(a){q(a)?u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE):u(a,d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST)}function p(a,b){var c=q(a)?d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_RESPONSE_FAILED:d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SEND_REQUEST_FAILED;u(a,c,{errorMessage:b})}function q(a){a=a.messageHeader.responseStatusCode;return a!=null}function r(a,b){var c=d("ZenonMWThriftMessageMap").messageTypeToString(a.messageHeader.type).toLowerCase();a=q(a)?"response":"request";switch(b){case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_REQUEST:case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.RECEIVED_RESPONSE:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","receive_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSING_REQUEST:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","processing_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_REQUEST:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","processed_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENDING_RESPONSE:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","sending_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_TRANSLATION:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","after_translation_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.REQUEST_AFTER_NULL_CHECK:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","after_null_check_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_RESPONSE:case d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_REQUEST:(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway","sent_"+a+"_"+c);(h||(h=d("ODS"))).flush();return;default:return}}var s={connectionState:"",peerConnectionState:"",signalingState:""};function t(a){var b=babelHelpers["extends"]({},s,a);if(s.connectionState!==b.connectionState||s.peerConnectionState!==b.peerConnectionState||s.signalingState!==b.signalingState){s=b;for(b of i.keys())d("ZenonMWThriftMessageQPLLogger").updateState(b,a)}}function u(a,b,c){var e,f=a.messageHeader;e=(e=i.get(f.transactionId))!=null?e:new Set();i.set(f.transactionId,e);if(b!==d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.SENT_SM_EVENT&&b!==d("ZenonMWMessageReliabilityLogTypes").ZenonMWMessageReliabilityEvent.PROCESSED_SM_EVENT&&e.has(b))return;e.add(b);j.set(f.transactionId,a);r(a,b);d("ZenonMWThriftMessageQPLLogger").log(a,b,babelHelpers["extends"]({},c,s))}g.setE2eeIsMandatedForCall=a;g.logEventForTxid=b;g.logReceivedMessage=c;g.logProcessingMessage=e;g.logMessageAfterNullCheck=f;g.logMessageAfterTranslation=l;g.logProcessedMessage=m;g.logSendingMessage=n;g.logSentMessage=o;g.logSendMessageFailed=p;g.updateState=t}),98);
__d("ZenonMWThriftMessageSerializer",["CompactSerializer","MqttThriftHeaderSerializers","MultiwayCommonSerializers","TCompactProtocol","TReadBuffer"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b===void 0&&(b=!1);var c=d("CompactSerializer").serialize(a.messageHeader,d("MultiwayCommonSerializers").serializeRtcMessageHeader);a=d("CompactSerializer").serialize(a.messageBody,d("MultiwayCommonSerializers").serializeRtcMessageBody);if(b){b=new Uint8Array(c.length+a.length);b.set(c);b.set(a,c.length);return b}b={};b=d("CompactSerializer").serialize(b,d("MqttThriftHeaderSerializers").serializeMqttThriftHeader);var e=new Uint8Array(b.length+c.length+a.length);e.set(b);e.set(c,b.length);e.set(a,b.length+c.length);return e}function b(a,b){b===void 0&&(b=!1);a=new(c("TReadBuffer"))(a);a=new(c("TCompactProtocol"))(a);b||d("MqttThriftHeaderSerializers").deserializeMqttThriftHeader(a);b=d("MultiwayCommonSerializers").deserializeRtcMessageHeader(a);a=d("MultiwayCommonSerializers").deserializeRtcMessageBody(a);return{messageBody:a,messageHeader:b}}g.serializeMWThriftMessage=a;g.deserializeMWThriftMessage=b}),98);
__d("ZenonMWThriftAddParticipantsTranslator",["MultiwayCommonTypes","RequestStreamBodyUtils","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="new_room_context";function a(a,b){var c={usersToInvite:new Set(b.participants)};if(b.groupThreadId!=null){b={calling_tags:2,group_thread_id:b.groupThreadId};if(b){b=[{body:{genericMessage:{data:d("RequestStreamBodyUtils").stringToUint8Array(JSON.stringify(b)),topic:h}},header:{topic_DEPRECATED:h}}];c.appMessages=b}}return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{addParticipantsRequest:c},type:d("MultiwayCommonTypes").MessageType.ADD_PARTICIPANTS})}g.NEW_ROOM_CONTEXT=h;g.toThriftAddParticipantsRequest=a}),98);
__d("ZenonMWThriftApprovalTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=b.approvalStatus;b=b.targetUsers;c={approvalStatus:c===0?d("MultiwayCommonTypes").ApprovalStatus.DENIED:d("MultiwayCommonTypes").ApprovalStatus.APPROVED,targetUsers:new Set(b)};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{approvalRequest:c},type:d("MultiwayCommonTypes").MessageType.APPROVAL})}g.toThriftApprovalRequest=a}),98);
__d("ZenonMWThriftClientEventTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b={clientEvents:[{type:b.clientEventType===0?d("MultiwayCommonTypes").ClientEventType.UNKNOWN:d("MultiwayCommonTypes").ClientEventType.MEDIA_CONNECTED}]};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{clientEventRequest:b},type:d("MultiwayCommonTypes").MessageType.CLIENT_EVENT})}g.toThriftClientEventRequest=a}),98);
__d("ZenonMWCommonUtils",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.split("\n");if(a.length<2)throw c("unrecoverableViolation")("Expected SDP string with two or more lines, but got "+a.length,"rtc_www");a=a[1].trim();a=a.split(" ");if(a.length<3)throw c("unrecoverableViolation")("Session line should have at least 3 tokens, but got "+a.length,"rtc_www");a=parseInt(a[2],10);if(isNaN(a))throw c("unrecoverableViolation")("SDP version could not be parsed as number.","rtc_www");return a}function b(a){return a.includes("BUNDLE 0")}g.getSdpVersion=a;g.isUnifiedPlan=b}),98);
__d("ZenonMWThriftClientMediaUpdateTranslator",["MultiwayCommonTypes","ZenonMWCommonUtils","ZenonMWThriftResponseStatusCodeUtils","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],c=a.messageBody;a=a.messageHeader;c=c.clientMediaUpdateResponse;var e=a.responseStatusCode,f=a.responseSubCode,g=a.retryAfterMsec;if(c){var h=c.answer,i=c.mediaStatus,j=h!=null&&i!=null;d("ZenonMWThriftTranslatorUtils").addThriftStateStoreSignalingEvents(c.stateStore,b,!1,j);var k=d("ZenonMWThriftTranslatorUtils").fetchE2eeServerState(c.stateStore);if(j){h=(j=h==null?void 0:h.sdpString)!=null?j:"";j=d("ZenonMWThriftTranslatorUtils").toZenonMediaStatesFromThrift(i);i={ackMessageId:a.transactionId,eventName:"localSdpResponse",hasAnswerInJoinResponse:!1,source:"clientMediaUpdate"};var l=c.renegotiationOffer,m=null;l!=null&&l.sdpString!=null&&(m={sdp:l.sdpString,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(l.sdpString)});l={e2eeServerState:k,eventName:"remoteSdpRequest",mediaPath:d("ZenonMWThriftTranslatorUtils").fromThriftMediaPath(c.mediaPath),mediaStates:j,negotiateType:!1,renegotiationOffer:m,sdp:{sdp:h,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(h)},sdpOriginLocalId:c.sdpOriginLocalId,source:"clientMediaUpdateResponse"};b.push(i);b.push(l)}k={ackMessageId:a.transactionId,acknowledgedVersion:Number(c.currentVersion),eventName:"mediaUpdateResponse",retryAfter:g!=null?g:0};e!=null&&(k.responseStatusCode=d("ZenonMWThriftResponseStatusCodeUtils").getResponseStatusCodeFromThrift(e));f!=null&&(k.responseSubCode=d("ZenonMWThriftResponseStatusCodeUtils").getResponseSubCodeFromThrift(f));b.push(k)}return b}function b(a,b,c){b={fromVersion:String(b.version),mediaUpdates:[{mediaStatus:d("ZenonMWThriftTranslatorUtils").toMWThriftMediaStatus(b),mediaStatusEx:d("ZenonMWThriftTranslatorUtils").toThriftMWMediaStatusEx(b)}],toVersion:String(b.version)};c!==void 0&&(b.offer={sdpString:c.sdp});return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{clientMediaUpdateRequest:b},type:d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE})}g.fromThriftClientMediaUpdateResponse=a;g.toThriftClientMediaUpdateRequest=b}),98);
__d("ZenonMWThriftConferenceStateTranslator",["MultiwayCommonTypes","RequestStreamBodyUtils","ZenonMWMessageTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],c=a.messageBody.conferenceStateRequest;if(c){var e=c.appMessages,f=c.participantStates,g={eventName:"participantUpdateRequest",participantStates:new Map(),sctpUserIdNodeIdMap:new Map(),versionId:+c.version},h={actorRepresentatives:new Map(),eventName:"clientInfoRequest",mediaPath:d("ZenonMWMessageTypes").ZenonMWMediaPath.UNKNOWN,userCapabilities:new Map()};Object.keys(f).forEach(function(a){var b=f[a],c=b.sctpNodeId,e=b.state;b=b.userCapabilities;g.participantStates.set(a,d("ZenonMWThriftTranslatorUtils").fromThriftParticipantState(e));c!=null&&g.sctpUserIdNodeIdMap.set(a,+c);h.userCapabilities.set(a,b?d("RequestStreamBodyUtils").uint8ArrayToString(b):"")});b.push(g);b.push(h);c=d("ZenonMWThriftTranslatorUtils").getCollisionContextFromThriftAppMessages(e);if(c){c.serverInfoData=a.messageHeader.serverInfoData;e={context:c,eventName:"roomContextUpdateRequest"};b.push(e)}}return b}function b(a,b){b={currentVersion:String(b.requestVersionId)};return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{conferenceStateResponse:b},type:d("MultiwayCommonTypes").MessageType.CONFERENCE_STATE})}g.fromThriftConferenceStateRequest=a;g.toThriftConferenceStateResponse=b}),98);
__d("ZenonMWThriftDataMessageTranslator",["MultiwayCommonTypes","RequestStreamBodyUtils","ZenonActorHooks","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.messageBody.dataMessageRequest;if(a){var c=a.message.header,e=d("ZenonMWThriftTranslatorUtils").getGenericMWThriftDataMessageData(a);a=d("ZenonMWThriftTranslatorUtils").getGenericMWThriftDataMessageTopic(a);var f=h(c.serviceRecipients);if(e!=null&&a!=null){c={data:e,eventName:"genericDataMessageRequest",recipientIDs:Array.from((e=c.recipients)!=null?e:[]),serviceRecipients:f,topic:a};b.push(c)}}return b}function b(a,b){var c={data:d("RequestStreamBodyUtils").stringToUint8Array(b.data),topic:b.topic},e=new Set(b.serviceRecipients.map(d("ZenonMWThriftTranslatorUtils").toThriftServiceRecipient));return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{dataMessageRequest:{message:{body:{genericMessage:c},header:{recipients:new Set(b.recipientIDs),sender:d("ZenonActorHooks").ZenonActor.getID(),serviceRecipients:e,topic_DEPRECATED:""}}}},type:d("MultiwayCommonTypes").MessageType.DATA_MESSAGE})}function c(a){return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{dataMessageResponse:{deliveryResult:{}}},type:d("MultiwayCommonTypes").MessageType.DATA_MESSAGE})}function h(a){var b=[];a==null||a.forEach(function(a){return b.push(d("ZenonMWThriftTranslatorUtils").toServiceRecipientType(a))});return b}g.fromThriftDataMessageRequest=a;g.toThriftDataMessageRequest=b;g.toThriftDataMessageResponse=c}),98);
__d("ZenonMWThriftDismissTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.messageBody.dismissRequest;if(a){var c=a.detailedReasonString;a=a.reason;a={eventName:"terminateRequest",fromJoinResponse:!1,reason:d("ZenonMWThriftTranslatorUtils").fromMWThriftDismissReason(a),shouldInformPeer:!0,subreason:c};b.push(a)}return b}function b(a){return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{},type:d("MultiwayCommonTypes").MessageType.DISMISS})}g.fromThriftDismissRequest=a;g.toThriftDismissResponse=b}),98);
__d("ZenonMWThriftHangupTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.messageHeader;a={ackMessageId:a.transactionId,eventName:"hangupResponse"};b.push(a);return b}function b(a,b){b=b.reason;b={detailedReasonString:"",reason:d("ZenonMWThriftTranslatorUtils").toMWThriftHangupReason(b)};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{hangupRequest:b},type:d("MultiwayCommonTypes").MessageType.HANGUP})}g.fromThriftHangupResponse=a;g.toThriftHangupRequest=b}),98);
__d("ZenonMWThriftIceCandidateTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.messageBody.iceCandidateRequest;if(a){a={eventName:"iceCandidateRequest",iceCandidates:a.iceCandidateSdps.map(function(a){var b;return{candidateSdpString:(b=a.candidateSdpString)!=null?b:"",sdpMid:a.sdpMid,sdpMLineIndex:parseInt(a.sdpMLineIndex,10)}})};b.push(a)}return b}function b(a){var b=[];a=a.messageHeader;a={ackMessageId:a.transactionId,eventName:"iceCandidateResponse"};b.push(a);return b}function c(a){return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{},type:d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE})}function e(a,b){b=b.iceCandidates;b=b.map(function(a){return{candidateSdpString:a.candidateSdpString,sdpMid:a.sdpMid,sdpMLineIndex:a.sdpMLineIndex.toString()}});b={iceCandidateSdps:b};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{iceCandidateRequest:b},type:d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE})}g.fromThriftIceCandidateRequest=a;g.fromThriftIceCandidateResponse=b;g.toThriftIceCandidateResponse=c;g.toThriftIceCandidateRequest=e}),98);
__d("ZenonBrowsers",["UserAgent","UserAgentData"],(function(a,b,c,d,e,f,g){"use strict";function h(){return c("UserAgent").isBrowser("Chrome")}function i(){return!!navigator.webkitGetUserMedia}function a(){return c("UserAgent").isBrowser("Edge (Chromium Based)")||c("UserAgent").isBrowser("Edge PWA (Chromium Based)")}function j(){return c("UserAgent").isBrowser("Safari")}function k(){return c("UserAgent").isBrowser("Firefox")}function b(){return c("UserAgent").isBrowser("Opera")}function l(){return c("UserAgent").isBrowser("Mobile Safari")}function m(){return c("UserAgent").isBrowser("Oculus Browser")}function n(){return c("UserAgent").isBrowser("Samsung Browser")}function d(){return l()||c("UserAgent").isPlatform("Android")||n()}function e(){return c("UserAgent").isPlatform("Android")||c("UserAgent").isPlatform("iOS")}function o(){if(k()){var a;return(a=c("UserAgentData").browserVersion)!=null?a:0}if(i()){a=navigator.userAgent.match(/Chrom(e|ium)\/(\d+)\./);return a!=null?parseInt(a[2],10):999}return 0}function f(){return c("UserAgent").isBrowser("FBLite")||c("UserAgent").isBrowser("Facebook for Android")}function p(){return k()}function q(){return!m()}function r(){return!m()}function s(){return!l()&&!j()&&!((i()||h())&&o()<80)&&!(k()&&o()<70)}function t(){return(i()||h())&&o()>=77||c("UserAgent").isBrowser("Firefox >= 70")||c("UserAgent").isBrowser("Safari >= 14.1")}function u(){return!(c("UserAgent").isBrowser("Chrome > 105")&&c("UserAgent").isBrowser("Chrome < 115"))}function v(){return c("UserAgent").isBrowser("Chrome >= 89")||c("UserAgent").isBrowser("Opera >= 75")||c("UserAgent").isBrowser("Edge (Chromium Based) >= 89")||c("UserAgent").isBrowser("Edge PWA (Chromium Based) >= 89")}function w(){var a=c("UserAgent").isBrowser("Chrome >= 113")&&c("UserAgent").isBrowser("Chrome < 114"),b=(c("UserAgent").isBrowser("Edge (Chromium Based) >= 113")||c("UserAgent").isBrowser("Edge PWA (Chromium Based) >= 113"))&&(c("UserAgent").isBrowser("Edge (Chromium Based) < 114")||c("UserAgent").isBrowser("Edge PWA (Chromium Based) < 114")),d=c("UserAgent").isBrowser("Safari >= 16")&&c("UserAgent").isBrowser("Safari < 17");return a||b||d}function x(){return!(c("UserAgent").isBrowser("Chrome <= 113")||c("UserAgent").isBrowser("Edge (Chromium Based) <= 113")||c("UserAgent").isBrowser("Edge PWA (Chromium Based) <= 113"))}g.isChrome=h;g.isChromium=i;g.isChromiumBasedEdge=a;g.isDesktopSafari=j;g.isFirefox=k;g.isOpera=b;g.isMobileSafari=l;g.isOculusBrowser=m;g.isSamsung=n;g.isSupportedMobileBrowser=d;g.isMobileDevice=e;g.webrtcVersion=o;g.isFBWebview=f;g.noTransceiverForNegotiations=p;g.supportsMWAVEscalation=q;g.supportsVideoCalls=r;g.supportsRollback=s;g.supportsIceRestart=t;g.supportsPranswer=u;g.isVideoLayersAllocationSupported=v;g.isSctpdataChannelDisabled=w;g.isMidCallSCTPSupported=x}),98);
__d("ZenonJoiningContext",[],(function(a,b,c,d,e,f){"use strict";b="joining_context";function a(a){var b=a.callablePostID,c=a.callingTags,d=a.callTrigger,e=a.conferenceName,f=a.groupThreadID,g=a.igThreadID,h=a.immersiveModeDoorID,i=a.isMetaAiCall,j=a.linkUrl,k=a.liveBroadcastID,l=a.meetingID,m=a.peerID,n=a.rtcDoorID;a=a.serverInfoData;return{call_trigger:d,callable_post_id:b,calling_tags:c,conference_name:e,group_thread_id:f,ig_thread_id:g,immersive_mode_door_id:h,is_meta_ai_call:i,link_url:j,live_broadcast_id:k,meeting_id:l,peer_id:m,rtc_door_id:n,server_info_data:a}}f.JOINING_CONTEXT_TOPIC=b;f.convertCollisionToJoiningContext=a}),66);
__d("ZenonIGMediaUtil",["ZenonAppProvider","gkx"],(function(a,b,c,d,e,f,g){"use strict";a={shouldUseSFUOnly:function(){return d("ZenonAppProvider").isInstagramApp()&&!c("gkx")("2274")}};b=a;g["default"]=b}),98);
__d("shouldUseSFUMediaPath",["UserAgent","ZenonAppProvider","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(c("UserAgent").isBrowser("Chrome <= 88"))return!0;return d("ZenonAppProvider").isMessengerWebApp()&&a&&((a=c("gkx")("3298"))!=null?a:!1)?!0:!1}g["default"]=a}),98);
__d("ZenonMWJoinUtils",["ZenonActorHooks","ZenonBrowsers","ZenonIGMediaUtil","shouldUseSFUMediaPath"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("ZenonBrowsers").isFirefox()&&a!=="answer"?!1:!c("ZenonIGMediaUtil").shouldUseSFUOnly()}function b(){return c("shouldUseSFUMediaPath")(!1)?!1:!d("ZenonBrowsers").isMobileSafari()&&!d("ZenonBrowsers").isDesktopSafari()&&!d("ZenonBrowsers").isFirefox()&&!d("ZenonBrowsers").isFBWebview()&&!d("ZenonActorHooks").ZenonActor.isInstagramUser()}g.canUseMwpp=a;g.canDeescalate=b}),98);
__d("ZenonMWThriftJoinTranslator",["MultiwayCommonTypes","MultiwaySharedTypes","RequestStreamBodyUtils","RoboticsPermission","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonDismissReason","ZenonInfraActionsLogger","ZenonJoiningContext","ZenonMWCommonUtils","ZenonMWJoinUtils","ZenonMWThriftTranslatorUtils","ZenonScreenShare","gkx","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],e=a.messageHeader,f=e.responseStatusCode,g=e.responseSubCode;if(f&&f!==d("MultiwayCommonTypes").RtcResponseStatusCode.OK){var i;g="JOIN response status code: "+String(f)+" subcode "+String(g!=null?g:"[undefined]");c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",checkpoint:"[ZP] Got non-OK "+g,errorDomain:"ZenonMWThriftMessageTranslator.fromThriftJoinResponse"});i={detailedReasonFromMW:(i=e.responseStatusMessage)!=null?i:"",eventName:"terminateRequest",fromJoinResponse:!0,reason:h(f,e.responseSubCode),shouldInformPeer:!1,subreason:g};b.push(i);return b}f=a.messageBody.joinResponse;if(!f)return b;a=(i=(g=f.answer)==null?void 0:g.sdpString)!=null?i:"";g=a!=="";d("ZenonMWThriftTranslatorUtils").addThriftStateStoreSignalingEvents(f.stateStore,b,!1,g);d("ZenonMWThriftTranslatorUtils").maybeAddOverlayConfigServerUpdateRequestFromThrift(b,e);i=d("ZenonMWThriftTranslatorUtils").fetchE2eeServerState(f.stateStore);e={ackMessageId:e.transactionId,eventName:"localSdpResponse",hasAnswerInJoinResponse:g,source:"joinResponse"};b.push(e);if(g){e={sdp:a,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(a)};g=d("ZenonMWThriftTranslatorUtils").toZenonMediaStatesFromThrift(f.mediaStatusEx);a=f.renegotiationOffer;var j=null;a!=null&&a.sdpString!=null&&(j={sdp:a.sdpString,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(a.sdpString)});a={e2eeServerState:i,eventName:"remoteSdpRequest",mediaPath:d("ZenonMWThriftTranslatorUtils").fromThriftMediaPath(f.mediaPath),mediaStates:g,negotiateType:!1,renegotiationOffer:j,sdp:e,sdpOriginLocalId:f.sdpOriginLocalId,source:"joinResponse"};b.push(a)}i={capabilities:{addParticipantEnabled:!0,cowatchEnabled:!0,cowatchGroupEnabled:!0,multipleVideoStreamsAllowed:f.multipleVideoStreamsAllowed},eventName:"capabilitiesRequest"};b.push(i);if(f.isPendingApproval){g={eventName:"pendingApprovalRequest"};b.push(g)}j=f.groupsOfUsers;var k=new Map();j.forEach(function(a){var b=a.aliasId;a=a.users;b!=null&&a.forEach(function(a){k.set(a,b)})});e={actorRepresentatives:k,eventName:"clientInfoRequest",mediaPath:d("ZenonMWThriftTranslatorUtils").fromThriftMediaPath(f.mediaPath),userCapabilities:new Map()};b.push(e);return b}function b(a,b,e,f){var g=b.initialSyncStates,h=b.isSecondaryJoinRole,j=b.userCapabilities;j={clientMediaMode:e.mediaMode==="p2p"?d("MultiwaySharedTypes").MediaPath.P2P:d("MultiwaySharedTypes").MediaPath.SFU,deviceCapabilities:new Set([d("MultiwayCommonTypes").Capability.SUPPORT_NEW_PARTICIPANT_STATES,d("MultiwayCommonTypes").Capability.REQUIRE_FULL_SDP_IN_SMU,d("MultiwayCommonTypes").Capability.SUPPORT_SDP_RENEGOTIATION,d("MultiwayCommonTypes").Capability.REQUIRE_FULL_SDP_IN_SMU_OPTIMIZED].concat(c("gkx")("16526")?[d("MultiwayCommonTypes").Capability.SUPPORT_DELTA_SMU]:[],d("ZenonBrowsers").supportsPranswer()?[d("MultiwayCommonTypes").Capability.SUPPORT_PRECONNECT]:[])),mediaStatus:d("ZenonMWThriftTranslatorUtils").toMWThriftMediaStatus(e.mediaStates),mediaStatusEx:d("ZenonMWThriftTranslatorUtils").toThriftMWMediaStatusEx(e.mediaStates),offer:{},syncPayload:g?{stateStore:d("ZenonMWThriftTranslatorUtils").toThriftMWSyncStateStore(g),stateStoreV2:{}}:void 0,userCapabilities:d("RequestStreamBodyUtils").stringToUint8Array((g=j.get(a.userInfo.userID))!=null?g:"")};h!=null&&(j.endpointSettings={joinMode:h?d("MultiwayCommonTypes").JoinMode.SECONDARY:d("MultiwayCommonTypes").JoinMode.PRIMARY});g=b.isE2eeMandated===!0;j.e2eeEnforcement={infraMandatedExpStatus:b.e2eeInfraMandatedExpStatus,mode:g?d("MultiwaySharedTypes").E2eeMode.E2EE_MANDATED:d("MultiwaySharedTypes").E2eeMode.E2EE_NOT_MANDATED,p2pSFrameExpStatus:d("MultiwaySharedTypes").P2PSFrameExpStatus.NOT_SET,preventSfuMode:!1};e.sdp.type==="offer"&&(j.offer={sdpString:e.sdp.sdp});d("ZenonMWJoinUtils").canUseMwpp(e.sdp.type)&&(j.deviceCapabilities.add(d("MultiwayCommonTypes").Capability.SUPPORT_MWPP),e.sdp.type==="answer"&&(j.answer={sdpString:e.sdp.sdp}),d("ZenonMWJoinUtils").canDeescalate()&&j.deviceCapabilities.add(d("MultiwayCommonTypes").Capability.SUPPORT_MWPP_DEESCALATION));(!d("ZenonScreenShare").screenShareWithReplaceTrack()||c("RoboticsPermission").is_authorized_robot)&&j.deviceCapabilities.add(d("MultiwayCommonTypes").Capability.SUPPORT_MULTIPLE_VIDEO_STREAMS);h=f==null?void 0:f.otherParticipants;h&&(j.usersToCall=new Set(h));b=[];e=(e=f==null?void 0:f.roomInfo.context)!=null?e:a.roomInfo.context;if(e!=null){var k=d("ZenonJoiningContext").convertCollisionToJoiningContext(e);g&&(k.calling_tags=2);b=[].concat(b,[{body:{genericMessage:{data:d("RequestStreamBodyUtils").stringToUint8Array(JSON.stringify(k)),topic:d("ZenonJoiningContext").JOINING_CONTEXT_TOPIC}},header:{topic_DEPRECATED:d("ZenonJoiningContext").JOINING_CONTEXT_TOPIC}}])}(f==null?void 0:f.appMessages)!=null&&(b=[].concat(b,d("ZenonMWThriftTranslatorUtils").signalingMessageAppMessagesToThriftMWAppMessages(f.appMessages,h)));j.appMessages=b;g=d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{joinRequest:j},type:d("MultiwayCommonTypes").MessageType.JOIN});e&&e.serverInfoData!=null&&(g.messageHeader.serverInfoData=e.serverInfoData);i(e,g.messageHeader)&&(g.messageHeader.conferenceType=d("MultiwaySharedTypes").ConferenceType.ROOM);return g}function h(a,b){if(b===d("MultiwayCommonTypes").RtcResponseSubCode.EXCEEDED_MAX_ALLOWED_PARTICIPANTS)return d("ZenonDismissReason").ZenonDismissReason.MaxAllowedParticipantsReached;if(b===d("MultiwayCommonTypes").RtcResponseSubCode.PRODUCT_SERVER_DEFINED_END_REASON)return d("ZenonDismissReason").ZenonDismissReason.ProductServerDefinedEndReason;if(b===d("MultiwayCommonTypes").RtcResponseSubCode.CALLER_HAS_APPEALABLE_CALLING_RESTRICTION)return d("ZenonDismissReason").ZenonDismissReason.CallerHasAppealableCallingRestriction;switch(a){case d("MultiwayCommonTypes").RtcResponseStatusCode.METHOD_NOT_ALLOWED:case d("MultiwayCommonTypes").RtcResponseStatusCode.UNAUTHORIZED:return d("ZenonDismissReason").ZenonDismissReason.NoPermission;case d("MultiwayCommonTypes").RtcResponseStatusCode.SERVICE_UNAVAILABLE:return d("ZenonDismissReason").ZenonDismissReason.SignalingMessageFailed;case d("MultiwayCommonTypes").RtcResponseStatusCode.OK:throw c("unrecoverableViolation")("Response status code is OK; should not return a dismiss reason","rtc_www");default:c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,callType:"mw",error:"[ZP] Got unexpected JOIN response status: "+String(a)+" subcode "+String(b!=null?b:"[undefined]"),errorDomain:"fromMWThriftJoinResponseStatusToDismissReason"});return d("ZenonDismissReason").ZenonDismissReason.UnexpectedEndOfCall}}function i(a,b){return((a==null?void 0:a.peerID)!=null||(a==null?void 0:a.groupThreadID)!=null)&&b.conferenceName===""}g.fromThriftJoinResponse=a;g.toThriftJoinRequest=b}),98);
__d("ZenonMWThriftPingTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.messageHeader;a={ackMessageId:a.transactionId,eventName:"pingResponse"};b.push(a);return b}function b(a){return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{},type:d("MultiwayCommonTypes").MessageType.PING})}g.fromThriftPingResponse=a;g.toThriftPingRequest=b}),98);
__d("ZenonMWThriftRemoveParticipantsTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b={usersToRemove:new Set(b.participants)};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{removeParticipantsRequest:b},type:d("MultiwayCommonTypes").MessageType.REMOVE_PARTICIPANTS})}g.toThriftRemoveParticipantsRequest=a}),98);
__d("ZenonMWThriftRingTranslator",["MultiwayCommonTypes","MultiwaySharedTypes","ZenonMWCommonUtils","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){if(b)return{groupThreadID:b.groupThreadId,peerID:b.peerId,serverInfoData:c};b=d("ZenonMWThriftTranslatorUtils").getCollisionContextFromThriftAppMessages(a);b&&(b.serverInfoData=c);return b!=null?b:{groupThreadID:null,peerID:null,serverInfoData:c}}function a(a,b){var c=[],e=a.messageBody;a=a.messageHeader;e=e.ringRequest;if(e){var f=e.appMessages,g=e.caller,i=e.e2eeEnforcement,j=e.otherParticipants,k=e.ringType,l=e.sdpOriginLocalId,m=e.threadIdInfo;g=g;k=k===d("MultiwayCommonTypes").RingType.PEER_VIDEO_CALL||k===d("MultiwayCommonTypes").RingType.GROUP_VIDEO_CALL||k===d("MultiwayCommonTypes").RingType.LIVE_STREAM||k===d("MultiwayCommonTypes").RingType.PEER_ESCALATED_AUDIO_CALL;var n=a.conferenceName;a=a.serverInfoData;m=h(f,m,a);var o=d("ZenonMWThriftTranslatorUtils").getRoomMetadataFromThriftAppMessages(f);g={actorID:b.actorID,e2eeInfraMandatedExpStatus:i==null?void 0:i.infraMandatedExpStatus,eventName:"inviteRequest",inviterID:g,isE2eeMandated:(i==null?void 0:i.mode)===d("MultiwaySharedTypes").E2eeMode.E2EE_MANDATED,isRemoteOfferer:!1,otherParticipants:Array.from(j),requestingVideo:k,roomInfo:babelHelpers["extends"]({context:m,name:n},o==null?{}:{room:o,sender:o.sender}),userID:b.userInfo.userID};a!=null&&(g.serverInfoData=a);f!=null&&(g.appMessages=d("ZenonMWThriftTranslatorUtils").mwThriftAppMessagesToSignalingAppMessages(f));c.push(g);k=(j=(i=e.offer)==null?void 0:i.sdpString)!=null?j:"";n=(m=e.mediaStatusEx)!=null?m:null;if(k!==""&&n!=null){o={sdp:k,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(k)};b=d("ZenonMWThriftTranslatorUtils").toZenonMediaStatesFromThrift(n);a={eventName:"remoteSdpRequest",mediaPath:d("ZenonMWThriftTranslatorUtils").fromThriftMediaPath(e.mediaPath),mediaStates:b,negotiateType:!1,sdp:o,sdpOriginLocalId:l,source:"ringRequest"};c.push(a)}}return c}function b(a,b){b=b.status;b==="IN_ANOTHER_CALL"&&(a.signalingID=null);b=d("ZenonMWThriftTranslatorUtils").toMWThriftDeviceStatus(b);b={deviceStatus:b};return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{ringResponse:b},type:d("MultiwayCommonTypes").MessageType.RING})}g.fromThriftRingRequest=a;g.toThriftRingResponse=b}),98);
__d("ZenonMWThriftServerMediaUpdateTranslator",["FBLogger","MultiwayCommonTypes","ZenonAuditedCheckpointLogId","ZenonBrowsers","ZenonInfraActionsLogger","ZenonMWCommonUtils","ZenonMWThriftMessageReliabilityLogger","ZenonMWThriftMessageTagUtils","ZenonMWThriftTranslatorUtils","ZenonScreenShare"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[],e=a.messageBody.serverMediaUpdateRequest,f=a.messageHeader,g=f.messageTags,i=f.transactionId;if(!e)return b;var j=e.answer,k=e.fromVersion,l=e.mediaPath,m=e.mediaStatus,n=e.multipleVideoStreamsAllowed,o=e.offer,p=e.prAnswer,q=e.renegotiationRequested,r=e.sdpOriginLocalId,s=e.stateStore,t=e.toVersion;e=e.update;o=(o=o==null?void 0:o.sdpString)!=null?o:"";j=(j=j==null?void 0:j.sdpString)!=null?j:"";p=(p=p==null?void 0:p.sdpString)!=null?p:"";k=+k;t=+t;l=d("ZenonMWThriftTranslatorUtils").fromThriftMediaPath(l);g=d("ZenonMWThriftMessageTagUtils").fromThriftMessageTags(g);var u=function(){d("ZenonMWThriftMessageReliabilityLogger").logProcessedMessage(a)},v=o!=="",w=j!=="",x=d("ZenonBrowsers").supportsPranswer()&&p!=="",y=e!==null;y=v||w||x||y;d("ZenonMWThriftTranslatorUtils").addThriftStateStoreSignalingEvents(s,b,!1,y);y=d("ZenonMWThriftTranslatorUtils").fetchE2eeServerState(s);if(q){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 1: renegotationRequested"});s={ackMessageId:i,eventName:"initiateRenegotiationRequest",fromVersion:k,hasRemoteOffer:o!=="",mediaPath:l,messageTags:g!=null?g:[],onProcessed:u,version:t};b.push(s);if(v){q=h(i,k,l,m,{sdp:o,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(o)},r,u,g,y);b.push(q)}}else if(w){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 2: answer SDP"});s=h(i,k,l,m,{sdp:j,type:"answer",version:d("ZenonMWCommonUtils").getSdpVersion(j)},r,u,g,y);if(s.sdp.sdp!=null&&d("ZenonMWCommonUtils").isUnifiedPlan(s.sdp.sdp)){q={sdp:j,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(j)};s.renegotiationOffer=q}b.push(s)}else if(v){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 3: offer SDP"});w=h(i,k,l,m,{sdp:o,type:"offer",version:d("ZenonMWCommonUtils").getSdpVersion(o)},r,u,g,y);b.push(w)}else if(e){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 4: delta SDP"});j=h(i,k,l,m,{type:"offer",update:e,version:t},r,u,g,y);b.push(j)}else if(x){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 5: prAnswer SDP"});q=h(i,k,l,m,{sdp:p,type:"pranswer",version:d("ZenonMWCommonUtils").getSdpVersion(p)},r,u,g,y);b.push(q)}else if(m){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"SMU type 6: media update"});s={ackMessageId:i,eventName:"mediaUpdateRequest",mediaStates:d("ZenonMWThriftTranslatorUtils").toZenonMediaStatesFromThrift(m,k,t),messageTags:g!=null?g:[],onProcessed:u};b.push(s)}else{v="Warning: unsupported SMU type. TXID: "+i;c("FBLogger")("rpweb").warn(v);c("ZenonInfraActionsLogger").logError({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__ERROR,error:v,errorDomain:"ZenonMWThriftServerMediaUpdateTranslator"})}d("ZenonMWThriftTranslatorUtils").maybeAddOverlayConfigServerUpdateRequestFromThrift(b,f);o={capabilities:{multipleVideoStreamsAllowed:n},eventName:"capabilitiesRequest",messageTags:g!=null?g:[]};b.push(o);return b}function h(a,b,c,e,f,g,h,i,j){return{ackMessageId:a,e2eeServerState:j,eventName:"remoteSdpRequest",fromVersion:b,mediaPath:c,mediaStates:d("ZenonMWThriftTranslatorUtils").toZenonMediaStatesFromThrift(e),messageTags:i!=null?i:[],negotiateType:!1,onProcessed:h,sdp:f,sdpOriginLocalId:g,source:"serverMediaUpdateRequest"}}function b(a,b,c,e){return i({acknowledgedVersion:b.acknowledgedVersion,answer:e,header:a,mediaStates:c,statusCode:d("ZenonMWThriftTranslatorUtils").toMWThriftResponseStatusCode(b.statusCode),subCode:(e=d("ZenonMWThriftTranslatorUtils").toMWThriftResponseStatusSubCode(b.subCode))!=null?e:void 0})}function e(a,b){return i({acknowledgedVersion:b.acknowledgedVersion,header:a,statusCode:d("ZenonMWThriftTranslatorUtils").toMWThriftResponseStatusCode(b.statusCode),subCode:(a=d("ZenonMWThriftTranslatorUtils").toMWThriftResponseStatusSubCode(b.subCode))!=null?a:void 0})}function f(a,b){return i({acknowledgedVersion:b.acknowledgedVersion,header:a,statusCode:(a=d("MultiwayCommonTypes").RtcResponseStatusCode.cast(b.responseStatusCode))!=null?a:d("MultiwayCommonTypes").RtcResponseStatusCode.CONDITIONAL_REQUEST_FAILED,subCode:d("MultiwayCommonTypes").RtcResponseSubCode.cast(b.responseSubCode)})}function i(a){var b=a.acknowledgedVersion,c=a.answer,e=a.header,f=a.mediaStates,g=a.statusCode;a=a.subCode;b={currentVersion:String(b)};f&&(b.mediaStatus=j(f));c&&(b.answer={sdpString:c.sdp});return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:e,rtcMessageBody:{serverMediaUpdateResponse:b},statusCode:g,subCode:a,type:d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE})}function j(a){var b={tracks:{}},c=!d("ZenonScreenShare").screenShareWithReplaceTrack();a.tracks.forEach(function(a){var e={customAudioContentType:void 0,customVideoContentType:void 0,enabled:a.enabled,name:a.name,owner:a.participantID},f=c?d("ZenonMWThriftTranslatorUtils").toMWThriftTrackLabel(a.type):null;f!=null&&(e.label=f);b.tracks[a.trackID]=e});return b}g.fromThriftServerMediaUpdateRequest=a;g.toThriftServerMediaUpdateResponse=b;g.toThriftServerMediaUpdateRenegotiationResponse=e;g.toThriftServerMediaUpdateNoSdpResponse=f}),98);
__d("ZenonMWThriftStateSyncTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.messageBody.updateResponse;a=a.messageHeader.transactionId;if(!b)return[];var c=b.topic;b=b.version;a={ackMessageId:a,eventName:"stateSyncUpdateResponse",topic:c,version:b};return[a]}function b(a){a=a.messageBody.notifyRequest;if(!a)return[];var b=[];if(a.syncPayload!=null)d("ZenonMWThriftTranslatorUtils").addThriftStateStoreSignalingEvents(a.syncPayload.stateStore,b,!0,!1);else{var c=a.data,e=a.topic;a=a.version;c={data:c,eventName:"stateSyncNotifyRequest",responseRequired:!0,topic:e,version:a};b.push(c)}return b}function c(a){var b=a.messageBody.unsubscribeResponse;a=a.messageHeader.transactionId;if(!b)return[];var c=b.topic;b=b.version;a={ackMessageId:a,eventName:"stateSyncUnsubscribeResponse",topic:c,version:b};return[a]}function e(a,b){var c=b.data,e=b.topic;b=b.version;c={data:c,syncPayload:{stateStore:{},stateStoreV2:{}},topic:e,topicId:null,version:b};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{updateRequest:c},type:d("MultiwayCommonTypes").MessageType.UPDATE})}function f(a,b){var c=b.topic;b=b.version;c={topic:c,version:b};return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{notifyResponse:c},type:d("MultiwayCommonTypes").MessageType.NOTIFY})}function h(a,b){var c=b.topic;b=b.version;c={topic:c,topicId:null,version:b};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{unsubscribeRequest:c},type:d("MultiwayCommonTypes").MessageType.UNSUBSCRIBE})}g.fromThriftUpdateResponse=a;g.fromThriftNotifyRequest=b;g.fromThriftUnsubscribeResponse=c;g.toThriftUpdateRequest=e;g.toThriftNotifyResponse=f;g.toThriftUnsubscribeRequest=h}),98);
__d("ZenonMWThriftSubscriptionTranslator",["MultiwayCommonTypes","MultiwaySharedTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=b.subscriptions;b={subscriptions:b.map(function(a){var b;return{cname:"",options:{videoQuality:d("MultiwaySharedTypes").VideoQuality.cast((b=a.options)==null?void 0:b.videoQuality)},trackId:a.trackId,type:d("MultiwaySharedTypes").SubscriptionType.cast(a.type)}})};return d("ZenonMWThriftTranslatorUtils").createMWThriftRequest({header:a,rtcMessageBody:{subscriptionRequest:b},type:d("MultiwayCommonTypes").MessageType.SUBSCRIPTION})}g.toThriftSubscriptionRequest=a}),98);
__d("ZenonMWThriftWakeupTranslator",["MultiwayCommonTypes","ZenonMWThriftTranslatorUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=[];a=a.messageHeader;a={ackMessageId:a.transactionId,eventName:"wakeupRequest"};b.push(a);return b}function b(a){return d("ZenonMWThriftTranslatorUtils").createMWThriftResponse({header:a,rtcMessageBody:{},type:d("MultiwayCommonTypes").MessageType.WAKEUP})}g.fromThriftWakeupRequest=a;g.toThriftWakeupResponse=b}),98);
__d("ZenonSignalingMessage",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getHeader=function(){return this.$1};b.getEvents=function(){return this.$2};b.setSignalingID=function(a){this.$1.signalingID=a};b.setRetryCount=function(a){this.$1.retryCount=a};return a}();f["default"]=a}),66);
__d("ZenonMWThriftMessageTranslator",["FBLogger","MultiwayCommonTypes","ZenonActorHooks","ZenonMWThriftAddParticipantsTranslator","ZenonMWThriftApprovalTranslator","ZenonMWThriftClientEventTranslator","ZenonMWThriftClientMediaUpdateTranslator","ZenonMWThriftConferenceStateTranslator","ZenonMWThriftDataMessageTranslator","ZenonMWThriftDismissTranslator","ZenonMWThriftHangupTranslator","ZenonMWThriftIceCandidateTranslator","ZenonMWThriftJoinTranslator","ZenonMWThriftPingTranslator","ZenonMWThriftRemoveParticipantsTranslator","ZenonMWThriftRingTranslator","ZenonMWThriftServerMediaUpdateTranslator","ZenonMWThriftStateSyncTranslator","ZenonMWThriftSubscriptionTranslator","ZenonMWThriftTranslatorUtils","ZenonMWThriftWakeupTranslator","ZenonSignalingMessage","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.getHeader();a=a.getEvents();if(a.length===0)throw c("unrecoverableViolation")("Unexpected Translation: called toMWThriftMessage with empty signaling events","rtc_www");else{var e=a[0];switch(e.eventName){case"addParticipantsRequest":return d("ZenonMWThriftAddParticipantsTranslator").toThriftAddParticipantsRequest(b,e);case"clientEventRequest":return d("ZenonMWThriftClientEventTranslator").toThriftClientEventRequest(b,e);case"clientInfoRequest":if(a.length>=2&&a[1].eventName==="localSdpRequest"&&(a[1].sdp.type==="offer"||a[1].sdp.type==="answer"))return d("ZenonMWThriftJoinTranslator").toThriftJoinRequest(b,e,a[1]);break;case"dismissResponse":return d("ZenonMWThriftDismissTranslator").toThriftDismissResponse(b);case"genericDataMessageRequest":return d("ZenonMWThriftDataMessageTranslator").toThriftDataMessageRequest(b,e);case"genericDataMessageResponse":return d("ZenonMWThriftDataMessageTranslator").toThriftDataMessageResponse(b);case"terminateRequest":return d("ZenonMWThriftHangupTranslator").toThriftHangupRequest(b,e);case"initiateRenegotiationResponse":if(a.length>=3&&a[1].eventName==="remoteSdpResponse"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="answer")return d("ZenonMWThriftServerMediaUpdateTranslator").toThriftServerMediaUpdateResponse(b,a[1],a[2].mediaStates,a[2].sdp);else return d("ZenonMWThriftServerMediaUpdateTranslator").toThriftServerMediaUpdateRenegotiationResponse(b,e);case"inviteRequest":if(a.length>=3&&a[1].eventName==="clientInfoRequest"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="offer")return d("ZenonMWThriftJoinTranslator").toThriftJoinRequest(b,a[1],a[2],e);break;case"inviteResponse":return d("ZenonMWThriftRingTranslator").toThriftRingResponse(b,e);case"iceCandidateRequest":return d("ZenonMWThriftIceCandidateTranslator").toThriftIceCandidateRequest(b,e);case"iceCandidateResponse":return d("ZenonMWThriftIceCandidateTranslator").toThriftIceCandidateResponse(b);case"participantUpdateResponse":return d("ZenonMWThriftConferenceStateTranslator").toThriftConferenceStateResponse(b,e);case"localSdpRequest":return d("ZenonMWThriftClientMediaUpdateTranslator").toThriftClientMediaUpdateRequest(b,e.mediaStates,e.sdp);case"mediaUpdateRequest":return d("ZenonMWThriftClientMediaUpdateTranslator").toThriftClientMediaUpdateRequest(b,e.mediaStates);case"mediaUpdateResponse":return d("ZenonMWThriftServerMediaUpdateTranslator").toThriftServerMediaUpdateNoSdpResponse(b,e);case"pingRequest":return d("ZenonMWThriftPingTranslator").toThriftPingRequest(b);case"remoteSdpResponse":return e.type==="offer"&&(a.length>=2&&a[1].eventName==="localSdpRequest"&&a[1].sdp.type==="answer")?a[1].mediaMode!=="p2p"?d("ZenonMWThriftServerMediaUpdateTranslator").toThriftServerMediaUpdateResponse(b,e,a[1].mediaStates):d("ZenonMWThriftServerMediaUpdateTranslator").toThriftServerMediaUpdateResponse(b,e,a[1].mediaStates,a[1].sdp):d("ZenonMWThriftServerMediaUpdateTranslator").toThriftServerMediaUpdateResponse(b,e);case"removeParticipantsRequest":return d("ZenonMWThriftRemoveParticipantsTranslator").toThriftRemoveParticipantsRequest(b,e);case"subscriptionRequest":return d("ZenonMWThriftSubscriptionTranslator").toThriftSubscriptionRequest(b,e);case"stateSyncNotifyResponse":return d("ZenonMWThriftStateSyncTranslator").toThriftNotifyResponse(b,e);case"stateSyncUpdateRequest":return d("ZenonMWThriftStateSyncTranslator").toThriftUpdateRequest(b,e);case"stateSyncUnsubscribeRequest":return d("ZenonMWThriftStateSyncTranslator").toThriftUnsubscribeRequest(b,e);case"usersApprovalRequest":return d("ZenonMWThriftApprovalTranslator").toThriftApprovalRequest(b,e);case"wakeupResponse":return d("ZenonMWThriftWakeupTranslator").toThriftWakeupResponse(b)}}return null}function b(a){var b=a.messageHeader;if(!h(b)){c("FBLogger")("rtc_www").info("Ignoring Thrift MW message; receiver does not match self ID","rtc_www");return null}var e=b.type,f=b.responseStatusCode==null;b=d("ZenonMWThriftTranslatorUtils").mwThriftMessageHeaderToSignalingMessageHeader(b);var g=[];if(e==null)return new(c("ZenonSignalingMessage"))(b,g);switch(e){case d("MultiwayCommonTypes").MessageType.RING:f&&(g=d("ZenonMWThriftRingTranslator").fromThriftRingRequest(a,b));break;case d("MultiwayCommonTypes").MessageType.JOIN:f||(g=d("ZenonMWThriftJoinTranslator").fromThriftJoinResponse(a));break;case d("MultiwayCommonTypes").MessageType.CONFERENCE_STATE:f&&(g=d("ZenonMWThriftConferenceStateTranslator").fromThriftConferenceStateRequest(a));break;case d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:f||(g=d("ZenonMWThriftClientMediaUpdateTranslator").fromThriftClientMediaUpdateResponse(a));break;case d("MultiwayCommonTypes").MessageType.HANGUP:f||(g=d("ZenonMWThriftHangupTranslator").fromThriftHangupResponse(a));break;case d("MultiwayCommonTypes").MessageType.PING:f||(g=d("ZenonMWThriftPingTranslator").fromThriftPingResponse(a));break;case d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:!f?g=d("ZenonMWThriftIceCandidateTranslator").fromThriftIceCandidateResponse(a):g=d("ZenonMWThriftIceCandidateTranslator").fromThriftIceCandidateRequest(a);break;case d("MultiwayCommonTypes").MessageType.DATA_MESSAGE:f&&(g=d("ZenonMWThriftDataMessageTranslator").fromThriftDataMessageRequest(a));break;case d("MultiwayCommonTypes").MessageType.DISMISS:f&&(g=d("ZenonMWThriftDismissTranslator").fromThriftDismissRequest(a));break;case d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:f&&(g=d("ZenonMWThriftServerMediaUpdateTranslator").fromThriftServerMediaUpdateRequest(a));break;case d("MultiwayCommonTypes").MessageType.NOTIFY:f&&(g=d("ZenonMWThriftStateSyncTranslator").fromThriftNotifyRequest(a));break;case d("MultiwayCommonTypes").MessageType.UPDATE:f||(g=d("ZenonMWThriftStateSyncTranslator").fromThriftUpdateResponse(a));break;case d("MultiwayCommonTypes").MessageType.UNSUBSCRIBE:f||(g=d("ZenonMWThriftStateSyncTranslator").fromThriftUnsubscribeResponse(a));break;case d("MultiwayCommonTypes").MessageType.WAKEUP:f&&(g=d("ZenonMWThriftWakeupTranslator").fromThriftWakeupRequest(a));break;default:break}return new(c("ZenonSignalingMessage"))(b,g)}function h(a){return d("ZenonActorHooks").ZenonActor.isInstagramUser()||d("ZenonActorHooks").ZenonActor.isOculusUser()||d("ZenonActorHooks").ZenonActor.isKadabraUser()||d("ZenonActorHooks").ZenonActor.isLiveChatOnlyPerson()||d("ZenonActorHooks").ZenonActor.isManagedMetaAccount()||d("ZenonActorHooks").ZenonActor.isMDCUser()||a.receiverUserId==null||a.receiverUserId===d("ZenonActorHooks").ZenonActor.getID()||((a=a.receiver)==null?void 0:a.baseId)===d("ZenonActorHooks").ZenonActor.getAccountID()}g.toMWThriftMessage=a;g.toSignalingMessage=b}),98);
__d("RTWebSignalingListener",["FBLogger","ZenonMWThriftMessageDebugLogger","ZenonMWThriftMessageReliabilityLogger","ZenonMWThriftMessageSerializer","ZenonMWThriftMessageTranslator","getZenonMqttChannel"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=c("getZenonMqttChannel")()}var b=a.prototype;b.setLoggingEventHandler=function(a){this.$2=a};b.subscribe=function(a,b){var e=this;this.$1.subscribeBinary("/t_rtc_multi",function(f){try{f=d("ZenonMWThriftMessageSerializer").deserializeMWThriftMessage(f);c("ZenonMWThriftMessageDebugLogger").logMWThriftMessage("RECEIVED","MQTT Thrift",f);d("ZenonMWThriftMessageReliabilityLogger").logReceivedMessage(f);e.$2&&e.$2({mwThriftMessage:f,name:"mwThriftMessageRecv"});var g=d("ZenonMWThriftMessageTranslator").toSignalingMessage(f);d("ZenonMWThriftMessageReliabilityLogger").logMessageAfterTranslation(f);if(g==null)return;d("ZenonMWThriftMessageReliabilityLogger").logMessageAfterNullCheck(f);b&&e.$3(f,g,b);a(g);d("ZenonMWThriftMessageReliabilityLogger").logProcessingMessage(f)}catch(a){c("FBLogger")("rpweb").catching(a).warn("Error receiving binary MQTT message from /t_rtc_multi topic")}})};b.unsubscribe=function(){this.$1.unsubscribeAll("/t_rtc_multi")};b.$3=function(a,b,d){try{d(a,b)}catch(a){d=c("FBLogger")("rtweb");a instanceof Error&&d.catching(a);d.mustfix("Signaling messages should be json parsable.")}};return a}();g["default"]=a}),98);
__d("ZenonLoggingEventTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["Send","Receive"]);c=b("$InternalEnum")({Primary:"primary",Secondary:"secondary"});d="rtc_www";f.ZenonUpdateIceInfoDirection=a;f.ZenonJoinMode=c;f.tslogSource=d}),66);
__d("ZenonMWThriftMessageLogger",["MultiwayCommonTypes","ZenonLoggingEventTypes"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set(),i=new Set();function a(a,b){var c=a.messageHeader;a=a.messageBody;if(h.has(c.transactionId)||c.type==null)return;switch(c.type){case d("MultiwayCommonTypes").MessageType.JOIN:a.joinRequest&&j(a.joinRequest,b);break;case d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:a.iceCandidateRequest&&l(a.iceCandidateRequest,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);break;case d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:a.clientMediaUpdateRequest&&m(a.clientMediaUpdateRequest,b);break;case d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:a.serverMediaUpdateResponse&&p(a.serverMediaUpdateResponse,b);break;default:break}h.add(c.transactionId)}function b(a,b){var c=a.messageHeader;a=a.messageBody;if(i.has(c.transactionId)||c.type==null)return;switch(c.type){case d("MultiwayCommonTypes").MessageType.JOIN:a.joinResponse&&k(a.joinResponse,b);break;case d("MultiwayCommonTypes").MessageType.ICE_CANDIDATE:a.iceCandidateRequest&&l(a.iceCandidateRequest,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);break;case d("MultiwayCommonTypes").MessageType.CLIENT_MEDIA_UPDATE:a.clientMediaUpdateResponse&&n(a.clientMediaUpdateResponse,b);break;case d("MultiwayCommonTypes").MessageType.SERVER_MEDIA_UPDATE:a.serverMediaUpdateRequest&&o(a.serverMediaUpdateRequest,b);break;default:break}i.add(c.transactionId)}function j(a,b){var c=a.answer;a=a.offer;b({name:"inviteSent"});q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send);c&&q(c,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function k(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function l(a,b,c){a=a.iceCandidateSdps;a.forEach(function(a){a.candidateSdpString!=null&&b({direction:c,name:"updateIceInfo",sdpString:a.candidateSdpString})})}function m(a,b){a=a.offer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function n(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function o(a,b){var c=a.answer;a=a.offer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive);c&&q(c,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Receive)}function p(a,b){a=a.answer;a&&q(a,b,d("ZenonLoggingEventTypes").ZenonUpdateIceInfoDirection.Send)}function q(a,b,c){a.sdpString!=null&&b({direction:c,name:"updateIceInfo",sdpString:a.sdpString})}g.logSentMessage=a;g.logReceivedMessage=b}),98);
__d("ZenonValidateMWThriftMessage",["FBLogger","MultiwayCommonTypes","ZenonInfraActionsLogger","ZenonMWThriftMessageMap"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.messageHeader.type,e=d("ZenonMWThriftMessageMap").messageTypeToString(b);if(a.messageHeader.serverInfoData==null&&b!=null&&b!==d("MultiwayCommonTypes").MessageType.JOIN){c("ZenonInfraActionsLogger").logCheckpoint({checkpoint:"[ZP][DROP] No remoteSignalingID in message: "+e});c("FBLogger")("rtc_www").warn("[ZP][DROP] No remoteSignalingID in message: "+e);return!1}return!0}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","cr:3024","gkx","isEmpty"],(function(a,b,c,d,e,f,g){var h,i="javascript-sandbox",j="OverrideServer",k="www_sandbox",l="www_tier";a=function(){function a(){}var d=a.prototype;d.patchRequestHeaders=function(a){var d={},e=c("RTISubscriptionManagerConfig").bladerunner_www_sandbox,f=c("RTISubscriptionManagerConfig").is_intern;if(!(h||(h=c("isEmpty")))(c("WebDriverConfig").auxiliaryServiceInfo)){var g;g=(g=c("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)!=null?g:c("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"];g!=null?(typeof g.ip_address==="string"?d[j]=g.ip_address+":18295":typeof g.hostname==="string"&&(d[j]=g.hostname+":18295"),typeof c("WebDriverConfig").originHost==="string"&&(d[k]="www."+c("WebDriverConfig").originHost)):e!=null&&(d[i]=e)}else e!=null&&(d[i]=e);f===!0&&(d[l]="intern");if(c("WebDriverConfig").isTestRunning&&c("gkx")("20919")){g=b("cr:3024")==null?void 0:b("cr:3024").get();g!=null&&(d.is_test="true",d.original_request_id=g)}c("gkx")("20929")&&(d["Accept-Ack"]="RSAck");for(e in a)d[e]=a[e];d.http_referer=window.location.href;return d};return a}();d=new a();e=d;g["default"]=e}),98);
__d("BladeRunnerLogger",["FBLogger","ODS"],(function(a,b,c,d,e,f,g){var h,i="bladerunner_js_client",j={info:"info",warning:"warning",exception:"exception"};a=function(){function a(){this.setFBLoggerLevel(1)}var b=a.prototype;b.info=function(a){this.$2>=2&&c("FBLogger")(i).info("BladeRunner info: %s",a),this.$3(j.info,a)};b.warn=function(a){this.$2>=1&&c("FBLogger")(i).warn("BladeRunner warn: %s",a),this.$3(j.warning,a)};b.exception=function(a,b){b===void 0&&(b="");var d=b+" "+a.toString();this.$2>=0&&c("FBLogger")(i).warn("BladeRunner exception: %s, %s",b,a.toString());this.$3(j.exception,d)};b.trimForLogging=function(a){var b=1024;return typeof a==="string"&&a.length>b?"[trimmed]:"+a.substring(0,b)+"...":a};b.bumpCounter=function(a,b){b===void 0&&(b=1),(h||(h=d("ODS"))).bumpEntityKey(2966,"BladeRunnerClient",a,b)};b.setClientSessionId=function(a){this.$1=a};b.setFBLoggerLevel=function(a){this.$2=a};b.$3=function(a,b){};return a}();b=new a();e=b;g["default"]=e}),98);
__d("BladeRunnerTypes",[],(function(a,b,c,d,e,f,g){a={REQUEST:1,DATA:2,DATA_ACK:3,STATUS_UPDATE:4,REWRITE_REQUEST:5,LOG:6};b={BLADE_RUNNER:1,GATEWAY:2};g.StreamFrameType=a;g.StreamRequestType=b}),98);
__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],(function(a,b,c,d,e,f,g){var h=function(){function a(){}var b=a.prototype;b.getHeaders=function(){if(this.headers!=null)return this.headers;throw new Error("Expected headers")};b.getInstrumentationData=function(){if(this.instrumentationData!=null&&this.instrumentationData.length>0)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.updateRetryRequestPayload=function(a){a!=null?this.payload=c("Base64").encode(a):this.payload=null};a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.requestType=o(b.requestType);c.payload=r(b.payload);c.headers=u(b.headers);c.extraHeader=r(b.extraHeader);c.requestTarget=r(b.requestTarget);c.instrumentationData=r(b.instrumentationData);return c};return a}(),i=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.dataId=p(b.dataId);c.data=r(b.data);c.shouldAck=w(b.shouldAck);return c};var b=a.prototype;b.rawData=function(){if(this.data==null)throw new Error("Expected data");return this.data};b.rawDataSize=function(){return this.data==null?0:this.data.length};b.decodeData=function(){if(this.data==null)throw new Error("Expected data");return c("Base64").decode(this.data)};b.setData=function(a){this.data=c("Base64").encode(a)};b.getInstrumentationData=function(){if(this.instrumentationData!=null)return JSON.parse(this.instrumentationData);else return null};return a}(),j=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.dataId=o(b.dataId);c.success=v(b.success);c.message=r(b.message);c.code=p(b.code);return c};return a}();j.ACK_CODE_LANDED_AND_ACCEPTED=20;j.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21;j.ACK_CODE_FAILED_TO_LAND=50;var k=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=p(b.streamId);c.message=r(b.message);return c};return a}(),l=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.status=o(b.status);c.message=r(b.message);c.code=p(b.code);c.shouldRetry=w(b.shouldRetry);c.retryDelayMs=p(b.retryDelayMs);return c};return a}(),m=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.newBody=r(b.newBody);c.newExtraHeader=r(b.newExtraHeader);c.patchExtraHeader=r(b.patchExtraHeader);c.killBody=w(b.killBody);c.temporary=w(b.temporary);return c};return a}(),n=function(){function a(){}var b=a.prototype;b.getRequest=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request;throw new Error("Expected request")};b.getData=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data;throw new Error("Expected data")};b.getDataAck=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck;throw new Error("Expected dataAck")};b.getStatusUpdate=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate;throw new Error("Expected status update")};b.getLog=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log;throw new Error("Expected log")};b.getRewriteRequest=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest;throw new Error("Expected rewrite request")};b.getStreamId=function(){if(this.type==d("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest.streamId;if(this.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck.streamId;throw new Error("Frame with unexpected type")};b.isInstrumented=function(){if(this.type===d("BladeRunnerTypes").StreamFrameType.REQUEST)return this.getRequest().instrumentationData!=null;else if(this.type===d("BladeRunnerTypes").StreamFrameType.DATA)return this.getData().instrumentationData!=null;else return!1};a.readObject=function(b){var e=new a();e.type=o(b.type);switch(e.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:e.request=h.readObject(s(b.request));break;case d("BladeRunnerTypes").StreamFrameType.DATA:e.data=i.readObject(s(b.data));break;case d("BladeRunnerTypes").StreamFrameType.DATA_ACK:e.dataAck=j.readObject(s(b.dataAck));break;case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:e.statusUpdate=l.readObject(s(b.statusUpdate));break;case d("BladeRunnerTypes").StreamFrameType.LOG:e.log=k.readObject(s(b.log));break;case d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:e.rewriteRequest=m.readObject(s(b.rewriteRequest));break;default:c("BladeRunnerLogger").warn("Frame with unexpected type: "+e.type);return null}return e};a.newRequestFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.REQUEST;c.request=b;return c};a.newDataFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.DATA;c.data=b;return c};a.newDataAckFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.DATA_ACK;c.dataAck=b;return c};a.newStatusUpdateFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE;c.statusUpdate=b;return c};a.newLogFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.LOG;c.log=b;return c};a.newRewriteRequestFrame=function(b){var c=new a();c.type=d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST;c.rewriteRequest=b;return c};return a}();a=function(){function a(a,b,c){this.batchId=a,this.frames=b,this.instrumentationData=c}var b=a.prototype;b.getFrames=function(){if(this.frames!=null)return this.frames;throw new Error("Expected frames")};b.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.getInstrumentationDataDfTraceId=function(){if(this.instrumentationData!=null)try{var a=JSON.parse(this.instrumentationData);return(a=a.dataFlowTracingData)==null?void 0:a.traceId}catch(a){return null}else return null};b.write=function(){return JSON.stringify(this)};b.isInstrumented=function(){return this.getFrames().some(function(a){return a.isInstrumented()})};a.read=function(b){b=JSON.parse(b);var c=b.batchId||0,d=[];for(var e of b.frames){var f=n.readObject(e);f!=null&&d.push(f)}f=b.instrumentationData||null;return new a(c,d,f)};return a}();function o(a){if(typeof a==="number")return a;throw new Error("Expected number")}function p(a){return a==null?null:o(a)}function q(a){if(typeof a==="string")return a;throw new Error("Expected string")}function r(a){return a==null?null:q(a)}function s(a){if(typeof a==="object"&&a!=null)return a;throw new Error("Expected object")}function t(a){if(typeof a==="object"&&a!=null){var b=a,c={};Object.keys(b).forEach(function(a){var d=b[a];typeof d==="string"&&d!=null&&(c[a]=d)});return c}throw new Error("Expected string map")}function u(a){return a==null?null:t(a)}function v(a){if(typeof a==="boolean"&&a!=null)return a;throw new Error("Expected boolean")}function w(a){return a==null?null:v(a)}g.GatewayStreamRequest=h;g.GatewayStreamData=i;g.GatewayStreamDataAck=j;g.GatewayStreamLog=k;g.GatewayStreamStatusUpdate=l;g.GatewayStreamRewriteRequest=m;g.GatewayStreamFrame=n;g.GatewayStreamBatch=a}),98);
__d("RequestStreamE2EClientLoggerEvent",[],(function(a,b,c,d,e,f){a=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"});f["default"]=a}),66);
__d("RequestStreamE2EClientLoggerMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"});f["default"]=a}),66);
__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){var h=1e3;a=function(){function a(a,b,c){this.$2=a,this.$1=b,this.$3=c}var b=a.prototype;b.onProxyResponse=function(a){this.$4(a);var b=[];for(var e of a.getFrames())this.$2.witnessFrame(e)&&b.push(e);e=this.$2.getRequest();(e=e.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").SENT,{},(e=a.getInstrumentationData())==null?void 0:e.auxId,null,a.getInstrumentationDataDfTraceId());b.length>0&&this.$5(new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(a.batchId,b,a.instrumentationData))};b.onDisconnect=function(){this.$2.resetErrors();var a=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();a.streamId=this.$2.getRequest().streamId;a.status=d("BladeRunnerStreamStatus").StreamStatus.CLOSED;a.shouldRetry=!0;a.retryDelayMs=0;a=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a)]);this.onProxyResponse(a)};b.$4=function(a){var b=this;a=a.getFrames().filter(function(a){return a.type==d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE});for(a of a){var e=a.getStatusUpdate();if(e.status==d("BladeRunnerStreamStatus").StreamStatus.CLOSED||e.status==d("BladeRunnerStreamStatus").StreamStatus.REJECTED){this.$2.onError();var f=e.shouldRetry!=null&&e.shouldRetry,g=e.message!=null?e.message:"null";if(f&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){e.status=d("BladeRunnerStreamStatus").StreamStatus.STOPPED;var i=h;e.retryDelayMs!=null&&(i=e.retryDelayMs);c("BladeRunnerLogger").info("Can retry: stream "+e.streamId+" closed with status "+e.status+", message "+g+". Error count: "+this.$2.getErrorCount()+", retryDelay "+i+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString());this.$2.getRetryRequestScheduled()?c("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(c("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),i>0?c("setTimeoutAcrossTransitions")(function(){return b.$6()},i):this.$6())}else c("BladeRunnerLogger").info("Will not retry: stream "+e.streamId+" closed with status "+e.status+", message "+g+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+f.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),f?c("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):c("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(e.streamId)}}};b.$6=function(){this.$2.setRetryRequestScheduled(!1);if(this.$2.isAlive()){var a=this.$1.getUpdatedRequestBody();a!=null&&this.$2.updateRetryRequestPayload(a);this.$3.sendRetryStreamRequest(this.$2)}};b.$5=function(a){c("BladeRunnerLogger").bumpCounter("send_to_handler");var b=[];this.$1.onBatch(a);for(a of a.getFrames())try{switch(a.type){case d("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(a.getData());b.push(a.getData());break;case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(a.getStatusUpdate().status);break;case d("BladeRunnerTypes").StreamFrameType.LOG:var e=a.getLog().message;e!=null&&this.$1.onLog(e);break;case d("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(a){c("BladeRunnerLogger").bumpCounter("send_to_handler_error"),c("BladeRunnerLogger").exception(a,"Failed sending frame to stream handler")}this.$7(b)};b.$7=function(a){var b=[];for(a of a)if(a.shouldAck===!0&&a.dataId!=null){var c=new(d("BladeRunnerTypesInternal").GatewayStreamDataAck)();c.streamId=a.streamId;c.dataId=a.dataId;c.success=!0;b.push(c)}this.$3.sendDataAcks(b)};return a}();g["default"]=a}),98);
__d("RtiRequestStreamE2eClientBatchFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("819");b=d("FalcoLoggerInternal").create("rti_request_stream_e2e_client_batch",a);e=b;g["default"]=e}),98);
__d("RtiRequestStreamE2eClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1857112");b=d("FalcoLoggerInternal").create("rti_request_stream_e2e_client",a);e=b;g["default"]=e}),98);
__d("RequestStreamE2ELogger",["ConstUriUtils","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RtiRequestStreamE2eClientBatchFalcoEvent","RtiRequestStreamE2eClientFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";var h=["FBGQLS:COMMENT_CREATE_SUBSCRIBE","FBGQLS:COMMENT_LIKE_SUBSCRIBE","FBGQLS:FEEDBACK_COMMENT_PERMISSION_TOGGLE_SUBSCRIBE","FBGQLS:FEEDBACK_TYPING_SUBSCRIBE","FBLQ:comet_notifications_live_query_experimental"],i=0;function j(){var a=Date.now();i>=a?i+=1:i=a;return i.toString()}var k=function(){function a(a,b,c,e,f,g,h,i,j,k){this.$10=[];this.$11=!1;this.$1=a;this.$2=b;this.$3=c;this.$4=e;this.$5=f;this.$6=g;this.$7=h;this.$8=i;this.$9=j;this.$12=k!=null?k:!1;a=d("ConstUriUtils").getUri(window.location.href);a&&(this.$13=a.getDomain())}var b=a.prototype;b.logE2EEvent=function(a,b,c,d,e,f){c===void 0&&(c=null);d===void 0&&(d=null);e===void 0&&(e=null);f===void 0&&(f=null);if(this.$3==="Falco")return;e={request_id:this.$1,resume_id:"0",retry_id:e,transport:this.$2,method:this.$3,use_case:this.$4,request_log_context:this.$5,force_log_context:this.$6,e2e_sample_rate:this.$7,message_type:a,event:b,timestamp_ms:j(),aux_id:d,additional_data:c,dgw_stream_group_logging_id:this.$8,dgw_count_prior_streams_in_group:this.$9,domain:this.$13,df_trace_id:f};this.$14(e)};b.$14=function(a){if(!this.$12){c("RtiRequestStreamE2eClientFalcoEvent").log(function(){return a});return}this.$10.push(a);if(this.$11||a.event==c("RequestStreamE2EClientLoggerEvent").FAILURE||a.message_type==c("RequestStreamE2EClientLoggerMessageType").RESPONSE){var b={events:this.$10};c("RtiRequestStreamE2eClientBatchFalcoEvent").log(function(){return b});this.$10=[];this.$11=!0}};b.getRequestId=function(){return this.$1};return a}();function a(a,b,c){if(a==null||a.method==null)return null;var d=!1;h.includes(a.method)&&(d=!0);if(b==null||b.length==0)return null;b=JSON.parse(b);return b.requestId==null?null:new k(b.requestId,c,a.method,l(a.method,a),b.requestLogContext,b.forceLogContext,b.sampleRate,b.dgwStreamGroupLoggingId,b.dgwCountPriorStreamsInGroup,d)}function l(a,b){if(a==="FBLQ"&&b.config_id)return b.config_id;if(a==="SKY"){if(b.topic){var c=b.topic.lastIndexOf("/");return c>0?b.topic.substr(0,c):b.topic}return}return a}function b(a,b,d,e,f,g){f===void 0&&(f=null);g===void 0&&(g=null);if(a==null||a.requestId==null||a.clientLoggingDisabled!=null)return;var h={request_id:a.requestId,resume_id:"0",transport:b,e2e_sample_rate:a.sampleRate,message_type:d,event:e,timestamp_ms:j(),aux_id:a.auxId,additional_data:f,df_trace_id:g};c("RtiRequestStreamE2eClientFalcoEvent").log(function(){return h})}g.RequestStreamE2ELogger=k;g.createStreamLogger=a;g.logRequestStreamE2EEventStatic=b}),98);
__d("RequestStreamTransport",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]);f.RequestStreamTransport=a}),66);
__d("BladeRunnerSocket",["BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","MqttPublishListener","Promise","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamTransport","justknobx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i="Connected",j="Disconnected",k="/br_sr",l="/sr_res",m=null;function n(a){var b;switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:return(b=a.request)==null?void 0:b.getInstrumentationData();case d("BladeRunnerTypes").StreamFrameType.DATA:return(b=a.data)==null?void 0:b.getInstrumentationData()}return null}function o(a){switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:return c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;case d("BladeRunnerTypes").StreamFrameType.DATA:return c("RequestStreamE2EClientLoggerMessageType").AMENDMENT}return null}function p(a){if(a===null)return null;switch(a){case d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:return"Accepted";case d("BladeRunnerStreamStatus").StreamStatus.REJECTED:return"Rejected";case d("BladeRunnerStreamStatus").StreamStatus.STARTED:return"Started";case d("BladeRunnerStreamStatus").StreamStatus.STOPPED:return"Stopped";case d("BladeRunnerStreamStatus").StreamStatus.CLOSED:return"Closed"}return null}function q(a){var b,c={};a==null||(b=a.frames)==null||b.forEach(function(a){if(a.type===d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE){a=(a=a.statusUpdate)==null?void 0:a.status;a=p(a);a!==null&&(c.flow_status=a)}});return c}function r(a,b){var c;switch(a.type){case d("BladeRunnerTypes").StreamFrameType.REQUEST:b.data_base64_size=(c=a.request)==null||(c=c.payload)==null||(c=c.length)==null?void 0:c.toString();break;case d("BladeRunnerTypes").StreamFrameType.DATA:b.data_base64_size=(c=a.data)==null||(c=c.rawDataSize())==null?void 0:c.toString();break}return null}function s(a,b,e){var f=n(a);if(f==null)return;var g=o(a);if(g==null)return;var h=null;switch(b){case d("MqttPublishListener").MqttPublishEvent.SENT:h=c("RequestStreamE2EClientLoggerEvent").SENT;break;case d("MqttPublishListener").MqttPublishEvent.ACKED:h=c("RequestStreamE2EClientLoggerEvent").PUBACK;break;case d("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case d("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:h=c("RequestStreamE2EClientLoggerEvent").FAILURE;e.reason==null&&(e.reason=b);break}if(h==null)return;r(a,e);if(((b=a.request)==null?void 0:b.e2eLogger)!=null&&f.clientLoggingDisabled==null){(b=a.request)==null||b.e2eLogger.logE2EEvent(g,h,e,f.auxId)}else d("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(f,d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,g,h,e)}a=function(){function a(a){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map(),this.$7=a!=null?a:c("FBMqttChannel"),this.$8=new Map(),c("BladeRunnerLogger").setClientSessionId(c("uuidv4")()),this.$9()}a.get=function(){m==null&&(m=new a(c("FBMqttChannel")));return m};var e=a.prototype;e.sendNewStreamRequest=function(b,d){d=new(c("BladeRunnerEventHandler"))(b,d,this);var e=b.getRequest();this.$6.set(e.streamId,d);if(!this.$10()){this.$11(d,e.streamId);return}this.getStreamCount()<=a.maxStreamCount?this.$12(e):(c("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),c("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(b.getRequest().getHeaders())),this.$11(d,e.streamId))};e.sendRetryStreamRequest=function(a){this.$12(a.getRequest())};e.sendCancel=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_cancel");var b=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();b.streamId=a.streamId;b.status=d("BladeRunnerStreamStatus").StreamStatus.CLOSED;this.$13(b,a);this.removeStream(a.streamId)};e.sendAmendment=function(a,b,e){c("BladeRunnerLogger").bumpCounter("socket_send_amendment");var f=new(d("BladeRunnerTypesInternal").GatewayStreamData)();f.streamId=a;f.setData(b);e!=null&&(f.instrumentationData=e);this.$14(f)};e.sendAmendmentWithAck=function(a,e,f){var g=this;c("BladeRunnerLogger").bumpCounter("socket_send_amendment");var i=this.$15(),j=new(d("BladeRunnerTypesInternal").GatewayStreamData)();j.streamId=a;j.setData(e);j.shouldAck=!0;j.dataId=i;f!=null&&(j.instrumentationData=f);a=new(h||(h=b("Promise")))(function(a,b){g.$8.set(i,{resolve:a,reject:b})});this.$14(j);return a};e.$14=function(a){this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(a)),this.$16()};e.sendDataAcks=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_data_ack",a.length),this.$17(a)};e.removeStream=function(a){this.$6["delete"](a)};e.getStreamCount=function(){return this.$6.size};e.getNextStreamId=function(){this.$5++;return this.$5};e.onMQTTStateChanged=function(a){this.$16();if(a!=j&&a!=i||this.$4==a)return;this.$4=a;c("BladeRunnerLogger").info("MQTTStateChanged: "+a);a==j?(c("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):a==i&&c("BladeRunnerLogger").bumpCounter("mqtt_state_connected")};e.$12=function(a){c("BladeRunnerLogger").bumpCounter("socket_send_request");this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(a));if(!this.$16()){(a=a.e2eLogger)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"MQTT Not Connected"})}};e.$13=function(a,b){this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a));if(this.$16()){(a=b.e2eLogger)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").SENT)}};e.$17=function(a){for(a of a)this.$1.push(d("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(a));this.$16()};e.$19=function(){this.$2++;return this.$2};e.$15=function(){this.$3++;return this.$3};e.$16=function(){var a=!1;if(this.$7.getConnectionState()===i&&this.$1.length>0)try{this.$20(this.$1),a=!0}catch(a){}finally{this.$1=[]}return a};e.$20=function(a){var b=this,e=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(this.$19(),a),f=e.write();if(f.length>this.$21()){var g=Math.floor(a.length/2);if(g===0){a.forEach(function(a){return s(a,d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR,{reason:"too long"})});var h=new Error("Publish is too long: "+f.length);h.stack;this.$22(e,h,"Publish is too long");throw h}this.$20(a.slice(0,g));this.$20(a.slice(g,a.length))}else try{c("BladeRunnerLogger").info("send message to "+k+" ("+f.length+" bytes)");h={qos:1,skipBuffer:!1};if(e.isInstrumented()){var i=Date.now();h.listener={onEvent:function(b){var c=(Date.now()-i).toString();a.forEach(function(a){s(a,b,{latency:c})})}}}this.$7.publish(k,f,h)["catch"](function(a){b.$22(e,a,"Failed publishing to MQTT")});c("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(a){this.$22(e,a,"Failed publishing to MQTT");throw a}};e.$9=function(){var a=this;c("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent);this.onMQTTStateChanged(this.$7.getConnectionState());this.$7.subscribeChannelEvents({onMQTTStateChanged:function(b){a.onMQTTStateChanged(b)},onJSError:function(a){var b=a!=null&&typeof a.isRecoverable==="boolean"?a.isRecoverable:!1;b?c("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(c("BladeRunnerLogger").warn("JS error in MQTTChannel: "+(typeof a=="object"&&a!=null?a.toString():"unknown error")+", "+JSON.stringify(a)),c("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}});this.$7.subscribe(k,function(a){throw new Error("Unexpected response: "+k+" "+a.toString())});this.$7.subscribe(l,function(b){a.$23(b)})};e.$23=function(a){a=d("BladeRunnerTypesInternal").GatewayStreamBatch.read(a);this.processBatch(a)};e.$22=function(a,b,e){for(a of a.getFrames())if(a.type===d("BladeRunnerTypes").StreamFrameType.REQUEST){var f=a.getRequest(),g=this.$6.get(f.streamId);g!=null&&this.$24(g,f.streamId,d("BladeRunnerStreamStatus").StreamStatus.CLOSED,!0,null)}else if(a.type===d("BladeRunnerTypes").StreamFrameType.DATA){g=a.getData();f=g.dataId;if(g.shouldAck!=null&&g.shouldAck&&f!=null){var h=new(d("BladeRunnerTypesInternal").GatewayStreamDataAck)();h.streamId=g.streamId;h.dataId=f;h.success=!1;h.code=d("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND;h.message=e;this.$25(h)}}c("BladeRunnerLogger").info("Failed publishing to MQTT: "+b.message);c("BladeRunnerLogger").bumpCounter("mqtt_publish_error")};e.$25=function(a){var b=this.$8.get(a.dataId);b!=null&&(this.$8["delete"](a.dataId),a.success?b.resolve(!0):a.code===d("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?b.resolve(!1):b.reject(a.message))};e.processBatch=function(a){try{d("RequestStreamE2ELogger").logRequestStreamE2EEventStatic(a.getInstrumentationData(),d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").RECEIVED,q(a),a.getInstrumentationDataDfTraceId());c("BladeRunnerLogger").bumpCounter("socket_process_batch");var b=JSON.stringify(a);c("BladeRunnerLogger").info("Received batch ("+b.length+" bytes)");b=null;for(var e of a.getFrames()){var f=e.getStreamId();b==null&&(b=f);if(f!=null&&b!=f)throw new Error("Received batch with frames for multiple streams");e.type==d("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$25(e.getDataAck())}if(b!=null){f=this.$6.get(b);f!=null?f.onProxyResponse(a):c("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+b)}else c("BladeRunnerLogger").info("Received batch with no frames")}catch(a){c("BladeRunnerLogger").exception(a,"Failed processing batch from MQTT");c("BladeRunnerLogger").bumpCounter("socket_process_batch_error");throw a}};e.$18=function(){this.$6.forEach(function(a,b,c){a.onDisconnect()})};e.$11=function(a,b){this.$24(a,b,d("BladeRunnerStreamStatus").StreamStatus.REJECTED,!1,0)};e.$24=function(a,b,c,e,f){var g=new(d("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();g.streamId=b;g.status=c;g.shouldRetry=e;g.retryDelayMs=f;b=new(d("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[d("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(g)]);a.onProxyResponse(b)};e.$10=function(){if(!c("CurrentUser").isLoggedIn()){c("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out");return!1}return!0};e.$21=function(){var a=1024*1024,b=512*1024;try{var d=c("justknobx")._("317");b=d*a}catch(a){}return Math.max(b-1024,0)};return a}();a.maxStreamCount=2e3;g["default"]=a}),98);
__d("BladeRunnerStream",[],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a}var b=a.prototype;b.getStreamHandler=function(){return this.$1};b.cancel=function(){};b.amendWithAck=async function(a){return!1};b.amendFireAndForget=function(a){};b.amendWithoutAck=function(a){};b.start=function(){return Promise.resolve()};b.isAlive=function(){return!1};b.canAmend=function(){return!1};b.getStatus=function(){return null};b.getStreamId=function(){return 0};return a}();f.default=a}),66);
__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerStreamStatus","BladeRunnerTypes"],(function(a,b,c,d,e,f,g){a=function(){function a(a){this.$1=a,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var b=a.prototype;b.getRequest=function(){return this.$1};b.updateRetryRequestPayload=function(a){this.$1.updateRetryRequestPayload(a)};b.isAlive=function(){return!(this.$2==d("BladeRunnerStreamStatus").StreamStatus.CLOSED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.REJECTED)};b.canAmend=function(){return this.$2==d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.STARTED||this.$2==d("BladeRunnerStreamStatus").StreamStatus.STOPPED};b.getLastStatus=function(){return this.$2};b.setLastStatus=function(a){this.$2=a};b.onError=function(){this.$3+=1};b.getErrorCount=function(){return this.$3};b.resetErrors=function(){this.$3=0};b.getRetryRequestScheduled=function(){return this.$6};b.setRetryRequestScheduled=function(a){this.$6=a};b.witnessFrame=function(a){switch(a.type){case d("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var b=a.getStatusUpdate(),c=!0;switch(b.status){case d("BladeRunnerStreamStatus").StreamStatus.ACCEPTED:c=!this.$4;this.$4||(this.$4=!0);break;case d("BladeRunnerStreamStatus").StreamStatus.STARTED:c=this.getLastStatus()!=d("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case d("BladeRunnerStreamStatus").StreamStatus.STOPPED:c=this.getLastStatus()==d("BladeRunnerStreamStatus").StreamStatus.STARTED;break;case d("BladeRunnerStreamStatus").StreamStatus.CLOSED:case d("BladeRunnerStreamStatus").StreamStatus.REJECTED:default:c=!0}this.setLastStatus(b.status);return c;case d("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:this.$7(a.getRewriteRequest());return!1;default:return!0}};b.setRetriesAllowed=function(a){this.$5=a};b.getRetriesAllowed=function(){return this.$5};b.$7=function(a){if(!(a.temporary!=null||a.temporary==!0)){a.newBody!=null&&(this.$1.payload=a.newBody);a.newExtraHeader!=null&&(this.$1.extraHeader=a.newExtraHeader,this.$1.headers=JSON.parse(a.newExtraHeader));if(a.patchExtraHeader!=null)try{var b=JSON.parse(a.patchExtraHeader),d=this.$1.extraHeader!=null?JSON.parse(this.$1.extraHeader):{};this.$1.headers==null&&(this.$1.headers={});for(var e of Object.keys(b))this.$1.headers[e]=b[e],d[e]=b[e];this.$1.extraHeader=JSON.stringify(d)}catch(b){c("BladeRunnerLogger").warn("Failed to patch header: "+a.patchExtraHeader)}a.killBody!=null&&a.killBody==!0&&(this.$1.payload=null)}};return a}();g["default"]=a}),98);
__d("BladeRunnerSocketStream",["BladeRunnerStream","BladeRunnerStreamState","BladeRunnerStreamStatus","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","uuidv4"],(function(a,b,c,d,e,f,g){var h=4,i={reason:"stream_dead"};a=function(a){function b(b,d,e){b=a.call(this,b)||this;b.$BladeRunnerSocketStream$p_1=e;b.$BladeRunnerSocketStream$p_2=new(c("BladeRunnerStreamState"))(d);b.$BladeRunnerSocketStream$p_2.setRetriesAllowed(h);return b}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.start=function(){var a=this;return new Promise(function(b){a.send(),b()})};e.send=function(){var a,b=this.$BladeRunnerSocketStream$p_2.getRequest();(a=b.e2eLogger)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_base64_size:(a=b.payload)==null||(a=a.length)==null?void 0:a.toString()});this.$BladeRunnerSocketStream$p_1.sendNewStreamRequest(this.$BladeRunnerSocketStream$p_2,this.getStreamHandler())};e.amendWithAck=async function(a){var b=this.$BladeRunnerSocketStream$p_2.getRequest(),d=b.getInstrumentationData();if(d){var e,f;d.auxId=c("uuidv4")();(e=b.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:a==null||(f=a.length)==null?void 0:f.toString()},d.auxId)}if(this.canAmend()){if(d){var g;(e=b.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:a==null||(g=a.length)==null?void 0:g.toString()},d.auxId)}return this.$BladeRunnerSocketStream$p_1.sendAmendmentWithAck(b.streamId,this.$BladeRunnerSocketStream$p_3(a),d==null?null:JSON.stringify(d))}(e=b.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,i,d==null?void 0:d.auxId);return Promise.reject("Stream is closed or not accepted")};e.amendFireAndForget=function(a){var b=this.$BladeRunnerSocketStream$p_2.getRequest(),d=b.getInstrumentationData();if(d){var e,f;d.auxId=c("uuidv4")();(e=b.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:a==null||(f=a.length)==null?void 0:f.toString()},d.auxId)}if(this.canAmend()){this.$BladeRunnerSocketStream$p_1.sendAmendment(this.$BladeRunnerSocketStream$p_2.getRequest().streamId,this.$BladeRunnerSocketStream$p_3(a),d==null?null:JSON.stringify(d));if(d){var g;(e=b.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:a==null||(g=a.length)==null?void 0:g.toString()},d.auxId)}}else{(e=b.e2eLogger)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,i,d==null?void 0:d.auxId);throw new Error("Stream is closed or not accepted")}};e.amendWithoutAck=function(a){this.amendFireAndForget(a)};e.$BladeRunnerSocketStream$p_3=function(a){return typeof a=="object"?btoa(new TextDecoder("utf8").decode(a)):a};e.cancel=function(){var a=this.$BladeRunnerSocketStream$p_2.getRequest();(a=a.e2eLogger)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").RECEIVED);this.isAlive()&&(this.$BladeRunnerSocketStream$p_1.sendCancel(this.$BladeRunnerSocketStream$p_2.getRequest()),this.$BladeRunnerSocketStream$p_2.setLastStatus(d("BladeRunnerStreamStatus").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())};e.isAlive=function(){return this.$BladeRunnerSocketStream$p_2.isAlive()};e.canAmend=function(){return this.$BladeRunnerSocketStream$p_2.canAmend()};e.getStatus=function(){return this.$BladeRunnerSocketStream$p_2.getLastStatus()};e.getStreamId=function(){return this.$BladeRunnerSocketStream$p_2.getRequest().streamId};return b}(c("BladeRunnerStream"));g.default=a}),98);
__d("RequestStreamE2ESampling",["invariant","Random","RequestStreamE2EClientSamplingConfig","uuidv4"],(function(a,b,c,d,e,f,g,h){"use strict";function i(a){return a==null?!1:a.requestId!=null&&typeof a.requestId=="string"&&a.forceLogContext!=null&&typeof a.forceLogContext=="string"}function j(a,b){var d=c("RequestStreamE2EClientSamplingConfig").sampleRate;if(d>1&&a!=null){a=c("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[a];a==0?d=0:a!=null&&(d/=a)}return d==1?1:d/b}function k(a,b,d,e){var f=c("uuidv4")();(b.requestId==null||b.requestId===""||typeof b.requestId!="string")&&(a.requestId!=null&&typeof a.requestId=="string"?b.requestId=a.requestId:b.requestId=f);b.requestId+="/_"+f.substring(0,4);b.resumeId="0";d!=null?b.sampleRate=d:b.sampleRate=void 0;f="";e!=null&&e.length>0&&(f=e);f.length>0&&(b.requestLogContext!=null&&b.requestLogContext.length>0?b.requestLogContext+=":":b.requestLogContext="",b.requestLogContext+=f);(a==null?void 0:a.method)==="Falco"&&(b.clientLoggingDisabled="Falco");d={};for(e of Object.keys(b).sort())d[e]=b[e];return JSON.stringify(d)}function a(a,b,d,e){b&&(!b.requestId.includes("/")&&!b.requestId.includes("#")||h(0,41721));e=j(a.method,e!=null?e:1);if(c("Random").coinflip(e))return k(a,b||{requestId:""},e,d);return i(b)?k(a,b||{requestId:""},null,d):""}g.isForceLogged=i;g.getSampleRateForLogging=j;g.normalizeInstrumentationData=k;g.validateInstrumentationData=a}),98);
__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamTransport","cr:2046346"],(function(a,b,c,d,e,f,g){a=function(){function a(a,b){this.$2=d("RequestStreamTransport").RequestStreamTransport.WEB_BR_MQTT,this.$1=a!=null?a:c("BladeRunnerSocket").get(),b&&(this.$2=b)}var e=a.prototype;e.createStream=function(a,b,c,d){return this.$3(a,b,c,d)};e.requestStream=function(a,c,d,e){a=this.$3(a,c,d,e);a.send();b("cr:2046346")!=null&&b("cr:2046346").startPulsarTest();return a};e.logInfo=function(a){c("BladeRunnerLogger").info(a)};e.bumpCounter=function(a){c("BladeRunnerLogger").bumpCounter(a)};e.$3=function(a,b,e,f){var g=new(d("BladeRunnerTypesInternal").GatewayStreamRequest)();g.streamId=this.$1.getNextStreamId();g.requestType=d("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER;g.headers=c("BladeRunnerConfig").patchRequestHeaders(a);g.extraHeader=JSON.stringify(g.headers);g.payload=b!=null?c("Base64").encode(b):null;f!=null&&(f.transport="WEB_RS_MQTT");g.instrumentationData=d("RequestStreamE2ESampling").validateInstrumentationData(g.headers||{},f);g.e2eLogger=d("RequestStreamE2ELogger").createStreamLogger(g.headers,g.instrumentationData,this.$2);return new(c("BladeRunnerSocketStream"))(e,g,this.$1)};return a}();g["default"]=a}),98);
__d("CometGroupsPathingFunnelLogger",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case"1635855486666999":return"REACTION_MENU_LIKE";case"1678524932434102":return"REACTION_MENU_LOVE";case"478547315650144":return"REACTION_MENU_WOW";case"115940658764963":return"REACTION_MENU_HAHA";case"908563459236466":return"REACTION_MENU_SORRY";case"444813342392137":return"REACTION_MENU_ANGER";case"613557422527858":return"REACTION_MENU_SUPPORT";default:return void 0}}function b(a,b,c){return}function c(a){return}function d(a,b){return}function e(a,b,c){return}function g(a){return}e={addEventSharedPoint:e,addPoint:c,addSharedPoint:d,endCancel:g,getReactionQPLPointFromReaction:a,start:b};f["default"]=e}),66);
__d("CometUFIFunnelLogger",["CometUFIFunnelLoggerConstants","FBLogger","QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(a){if(h[a])return;c("QPLUserFlow").start(c("qpl")._(3747131,"4389"),{instanceKey:a});h[a]=!0}function j(a){c("QPLUserFlow").endSuccess(c("qpl")._(3747131,"4389"),{instanceKey:a}),h[a]=!1}function k(a,b){h[a]||i(a),c("QPLUserFlow").addPoint(c("qpl")._(3747131,"4389"),b,{instanceKey:a})}function l(a){if(a>2||a<0){c("FBLogger")("ufi2").mustfix("Depth should be 0 to 2.");return}switch(a){case 0:return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.LEVEL_0_PAGER_CLICK;case 1:return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.LEVEL_1_PAGER_CLICK;case 2:return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.LEVEL_2_PAGER_CLICK}}function m(a){switch(a){case"1635855486666999":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_LIKE;case"1678524932434102":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_LOVE;case"478547315650144":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_WOW;case"115940658764963":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_HAHA;case"908563459236466":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_SORRY;case"444813342392137":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_ANGER;case"613557422527858":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_SUPPORT}}a={addPoint:function(a,b){k(a,b)},endSuccess:function(a){j(a)},getPagerEventFromDepth:function(a){l(a)},getReactionMenuEventFromReaction:function(a){m(a)},start:function(a){i(a)}};b=a;g["default"]=b}),98);
__d("jsbi",[],(function(a,b,c,d,e,f){(function(a,b){"object"==typeof f&&"undefined"!=typeof e?e.exports=b():"function"==typeof define&&define.amd?define(b):a.JSBI=b()})(this,function(){"use strict";function a(b){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},f(a)}function g(a,b){return g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},g(a,b)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function i(){return i=h()?Reflect.construct:function(a,b,c){var d=[null];d.push.apply(d,b);b=Function.bind.apply(a,d);a=new b;return c&&g(a,c.prototype),a},i.apply(null,arguments)}function j(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function k(a){var b="function"==typeof Map?new Map:void 0;return k=function(a){function c(){return i(a,arguments,f(this).constructor)}if(null===a||!j(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),g(c,a)},k(a)}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:l(a)}var n=function(c){var h=Math.abs,i=Math.max,j=Math.imul,k=Math.clz32;function g(a,c){if(b(this,g),a>g.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return a=m(this,f(g).call(this,a)),a.sign=c,a}return e(g,c),d(g,[{key:"toDebugString",value:function(){var a=["BigInt["],b=!0,c=!1,d=void 0;try{for(var e,e,f=this[Symbol.iterator]();!(b=(e=f.next()).done);b=!0)e=e.value,a.push((e?(e>>>0).toString(16):e)+", ")}catch(a){c=!0,d=a}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return a.push("]"),a.join("")}},{key:"toString",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>a||36<a)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(a&a-1)?g.__toStringBasePowerOfTwo(this,a):g.__toStringGeneric(this,a,!1)}},{key:"__copy",value:function(){for(var a=new g(this.length,this.sign),b=0;b<this.length;b++)a[b]=this[b];return a}},{key:"__trim",value:function(){for(var a=this.length,b=this[a-1];0===b;)a--,b=this[a-1],this.pop();return 0===a&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var a=0;a<this.length;a++)this[a]=0}},{key:"__clzmsd",value:function(){return k(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(a,b,c){c>this.length&&(c=this.length);for(var d=65535&a,a=a>>>16,e=0,f=65535&b,b=b>>>16,i=0;i<c;i++){var n=this.__digit(i),m=65535&n;n=n>>>16;var o=j(m,d);m=j(m,a);var p=j(n,d);n=j(n,a);var q=f+(65535&o);o=b+e+(q>>>16)+(o>>>16)+(65535&m)+(65535&p);f=(m>>>16)+(p>>>16)+(65535&n)+(o>>>16),e=f>>>16,f&=65535,b=n>>>16;this.__setDigit(i,65535&q|o<<16)}if(0!==e||0!==f||0!==b)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(a,b,c){for(var d,e=0,f=0;f<c;f++)d=this.__halfDigit(b+f)+a.__halfDigit(f)+e,e=d>>>16,this.__setHalfDigit(b+f,d);return e}},{key:"__inplaceSub",value:function(a,b,c){var d=0;if(1&b){b>>=1;for(var e=this.__digit(b),f=65535&e,k=0;k<c-1>>>1;k++){var l=a.__digit(k),m=(e>>>16)-(65535&l)-d;d=1&m>>>16,this.__setDigit(b+k,m<<16|65535&f),e=this.__digit(b+k+1),f=(65535&e)-(l>>>16)-d,d=1&f>>>16}m=a.__digit(k);l=(e>>>16)-(65535&m)-d;d=1&l>>>16,this.__setDigit(b+k,l<<16|65535&f);if(b+k+1>=this.length)throw new RangeError("out of bounds");0==(1&c)&&(e=this.__digit(b+k+1),f=(65535&e)-(m>>>16)-d,d=1&f>>>16,this.__setDigit(b+a.length,4294901760&e|65535&f))}else{b>>=1;for(l=0;l<a.length-1;l++){k=this.__digit(b+l);m=a.__digit(l);e=(65535&k)-(65535&m)-d;d=1&e>>>16;f=(k>>>16)-(m>>>16)-d;d=1&f>>>16,this.__setDigit(b+l,f<<16|65535&e)}k=this.__digit(b+l);m=a.__digit(l);f=(65535&k)-(65535&m)-d;d=1&f>>>16;e=0;0==(1&c)&&(e=(k>>>16)-(m>>>16)-d,d=1&e>>>16),this.__setDigit(b+l,e<<16|65535&f)}return d}},{key:"__inplaceRightShift",value:function(a){if(0!==a){for(var b,c=this.__digit(0)>>>a,d=this.length-1,e=0;e<d;e++)b=this.__digit(e+1),this.__setDigit(e,b<<32-a|c),c=b>>>a;this.__setDigit(d,c)}}},{key:"__digit",value:function(a){return this[a]}},{key:"__unsignedDigit",value:function(a){return this[a]>>>0}},{key:"__setDigit",value:function(a,b){this[a]=0|b}},{key:"__setDigitGrow",value:function(a,b){this[a]=0|b}},{key:"__halfDigitLength",value:function(){var a=this.length;return 65535>=this.__unsignedDigit(a-1)?2*a-1:2*a}},{key:"__halfDigit",value:function(a){return 65535&this[a>>>1]>>>((1&a)<<4)}},{key:"__setHalfDigit",value:function(a,b){var c=a>>>1,d=this.__digit(c);a=1&a?65535&d|b<<16:4294901760&d|65535&b;this.__setDigit(c,a)}}],[{key:"BigInt",value:function(b){var c=Math.floor,d=Number.isFinite;if("number"==typeof b){if(0===b)return g.__zero();if((0|b)===b)return 0>b?g.__oneDigit(-b,!0):g.__oneDigit(b,!1);if(!d(b)||c(b)!==b)throw new RangeError("The number "+b+" cannot be converted to BigInt because it is not an integer");return g.__fromDouble(b)}if("string"==typeof b){d=g.__fromString(b);if(null===d)throw new SyntaxError("Cannot convert "+b+" to a BigInt");return d}if("boolean"==typeof b)return!0===b?g.__oneDigit(1,!1):g.__zero();if("object"===a(b)){if(b.constructor===g)return b;c=g.__toPrimitive(b);return g.BigInt(c)}throw new TypeError("Cannot convert "+b+" to a BigInt")}},{key:"toNumber",value:function(a){var b=a.length;if(0===b)return 0;if(1===b){var c=a.__unsignedDigit(0);return a.sign?-c:c}c=a.__digit(b-1);var d=k(c),e=32*b-d;if(1024<e)return a.sign?-Infinity:1/0;e=e-1;c=c;b=b-1;d=d+1;var f=32===d?0:c<<d;f>>>=12;var h=d-12,i=12<=d?0:c<<20+d;d=20+d;0<h&&0<b&&(b--,c=a.__digit(b),f|=c>>>32-h,i=c<<h,d=h),0<d&&0<b&&(b--,c=a.__digit(b),i|=c>>>32-d,d-=32);h=g.__decideRounding(a,d,b,c);if((1===h||0===h&&1==(1&i))&&(i=i+1>>>0,0===i&&(f++,0!=f>>>20&&(f=0,e++,1023<e))))return a.sign?-Infinity:1/0;d=a.sign?-2147483648:0;return e=e+1023<<20,g.__kBitConversionInts[1]=d|e|f,g.__kBitConversionInts[0]=i,g.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(a){if(0===a.length)return a;var b=a.__copy();return b.sign=!a.sign,b}},{key:"bitwiseNot",value:function(a){return a.sign?g.__absoluteSubOne(a).__trim():g.__absoluteAddOne(a,!0)}},{key:"exponentiate",value:function(a,b){if(b.sign)throw new RangeError("Exponent must be positive");if(0===b.length)return g.__oneDigit(1,!1);if(0===a.length)return a;if(1===a.length&&1===a.__digit(0))return a.sign&&0==(1&b.__digit(0))?g.unaryMinus(a):a;if(1<b.length)throw new RangeError("BigInt too big");b=b.__unsignedDigit(0);if(1===b)return a;if(b>=g.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===a.length&&2===a.__digit(0)){var c=1+(b>>>5),d=a.sign&&0!=(1&b);d=new g(c,d);d.__initializeDigits();var e=1<<(31&b);return d.__setDigit(c-1,e),d}c=null;e=a;for(0!=(1&b)&&(c=a),b>>=1;0!==b;b>>=1)e=g.multiply(e,e),0!=(1&b)&&(null===c?c=e:c=g.multiply(c,e));return c}},{key:"multiply",value:function(a,b){if(0===a.length)return a;if(0===b.length)return b;var c=a.length+b.length;32<=a.__clzmsd()+b.__clzmsd()&&c--;c=new g(c,a.sign!==b.sign);c.__initializeDigits();for(var d=0;d<a.length;d++)g.__multiplyAccumulate(b,a.__digit(d),c,d);return c.__trim()}},{key:"divide",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return g.__zero();var c=a.sign!==b.sign,d=b.__unsignedDigit(0);if(1===b.length&&65535>=d){if(1===d)return c===a.sign?a:g.unaryMinus(a);d=g.__absoluteDivSmall(a,d,null)}else d=g.__absoluteDivLarge(a,b,!0,!1);return d.sign=c,d.__trim()}},{key:"remainder",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return a;var c=b.__unsignedDigit(0);if(1===b.length&&65535>=c){if(1===c)return g.__zero();c=g.__absoluteModSmall(a,c);return 0===c?g.__zero():g.__oneDigit(c,a.sign)}c=g.__absoluteDivLarge(a,b,!1,!0);return c.sign=a.sign,c.__trim()}},{key:"add",value:function(a,b){var c=a.sign;return c===b.sign?g.__absoluteAdd(a,b,c):0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c)}},{key:"subtract",value:function(a,b){var c=a.sign;return c===b.sign?0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c):g.__absoluteAdd(a,b,c)}},{key:"leftShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__rightShiftByAbsolute(a,b):g.__leftShiftByAbsolute(a,b)}},{key:"signedRightShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__leftShiftByAbsolute(a,b):g.__rightShiftByAbsolute(a,b)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(a,b){return 0>g.__compareToBigInt(a,b)}},{key:"lessThanOrEqual",value:function(a,b){return 0>=g.__compareToBigInt(a,b)}},{key:"greaterThan",value:function(a,b){return 0<g.__compareToBigInt(a,b)}},{key:"greaterThanOrEqual",value:function(a,b){return 0<=g.__compareToBigInt(a,b)}},{key:"equal",value:function(a,b){if(a.sign!==b.sign)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a.__digit(c)!==b.__digit(c))return!1;return!0}},{key:"notEqual",value:function(a,b){return!g.equal(a,b)}},{key:"bitwiseAnd",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteAnd(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length)+1;c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return c=g.__absoluteOr(c,d,c),g.__absoluteAddOne(c,!0,c).__trim()}if(a.sign){d=[b,a];a=d[0],b=d[1]}return g.__absoluteAndNot(a,g.__absoluteSubOne(b)).__trim()}},{key:"bitwiseXor",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteXor(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length);c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return g.__absoluteXor(c,d,c).__trim()}d=i(a.length,b.length)+1;if(a.sign){c=[b,a];a=c[0],b=c[1]}c=g.__absoluteSubOne(b,d);return c=g.__absoluteXor(c,a,c),g.__absoluteAddOne(c,!0,c).__trim()}},{key:"bitwiseOr",value:function(a,b){var c=i(a.length,b.length);if(!a.sign&&!b.sign)return g.__absoluteOr(a,b).__trim();if(a.sign&&b.sign){var d=g.__absoluteSubOne(a,c),e=g.__absoluteSubOne(b);return d=g.__absoluteAnd(d,e,d),g.__absoluteAddOne(d,!0,d).__trim()}if(a.sign){e=[b,a];a=e[0],b=e[1]}d=g.__absoluteSubOne(b,c);return d=g.__absoluteAndNot(d,a,d),g.__absoluteAddOne(d,!0,d).__trim()}},{key:"asIntN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=b.__unsignedDigit(c-1),e=1<<(31&a-1);if(b.length===c&&d<e)return b;if(!((d&e)===e))return g.__truncateToNBits(a,b);if(!b.sign)return g.__truncateAndSubFromPowerOfTwo(a,b,!0);if(0==(d&e-1)){for(var f=c-2;0<=f;f--)if(0!==b.__digit(f))return g.__truncateAndSubFromPowerOfTwo(a,b,!1);return b.length===c&&d===e?b:g.__truncateToNBits(a,b)}return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}},{key:"asUintN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(b.sign){if(a>g.__kMaxLengthBits)throw new RangeError("BigInt too big");return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=31&a;if(b.length==c){if(0==d)return b;c=b.__digit(c-1);if(0==c>>>d)return b}return g.__truncateToNBits(a,b)}},{key:"ADD",value:function(a,b){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a)return"string"!=typeof b&&(b=b.toString()),a+b;if("string"==typeof b)return a.toString()+b;if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)&&g.__isBigInt(b))return g.add(a,b);if("number"==typeof a&&"number"==typeof b)return a+b;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(a,b){return g.__compare(a,b,0)}},{key:"LE",value:function(a,b){return g.__compare(a,b,1)}},{key:"GT",value:function(a,b){return g.__compare(a,b,2)}},{key:"GE",value:function(a,b){return g.__compare(a,b,3)}},{key:"EQ",value:function(b,c){for(;;){if(g.__isBigInt(b))return g.__isBigInt(c)?g.equal(b,c):g.EQ(c,b);if("number"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("string"==typeof b){if(g.__isBigInt(c))return b=g.__fromString(b),null!==b&&g.equal(b,c);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("boolean"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,+b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("symbol"===a(b)){if(g.__isBigInt(c))return!1;if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("object"===a(b)){if("object"===a(c)&&c.constructor!==g)return b==c;b=g.__toPrimitive(b)}else return b==c}}},{key:"NE",value:function(a,b){return!g.EQ(a,b)}},{key:"__zero",value:function(){return new g(0,!1)}},{key:"__oneDigit",value:function(a,b){b=new g(1,b);return b.__setDigit(0,a),b}},{key:"__decideRounding",value:function(a,b,c,d){if(0<b)return-1;if(0>b)b=-b-1;else{if(0===c)return-1;c--,d=a.__digit(c),b=31}b=1<<b;if(0==(d&b))return-1;if(b-=1,0!=(d&b))return 1;for(;0<c;)if(c--,0!==a.__digit(c))return 1;return 0}},{key:"__fromDouble",value:function(a){g.__kBitConversionDouble[0]=a;var b,c=2047&g.__kBitConversionInts[1]>>>20;c=c-1023;var d=(c>>>5)+1;a=new g(d,0>a);var e=1048575&g.__kBitConversionInts[1]|1048576,f=g.__kBitConversionInts[0],k=20;c=31&c;var n=0;if(c<k){var m=k-c;n=m+32,b=e>>>m,e=e<<32-m|f>>>m,f<<=32-m}else if(c===k)n=32,b=e,e=f;else{m=c-k;n=32-m,b=e<<m|f>>>32-m,e=f<<m}a.__setDigit(d-1,b);for(c=d-2;0<=c;c--)0<n?(n-=32,b=e,e=f):b=0,a.__setDigit(c,b);return a.__trim()}},{key:"__isWhitespace",value:function(a){return!!(13>=a&&9<=a)||(159>=a?32==a:131071>=a?160==a||5760==a:196607>=a?(a&=131071,10>=a||40==a||41==a||47==a||95==a||4096==a):65279==a)}},{key:"__fromString",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=0,d=a.length,e=0;if(e===d)return g.__zero();for(var f=a.charCodeAt(e);g.__isWhitespace(f);){if(++e===d)return g.__zero();f=a.charCodeAt(e)}if(43===f){if(++e===d)return null;f=a.charCodeAt(e),c=1}else if(45===f){if(++e===d)return null;f=a.charCodeAt(e),c=-1}if(0===b){if(b=10,48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(b=16,++e===d)return null;f=a.charCodeAt(e)}else if(79===f||111===f){if(b=8,++e===d)return null;f=a.charCodeAt(e)}else if(66===f||98===f){if(b=2,++e===d)return null;f=a.charCodeAt(e)}}}else if(16===b&&48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(++e===d)return null;f=a.charCodeAt(e)}}for(;48===f;){if(++e===d)return g.__zero();f=a.charCodeAt(e)}var m=d-e,i=g.__kMaxBitsPerChar[b],j=g.__kBitsPerCharTableMultiplier-1;if(m>1073741824/i)return null;var k=i*m+j>>>g.__kBitsPerCharTableShift,l=new g(k+31>>>5,!1),n=10>b?b:10,o=10<b?b-10:0;if(0==(b&b-1)){i>>=g.__kBitsPerCharTableShift;var p=[],q=[],r=!1;do{for(var s,t=0,u=0;;){if(void 0,f-48>>>0<n)s=f-48;else if((32|f)-97>>>0<o)s=(32|f)-87;else{r=!0;break}if(u+=i,t=t<<i|s,++e===d){r=!0;break}if(f=a.charCodeAt(e),32<u+i)break}p.push(t),q.push(u)}while(!r);g.__fillFromParts(l,p,q)}else{l.__initializeDigits();var v=!1,w=0;do{for(var x,y=0,z=1;;){if(void 0,f-48>>>0<n)x=f-48;else if((32|f)-97>>>0<o)x=(32|f)-87;else{v=!0;break}var A=z*b;if(4294967295<A)break;if(z=A,y=y*b+x,w++,++e===d){v=!0;break}f=a.charCodeAt(e)}j=32*g.__kBitsPerCharTableMultiplier-1;var B=i*w+j>>>g.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(z,y,B)}while(!v)}if(e!==d){if(!g.__isWhitespace(f))return null;for(e++;e<d;e++)if(f=a.charCodeAt(e),!g.__isWhitespace(f))return null}return 0!==c&&10!==b?null:(l.sign=-1===c,l.__trim())}},{key:"__fillFromParts",value:function(a,b,c){for(var d=0,e=0,f=0,k=b.length-1;0<=k;k--){var l=b[k],m=c[k];e|=l<<f,f+=m,32===f?(a.__setDigit(d++,e),f=0,e=0):32<f&&(a.__setDigit(d++,e),f-=32,e=l>>>m-f)}if(0!==e){if(d>=a.length)throw new Error("implementation bug");a.__setDigit(d++,e)}for(;d<a.length;d++)a.__setDigit(d,0)}},{key:"__toStringBasePowerOfTwo",value:function(a,b){var c=a.length,d=b-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);d=d;b=b-1;var e=a.__digit(c-1),f=k(e);f=0|(32*c-f+d-1)/d;if(a.sign&&f++,268435456<f)throw new Error("string too long");for(var h=Array(f),f=f-1,l=0,n=0,o=0;o<c-1;o++){var p=a.__digit(o),q=(l|p<<n)&b;h[f--]=g.__kConversionChars[q];q=d-n;for(l=p>>>q,n=32-q;n>=d;)h[f--]=g.__kConversionChars[l&b],l>>>=d,n-=d}p=(l|e<<n)&b;for(h[f--]=g.__kConversionChars[p],l=e>>>d-n;0!==l;)h[f--]=g.__kConversionChars[l&b],l>>>=d;if(a.sign&&(h[f--]="-"),-1!==f)throw new Error("implementation bug");return h.join("")}},{key:"__toStringGeneric",value:function(a,b,c){var d=a.length;if(0===d)return"";if(1===d){var e=a.__unsignedDigit(0).toString(b);return!1===c&&a.sign&&(e="-"+e),e}e=32*d-k(a.__digit(d-1));d=g.__kMaxBitsPerChar[b];d=d-1;e=e*g.__kBitsPerCharTableMultiplier;e+=d-1,e=0|e/d;var f;d=e+1>>1;e=g.exponentiate(g.__oneDigit(b,!1),g.__oneDigit(d,!1));var h=e.__unsignedDigit(0);if(1===e.length&&65535>=h){f=new g(a.length,!1),f.__initializeDigits();for(var i,j=0,l=2*a.length-1;0<=l;l--)i=j<<16|a.__halfDigit(l),f.__setHalfDigit(l,0|i/h),j=0|i%h;i=j.toString(b)}else{h=g.__absoluteDivLarge(a,e,!0,!0);f=h.quotient;l=h.remainder.__trim();i=g.__toStringGeneric(l,b,!0)}f.__trim();for(j=g.__toStringGeneric(f,b,!0);i.length<d;)i="0"+i;return!1===c&&a.sign&&(j="-"+j),j+i}},{key:"__unequalSign",value:function(a){return a?-1:1}},{key:"__absoluteGreater",value:function(a){return a?-1:1}},{key:"__absoluteLess",value:function(a){return a?1:-1}},{key:"__compareToBigInt",value:function(a,b){var c=a.sign;if(c!==b.sign)return g.__unequalSign(c);a=g.__absoluteCompare(a,b);return 0<a?g.__absoluteGreater(c):0>a?g.__absoluteLess(c):0}},{key:"__compareToNumber",value:function(a,b){if(!0|b){var c=a.sign,d=0>b;if(c!==d)return g.__unequalSign(c);if(0===a.length){if(d)throw new Error("implementation bug");return 0===b?0:-1}if(1<a.length)return g.__absoluteGreater(c);d=h(b);var e=a.__unsignedDigit(0);return e>d?g.__absoluteGreater(c):e<d?g.__absoluteLess(c):0}return g.__compareToDouble(a,b)}},{key:"__compareToDouble",value:function(a,b){if(b!==b)return b;if(b===1/0)return-1;if(b===-Infinity)return 1;var c=a.sign;if(c!==0>b)return g.__unequalSign(c);if(0===b)throw new Error("implementation bug: should be handled elsewhere");if(0===a.length)return-1;g.__kBitConversionDouble[0]=b;b=2047&g.__kBitConversionInts[1]>>>20;if(2047==b)throw new Error("implementation bug: handled elsewhere");b=b-1023;if(0>b)return g.__absoluteGreater(c);var d=a.length,e=a.__digit(d-1),f=k(e),l=32*d-f;b=b+1;if(l<b)return g.__absoluteLess(c);if(l>b)return g.__absoluteGreater(c);b=1048576|1048575&g.__kBitConversionInts[1];var m=g.__kBitConversionInts[0],o=20;f=31-f;if(f!==(l-1)%31)throw new Error("implementation bug");var p;l=0;if(f<o){var q=o-f;l=q+32,p=b>>>q,b=b<<32-q|m>>>q,m<<=32-q}else if(f===o)l=32,p=b,b=m;else{q=f-o;l=32-q,p=b<<q|m>>>32-q,b=m<<q}if(e>>>=0,p>>>=0,e>p)return g.__absoluteGreater(c);if(e<p)return g.__absoluteLess(c);for(f=d-2;0<=f;f--){0<l?(l-=32,p=b>>>0,b=m,m=0):p=0;o=a.__unsignedDigit(f);if(o>p)return g.__absoluteGreater(c);if(o<p)return g.__absoluteLess(c)}if(0!==b||0!==m){if(0===l)throw new Error("implementation bug");return g.__absoluteLess(c)}return 0}},{key:"__equalToNumber",value:function(a,b){return b|0===b?0===b?0===a.length:1===a.length&&a.sign===0>b&&a.__unsignedDigit(0)===h(b):0===g.__compareToDouble(a,b)}},{key:"__comparisonResultToBool",value:function(a,b){switch(b){case 0:return 0>a;case 1:return 0>=a;case 2:return 0<a;case 3:return 0<=a}throw new Error("unreachable")}},{key:"__compare",value:function(a,b,c){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a&&"string"==typeof b)switch(c){case 0:return a<b;case 1:return a<=b;case 2:return a>b;case 3:return a>=b}if(g.__isBigInt(a)&&"string"==typeof b)return b=g.__fromString(b),null!==b&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("string"==typeof a&&g.__isBigInt(b))return a=g.__fromString(a),null!==a&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)){if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("number"!=typeof b)throw new Error("implementation bug");return g.__comparisonResultToBool(g.__compareToNumber(a,b),c)}if("number"!=typeof a)throw new Error("implementation bug");if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToNumber(b,a),2^c);if("number"!=typeof b)throw new Error("implementation bug");return 0===c?a<b:1===c?a<=b:2===c?a>b:3===c?a>=b:void 0}},{key:"__absoluteAdd",value:function(a,b,c){if(a.length<b.length)return g.__absoluteAdd(b,a,c);if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);var d=a.length;(0===a.__clzmsd()||b.length===a.length&&0===b.__clzmsd())&&d++;for(var d=new g(d,c),c=0,e=0;e<b.length;e++){var f=b.__digit(e),h=a.__digit(e),m=(65535&h)+(65535&f)+c;h=(h>>>16)+(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}for(;e<a.length;e++){f=a.__digit(e);m=(65535&f)+c;h=(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}return e<d.length&&d.__setDigit(e,c),d.__trim()}},{key:"__absoluteSub",value:function(a,b,c){if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);for(var c=new g(a.length,c),d=0,e=0;e<b.length;e++){var f=a.__digit(e),l=b.__digit(e),m=(65535&f)-(65535&l)-d;d=1&m>>>16;f=(f>>>16)-(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}for(;e<a.length;e++){l=a.__digit(e);m=(65535&l)-d;d=1&m>>>16;f=(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}return c.__trim()}},{key:"__absoluteAddOne",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length;null===c?c=new g(d,b):c.sign=b;for(var e=!0,f=0;f<d;f++){var k=a.__digit(f),l=-1===k;e&&(k=0|k+1),e=l,c.__setDigit(f,k)}return e&&c.__setDigitGrow(d,1),c}},{key:"__absoluteSubOne",value:function(a,b){var c=a.length;b=b||c;for(var d=new g(b,!1),e=!0,f=0;f<c;f++){var k=a.__digit(f),l=0===k;e&&(k=0|k-1),e=l,d.__setDigit(f,k)}for(l=c;l<b;l++)d.__setDigit(l,0);return d}},{key:"__absoluteAnd",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,e,b=m,n}var k=f;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&b.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteAndNot",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;d<e&&(f=d);var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&~b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteOr",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)|b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteXor",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)^b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteCompare",value:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(c=a.length-1;0<=c&&a.__digit(c)===b.__digit(c);)c--;return 0>c?0:a.__unsignedDigit(c)>b.__unsignedDigit(c)?1:-1}},{key:"__multiplyAccumulate",value:function(a,b,c,d){if(0!==b){for(var e=65535&b,b=b>>>16,f=0,g=0,k=0,l=0;l<a.length;l++,d++){var m=c.__digit(d),n=65535&m,o=m>>>16,p=a.__digit(l),q=65535&p;p=p>>>16;var r=j(q,e);q=j(q,b);var s=j(p,e);p=j(p,b);n+=g+(65535&r),o+=k+f+(n>>>16)+(r>>>16)+(65535&q)+(65535&s),f=o>>>16,g=(q>>>16)+(s>>>16)+(65535&p)+f,f=g>>>16,g&=65535,k=p>>>16,m=65535&n|o<<16,c.__setDigit(d,m)}for(;0!==f||0!==g||0!==k;d++){r=c.__digit(d);q=(65535&r)+g;s=(r>>>16)+(q>>>16)+k+f;g=0,k=0,f=s>>>16,r=65535&q|s<<16,c.__setDigit(d,r)}}}},{key:"__internalMultiplyAdd",value:function(a,b,c,d,e){for(var c=c,f=0,h=0;h<d;h++){var l=a.__digit(h),m=j(65535&l,b),n=(65535&m)+f+c;c=n>>>16;l=j(l>>>16,b);m=(65535&l)+(m>>>16)+c;c=m>>>16,f=l>>>16,e.__setDigit(h,m<<16|65535&n)}if(e.length>d)for(e.__setDigit(d++,c+f);d<e.length;)e.__setDigit(d++,0);else if(0!==c+f)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(a,b,c){null===c&&(c=new g(a.length,!1));for(var d=0,e=2*a.length-1;0<=e;e-=2){var f=(d<<16|a.__halfDigit(e))>>>0,k=0|f/b;d=0|f%b,f=(d<<16|a.__halfDigit(e-1))>>>0;var l=0|f/b;d=0|f%b,c.__setDigit(e>>>1,k<<16|l)}return c}},{key:"__absoluteModSmall",value:function(a,b){for(var c,d=0,e=2*a.length-1;0<=e;e--)c=(d<<16|a.__halfDigit(e))>>>0,d=0|c%b;return d}},{key:"__absoluteDivLarge",value:function(a,b,c,d){var f=b.__halfDigitLength(),e=b.length,n=a.__halfDigitLength()-f,i=null;c&&(i=new g(n+2>>>1,!1),i.__initializeDigits());var l=new g(f+2>>>1,!1);l.__initializeDigits();var m=g.__clz16(b.__halfDigit(f-1));0<m&&(b=g.__specialLeftShift(b,m,0));for(var a=g.__specialLeftShift(a,m,1),k=b.__halfDigit(f-1),o=0,n=n;0<=n;n--){var p=65535,q=a.__halfDigit(n+f);if(q!==k){q=(q<<16|a.__halfDigit(n+f-1))>>>0;p=0|q/k;for(var q=0|q%k,r=b.__halfDigit(f-2),s=a.__halfDigit(n+f-2);j(p,r)>>>0>(q<<16|s)>>>0&&(p--,q+=k,!(65535<q)););}g.__internalMultiplyAdd(b,p,0,e,l);r=a.__inplaceSub(l,n,f+1);0!==r&&(r=a.__inplaceAdd(b,n,f),a.__setHalfDigit(n+f,a.__halfDigit(n+f)+r),p--),c&&(1&n?o=p<<16:i.__setDigit(n>>>1,o|p))}return d?(a.__inplaceRightShift(m),c?{quotient:i,remainder:a}:a):c?i:void 0}},{key:"__clz16",value:function(a){return k(a)-16}},{key:"__specialLeftShift",value:function(a,b,c){var e=a.length,d=new g(e+c,!1);if(0===b){for(var f=0;f<e;f++)d.__setDigit(f,a.__digit(f));return 0<c&&d.__setDigit(e,0),d}for(var j,f=0,l=0;l<e;l++)j=a.__digit(l),d.__setDigit(l,j<<b|f),f=j>>>32-b;return 0<c&&d.__setDigit(e,f),d}},{key:"__leftShiftByAbsolute",value:function(a,b){b=g.__toShiftAmount(b);if(0>b)throw new RangeError("BigInt too big");var c=b>>>5;b=31&b;var d=a.length,e=0!==b&&0!=a.__digit(d-1)>>>32-b,f=d+c+(e?1:0),m=new g(f,a.sign);if(0===b){for(var n=0;n<c;n++)m.__setDigit(n,0);for(;n<f;n++)m.__setDigit(n,a.__digit(n-c))}else{for(n=0,f=0;f<c;f++)m.__setDigit(f,0);for(var o,f=0;f<d;f++)o=a.__digit(f),m.__setDigit(f+c,o<<b|n),n=o>>>32-b;if(e)m.__setDigit(d+c,n);else if(0!==n)throw new Error("implementation bug")}return m.__trim()}},{key:"__rightShiftByAbsolute",value:function(a,b){var c=a.length,d=a.sign;b=g.__toShiftAmount(b);if(0>b)return g.__rightShiftByMaximum(d);var e=b>>>5;b=31&b;var f=c-e;if(0>=f)return g.__rightShiftByMaximum(d);var i=!1;if(d)if(0!=(a.__digit(e)&(1<<b)-1))i=!0;else for(var m=0;m<e;m++)if(0!==a.__digit(m)){i=!0;break}if(i&&0===b){m=a.__digit(c-1);0==~m&&f++}m=new g(f,d);if(0===b)for(f=e;f<c;f++)m.__setDigit(f-e,a.__digit(f));else{for(var n,d=a.__digit(e)>>>b,f=c-e-1,c=0;c<f;c++)n=a.__digit(c+e+1),m.__setDigit(c,n<<32-b|d),d=n>>>b;m.__setDigit(f,d)}return i&&(m=g.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(a){return a?g.__oneDigit(1,!0):g.__zero()}},{key:"__toShiftAmount",value:function(a){if(1<a.length)return-1;a=a.__unsignedDigit(0);return a>g.__kMaxLengthBits?-1:a}},{key:"__toPrimitive",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==a(b))return b;if(b.constructor===g)return b;var d=b[Symbol.toPrimitive];if(d){var e=d(c);if("object"!==a(e))return e;throw new TypeError("Cannot convert object to primitive value")}var f=b.valueOf;if(f){var k=f.call(b);if("object"!==a(k))return k}var l=b.toString;if(l){var m=l.call(b);if("object"!==a(m))return m}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(a){return g.__isBigInt(a)?a:+a}},{key:"__isBigInt",value:function(b){return"object"===a(b)&&b.constructor===g}},{key:"__truncateToNBits",value:function(a,b){for(var c=a+31>>>5,d=new g(c,b.sign),c=c-1,e=0;e<c;e++)d.__setDigit(e,b.__digit(e));e=b.__digit(c);if(0!=(31&a)){b=32-(31&a);e=e<<b>>>b}return d.__setDigit(c,e),d.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(a,b,c){for(var d=Math.min,e=a+31>>>5,c=new g(e,c),f=0,e=e-1,h=0,d=d(e,b.length);f<d;f++){var j=b.__digit(f),l=0-(65535&j)-h;h=1&l>>>16;j=0-(j>>>16)-h;h=1&j>>>16,c.__setDigit(f,65535&l|j<<16)}for(;f<e;f++)c.__setDigit(f,0|-h);l=e<b.length?b.__digit(e):0;j=31&a;if(0===j){d=0-(65535&l)-h;h=1&d>>>16;f=0-(l>>>16)-h;b=65535&d|f<<16}else{a=32-j;l=l<<a>>>a;d=1<<32-a;f=(65535&d)-(65535&l)-h;h=1&f>>>16;j=(d>>>16)-(l>>>16)-h;b=65535&f|j<<16,b&=d-1}return c.__setDigit(e,b),c.__trim()}},{key:"__digitPow",value:function(a,b){for(var c=1;0<b;)1&b&&(c*=a),b>>>=1,a*=a;return c}}]),g}(k(Array));return n.__kMaxLength=33554432,n.__kMaxLengthBits=n.__kMaxLength<<5,n.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],n.__kBitsPerCharTableShift=5,n.__kBitsPerCharTableMultiplier=1<<n.__kBitsPerCharTableShift,n.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n.__kBitConversionBuffer=new ArrayBuffer(8),n.__kBitConversionDouble=new Float64Array(n.__kBitConversionBuffer),n.__kBitConversionInts=new Int32Array(n.__kBitConversionBuffer),n})}),null);
__d("TCompactProtocolPolyfill",["StringToUtf8","ThriftTypes","Utf8ToString","jsbi"],(function(a,b,c,d,e,f,g){var h,i=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),j=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:i.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:i.CT_BOOLEAN_FALSE}),k=[i.CT_STOP,0,i.CT_BOOLEAN_TRUE,i.CT_BYTE,i.CT_DOUBLE,0,i.CT_I16,0,i.CT_I32,0,i.CT_I64,i.CT_BINARY,i.CT_STRUCT,i.CT_MAP,i.CT_SET,i.CT_LIST,0,0,0,i.CT_FLOAT],l=Math.pow(2,7)-1,m=-1*Math.pow(2,7),n=Math.pow(2,15)-1,o=-1*Math.pow(2,15),p=Math.pow(2,31)-1,q=-1*Math.pow(2,31),r=Math.pow(2,32)-1,s=(a=c("jsbi")).BigInt("9223372036854775807"),t=a.BigInt("-9223372036854775808"),u=a.BigInt("18446744073709551615"),v=a.BigInt(63),w=a.BigInt(1),x=a.BigInt(0),y=a.BigInt(7),z=a.BigInt(70),A=a.BigInt(127),B=a.BigInt(128),C=Math.pow(2,4);b=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var b=a.prototype;b.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};b.readStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};b.writeStructEnd=function(){this.$3=this.$2.pop();return 0};b.writeFieldBegin=function(a){if(a.ftype===(h||(h=c("ThriftTypes"))).BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,j.NONE)};b.writeListBegin=function(a){return this.$8(a)};b.writeListEnd=function(){return 0};b.writeSetBegin=function(a){return this.$8(a)};b.writeSetEnd=function(){return 0};b.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};b.writeMapEnd=function(){return 0};b.$7=function(a,b){var c=0;b=b===j.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=C-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};b.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=C-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};b.readFieldBegin=function(){var a=this.$1.readByte(),b=a&15;if(b===(h||(h=c("ThriftTypes"))).STOP)return{ftype:(h||(h=c("ThriftTypes"))).STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(b);(b===i.CT_BOOLEAN_TRUE||b===i.CT_BOOLEAN_FALSE)&&(this.$5=b===i.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};b.readListBegin=function(){return this.$11()};b.readListEnd=function(){return 0};b.readSetBegin=function(){return this.$11()};b.readSetEnd=function(){return 0};b.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};b.readMapEnd=function(){return 0};b.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};b.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};b.readFieldEnd=function(){return 0};b.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};b.writeByte=function(a){if(a<m||a>l)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};b.readFloat=function(){return this.$1.readFloatBE()};b.writeFloat=function(a){return this.$1.writeFloatBE(a)};b.readDouble=function(){return this.$1.readDoubleBE()};b.writeDouble=function(a){return this.$1.writeDoubleBE(a)};b.writeString=function(a){return this.writeBinary(d("StringToUtf8").StringToUtf8(a))};b.skip=function(a){switch(a){case(h||(h=c("ThriftTypes"))).STOP:return;case(h||(h=c("ThriftTypes"))).BOOL:this.readBool();break;case(h||(h=c("ThriftTypes"))).BYTE:this.readByte();break;case(h||(h=c("ThriftTypes"))).DOUBLE:this.readDouble();break;case(h||(h=c("ThriftTypes"))).I16:this.readI16();break;case(h||(h=c("ThriftTypes"))).I32:this.readI32();break;case(h||(h=c("ThriftTypes"))).I64:this.readI64();break;case(h||(h=c("ThriftTypes"))).STRING:this.readString();break;case(h||(h=c("ThriftTypes"))).STRUCT:this.readStructBegin();var b;while(!0){b=this.readFieldBegin();if(b.ftype===(h||(h=c("ThriftTypes"))).STOP)break;this.skip(b.ftype)}this.readStructEnd();break;case(h||(h=c("ThriftTypes"))).MAP:b=this.readMapBegin();if(b.size>0&&b.ktype!=null&&b.vtype!=null){var d=b.ktype,e=b.vtype;for(var f=0;f<b.size;f++)this.skip(d),this.skip(e)}break;case(h||(h=c("ThriftTypes"))).SET:case(h||(h=c("ThriftTypes"))).LIST:f=this.$11();for(d=0;d<f.size;d++)this.skip(f.etype);break;case(h||(h=c("ThriftTypes"))).FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};b.toByteArray=function(){return this.$1.toByteArray()};b.writeFieldEnd=function(){return 0};b.writeFieldStop=function(){return this.$1.writeByte((h||(h=c("ThriftTypes"))).STOP)};b.writeI16=function(a){if(a<o||a>n)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<o||a>n)throw new Error("read invalid i16: "+a);return a};b.writeI32=function(a){if(a<q||a>p)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};b.readI32=function(){return this.zigzagToI32(this.readVarint32())};b.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};b.readI64=function(){return this.zigzagToI64(this.readVarint64())};b.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===i.CT_BOOLEAN_TRUE;return a};b.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?j.CT_BOOLEAN_TRUE:j.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?i.CT_BOOLEAN_TRUE:i.CT_BOOLEAN_FALSE);return b};b.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};b.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};b.i32ToZigzag=function(a){if(a<q||a>p)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};b.zigzagToI32=function(a){if(a<0||a>r)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};b.i64ToZigzag=function(a){if(c("jsbi").greaterThan(a,s)||c("jsbi").lessThan(a,t))throw new Error("i64 out of range: "+a.toString());return c("jsbi").bitwiseXor(c("jsbi").signedRightShift(a,v),c("jsbi").leftShift(a,w))};b.zigzagToI64=function(a){if(c("jsbi").lessThan(a,0)||c("jsbi").greaterThan(a,u))throw new Error("invalid uint64: "+a.toString());return c("jsbi").equal(c("jsbi").bitwiseAnd(a,w),w)?c("jsbi").bitwiseNot(c("jsbi").signedRightShift(a,w)):c("jsbi").signedRightShift(a,w)};b.writeVarint32=function(a){if(a<0||a>r)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};b.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};b.writeVarint64=function(a){if(c("jsbi").lessThan(a,x)||c("jsbi").greaterThan(a,u))throw new Error("invalid uint64: "+a.toString());a=a;var b=0;while(!0)if(c("jsbi").equal(c("jsbi").signedRightShift(a,y),x)){this.$1.writeByte(c("jsbi").toNumber(a));b++;break}else{var d,e=(d=c("jsbi")).toNumber(d.bitwiseOr(d.bitwiseAnd(a,A),B));this.$1.writeByte(e);b++;a=d.signedRightShift(a,y)}return b};b.readVarint64=function(){var a=x,b=x,d;while(!0){var e;d=(e=c("jsbi")).BigInt(this.$1.readByte());a=e.bitwiseOr(a,e.leftShift(e.bitwiseAnd(d,A),b));b=e.add(b,y);if(c("jsbi").equal(c("jsbi").bitwiseAnd(d,B),x)){if(c("jsbi").equal(b,z)&&c("jsbi").notEqual(d,w))throw new Error("result exceeded 64 bit limit");break}if(c("jsbi").greaterThan(b,v))throw new Error("result exceeded 64 bit limit")}return a};b.readString=function(){return d("Utf8ToString").Utf8ToString(this.readBinary())};b.getLastFieldId=function(){return this.$3};b.getLastField=function(){return this.$2};b.getBooleanFieldInfo=function(){return this.$4};b.getBooleanValue=function(){return this.$5};b.$9=function(a){return k[a]};b.$10=function(a){switch(a){case i.CT_STOP:return(h||(h=c("ThriftTypes"))).STOP;case i.CT_BOOLEAN_FALSE:case i.CT_BOOLEAN_TRUE:return(h||(h=c("ThriftTypes"))).BOOL;case i.CT_BYTE:return(h||(h=c("ThriftTypes"))).BYTE;case i.CT_I16:return(h||(h=c("ThriftTypes"))).I16;case i.CT_I32:return(h||(h=c("ThriftTypes"))).I32;case i.CT_I64:return(h||(h=c("ThriftTypes"))).I64;case i.CT_DOUBLE:return(h||(h=c("ThriftTypes"))).DOUBLE;case i.CT_FLOAT:return(h||(h=c("ThriftTypes"))).FLOAT;case i.CT_BINARY:return(h||(h=c("ThriftTypes"))).STRING;case i.CT_LIST:return(h||(h=c("ThriftTypes"))).LIST;case i.CT_SET:return(h||(h=c("ThriftTypes"))).SET;case i.CT_MAP:return(h||(h=c("ThriftTypes"))).MAP;case i.CT_STRUCT:return(h||(h=c("ThriftTypes"))).STRUCT;default:throw new Error("don't know what type")}};return a}();g["default"]=b}),98);
__d("CompactSerializerPolyfill",["TCompactProtocolPolyfill","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){a=new(c("TReadBuffer"))(a);a=new(c("TCompactProtocolPolyfill"))(a);return b(a)}function a(a,b,c){try{return h(a,b)}catch(a){c!=null&&c(a)}return null}function i(a,b,d){d===void 0&&(d=!1);if(d){d=new(c("TNoOpWriteBuffer"))();var e=new(c("TCompactProtocolPolyfill"))(d);b(a,e);e=new(c("TWriteBuffer"))(d.currentSize())}else e=new(c("TWriteBuffer"))();d=new(c("TCompactProtocolPolyfill"))(e);b(a,d);return d.toByteArray()}function b(a,b,c,d){c===void 0&&(c=!1);try{return i(a,b,c)}catch(a){d!=null&&d(a)}return null}g.deserialize=h;g.deserializeNoThrow=a;g.serialize=i;g.serializeNoThrow=b}),98);
__d("ContentAccessAndControlEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({CLICK_BEGIN:"content_access_and_control_click_begin",CLICK_CANCEL:"content_access_and_control_click_cancel",CLICK_CONFIRM:"content_access_and_control_click_confirm",IMPRESSION:"content_access_and_control_impression",ENT_STORY_ACTION:"content_access_and_control_ent_story_action",SERVER_MUTATION_BEGIN:"content_access_and_control_mutation_begin",SERVER_MUTATION_FAILURE:"content_access_and_control_mutation_failure",SERVER_MUTATION_SUCCESS:"content_access_and_control_mutation_success",TRASH_METADATA_NOT_FOUND:"content_access_and_control_trash_metadata_not_found"});f["default"]=a}),66);
__d("ContextualConfigConstants",[],(function(a,b,c,d,e,f){"use strict";a=1e3;b=", ";c={SAME:"same",NULL:"null",NNULL:"nnull",CATCH_ALL:"catch_all",EQ:"eq",NEQ:"neq",LT:"lt",LTE:"lte",GT:"gt",GTE:"gte",COR:"cor",CONTAINS:"contains",REGEX:"regex",IN:"in",NIN:"nin"};d={DENSE:"dense",MULTI_OUTPUT_RESOLVED:"multi-output-resolved",TABLE:"table"};e=[];var g=[],h=[],i={BAD_BOOLEAN_FORMAT:"Bad boolean format",BAD_CONFIG:"Bad config",BAD_CONTEXT_IDENTIFIER:"Bad context identifier",BAD_CONTEXT_VALUE:"Bad context value",BAD_MONITORED_CONTEXTS:"Bad monitored contexts",BAD_NUMBER_FORMAT:"Bad number format",BAD_OUTPUT_NAME:"Bad output name",BAD_OUTPUT_TYPE:"Bad output type",BAD_VALUE_ORDER:"Bad values order",DUPLICATE_OUTPUT_NAME:"Duplicate output name",ILLEGAL_BOOLEAN_STRATEGY:"Illegal boolean strategy",ILLEGAL_BUCKET_VALUES:"Illegal bucket values",ILLEGAL_NUMERIC_STRATEGY:"Illegal numeric strategy",ILLEGAL_STRING_STRATEGY:"Illegal string strategy",INVALID_BOOLEAN:"Invalid boolean",INVALID_FLOAT:"Invalid float",INVALID_INTEGER:"Invalid integer",INVALID_STRING:"Invalid string",INVALID_VALUE_TYPE:"Invalid value type",MISMATCH_NUMBER_OF_VALUES:"Mismatching number of values",MISSING_BUCKETS:"Missing buckets",MISSING_BUCKET_MATCH:"Missing bucket match",MISSING_BUCKET_NAME:"Missing bucket name",MISSING_BUCKET_STRATEGY:"Missing bucket strategy",MISSING_CONTEXT_IN_CONFIG:"Missing context in config",MISSING_DEFAULT_VALUE:"Missing default value",MISSING_OUTPUTS_DEFINITION:"Missing outputs field definition",MISSING_RESULTS:"Missing results",MISSING_TABLE:"Missing table",MISSING_TABLE_ITEM_BUCKET:"Missing table item bucket",MISSING_TABLE_ITEM_VALUES:"Missing table item values",MISSING_VECTOR:"Missing vector",REGEX_SYNTAX_ERROR:"Regex syntax error",REQUESTED_PARAM_NOT_FOUND:"Requested param not found",RESULTS_VECTOR_SIZE_MISMATCH:"Results vector size mismatch",UNDECLARED_OUTPUT_PARAM:"Undeclared output param",UNKNOWN_BUCKET_DEFINITION:"Unknown bucket definition",UNKNOWN_CONFIG_TYPE:"Unknown config type",UNSUPPORTED_CONFIG_VERSION:"Unsupported config version"},j=10,k=", ",l={BOOL:"BOOL",FLOAT:"FLOAT",INT:"INT",STRING:"STRING"};f.ANALYTICS_SAMPLE_RATE=a;f.BUCKET_DELIMITER=b;f.CONTEXT_BUCKET_STRATEGY=c;f.CONFIG_TYPE=d;f.EMPTY_RESOLVED_CONTEXTS=e;f.EMPTY_RESOLVED_MONITORS=g;f.EMPTY_RESULT_PARAMS=h;f.ERROR=i;f.JSON_SUB_SAMPLE_RATE=j;f.LIST_DELIMITER=k;f.TYPE=l}),66);
__d("ContextualConfigResolvedContextsUtils",[],(function(a,b,c,d,e,f){"use strict";a=function(a){var b=[];for(a of a){var c=a.bucketIndex;if(c==void 0)break;b.push(c)}return b};b=function(a){var b=[];for(a of a){var c=a.bucketName;if(c===void 0)break;b.push(c)}return b};var g=function(a){return a.name};c=function(a){return a.map(g)};d=function(a){var b=[];for(a of a){var c=a.value;if(c===void 0)break;b.push(c)}return b};f.getBucketIndices=a;f.getBucketNames=b;f.getContextNames=c;f.getContextValues=d}),66);
__d("ContextualConfigCollateExposureData",["ContextualConfigConstants","ContextualConfigResolvedContextsUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=["cfg_ver_timestamp","policy_id","version","sample_rate"],i=function(a){return a.join(d("ContextualConfigConstants").LIST_DELIMITER)},j=function(a,b){for(var c of h)b[c]!=null&&(a[c]=b[c]);b.name&&(a.config_name=b.name)},k=function(a,b){var c=b[0],e=b[1],f=b[2];b=b[3];c!=null&&(a.exception=c.message);a.result=i(e.map(function(a){return a.value}))||"INVALID";a.context=i(d("ContextualConfigResolvedContextsUtils").getContextNames(f));a.context_value=i(d("ContextualConfigResolvedContextsUtils").getContextValues(f));a.bucket_name=i(d("ContextualConfigResolvedContextsUtils").getBucketNames(f));a.monitor=i(d("ContextualConfigResolvedContextsUtils").getContextNames(b));a.monitor_value=i(d("ContextualConfigResolvedContextsUtils").getContextValues(b))};function a(a,b,c){var e={sample_rate:d("ContextualConfigConstants").ANALYTICS_SAMPLE_RATE};j(e,a);k(e,b);c&&(e.config_contents=JSON.stringify(a));return e}g["default"]=a}),98);
__d("ContextualConfigExposureEvent",["Random"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$2=a,this.$4=d("Random").random()<1/a.sample_rate,this.$3=b,this.$1=c}var b=a.prototype;b.getData=function(){return this.$2};b.log=function(a){var b=this.$2,c=this.$3,d=this.$4;a&&c(b);d&&this.$1(b);return this};b.isSampled=function(){return this.$4};return a}();g["default"]=a}),98);
__d("ContextualConfigExposureLoggerFactory",["ContextualConfigExposureEvent"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a,b){this.$2=a,this.$1=b}var b=a.prototype;b.createEvent=function(a){a=new(c("ContextualConfigExposureEvent"))(a,this.$2,this.$1);return a};return a}();function a(a,b){return new h(a,b)}g["default"]=a}),98);
__d("ContextualConfigExposureLogger",["ContextualConfigExposureLoggerFactory","MarauderLogger"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){};b=function(a){d("MarauderLogger").log("contextual_config_exposure","",a)};e=c("ContextualConfigExposureLoggerFactory")(a,b);g["default"]=e}),98);
__d("ContextualConfigAssert",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){if(a===!1)throw new Error(b)}f["default"]=a}),66);
__d("ContextualConfigValidators",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return Array.isArray(a)};b=function(a){return typeof a==="boolean"};c=function(a){return a!=null};e=function(a){return function(b){return Object.prototype.hasOwnProperty.call(a,b)}};f=function(a){return i(a)&&a%1===0};var h=function(a){return j(a)&&a.length>0},i=function(a){return typeof a==="number"&&!isNaN(a)&&a!==Infinity&&a!==-Infinity},j=function(a){return typeof a==="string"},k=function(a){switch(a){case d("ContextualConfigConstants").TYPE.BOOL:case d("ContextualConfigConstants").TYPE.FLOAT:case d("ContextualConfigConstants").TYPE.INT:case d("ContextualConfigConstants").TYPE.STRING:return!0;default:return!1}};g.isArray=a;g.isBoolean=b;g.isDefined=c;g.isKey=e;g.isInteger=f;g.isNonEmptyString=h;g.isNumber=i;g.isString=j;g.isType=k}),98);
__d("ContextualConfigParseBoolean",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.toUpperCase()){case"TRUE":return!0;case"FALSE":return!1;default:throw new Error(d("ContextualConfigConstants").ERROR.BAD_BOOLEAN_FORMAT)}}g["default"]=a}),98);
__d("ContextualConfigParsePredBoolean",["ContextualConfigConstants","ContextualConfigParseBoolean"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var f=c("ContextualConfigParseBoolean")(a);e=function(a){return a===f};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:e=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:e=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:e=function(a){return!0};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_BOOLEAN_STRATEGY)}return function(a){return e(a)}}g["default"]=a}),98);
__d("ContextualConfigParseFloat",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=/^[-\+]?([1-9]\d*|0)(\.\d+)?$/,j=function(a){return i.test(a)};function a(a){(h||(h=c("ContextualConfigAssert")))(j(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);a=parseFloat(a);h(d("ContextualConfigValidators").isNumber(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);return a}g["default"]=a}),98);
__d("ContextualConfigParseInteger",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=/^[-\+]?([1-9]\d*|0)$/,j=function(a){return i.test(a)};function a(a){(h||(h=c("ContextualConfigAssert")))(j(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);a=parseInt(a,10);h(d("ContextualConfigValidators").isNumber(a),d("ContextualConfigConstants").ERROR.BAD_NUMBER_FORMAT);return a}g["default"]=a}),98);
__d("ContextualConfigPredAssertions",["ContextualConfigAssert","ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){return(h||(h=c("ContextualConfigAssert")))(a>0,d("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)};b=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a===b,d("ContextualConfigConstants").ERROR.MISMATCH_NUMBER_OF_VALUES)};e=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a<b,d("ContextualConfigConstants").ERROR.BAD_VALUE_ORDER)};g.assertHasValues=a;g.assertNumberOfValues=b;g.assertValueOrder=e}),98);
__d("ContextualConfigParsePredNumeric",["ContextualConfigConstants","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigPredAssertions","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f){var g=e.map(f?c("ContextualConfigParseInteger"):h||(h=c("ContextualConfigParseFloat"))),i;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:var j=f?c("ContextualConfigParseInteger")(a):(h||(h=c("ContextualConfigParseFloat")))(a);i=function(a){return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a===j};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:i=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:i=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:i=function(a){return!0};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.COR:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,2);d("ContextualConfigPredAssertions").assertValueOrder(g[0],g[1]);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>=g[0]&&a<g[1]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LT:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a<g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.LTE:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a<=g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.EQ:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a===g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NEQ:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a!==g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GT:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>g[0]};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.GTE:d("ContextualConfigPredAssertions").assertNumberOfValues(g.length,1);i=function(a){if(typeof a!=="number")return!1;return f&&!d("ContextualConfigValidators").isInteger(a)?!1:a>=g[0]};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_NUMERIC_STRATEGY)}return function(a){return i(a)}}g["default"]=a}),98);
__d("ContextualConfigParseRegExp",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h=/^\/(.+)\/(.*)$/;function a(a){try{var b=a.match(h);if(b!=null)return new RegExp(b[1],b[2]);else return new RegExp(a)}catch(a){throw new Error(d("ContextualConfigConstants").ERROR.REGEX_SYNTAX_ERROR)}}g["default"]=a}),98);
__d("ContextualConfigParsePredString",["ContextualConfigConstants","ContextualConfigParseRegExp","ContextualConfigPredAssertions"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){if(typeof a!=="string")throw new Error(d("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE);return a},i=function(a){var b=[];for(a of a)b.push(h(a));return b};function a(a,b,e){var f=i(e),g;switch(b){case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.SAME:g=function(b){return typeof b!=="string"?!1:b===a};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NULL:g=function(a){return a==null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NNULL:g=function(a){return a!=null};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CATCH_ALL:g=function(a){return!0};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.IN:d("ContextualConfigPredAssertions").assertHasValues(f.length);g=function(a){return typeof a!=="string"?!1:f.indexOf(a)!==-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.NIN:d("ContextualConfigPredAssertions").assertHasValues(f.length);g=function(a){return typeof a!=="string"?!1:f.indexOf(a)===-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.CONTAINS:d("ContextualConfigPredAssertions").assertNumberOfValues(f.length,1);g=function(a){return typeof a!=="string"?!1:a.indexOf(f[0])!==-1};break;case d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY.REGEX:d("ContextualConfigPredAssertions").assertNumberOfValues(f.length,1);var h=c("ContextualConfigParseRegExp")(f[0]);g=function(a){return typeof a!=="string"?!1:h.test(a)};break;default:throw new Error(d("ContextualConfigConstants").ERROR.ILLEGAL_STRING_STRATEGY)}return function(a){return g(a)}}g["default"]=a}),98);
__d("ContextualConfigParseContextBuckets",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParsePredBoolean","ContextualConfigParsePredNumeric","ContextualConfigParsePredString","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKETS)},k=d("ContextualConfigValidators").isKey(d("ContextualConfigConstants").CONTEXT_BUCKET_STRATEGY),l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isString(a)&&k(a.toUpperCase()),d("ContextualConfigConstants").ERROR.MISSING_BUCKET_STRATEGY)},m=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.ILLEGAL_BUCKET_VALUES)},n=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.MISSING_BUCKET_NAME)},o=function(a,b){var e=b.name;n(e);var f=b.strategy;l(f);b=b.values||[];m(b);switch(a){case d("ContextualConfigConstants").TYPE.BOOL:return c("ContextualConfigParsePredBoolean")(e,f);case d("ContextualConfigConstants").TYPE.FLOAT:return c("ContextualConfigParsePredNumeric")(e,f,b,!1);case d("ContextualConfigConstants").TYPE.INT:return c("ContextualConfigParsePredNumeric")(e,f,b,!0);case d("ContextualConfigConstants").TYPE.STRING:return c("ContextualConfigParsePredString")(e,f,b);default:throw new Error(d("ContextualConfigConstants").ERROR.UNKNOWN_BUCKET_DEFINITION)}},p=function(a,b){i(b);var c=b.name;n(c);return{name:c,pred:o(a,b)}};function a(a,b){j(b);return b.map(function(b){return p(a,b)})}g["default"]=a}),98);
__d("ContextualConfigParseContexts",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContextBuckets","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a)&&a.length>0,d("ContextualConfigConstants").ERROR.MISSING_CONTEXT_IN_CONFIG)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(a){i(a);var b=a.name,d=a.type;a=a.buckets;k(b);l(d);return{name:b,type:d,buckets:c("ContextualConfigParseContextBuckets")(d,a)}};function a(a){j(a);return a.map(m)}g["default"]=a}),98);
__d("ContextualConfigIsEqualParams",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c+=1){var d=a[c],e=b[c];if(d.name!==e.name||d.type!==e.type)return!1}return!0}f["default"]=a}),66);
__d("ContextualConfigParseResultParamValue",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseBoolean","ContextualConfigParseFloat","ContextualConfigParseInteger","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isString(a),d("ContextualConfigConstants").ERROR.INVALID_STRING)};function a(a,b){j(b);switch(a){case d("ContextualConfigConstants").TYPE.BOOL:return c("ContextualConfigParseBoolean")(b);case d("ContextualConfigConstants").TYPE.FLOAT:return(i||(i=c("ContextualConfigParseFloat")))(b);case d("ContextualConfigConstants").TYPE.INT:return c("ContextualConfigParseInteger")(b);case d("ContextualConfigConstants").TYPE.STRING:return b;default:throw new Error(d("ContextualConfigConstants").ERROR.INVALID_VALUE_TYPE)}}g["default"]=a}),98);
__d("ContextualConfigParseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_RESULTS)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},m=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_VALUE)},n=function(a,b){for(a of a)if(a.name===b)return a.type;throw new Error(d("ContextualConfigConstants").ERROR.UNDECLARED_OUTPUT_PARAM)},o=function(a){return function(b){k(b);var d=b.name;l(d);var e=n(a,d);m(e);b=(i||(i=c("ContextualConfigParseResultParamValue")))(e,b.value);return{name:d,type:e,value:b}}};function a(a,b){j(b);return b.map(o(a))}g["default"]=a}),98);
__d("ContextualConfigParseDenseResultParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b){return(h||(h=c("ContextualConfigAssert")))(c("ContextualConfigIsEqualParams")(a,b),d("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)};function a(a,b){b=c("ContextualConfigParseResultParams")(a,b.map(function(b,c){return{name:a[c].name,value:b}}));i(a,b);return b}g["default"]=a}),98);
__d("ContextualConfigParseDenseDefaults",["ContextualConfigConstants","ContextualConfigParseDenseResultParams"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){try{return c("ContextualConfigParseDenseResultParams")(a,b)}catch(a){throw new Error(d("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)}}g["default"]=a}),98);
__d("ContextualConfigParseMonitors",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.BAD_MONITORED_CONTEXTS)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_CONTEXT_IDENTIFIER)},m=function(a){i(a);var b=a.name;a=a.type;k(b);l(a);return{name:b,type:a}};function a(a){j(a);return a.map(m)}g["default"]=a}),98);
__d("ContextualConfigParseOutputParams",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_OUTPUTS_DEFINITION)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isType(a),d("ContextualConfigConstants").ERROR.BAD_OUTPUT_TYPE)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.BAD_OUTPUT_NAME)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(m(a),d("ContextualConfigConstants").ERROR.DUPLICATE_OUTPUT_NAME)},m=function(a){var b={};for(a of a){if(b[a.name])return!1;b[a.name]=!0}return!0},n=function(a){k(a.name);j(a.type);return a};function a(a){i(a);a=a.map(n);l(a);return a}g["default"]=a}),98);
__d("ContextualConfigParseVector",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParamValue","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_VECTOR)},k=function(a,b){return(h||(h=c("ContextualConfigAssert")))(a===b,d("ContextualConfigConstants").ERROR.RESULTS_VECTOR_SIZE_MISMATCH)},l=function(a,b){k(a.length,b.length);for(var d=0;d<a.length;d+=1){var e=a[d].type,f=b[d];(i||(i=c("ContextualConfigParseResultParamValue")))(e,f)}},m=function(a){return a.reduce(function(a,b){b=b.buckets;return a*b.length},1)};function a(a,b,c){j(c);b=m(b);var d=a.length;k(b*d,c.length);for(var e=0;e<b;e+=1){var f=e*d;l(a,c.slice(f,f+d))}return c}g["default"]=a}),98);
__d("ContextualConfigResolveContexts",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b){for(var c=0;c<a.length;c+=1){var d=a[c];try{if(d.pred(b))return[d.name,c]}catch(a){return null}}return null};function a(a,b,c){var e=null;a=a.map(function(a){var f=a.name,g={name:f};if(e!=null)return g;var i;c[f]!=null?i=c[f]:b[f]!=null?i=b[f]():i=null;g.value=i;if(a.buckets!=null){f=h(a.buckets,i);if(f==null){e=new Error(d("ContextualConfigConstants").ERROR.MISSING_BUCKET_MATCH);return g}a=f[0];i=f[1];g.bucketName=a;g.bucketIndex=i}return g});return[e,a]}g["default"]=a}),98);
__d("DenseContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseContexts","ContextualConfigParseDenseDefaults","ContextualConfigParseDenseResultParams","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseVector","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)},j=function(a){var b=[],c=1;for(var d=a.length-1;d>=0;d-=1)b.push(c),c*=a[d].buckets.length;return b.reverse()},k=function(a,b,d,e){try{b=b.slice(d,d+a.length);return[null,c("ContextualConfigParseDenseResultParams")(a,b)]}catch(a){return[a,e]}},l=function(a,b,d){try{d=d.reduce(function(b,d,e){(h||(h=c("ContextualConfigAssert")))(e<a.length,"Auxillery index out of range.");return b+a[e]*d},0);return[null,d*b]}catch(a){return[a,-1]}};a=function(){function a(a,b){i(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);var d=c("ContextualConfigParseContexts")(a.contexts);this.aux=j(d);this.contexts=d;this.defaults=c("ContextualConfigParseDenseDefaults")(b,a.vectorDefaults);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.outputs=b;this.vector=c("ContextualConfigParseVector")(b,d,a.vector)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.defaults,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.aux,e=this.globalContextProviders,f=this.contexts,g=this.defaults,h=this.monitors,i=this.outputs,j=this.vector;f=c("ContextualConfigResolveContexts")(f,e,a);var m=f[0];f=f[1];if(m!=null)return[m,g,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];m=l(b,i.length,d("ContextualConfigResolvedContextsUtils").getBucketIndices(f));b=m[0];m=m[1];if(b!=null)return[b,g,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];b=k(i,j,m,g);i=b[0];j=b[1];if(i!=null)return[i,j,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS];m=c("ContextualConfigResolveContexts")(h,e,a);g=m[0];b=m[1];return g!=null?[g,j,f,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,j,f,b]};return a}();g["default"]=a}),98);
__d("MultiOutputResolvedContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseResultParams","ContextualConfigResolveContexts","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)};a=function(){function a(a,b){i(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.values=c("ContextualConfigParseResultParams")(b,a.values)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.values,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.globalContextProviders,e=this.monitors,f=this.values;e=c("ContextualConfigResolveContexts")(e,b,a);b=e[0];a=e[1];return b!=null?[b,f,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]:[null,f,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,a]};return a}();g["default"]=a}),98);
__d("ContextualConfigMergePartialResultParams",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c={};for(b of b)c[b.name]=b;b=[];for(a of a){var d=c[a.name];b.push(d!=null&&d.name===a.name&&d.type===a.type?d:a)}return b}f["default"]=a}),66);
__d("ContextualConfigParseDefaults",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigIsEqualParams","ContextualConfigParseResultParams"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a,b){return(h||(h=c("ContextualConfigAssert")))(c("ContextualConfigIsEqualParams")(a,b),d("ContextualConfigConstants").ERROR.MISSING_DEFAULT_VALUE)};function a(a,b){b=c("ContextualConfigParseResultParams")(a,b);i(a,b);return b}g["default"]=a}),98);
__d("ContextualConfigParseTable",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigParseResultParams","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE)},j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isNonEmptyString(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_BUCKET)},l=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isArray(a),d("ContextualConfigConstants").ERROR.MISSING_TABLE_ITEM_VALUES)},m=function(a,b){j(b);var d=b.bucket;b=b.values;k(d);l(b);return{bucket:d,values:c("ContextualConfigParseResultParams")(a,b)}};function a(a,b){i(b);return b.reduce(function(b,c){c=m(a,c);b[c.bucket]=c.values;return b},{})}g["default"]=a}),98);
__d("TableContextualConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigMergePartialResultParams","ContextualConfigParseContexts","ContextualConfigParseDefaults","ContextualConfigParseMonitors","ContextualConfigParseOutputParams","ContextualConfigParseTable","ContextualConfigResolveContexts","ContextualConfigResolvedContextsUtils","ContextualConfigValidators"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[],j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a),d("ContextualConfigConstants").ERROR.BAD_CONFIG)};a=function(){function a(a,b){j(a);this.globalContextProviders=babelHelpers["extends"]({},b);b=c("ContextualConfigParseOutputParams")(a.outputs);this.contexts=c("ContextualConfigParseContexts")(a.contexts);this.defaults=c("ContextualConfigParseDefaults")(b,a.defaults);this.monitors=a.monitors!=null?c("ContextualConfigParseMonitors")(a.monitors):[];this.table=c("ContextualConfigParseTable")(b,a.table)}var b=a.prototype;b.resolve=function(a){try{return this.unsafeResolve(a)}catch(a){return[a,this.defaults,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]}};b.unsafeResolve=function(a){var b=this.globalContextProviders,e=this.contexts,f=this.defaults,g=this.monitors,h=this.table;e=c("ContextualConfigResolveContexts")(e,b,a);var j=e[0];e=e[1];if(j!=null)return[j,f,e,[]];j=d("ContextualConfigResolvedContextsUtils").getBucketNames(e).join(d("ContextualConfigConstants").BUCKET_DELIMITER);h=h[j]||i;j=c("ContextualConfigMergePartialResultParams")(f,h);f=c("ContextualConfigResolveContexts")(g,b,a);h=f[0];g=f[1];return h!=null?[h,j,e,[]]:[null,j,e,g]};return a}();g["default"]=a}),98);
__d("ContextualConfigParseConfig",["ContextualConfigAssert","ContextualConfigConstants","ContextualConfigValidators","DenseContextualConfig","MultiOutputResolvedContextualConfig","TableContextualConfig"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[1],j=function(a){return(h||(h=c("ContextualConfigAssert")))(d("ContextualConfigValidators").isDefined(a)&&d("ContextualConfigValidators").isDefined(a.version),d("ContextualConfigConstants").ERROR.BAD_CONFIG)},k=function(a){return(h||(h=c("ContextualConfigAssert")))(i.indexOf(a)!==-1,d("ContextualConfigConstants").ERROR.UNSUPPORTED_CONFIG_VERSION)};function a(a,b){j(a);k(a.version);switch(a.cctype){case d("ContextualConfigConstants").CONFIG_TYPE.DENSE:return new(c("DenseContextualConfig"))(a,b);case d("ContextualConfigConstants").CONFIG_TYPE.MULTI_OUTPUT_RESOLVED:return new(c("MultiOutputResolvedContextualConfig"))(a,b);case d("ContextualConfigConstants").CONFIG_TYPE.TABLE:return new(c("TableContextualConfig"))(a,b);default:throw new Error(d("ContextualConfigConstants").ERROR.UNKNOWN_CONFIG_TYPE)}}g["default"]=a}),98);
__d("ContextualConfigWarn",[],(function(a,b,c,d,e,f){"use strict";function a(a){}f["default"]=a}),66);
__d("ContextualConfigResult",["ContextualConfigConstants","ContextualConfigWarn"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a.reduce(function(a,b){var c=b.name;b=b.value;a[c]=b;return a},{}),this.$2=a}var b=a.prototype;b.get=function(a,b){try{a=this.$1[a];if(typeof a!==typeof b){c("ContextualConfigWarn")(d("ContextualConfigConstants").ERROR.REQUESTED_PARAM_NOT_FOUND);return b}return a}catch(a){c("ContextualConfigWarn")(a.message);return b}};b.getParams=function(){return this.$2};return a}();g["default"]=a}),98);
__d("ErrorContextualConfig",["ContextualConfigConstants"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.error=a}var b=a.prototype;b.resolve=function(a){return[this.error,d("ContextualConfigConstants").EMPTY_RESULT_PARAMS,d("ContextualConfigConstants").EMPTY_RESOLVED_CONTEXTS,d("ContextualConfigConstants").EMPTY_RESOLVED_MONITORS]};return a}();g["default"]=a}),98);
__d("ContextualConfig",["ContextualConfigCollateExposureData","ContextualConfigConstants","ContextualConfigExposureLogger","ContextualConfigParseConfig","ContextualConfigResult","ErrorContextualConfig","Random"],(function(a,b,c,d,e,f,g){"use strict";var h=1/d("ContextualConfigConstants").JSON_SUB_SAMPLE_RATE,i=1;a=function(){function a(a,b){b===void 0&&(b={}),this.isDebugLoggingEnabled=!1,this.$3=!1,this.$4=a,this.$2=b}var b=a.prototype;b.$5=function(){if(this.$1)return this.$1;var a=this.$2,b=this.$4;try{b=c("ContextualConfigParseConfig")(b,a)}catch(a){b=new(c("ErrorContextualConfig"))(a)}this.$1=b;return b};b.$6=function(a){var b=this.isDebugLoggingEnabled,e=this.$3;e=!e&&d("Random").random()<h;e&&(this.$3=!0);a=c("ContextualConfigCollateExposureData")(this.$4,a,e);e=c("ContextualConfigExposureLogger").createEvent(a);e.log(b)};b.resolve=function(a){a===void 0&&(a={});var b=this.$1||this.$5();b=b.resolve(a);this.$6(b);return new(c("ContextualConfigResult"))(b[i])};return a}();g["default"]=a}),98);
__d("DgwClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1755537");b=d("FalcoLoggerInternal").create("dgw_client",a);e=b;g["default"]=e}),98);
__d("DGWLoggingContext",["$InternalEnum","DgwClientFalcoEvent","ODS","Random"],(function(a,b,c,d,e,f,g){"use strict";var h;a="dgw_client";var i=b("$InternalEnum")({STREAM_GROUP_COMPONENT:"WebStreamGroup",GROUPED_STREAM_COMPONENT:"GroupedWebStream",WEBSOCKET_TRANSPORT_COMPONENT:"WebSocketTransport",ACK_MANAGER_COMPONENT:"WebStreamAckManager",CODEC_COMPONENT:"WebCodec",RAW_CLIENT:"RAWDGWClient",PINGER:"DGWPinger"}),j={VERBOSE:-1,INFO:0,WARNING:1,ERROR:2,FATAL:3};function k(a){switch(a){case i.GROUPED_STREAM_COMPONENT:case i.ACK_MANAGER_COMPONENT:return!0;default:return!1}}e=function(){function a(a,b,c,d,e,f,g){f===void 0&&(f=!1),g===void 0&&(g=!1),this.$5=""+a,this.$1=b,this.$4=c,this.$3=d,this.sgTransportId=e,this.$2=f,this.$6=g}a.bumpODSKey=function(a,b,c){c===void 0&&(c=1);if(!d("Random").coinflip(c))return;a=a+"."+b;(h||(h=d("ODS"))).bumpEntityKey(3589,"dgw_web_client",a,c)};var b=a.prototype;b.bumpODSKey=function(a,b,c){c===void 0&&(c=1);if(!d("Random").coinflip(c))return;a=this.$4+"."+a+"."+b;(h||(h=d("ODS"))).bumpEntityKey(3589,"dgw_web_client",a,c)};b.logEvent=function(a,b,c,d,e){d===void 0&&(d=!1),this.$2||this.$7(a,b,null,j.INFO,c,d,e)};b.$7=function(a,b,d,e,f,g,h){var i=this;g===void 0&&(g=!1);if(g&&!this.$6)return;(k(a)&&this.$1!=null||!k(a)&&this.sgTransportId!=null)&&c("DgwClientFalcoEvent").log(function(){return{event:b,logging_id:h!=null?h:i.$1,dgw_version:i.$5,message:d,severity:e,uuid:i.$3,dgw_component:a,extra_info:f,destination_tier:i.$4,sg_transport_id:i.sgTransportId,source:2}})};b.logError=function(a,b,c,d,e,f){e===void 0&&(e=!1),this.$2||this.$7(a,b,c,j.ERROR,d,e,f)};b.logWarn=function(a,b,c,d,e){e===void 0&&(e=!1),this.$2||this.$7(a,b,c,j.WARNING,d,e)};return a}();g.DGW_MODULE=a;g.DGWLoggingComponent=i;g.DGWLoggingContext=e}),98);
__d("DGWAckManager",["DGWLoggingContext"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){function a(a,b,c){var d=this;this.$3=c;this.sendId=a;this.$2=b;this.handleAckReceived=function(){d.stopTracking(!0)};this.$1=window.setTimeout(function(){d.stopTracking(!1)},b)}var b=a.prototype;b.stopTracking=function(a){window.clearTimeout(this.$1),this.$3(a)};return a}();a=function(){function a(a){this.$1=new Map(),this.$2=a}var b=a.prototype;b.waitForAck=async function(a,b){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_expected");var c=this.$1;try{var e=await new Promise(function(d,e){c.set(a,new h(a,b,d))});e===!0?this.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Received ACK","sendId:"+a,!0):(this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_timeout"),this.$2.logWarn(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ACK timeout","Request "+a+" timed out after "+b+"ms"));c.delete(a);return e}catch(b){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_error");c.delete(a);throw b}};b.handleAckReceived=function(a){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received");var b=this.$1.get(a);if(b===void 0){this.$2.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ack_received.not_tracked");this.$2.logWarn(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"untracked ACK","Received ACK for ackId "+a+" which was not being tracked");return}b.handleAckReceived()};b.clearPendingAcks=function(){var a=this;this.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending acks","ACKs cleared size: "+this.$1.size);this.$1.forEach(function(b,c,e){a.$2.logEvent(d("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending ACK with ackId "+b.sendId,null,!0),b.stopTracking(!1),e.delete(c)})};return a}();g.DGWAckManager=a}),98);
__d("DGWStream",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["ABNORMAL_CLOSURE","GOING_AWAY","SERVER_INTERNAL_ERROR","PREMATURE_CLOSE","UNKNOWN_ERROR","KEEPALIVE_TIMEOUT","TRANSPORT_CLOSED_BEFORE_STREAM_INIT","TRANSPORT_ESTABLISHMENT_ERROR","TRANSPORT_ESTABLISHMENT_TIMEOUT","ESTABLISHMENT_TIMEOUT","UNAUTHENTICATED","UNAUTHORIZED","REJECTED","BAD_REQUEST","DGW_SERVER_ERROR","ESTABLISHMENT_ERROR","ACK_TIMEOUT"]);function a(a){switch(a){case g.UNAUTHENTICATED:case g.UNAUTHORIZED:case g.REJECTED:case g.BAD_REQUEST:case g.UNKNOWN_ERROR:case g.SERVER_INTERNAL_ERROR:return!1;default:return!0}}f.StreamError=g;f.isRetryableError=a}),66);
__d("DGWCppBridge",[],(function(l,m,n,o,p,q){var r=function(){var l=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(m){m=m||{};var m=typeof m!=="undefined"?m:{},n=function(){function m(){}function n(l,m){return function(){l.apply(m,arguments)}}function l(m){if(!(this instanceof l))throw new TypeError("Promises must be constructed via new");if(typeof m!=="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];t(m,this)}function o(m,n){while(m._state===3)m=m._value;if(m._state===0){m._deferreds.push(n);return}m._handled=!0;l._immediateFn(function(){var l=m._state===1?n.onFulfilled:n.onRejected;if(l===null){(m._state===1?p:q)(n.promise,m._value);return}var o;try{o=l(m._value)}catch(l){q(n.promise,l);return}p(n.promise,o)})}function p(m,o){try{if(o===m)throw new TypeError("A promise cannot be resolved with itself.");if(o&&(typeof o==="object"||typeof o==="function")){var p=o.then;if(o instanceof l){m._state=3;m._value=o;r(m);return}else if(typeof p==="function"){t(n(p,o),m);return}}m._state=1;m._value=o;r(m)}catch(l){q(m,l)}}function q(l,m){l._state=2,l._value=m,r(l)}function r(m){m._state===2&&m._deferreds.length===0&&l._immediateFn(function(){m._handled||l._unhandledRejectionFn(m._value)});for(var n=0,p=m._deferreds.length;n<p;n++)o(m,m._deferreds[n]);m._deferreds=null}function s(l,m,n){this.onFulfilled=typeof l==="function"?l:null,this.onRejected=typeof m==="function"?m:null,this.promise=n}function t(l,m){var n=!1;try{l(function(l){if(n)return;n=!0;p(m,l)},function(l){if(n)return;n=!0;q(m,l)})}catch(l){if(n)return;n=!0;q(m,l)}}l.prototype["catch"]=function(l){return this.then(null,l)};l.prototype.then=function(l,n){var p=new this.constructor(m);o(this,new s(l,n,p));return p};l.all=function(m){return new l(function(l,n){if(!Array.isArray(m))return n(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(m);if(o.length===0)return l([]);var p=o.length;function q(m,r){try{if(r&&(typeof r==="object"||typeof r==="function")){var s=r.then;if(typeof s==="function"){s.call(r,function(l){q(m,l)},n);return}}o[m]=r;--p===0&&l(o)}catch(l){n(l)}}for(var r=0;r<o.length;r++)q(r,o[r])})};l.resolve=function(m){return m&&typeof m==="object"&&m.constructor===l?m:new l(function(l){l(m)})};l.reject=function(m){return new l(function(l,n){n(m)})};l.race=function(m){return new l(function(n,o){if(!Array.isArray(m))return o(new TypeError("Promise.race accepts an array"));for(var p=0,q=m.length;p<q;p++)l.resolve(m[p]).then(n,o)})};l._immediateFn=typeof setImmediate==="function"&&function(l){setImmediate(l)}||function(l){setTimeout(l,0)};l._unhandledRejectionFn=function(l){typeof console!=="undefined"&&console};return l}(),o,s;m.ready=new n(function(l,m){o=l,s=m});var t={},u;for(u in m)Object.prototype.hasOwnProperty.call(m,u)&&(t[u]=m[u]);var v=[];(function(l,m){throw m});var w=!0,x=!1,y="";function z(l){return m.locateFile?m.locateFile(l,y):y+l}var A;(w||x)&&(x?y=self.location.href:typeof document!=="undefined"&&document.currentScript&&(y=document.currentScript.src),l&&(y=l),y.indexOf("blob:")!==0?y=y.substr(0,y.lastIndexOf("/")+1):y="",(function(l){try{var m=new XMLHttpRequest();m.open("GET",l,!1);m.send(null);return m.responseText}catch(n){m=ga(l);if(m)return fa(m);throw n}},x&&(A=function(l){try{var m=new XMLHttpRequest();m.open("GET",l,!1);m.responseType="arraybuffer";m.send(null);return new Uint8Array(m.response)}catch(n){m=ga(l);if(m)return m;throw n}}),function(l,m,n){var o=new XMLHttpRequest();o.open("GET",l,!0);o.responseType="arraybuffer";o.onload=function(){if(o.status==200||o.status==0&&o.response){m(o.response);return}var p=ga(l);if(p){m(p.buffer);return}n()};o.onerror=n;o.send(null)}),function(l){document.title=l});m.print||emptyFunction.bind(console);var B=m.printErr||emptyFunction.bind(console);for(u in t)Object.prototype.hasOwnProperty.call(t,u)&&(m[u]=t[u]);t=null;m.arguments&&(v=m.arguments);m.thisProgram&&m.thisProgram;m.quit&&m.quit;var C;m.wasmBinary&&(C=m.wasmBinary);m.noExitRuntime||!0;var D={Memory:function(l){this.buffer=new ArrayBuffer(l.initial*65536)},Module:function(l){},Instance:function(l,m){this.exports=function(l){function m(l){l.set=function(l,m){this[l]=m};l.get=function(l){return this[l]};return l}var n,o=new Uint8Array(123);for(var p=25;p>=0;--p)o[48+p]=52+p,o[65+p]=p,o[97+p]=26+p;o[43]=62;o[47]=63;function q(m,n,p){var q,r,l=0,s=n,t=p.length;n=n+(t*3>>2)-(p[t-2]=="=")-(p[t-1]=="=");for(;l<t;l+=4)q=o[p.charCodeAt(l+1)],r=o[p.charCodeAt(l+2)],m[s++]=o[p.charCodeAt(l)]<<2|q>>4,s<n&&(m[s++]=q<<4|r>>2),s<n&&(m[s++]=r<<6|o[p.charCodeAt(l+3)])}function r(l){q(n,1024,"U3Q5dHlwZV9pbmZvAAAAAOAEAAAABAAATjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAAAACAUAABgEAAAQBAAATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAAAACAUAAEgEAAA8BAAATjEwX19jeHhhYml2MTE3X19wYmFzZV90eXBlX2luZm9FAAAACAUAAHgEAAA8BAAATjEwX19jeHhhYml2MTE5X19wb2ludGVyX3R5cGVfaW5mb0UACAUAAKgEAACcBAAAAAAAAGwEAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAAAAABQBQAAAQAAAAkAAAADAAAABAAAAAUAAAAKAAAACwAAAAwAAABOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UAAAAACAUAACgFAABsBA=="),q(n,1372,"gAkQ")}function s(l){var o=l.a,p=o.buffer;o.grow=xa;var q=new Int8Array(p),s=new Int16Array(p),t=new Int32Array(p),u=new Uint8Array(p),v=new Uint16Array(p),w=new Uint32Array(p);new Float32Array(p);new Float64Array(p);var x=Math.imul;Math.fround;Math.abs;var y=Math.clz32;Math.min;Math.max;Math.floor;Math.ceil;Math.trunc;Math.sqrt;l.abort;NaN;Infinity;var z=l.b,A=1051008,B;function C(o,p,l,r,m,n){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;n=n|0;var y=0,z=0,B;y=A-80|0;A=y;t[y+72>>2]=o;t[y+68>>2]=p;t[y+64>>2]=l;t[y+60>>2]=r;t[y+56>>2]=m;t[y+52>>2]=n;a:{if(t[y+52>>2]?!t[y+56>>2]|(!t[y+72>>2]|!t[y+68>>2]|(!t[y+64>>2]|!t[y+60>>2])):1){t[y+76>>2]=5;break a}t[t[y+64>>2]>>2]=0;t[t[y+60>>2]>>2]=0;p=t[y+68>>2];l=t[y+56>>2];r=t[y+52>>2];o=A+-64|0;A=o;t[o+56>>2]=t[y+72>>2];t[o+52>>2]=p;t[o+48>>2]=l;t[o+44>>2]=r;t[o+40>>2]=0;t[o+36>>2]=t[o+56>>2];b:{c:{d:{while(1){if(!t[o+52>>2])break c;t[o+32>>2]=t[o+36>>2];q[o+31|0]=u[t[o+36>>2]];t[o+52>>2]=t[o+52>>2]-1;t[o+36>>2]=t[o+36>>2]+1;if(u[o+31|0]!=10?u[o+31|0]==2|u[o+31|0]==4|u[o+31|0]==9:1){t[o+40>>2]=t[o+40>>2]+1;continue}t[o+24>>2]=1;if(V(u[o+31|0])&1){z=o,B=X(u[o+31|0])&1,q[z+23|0]=B;t[o+16>>2]=q[o+23|0]&1?1:2;if(w[o+52>>2]<w[o+16>>2]){t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[o+52>>2]=t[o+52>>2]-t[o+16>>2];t[o+24>>2]=t[o+16>>2]+t[o+24>>2];t[o+36>>2]=t[o+16>>2]+t[o+36>>2];if(!(u[o+31|0]!=14?u[o+31|0]!=8:0)){t[o+40>>2]=t[o+40>>2]+1;continue}}if(w[o+52>>2]<3)break d;t[o+12>>2]=0;p=t[o+36>>2];l=u[p|0]|u[p+1|0]<<8;q[o+12|0]=l;q[o+13|0]=l>>>8;q[o+14|0]=u[p+2|0];t[o+52>>2]=t[o+52>>2]-3;t[o+24>>2]=t[o+24>>2]+3;t[o+36>>2]=t[o+36>>2]+3;if(w[o+12>>2]<=w[o+52>>2]){t[o+40>>2]=t[o+40>>2]+1;t[o+36>>2]=t[o+12>>2]+t[o+36>>2];t[o+52>>2]=t[o+52>>2]-t[o+12>>2];continue}break}t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[t[o+48>>2]>>2]=t[o+32>>2];t[t[o+44>>2]>>2]=t[o+52>>2]+t[o+24>>2];break b}t[t[o+44>>2]>>2]=t[o+52>>2]}t[o+60>>2]=t[o+40>>2];A=o- -64|0;t[y+48>>2]=t[o+60>>2];if(!t[y+48>>2]){t[y+76>>2]=0;break a}z=y,B=D(x(t[y+48>>2],20)),t[z+44>>2]=B;if(!t[y+44>>2]){t[y+76>>2]=3;break a}t[y+40>>2]=t[y+44>>2];t[y+36>>2]=t[y+72>>2];t[y+32>>2]=t[y+68>>2]-t[t[y+52>>2]>>2];t[y+28>>2]=0;while(1){if(w[y+28>>2]<w[y+48>>2]){if(w[y+32>>2]<1){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=1;break a}q[y+27|0]=u[t[y+36>>2]];t[y+36>>2]=t[y+36>>2]+1;t[y+32>>2]=t[y+32>>2]-1;e:{if(!u[y+27|0]|u[y+27|0]==1|(u[y+27|0]==2|u[y+27|0]==3)|(u[y+27|0]==4|u[y+27|0]==9|u[y+27|0]==10))break e;if(V(u[y+27|0])&1)break e;O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=6;break a}o=t[y+40>>2];t[o>>2]=u[y+27|0]&15|t[o>>2]&-16;f:{if(u[y+27|0]!=10?u[y+27|0]==2|u[y+27|0]==4|u[y+27|0]==9:1){o=t[y+40>>2];t[o>>2]=t[o>>2]&-268435441;t[y+40>>2]=t[y+40>>2]+20;break f}if(V(u[y+27|0])&1){o=A-48|0;A=o;t[o+40>>2]=t[y+40>>2];t[o+36>>2]=y+36;t[o+32>>2]=y+32;g:{if(!(V(t[t[o+40>>2]>>2]&15)&1)){t[o+44>>2]=1;break g}z=o,B=X(t[t[o+40>>2]>>2]&15)&1,q[z+31|0]=B;t[o+24>>2]=q[o+31|0]&1?1:2;if(w[t[o+32>>2]>>2]<w[o+24>>2]){t[o+44>>2]=1;break g}ba(t[o+40>>2]+4|0,t[t[o+36>>2]>>2],t[o+24>>2]);p=t[o+36>>2];t[p>>2]=t[o+24>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+24>>2];if((t[t[o+40>>2]>>2]&15)==8){p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==14){p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441;t[o+44>>2]=0;break g}if(w[t[o+32>>2]>>2]<3){t[o+44>>2]=11;break g}t[o+20>>2]=0;p=t[t[o+36>>2]>>2];l=u[p|0]|u[p+1|0]<<8;q[o+20|0]=l;q[o+21|0]=l>>>8;q[o+22|0]=u[p+2|0];p=t[o+36>>2];t[p>>2]=t[p>>2]+3;p=t[o+32>>2];t[p>>2]=t[p>>2]-3;p=t[o+40>>2];t[p>>2]=t[p>>2]&-268435441|(t[o+20>>2]&16777215)<<4;if(w[t[o+32>>2]>>2]<w[o+20>>2]){t[o+44>>2]=11;break g}if((t[t[o+40>>2]>>2]&15)==15){t[t[o+40>>2]+12>>2]=t[o+20>>2];p=D(t[o+20>>2]);t[t[o+40>>2]+8>>2]=p;if(!t[t[o+40>>2]+8>>2]){t[o+44>>2]=3;break g}ba(t[t[o+40>>2]+8>>2],t[t[o+36>>2]>>2],t[o+20>>2]);p=t[o+36>>2];t[p>>2]=t[o+20>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+20>>2];t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==5){t[t[o+40>>2]+12>>2]=t[o+20>>2];p=D(t[o+20>>2]);t[t[o+40>>2]+8>>2]=p;if(!t[t[o+40>>2]+8>>2]){t[o+44>>2]=3;break g}ba(t[t[o+40>>2]+8>>2],t[t[o+36>>2]>>2],t[o+20>>2]);p=t[o+36>>2];t[p>>2]=t[o+20>>2]+t[p>>2];p=t[o+32>>2];t[p>>2]=t[p>>2]-t[o+20>>2];t[o+44>>2]=0;break g}h:{if(!((t[t[o+40>>2]>>2]&15)!=6?(t[t[o+40>>2]>>2]&15)!=7:0)){z=o,B=Q(t[o+36>>2],t[o+32>>2],o+19|0,o+18|0),t[z+12>>2]=B;if(t[o+12>>2]){t[o+44>>2]=t[o+12>>2];break g}break h}if(!((t[t[o+40>>2]>>2]&15)!=13?(t[t[o+40>>2]>>2]&15)!=12:0)){l=t[o+32>>2];p=A-32|0;t[p+24>>2]=t[o+36>>2];t[p+20>>2]=l;t[p+16>>2]=o+19;t[p+12>>2]=o+16;s[p+10>>1]=0;i:{if(w[t[p+20>>2]>>2]<2){t[p+28>>2]=1;break i}l=t[t[p+24>>2]>>2];l=u[l|0]|u[l+1|0]<<8;q[p+10|0]=l;q[p+11|0]=l>>>8;l=t[p+24>>2];t[l>>2]=t[l>>2]+2;l=t[p+20>>2];t[l>>2]=t[l>>2]-2;q[t[p+16>>2]]=(v[p+10>>1]&32768)==32768;s[t[p+12>>2]>>1]=v[p+10>>1]&32767;t[p+28>>2]=0}t[o+12>>2]=t[p+28>>2];if(t[o+12>>2]){t[o+44>>2]=t[o+12>>2];break g}}}if((t[t[o+40>>2]>>2]&15)==12){p=t[o+40>>2];s[p+8>>1]=s[p+8>>1]&1|v[o+16>>1]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==7){p=t[o+40>>2];q[p+8|0]=q[p+8|0]&1|u[o+18|0]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==13){l=t[o+32>>2];r=t[o+20>>2];m=t[o+40>>2]+12|0;n=t[o+40>>2];p=A-32|0;A=p;t[p+24>>2]=t[o+36>>2];t[p+20>>2]=l;t[p+16>>2]=r;t[p+12>>2]=m;t[p+8>>2]=n+16;j:{if(w[p+16>>2]<2){t[p+28>>2]=9;break j}t[t[p+8>>2]>>2]=t[p+16>>2]-2;if(w[t[p+20>>2]>>2]<w[t[p+8>>2]>>2]){t[p+28>>2]=1;break j}l=D(t[t[p+8>>2]>>2]);t[t[p+12>>2]>>2]=l;if(!t[t[p+12>>2]>>2]){t[p+28>>2]=3;break j}ba(t[t[p+12>>2]>>2],t[t[p+24>>2]>>2],t[t[p+8>>2]>>2]);l=t[p+24>>2];t[l>>2]=t[t[p+8>>2]>>2]+t[l>>2];l=t[p+20>>2];t[l>>2]=t[l>>2]-t[t[p+8>>2]>>2];t[p+28>>2]=0}A=p+32|0;t[o+8>>2]=t[p+28>>2];if(t[o+8>>2]){t[o+44>>2]=t[o+8>>2];break g}p=t[o+40>>2];s[p+8>>1]=q[o+19|0]&1|v[p+8>>1]&65534;p=t[o+40>>2];s[p+8>>1]=s[p+8>>1]&1|v[o+16>>1]<<1;t[o+44>>2]=0;break g}if((t[t[o+40>>2]>>2]&15)==6){z=o,B=M(t[o+36>>2],t[o+32>>2],t[o+20>>2],t[o+40>>2]+12|0,t[o+40>>2]+16|0),t[z+4>>2]=B;if(t[o+4>>2]){t[o+44>>2]=t[o+4>>2];break g}p=t[o+40>>2];q[p+8|0]=q[o+19|0]&1|u[p+8|0]&254;p=t[o+40>>2];q[p+8|0]=q[p+8|0]&1|u[o+18|0]<<1;t[o+44>>2]=0;break g}t[o+44>>2]=1}A=o+48|0;t[y+20>>2]=t[o+44>>2];if(!t[y+20>>2]){t[y+40>>2]=t[y+40>>2]+20;break f}O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+20>>2];break a}t[y+16>>2]=0;if(w[y+32>>2]<3){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=1;break a}o=t[y+36>>2];p=u[o|0]|u[o+1|0]<<8;q[y+16|0]=p;q[y+17|0]=p>>>8;q[y+18|0]=u[o+2|0];t[y+36>>2]=t[y+36>>2]+3;t[y+32>>2]=t[y+32>>2]-3;if(!(t[y+16>>2]==1|u[y+27|0]!=1)){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=7;break a}o=t[y+40>>2];t[o>>2]=t[o>>2]&-268435441|(t[y+16>>2]&16777215)<<4;if(u[y+27|0]==3){if(t[y+16>>2]!=1){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=10;break a}q[y+15|0]=0;if(w[y+32>>2]<1){J(t[y+44>>2]);t[y+76>>2]=1;break a}q[y+15|0]=u[t[y+36>>2]];t[y+36>>2]=t[y+36>>2]+1;t[y+32>>2]=t[y+32>>2]-1;k:{if(u[y+15|0]<=4){q[t[y+40>>2]+4|0]=u[y+15|0];break k}q[t[y+40>>2]+4|0]=4}t[y+40>>2]=t[y+40>>2]+20;break f}z=y,B=Q(y+36|0,y+32|0,y+14|0,y+13|0),t[z+8>>2]=B;if(t[y+8>>2]){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+8>>2];break a}if(u[y+27|0]==1){o=t[y+40>>2];q[o+4|0]=q[o+4|0]&1|u[y+13|0]<<1;t[y+40>>2]=t[y+40>>2]+20;break f}if(!u[y+27|0]){z=y,B=M(y+36|0,y+32|0,t[y+16>>2],t[y+40>>2]+8|0,t[y+40>>2]+12|0),t[z+4>>2]=B;if(t[y+4>>2]){O(t[y+44>>2],t[y+28>>2]);t[y+76>>2]=t[y+4>>2];break a}o=t[y+40>>2];q[o+4|0]=q[y+14|0]&1|u[o+4|0]&254;o=t[y+40>>2];q[o+4|0]=q[o+4|0]&1|u[y+13|0]<<1;t[y+40>>2]=t[y+40>>2]+20}}t[y+28>>2]=t[y+28>>2]+1;continue}break}if(t[y+32>>2]){O(t[y+44>>2],t[y+48>>2]);t[y+76>>2]=1;break a}t[t[y+64>>2]>>2]=t[y+44>>2];t[t[y+60>>2]>>2]=t[y+48>>2];t[y+76>>2]=0}A=y+80|0;return t[y+76>>2]}function D(o){var q=0,l=0,r=0,m=0,n=0,s=0,u=0,v,w=0,x,p;w=8;a:{b:{if(o>>>0>4294967239)break b;while(1){w=w>>>0>8?w:8;l=t[603];n=l;m=t[602];u=m;o=o>>>0>8?o+3&-4:8;c:{if(o>>>0<=127){s=(o>>>3|0)-1|0;break c}r=y(o);s=((o>>>29-r^4)-(r<<2)|0)+110|0;if(o>>>0<=4095)break c;r=((o>>>30-r^2)-(r<<1)|0)+71|0;s=r>>>0<63?r:63}q=s;r=q&31;(q&63)>>>0>=32?(q=0,l=l>>>r|0):(q=l>>>r|0,l=((1<<r)-1&l)<<32-r|u>>>r);r=q;if(l|q){while(1){n=l;q=r;d:{if(q|l){m=q-1|0;v=m+1|0;u=m;m=l-1|0;u=(m|0)!=-1?v:u;m=y(l^m)+32|0;l=y(q^u);l=(l|0)==32?m:l;q=63-l|0;0-(l>>>0>63)|0;break d}q=64}m=q;q=m;l=q&31;(q&63)>>>0>=32?(q=0,u=r>>>l|0):(q=r>>>l|0,u=((1<<l)-1&r)<<32-l|n>>>l);r=q;s=m+s|0;n=s<<4;q=t[n+1384>>2];m=n+1376|0;e:{if((q|0)!=(m|0)){l=I(q,w,o);if(l)break b;l=t[q+4>>2];t[l+8>>2]=t[q+8>>2];t[t[q+8>>2]+4>>2]=l;t[q+8>>2]=m;l=n+1380|0;t[q+4>>2]=t[l>>2];t[l>>2]=q;t[t[q+4>>2]+8>>2]=q;s=s+1|0;l=(r&1)<<31|u>>>1;r=r>>>1|0;break e}x=t[603];q=s;v=q&63;l=v;n=l&31;l>>>0>=32?(l=0,m=-1>>>n|0):(l=-1>>>n|0,m=(1<<n)-1<<32-n|-1>>>n);m=m&-2;n=v&31;v>>>0>=32?(l=m<<n,v=0):(l=(1<<n)-1&m>>>32-n|l<<n,v=m<<n);n=l;m=0-q&63;l=m;q=l&31;l>>>0>=32?(l=-1<<q,q=0):(l=(1<<q)-1&-1>>>32-q|-1<<q,q=-1<<q);p=q&-2;q=m&31;m>>>0>=32?(m=0,q=l>>>q|0):(m=l>>>q|0,q=((1<<q)-1&l)<<32-q|p>>>q);l=q|v;B=n|m;t[602]=t[602]&l;t[603]=B&x;l=u^1}if(l|r)continue;break}m=t[602];n=t[603]}f:{if(n|m){r=y(n);r=63-((r|0)==32?y(m)+32|0:r)<<4;q=r+1376|0;r=t[r+1384>>2];g:{if(!n&m>>>0<1073741824)break g;s=98;if((q|0)==(r|0))break g;while(1){l=I(r,w,o);if(l)break b;r=t[r+8>>2];if(!s)break g;s=s-1|0;if((q|0)!=(r|0))continue;break}}if(G(o+48|0))break f;if(!r|(q|0)==(r|0))break a;while(1){l=I(r,w,o);if(l)break b;r=t[r+8>>2];if((q|0)!=(r|0))continue;break}break a}if(!G(o+48|0))break a}l=0;if(o>>>0>4294967239)break b;r=w;q=0;while(1){s=q;if(r){r=r-1&r;q=q+1|0;continue}break}if(s>>>0<=1)continue;break}}return l}return 0}function E(o,p,l,r,m,n,x){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;n=n|0;x=x|0;var y=0,z=0;y=A-32|0;A=y;s[y+26>>1]=o;t[y+20>>2]=p;t[y+16>>2]=l;q[y+15|0]=r;s[y+12>>1]=m;t[y+8>>2]=n;t[y+4>>2]=x;a:{if(!(!(q[y+15|0]&1)|v[y+12>>1]<=32767)){t[y+28>>2]=4;break a}p=t[y+20>>2];l=t[y+16>>2];r=t[y+8>>2];m=t[y+4>>2];n=q[y+15|0]&1;o=A+-64|0;A=o;t[o+56>>2]=y+26;t[o+52>>2]=p;t[o+48>>2]=l;t[o+44>>2]=r;t[o+40>>2]=m;q[o+39|0]=2;q[o+38|0]=13;t[o+32>>2]=y+12;q[o+31|0]=n;q[o+30|0]=2;b:{c:{if(!(!t[o+52>>2]|(!t[o+44>>2]|!t[o+40>>2]))&&w[o+48>>2]<=16777215)break c;t[o+60>>2]=5;break b}t[o+24>>2]=t[o+48>>2]+(u[o+39|0]+(u[o+30|0]+4|0)|0);z=o,x=D(t[o+24>>2]),t[z+20>>2]=x;if(!t[o+20>>2]){t[o+60>>2]=3;break b}t[o+16>>2]=t[o+20>>2];q[t[o+16>>2]]=u[o+38|0];t[o+16>>2]=t[o+16>>2]+1;ba(t[o+16>>2],t[o+56>>2],u[o+30|0]);t[o+16>>2]=u[o+30|0]+t[o+16>>2];t[o+12>>2]=u[o+39|0]+t[o+48>>2];if(w[o+12>>2]<w[o+48>>2]){J(t[o+20>>2]);t[o+60>>2]=9;break b}p=t[o+16>>2];l=u[o+12|0]|u[o+13|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+14|0];t[o+16>>2]=t[o+16>>2]+3;if(q[o+31|0]&1)d:{if(u[o+38|0]==6){p=t[o+32>>2];q[p|0]=u[p|0]|128;break d}e:{if(u[o+38|0]==13){p=t[o+32>>2];s[p>>1]=v[p>>1]|32768;break e}J(t[o+20>>2]);t[o+60>>2]=1;break b}}ba(t[o+16>>2],t[o+32>>2],u[o+39|0]);t[o+16>>2]=u[o+39|0]+t[o+16>>2];ba(t[o+16>>2],t[o+52>>2],t[o+48>>2]);t[t[o+44>>2]>>2]=t[o+20>>2];t[t[o+40>>2]>>2]=t[o+24>>2];t[o+60>>2]=0}A=o- -64|0;t[y+28>>2]=t[o+60>>2]}A=y+32|0;return t[y+28>>2]}function F(o,p,l,r,m){o=o|0;p=p|0;l=l|0;r=r|0;m=m|0;var n=0,v=0;n=A-32|0;A=n;s[n+30>>1]=o;t[n+24>>2]=p;t[n+20>>2]=l;t[n+16>>2]=r;t[n+12>>2]=m;p=t[n+24>>2];l=t[n+20>>2];r=t[n+16>>2];m=t[n+12>>2];o=A-48|0;A=o;t[o+40>>2]=n+30;t[o+36>>2]=p;t[o+32>>2]=l;t[o+28>>2]=r;t[o+24>>2]=m;q[o+23|0]=2;q[o+22|0]=15;a:{if(!(t[o+24>>2]?t[o+28>>2]:0)){t[o+44>>2]=5;break a}t[t[o+28>>2]>>2]=0;t[t[o+24>>2]>>2]=0;if(!(w[o+32>>2]<=16777215?t[o+36>>2]:0)){t[o+44>>2]=5;break a}t[o+16>>2]=t[o+32>>2]+(u[o+23|0]+4|0);v=o,r=D(t[o+16>>2]),t[v+12>>2]=r;if(!t[o+12>>2]){t[o+44>>2]=3;break a}t[o+8>>2]=t[o+12>>2];q[t[o+8>>2]]=u[o+22|0];t[o+8>>2]=t[o+8>>2]+1;ba(t[o+8>>2],t[o+40>>2],u[o+23|0]);t[o+8>>2]=u[o+23|0]+t[o+8>>2];p=t[o+8>>2];l=u[o+32|0]|u[o+33|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+34|0];t[o+8>>2]=t[o+8>>2]+3;ba(t[o+8>>2],t[o+36>>2],t[o+32>>2]);t[o+8>>2]=t[o+32>>2]+t[o+8>>2];t[t[o+28>>2]>>2]=t[o+12>>2];t[t[o+24>>2]>>2]=t[o+16>>2];t[o+44>>2]=0}A=o+48|0;A=n+32|0;return t[o+44>>2]}function G(o){var p=0,l,r=0,m=0,n,s=0;r=t[343];l=o+3&-4;p=r+l|0;a:{b:{if(p>>>0<=r>>>0?l:0)break b;if(p>>>0>wa()<<16>>>0&&!(z(p|0)|0))break b;t[343]=p;break a}t[604]=48;r=-1}if((r|0)!=-1){l=o+r|0;p=l-16|0;t[p+12>>2]=16;t[p>>2]=16;o=t[600];o?s=t[o+8>>2]:s=0;c:{d:{if((s|0)==(r|0)){m=r-(t[r-4>>2]&-2)|0;n=t[m-4>>2];t[o+8>>2]=l;o=m-(n&-2)|0;l=-16;if(!(q[(o+t[o>>2]|0)-4|0]&1))break d;l=t[o+4>>2];t[l+8>>2]=t[o+8>>2];t[t[o+8>>2]+4>>2]=l;p=p-o|0;t[o>>2]=p;break c}t[r+12>>2]=16;t[r>>2]=16;t[r+8>>2]=l;t[r+4>>2]=o;t[600]=r;l=16}o=r+l|0;p=p-o|0;t[o>>2]=p}t[((p&-4)+o|0)-4>>2]=p|1;s=o;m=t[o>>2]-8|0;e:{if(m>>>0<=127){p=(m>>>3|0)-1|0;break e}n=y(m);p=((m>>>29-n^4)-(n<<2)|0)+110|0;if(m>>>0<=4095)break e;p=((m>>>30-n^2)-(n<<1)|0)+71|0;p=p>>>0<63?p:63}l=p<<4;t[s+4>>2]=l+1376;l=l+1384|0;t[o+8>>2]=t[l>>2];t[l>>2]=o;t[t[o+8>>2]+4>>2]=o;l=t[603];o=p&31;(p&63)>>>0>=32?(p=1<<o,o=0):(p=(1<<o)-1&1>>>32-o,o=1<<o);t[602]=o|t[602];t[603]=p|l}return(r|0)!=-1}function la(o,p,l,r){o=o|0;p=p|0;l=l|0;r=r|0;var m=0,n=0;m=A-16|0;A=m;s[m+10>>1]=o;s[m+8>>1]=p;t[m+4>>2]=l;t[m>>2]=r;a:{if(v[m+8>>1]>32767){t[m+12>>2]=4;break a}p=t[m+4>>2];l=t[m>>2];o=A-48|0;A=o;t[o+40>>2]=m+10;t[o+36>>2]=p;t[o+32>>2]=l;q[o+31|0]=2;q[o+30|0]=12;t[o+24>>2]=m+8;q[o+23|0]=2;b:{if(!(t[o+32>>2]?t[o+36>>2]:0)){t[o+44>>2]=5;break b}t[o+16>>2]=u[o+31|0]+(u[o+23|0]+4|0);n=o,r=D(t[o+16>>2]),t[n+12>>2]=r;if(!t[o+12>>2]){t[o+44>>2]=3;break b}t[o+8>>2]=t[o+12>>2];q[t[o+8>>2]]=u[o+30|0];t[o+8>>2]=t[o+8>>2]+1;ba(t[o+8>>2],t[o+40>>2],u[o+23|0]);t[o+8>>2]=u[o+23|0]+t[o+8>>2];t[o+4>>2]=u[o+31|0];p=t[o+8>>2];l=u[o+4|0]|u[o+5|0]<<8;q[p|0]=l;q[p+1|0]=l>>>8;q[p+2|0]=u[o+6|0];t[o+8>>2]=t[o+8>>2]+3;ba(t[o+8>>2],t[o+24>>2],u[o+31|0]);t[t[o+32>>2]>>2]=t[o+16>>2];t[t[o+36>>2]>>2]=t[o+12>>2];t[o+44>>2]=0}A=o+48|0;t[m+12>>2]=t[o+44>>2]}A=m+16|0;return t[m+12>>2]}function H(o,p,l){o=o|0;p=p|0;l=l|0;var q=0,m=0,n=0,r=0,s=0;n=A+-64|0;A=n;m=1;a:{if(R(o,p,0))break a;m=0;if(!p)break a;q=A+-64|0;A=q;m=t[p>>2];r=t[m-4>>2];s=t[m-8>>2];t[q+20>>2]=0;t[q+16>>2]=1084;t[q+12>>2]=p;t[q+8>>2]=1132;m=0;ca(q+24|0,39);p=p+s|0;b:{if(R(r,1132,0)){t[q+56>>2]=1;ka[t[t[r>>2]+20>>2]](r,q+8|0,p,p,1,0);m=t[q+32>>2]==1?p:0;break b}ka[t[t[r>>2]+24>>2]](r,q+8|0,p,1,0);c:switch(t[q+44>>2]){case 0:m=t[q+48>>2]==1?t[q+36>>2]==1?t[q+40>>2]==1?t[q+28>>2]:0:0:0;break b;case 1:break c;default:break b}if(t[q+48>>2]|t[q+36>>2]!=1|t[q+40>>2]!=1?t[q+32>>2]!=1:0)break b;m=t[q+24>>2]}A=q- -64|0;p=m;m=0;if(!p)break a;ca(n+8|4,52);t[n+56>>2]=1;t[n+20>>2]=-1;t[n+16>>2]=o;t[n+8>>2]=p;ka[t[t[p>>2]+28>>2]](p,n+8|0,t[l>>2],1);o=t[n+32>>2];(o|0)==1&&(t[l>>2]=t[n+24>>2]);m=(o|0)==1}o=m;A=n- -64|0;return o|0}function I(o,p,l){var q=0,m,n=0,r=0;q=o+4|0;m=(q+p|0)-1&0-p;p=t[o>>2];if(m+l>>>0<=(p+o|0)-4>>>0){n=t[o+4>>2];t[n+8>>2]=t[o+8>>2];t[t[o+8>>2]+4>>2]=n;(q|0)!=(m|0)&&(m=m-q|0,n=o-(t[o-4>>2]&-2)|0,q=m+t[n>>2]|0,t[n>>2]=q,t[(n+(q&-4)|0)-4>>2]=q,o=o+m|0,p=p-m|0,t[o>>2]=p);a:{if(l+24>>>0<=p>>>0){q=(o+l|0)+8|0;p=(p-l|0)-8|0;t[q>>2]=p;t[(q+(p&-4)|0)-4>>2]=p|1;r=q;n=t[q>>2]-8|0;b:{if(n>>>0<=127){m=(n>>>3|0)-1|0;break b}p=y(n);m=((n>>>29-p^4)-(p<<2)|0)+110|0;if(n>>>0<=4095)break b;p=((n>>>30-p^2)-(p<<1)|0)+71|0;m=p>>>0<63?p:63}p=m;m=p<<4;t[r+4>>2]=m+1376;m=m+1384|0;t[q+8>>2]=t[m>>2];t[m>>2]=q;t[t[q+8>>2]+4>>2]=q;m=t[603];q=p&31;(p&63)>>>0>=32?(p=1<<q,r=0):(p=(1<<q)-1&1>>>32-q,r=1<<q);t[602]=r|t[602];t[603]=p|m;p=l+8|0;t[o>>2]=p;t[((p&-4)+o|0)-4>>2]=p;break a}t[(o+p|0)-4>>2]=p}o=o+4|0}else o=0;return o}function J(o){var p=0,l,q=0,m,n=0;if(o){l=o-4|0;m=t[l>>2];q=m;p=l;n=t[o-8>>2];o=n&-2;(o|0)!=(n|0)&&(p=l-o|0,q=t[p+4>>2],t[q+8>>2]=t[p+8>>2],t[t[p+8>>2]+4>>2]=q,q=o+m|0);o=l+m|0;l=t[o>>2];(l|0)!=t[(o+l|0)-4>>2]&&(m=t[o+4>>2],t[m+8>>2]=t[o+8>>2],t[t[o+8>>2]+4>>2]=m,q=q+l|0);t[p>>2]=q;t[((q&-4)+p|0)-4>>2]=q|1;n=p;q=t[p>>2]-8|0;a:{if(q>>>0<=127){o=(q>>>3|0)-1|0;break a}m=y(q);o=((q>>>29-m^4)-(m<<2)|0)+110|0;if(q>>>0<=4095)break a;o=((q>>>30-m^2)-(m<<1)|0)+71|0;o=o>>>0<63?o:63}l=o<<4;t[n+4>>2]=l+1376;l=l+1384|0;t[p+8>>2]=t[l>>2];t[l>>2]=p;t[t[p+8>>2]+4>>2]=p;l=t[603];p=o&31;(o&63)>>>0>=32?(o=1<<p,p=0):(o=(1<<p)-1&1>>>32-p,p=1<<p);t[602]=p|t[602];t[603]=o|l}}function K(n,o,l){n=n|0;o=o|0;l=l|0;var p=0,m=0;p=A-48|0;A=p;t[p+40>>2]=n;t[p+36>>2]=o;t[p+32>>2]=l;a:{if(!(t[p+32>>2]?t[p+36>>2]:0)){t[p+44>>2]=5;break a}if(w[p+40>>2]>4){t[p+44>>2]=8;break a}t[p+28>>2]=5;m=p,l=D(t[p+28>>2]),t[m+24>>2]=l;if(!t[p+24>>2]){t[p+44>>2]=3;break a}t[p+20>>2]=t[p+24>>2];q[p+19|0]=3;q[t[p+20>>2]]=u[p+19|0];t[p+20>>2]=t[p+20>>2]+1;t[p+12>>2]=1;n=t[p+20>>2];o=u[p+12|0]|u[p+13|0]<<8;q[n|0]=o;q[n+1|0]=o>>>8;q[n+2|0]=u[p+14|0];t[p+20>>2]=t[p+20>>2]+3;q[p+11|0]=t[p+40>>2];q[t[p+20>>2]]=u[p+11|0];t[t[p+36>>2]>>2]=t[p+24>>2];t[t[p+32>>2]>>2]=t[p+28>>2];t[p+44>>2]=0}A=p+48|0;return t[p+44>>2]}function L(n,o,l,p,m){n=n|0;o=o|0;l=l|0;p=p|0;m=m|0;if(R(n,t[o+8>>2],m)){da(o,l,p);return}a:{if(R(n,t[o>>2],m)){if(!(t[o+20>>2]!=(l|0)?t[o+16>>2]!=(l|0):0)){if((p|0)!=1)break a;t[o+32>>2]=1;return}t[o+32>>2]=p;b:{if(t[o+44>>2]==4)break b;s[o+52>>1]=0;n=t[n+8>>2];ka[t[t[n>>2]+20>>2]](n,o,l,l,1,m);if(u[o+53|0]){t[o+44>>2]=3;if(!u[o+52|0])break b;break a}t[o+44>>2]=4}t[o+20>>2]=l;t[o+40>>2]=t[o+40>>2]+1;if(t[o+36>>2]!=1|t[o+24>>2]!=2)break a;q[o+54|0]=1;return}n=t[n+8>>2];ka[t[t[n>>2]+24>>2]](n,o,l,p,m)}}function M(o,p,l,q,m){var n=0;n=A-32|0;A=n;t[n+24>>2]=o;t[n+20>>2]=p;t[n+16>>2]=l;t[n+12>>2]=q;t[n+8>>2]=m;a:{if(w[n+16>>2]<1){t[n+28>>2]=9;break a}t[t[n+8>>2]>>2]=t[n+16>>2]-1;if(w[t[n+20>>2]>>2]<w[t[n+8>>2]>>2]){t[n+28>>2]=1;break a}o=D(t[t[n+8>>2]>>2]);t[t[n+12>>2]>>2]=o;if(!t[t[n+12>>2]>>2]){t[n+28>>2]=3;break a}ba(t[t[n+12>>2]>>2],t[t[n+24>>2]>>2],t[t[n+8>>2]>>2]);o=t[n+24>>2];t[o>>2]=t[t[n+8>>2]>>2]+t[o>>2];o=t[n+20>>2];t[o>>2]=t[o>>2]-t[t[n+8>>2]>>2];t[n+28>>2]=0}A=n+32|0;return t[n+28>>2]}function N(n,o,l){n=n|0;o=o|0;l=l|0;var p=0,m=0;p=A-32|0;A=p;s[p+26>>1]=n;t[p+20>>2]=o;t[p+16>>2]=l;t[t[p+16>>2]>>2]=3;m=p,l=D(t[t[p+16>>2]>>2]),t[m+12>>2]=l;a:{if(!t[p+12>>2]){t[p+28>>2]=3;break a}t[t[p+20>>2]>>2]=t[p+12>>2];q[p+11|0]=14;q[t[p+12>>2]]=u[p+11|0];t[p+12>>2]=t[p+12>>2]+1;n=t[p+12>>2];o=u[p+26|0]|u[p+27|0]<<8;q[n|0]=o;q[n+1|0]=o>>>8;t[p+28>>2]=0}A=p+32|0;return t[p+28>>2]}function O(m,n){var l=0;l=A-16|0;A=l;t[l+12>>2]=m;t[l+8>>2]=n;t[l+4>>2]=0;while(1){if(w[l+4>>2]<w[l+8>>2]){t[l>>2]=t[l+12>>2]+x(t[l+4>>2],20);a:{if(!(t[t[l>>2]>>2]&15)){J(t[t[l>>2]+8>>2]);break a}b:{if((t[t[l>>2]>>2]&15)==5){J(t[t[l>>2]+8>>2]);break b}(t[t[l>>2]>>2]&15)==6&&J(t[t[l>>2]+12>>2])}}t[l+4>>2]=t[l+4>>2]+1;continue}break}J(t[l+12>>2]);A=l+16|0}function P(m,n,l,o){q[m+53|0]=1;a:{if(t[m+4>>2]!=(l|0))break a;q[m+52|0]=1;l=t[m+16>>2];if(!l){t[m+36>>2]=1;t[m+24>>2]=o;t[m+16>>2]=n;if((o|0)!=1|t[m+48>>2]!=1)break a;q[m+54|0]=1;return}if((n|0)==(l|0)){l=t[m+24>>2];(l|0)==2&&(t[m+24>>2]=o,l=o);if(t[m+48>>2]!=1|(l|0)!=1)break a;q[m+54|0]=1;return}q[m+54|0]=1;t[m+36>>2]=t[m+36>>2]+1}}function Q(n,o,l,p){var m;m=A-32|0;t[m+24>>2]=n;t[m+20>>2]=o;t[m+16>>2]=l;t[m+12>>2]=p;q[m+11|0]=0;a:{if(w[t[m+20>>2]>>2]<1){t[m+28>>2]=1;break a}q[m+11|0]=u[t[t[m+24>>2]>>2]];n=t[m+24>>2];t[n>>2]=t[n>>2]+1;n=t[m+20>>2];t[n>>2]=t[n>>2]-1;q[t[m+16>>2]]=(u[m+11|0]&128)==128;q[t[m+12>>2]]=u[m+11|0]&127;t[m+28>>2]=0}return t[m+28>>2]}function ma(n,o,l,p,m){n=n|0;o=o|0;l=l|0;p=p|0;m=m|0;if(R(n,t[o+8>>2],m)){da(o,l,p);return}a:{if(!R(n,t[o>>2],m))break a;if(!(t[o+20>>2]!=(l|0)?t[o+16>>2]!=(l|0):0)){if((p|0)!=1)break a;t[o+32>>2]=1;return}t[o+20>>2]=l;t[o+32>>2]=p;t[o+40>>2]=t[o+40>>2]+1;t[o+36>>2]!=1|t[o+24>>2]!=2||(q[o+54|0]=1);t[o+44>>2]=4}}function R(m,n,l){var o;if(!l)return t[m+4>>2]==t[n+4>>2];if((m|0)==(n|0))return 1;l=t[m+4>>2];m=u[l|0];n=t[n+4>>2];o=u[n|0];a:{if(!m|(o|0)!=(m|0))break a;while(1){o=u[n+1|0];m=u[l+1|0];if(!m)break a;n=n+1|0;l=l+1|0;if((m|0)==(o|0))continue;break}}return(m|0)==(o|0)}function na(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=9;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function S(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=10;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function T(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=2;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function U(m,n){m=m|0;n=n|0;var l=0,o=0;l=A-32|0;A=l;t[l+24>>2]=m;t[l+20>>2]=n;o=l,m=D(1),t[o+16>>2]=m;a:{if(!t[l+16>>2]){t[l+28>>2]=3;break a}q[l+15|0]=4;q[t[l+16>>2]]=u[l+15|0];t[t[l+24>>2]>>2]=t[l+16>>2];t[t[l+20>>2]>>2]=1;t[l+28>>2]=0}A=l+32|0;return t[l+28>>2]}function V(l){var m=0;m=A-16|0;A=m;t[m+12>>2]=l;l=1;a:{if(X(t[m+12>>2])&1)break a;l=1;if(t[m+12>>2]==15)break a;l=1;if(t[m+12>>2]==13)break a;l=1;if(t[m+12>>2]==12)break a;l=t[m+12>>2]==14}A=m+16|0;return l}function W(m,n,l){var o;o=t[m+16>>2];if(!o){t[m+36>>2]=1;t[m+24>>2]=l;t[m+16>>2]=n;return}a:{if((n|0)==(o|0)){if(t[m+24>>2]!=2)break a;t[m+24>>2]=l;return}q[m+54|0]=1;t[m+24>>2]=2;t[m+36>>2]=t[m+36>>2]+1}}function X(l){var m;m=A-16|0;t[m+12>>2]=l;l=1;a:{if(t[m+12>>2]==5)break a;l=1;if(t[m+12>>2]==6)break a;l=1;if(t[m+12>>2]==7)break a;l=t[m+12>>2]==8}return l}function Y(o,p,l,q,m,n){o=o|0;p=p|0;l=l|0;q=q|0;m=m|0;n=n|0;if(R(o,t[p+8>>2],n)){P(p,l,q,m);return}o=t[o+8>>2];ka[t[t[o>>2]+20>>2]](o,p,l,q,m,n)}function Z(){var m=0,n,l;while(1){n=m<<4;l=n+1376|0;t[n+1380>>2]=l;t[n+1384>>2]=l;m=m+1|0;if((m|0)!=64)continue;break}G(48)}function $(m,n,l,o){m=m|0;n=n|0;l=l|0;o=o|0;if(R(m,t[n+8>>2],0)){W(n,l,o);return}m=t[m+8>>2];ka[t[t[m>>2]+28>>2]](m,n,l,o)}function aa(o,p,l,q,m,n){o=o|0,p=p|0,l=l|0,q=q|0,m=m|0,n=n|0,R(o,t[p+8>>2],n)&&P(p,l,q,m)}function ba(m,n,l){if(l)while(1){q[m|0]=u[n|0];m=m+1|0;n=n+1|0;l=l-1|0;if(l)continue;break}}function ca(l,m){if(m)while(1){q[l|0]=0;l=l+1|0;m=m-1|0;if(m)continue;break}}function oa(m,n,l,o){m=m|0,n=n|0,l=l|0,o=o|0,R(m,t[n+8>>2],0)&&W(n,l,o)}function da(m,n,l){t[m+28>>2]==1|t[m+4>>2]!=(n|0)||(t[m+28>>2]=l)}function pa(l,m){l=l|0;m=m|0;return x(m,20)+l|0}function ea(l){l=l|0;return v[l+8>>1]>>>1|0}function qa(l){l=l|0;return s[l+8>>1]&1}function fa(l){l=l|0;return t[l+12>>2]}function ra(l){l=l|0;return t[l>>2]&15}function sa(l){l=l|0;return t[l+16>>2]}function ga(l){l=l|0;return v[l+4>>1]}function ha(l){l=l|0;return t[l+8>>2]}function ia(l){l=l|0;return u[l+4|0]}function ja(l){l=l|0;return l|0}function ta(l){return D(l)}function ua(l){l=l|0,J(l)}function va(l){l|0}n=u;r(l);var ka=m([null,ja,ua,va,va,H,aa,ma,oa,ua,Y,L,$]);function wa(){return p.byteLength/65536|0}function xa(l){l=l|0;var m=wa()|0;l=m+l|0;if(m<l&&l<65536){l=new ArrayBuffer(x(l,65536));var r=new Int8Array(l);r.set(q);q=new Int8Array(l);s=new Int16Array(l);t=new Int32Array(l);u=new Uint8Array(l);v=new Uint16Array(l);w=new Uint32Array(l);new Float32Array(l);new Float64Array(l);p=l;o.buffer=p;n=u}return m}return{c:Z,d:ta,e:ua,f:T,g:U,h:K,i:F,j:N,k:E,l:la,m:na,n:S,o:C,p:ra,q:ia,r:pa,s:ga,t:ha,u:fa,v:fa,w:sa,x:ea,y:qa,z:ea,A:ka}}return s(l)}(ha)},instantiate:function(l,m){return{then:function(n){var m=new D.Module(l);n({instance:new D.Instance(m)})}}},RuntimeError:Error};C=[];typeof D!=="object"&&Y("no native wasm support detected");var E,F=!1;function G(l,m){l||Y("Assertion failed: "+m)}function la(l,m){l%m>0&&(l+=m-l%m);return l}var H,I;function J(l){H=l,m.HEAP8=new Int8Array(l),m.HEAP16=new Int16Array(l),m.HEAP32=new Int32Array(l),m.HEAPU8=I=new Uint8Array(l),m.HEAPU16=new Uint16Array(l),m.HEAPU32=new Uint32Array(l),m.HEAPF32=new Float32Array(l),m.HEAPF64=new Float64Array(l)}u=m.INITIAL_MEMORY||2097152;m.wasmMemory?E=m.wasmMemory:E=new D.Memory({initial:u/65536,maximum:2147483648/65536});E&&(H=E.buffer);H.byteLength;J(H);var K,L=[],M=[],N=[];function O(){if(m.preRun){typeof m.preRun=="function"&&(m.preRun=[m.preRun]);while(m.preRun.length)ma(m.preRun.shift())}da(L)}function P(){da(M)}function Q(){if(m.postRun){typeof m.postRun=="function"&&(m.postRun=[m.postRun]);while(m.postRun.length)na(m.postRun.shift())}da(N)}function ma(l){L.unshift(l)}function R(l){M.unshift(l)}function na(l){N.unshift(l)}(!Math.imul||Math.imul(4294967295,5)!==-5)&&(Math.imul=function(l,m){var n=l>>>16;l=l&65535;var o=m>>>16;m=m&65535;return l*m+(n*m+l*o<<16)|0});if(!Math.fround){var S=new Float32Array(1);Math.fround=function(l){S[0]=l;return S[0]}}Math.clz32||(Math.clz32=function(l){var m=32,n=l>>16;n&&(m-=16,l=n);n=l>>8;n&&(m-=8,l=n);n=l>>4;n&&(m-=4,l=n);n=l>>2;n&&(m-=2,l=n);n=l>>1;return n?m-2:m-l});Math.trunc||(Math.trunc=function(l){return l<0?Math.ceil(l):Math.floor(l)});var T=0,U=null,V=null;function W(l){T++,m.monitorRunDependencies&&m.monitorRunDependencies(T)}function X(l){T--;m.monitorRunDependencies&&m.monitorRunDependencies(T);if(T==0){U!==null&&(clearInterval(U),U=null);if(V){l=V;V=null;l()}}}m.preloadedImages={};m.preloadedAudios={};function Y(l){m.onAbort&&m.onAbort(l);l+="";B(l);F=!0;l="abort("+l+"). Build with -s ASSERTIONS=1 for more info.";l=new D.RuntimeError(l);s(l);throw l}var Z="data:application/octet-stream;base64,";function $(l){return l.startsWith(Z)}var aa="dgwcppbridge.wasm";$(aa)||(aa=z(aa));function ba(l){try{if(l==aa&&C)return new Uint8Array(C);var m=ga(l);if(m)return m;if(A)return A(l);else throw"both async and sync fetching of the wasm failed"}catch(l){Y(l)}}function ca(){return!C&&(w||x)&&typeof fetch==="function"?fetch(aa,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+aa+"'";return l.arrayBuffer()})["catch"](function(){return ba(aa)}):n.resolve().then(function(){return ba(aa)})}function oa(){var n={a:ha};function o(n,l){l=n.exports;m.asm=l;K=m.asm.A;R(m.asm.c);X("wasm-instantiate")}W("wasm-instantiate");function r(l){o(l.instance)}function t(l){return ca().then(function(l){l=D.instantiate(l,n);return l}).then(l,function(l){B("failed to asynchronously prepare wasm: "+l),Y(l)})}function u(){if(!C&&typeof D.instantiateStreaming==="function"&&!$(aa)&&typeof fetch==="function")return fetch(aa,{credentials:"same-origin"}).then(function(l){l=D.instantiateStreaming(l,n);return l.then(r,function(l){B("wasm streaming compile failed: "+l);B("falling back to ArrayBuffer instantiation");return t(r)})});else return t(r)}if(m.instantiateWasm)try{var l=m.instantiateWasm(n,o);return l}catch(l){B("Module.instantiateWasm callback failed with error: "+l);return!1}u()["catch"](s);return{}}function da(l){while(l.length>0){var n=l.shift();if(typeof n=="function"){n(m);continue}var o=n.func;typeof o==="number"?n.arg===void 0?K.get(o)():K.get(o)(n.arg):o(n.arg===void 0?null:n.arg)}}function pa(l){try{E.grow(l-H.byteLength+65535>>>16);J(E.buffer);return 1}catch(l){}}function ea(l){var m=I.length;l=l>>>0;var n=2147483648;if(l>n)return!1;for(var o=1;o<=4;o*=2){var p=m*(1+.2/o);p=Math.min(p,l+100663296);p=Math.min(n,la(Math.max(l,p),65536));p=pa(p);if(p)return!0}return!1}var qa=!1;function fa(l){var m=[];for(var n=0;n<l.length;n++){var o=l[n];o>255&&(qa&&G(!1,"Character code "+o+" ("+String.fromCharCode(o)+")  at offset "+n+" not in 0x00-0xFF."),o&=255);m.push(String.fromCharCode(o))}return m.join("")}var ra=typeof atob==="function"?atob:function(l){var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="",o,p,q,r,s,t=0;l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");do p=m.indexOf(l.charAt(t++)),q=m.indexOf(l.charAt(t++)),r=m.indexOf(l.charAt(t++)),s=m.indexOf(l.charAt(t++)),p=p<<2|q>>4,q=(q&15)<<4|r>>2,o=(r&3)<<6|s,n=n+String.fromCharCode(p),r!==64&&(n=n+String.fromCharCode(q)),s!==64&&(n=n+String.fromCharCode(o));while(t<l.length);return n};function sa(l){try{l=ra(l);var m=new Uint8Array(l.length);for(var n=0;n<l.length;++n)m[n]=l.charCodeAt(n);return m}catch(l){throw new Error("Converting base64 string to bytes failed.")}}function ga(l){if(!$(l))return;return sa(l.slice(Z.length))}var ha={b:ea,a:E};oa();m.___wasm_call_ctors=function(){return(m.___wasm_call_ctors=m.asm.c).apply(null,arguments)};m.__malloc=function(){return(m.__malloc=m.asm.d).apply(null,arguments)};m.__free=function(){return(m.__free=m.asm.e).apply(null,arguments)};m.__DgwCodecEncodeEmpty=function(){return(m.__DgwCodecEncodeEmpty=m.asm.f).apply(null,arguments)};m.__DgwCodecEncodeDeauth=function(){return(m.__DgwCodecEncodeDeauth=m.asm.g).apply(null,arguments)};m.__DgwCodecEncodeDrain=function(){return(m.__DgwCodecEncodeDrain=m.asm.h).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_EstabStream=function(){return(m.__DgwCodecEncodeStreamGroup_EstabStream=m.asm.i).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_EndOfData=function(){return(m.__DgwCodecEncodeStreamGroup_EndOfData=m.asm.j).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_Data=function(){return(m.__DgwCodecEncodeStreamGroup_Data=m.asm.k).apply(null,arguments)};m.__DgwCodecEncodeStreamGroup_Ack=function(){return(m.__DgwCodecEncodeStreamGroup_Ack=m.asm.l).apply(null,arguments)};m.__DgwCodecEncodePing=function(){return(m.__DgwCodecEncodePing=m.asm.m).apply(null,arguments)};m.__DgwCodecEncodePong=function(){return(m.__DgwCodecEncodePong=m.asm.n).apply(null,arguments)};m.__DgwCodecDecode=function(){return(m.__DgwCodecDecode=m.asm.o).apply(null,arguments)};m.__getFrameType=function(){return(m.__getFrameType=m.asm.p).apply(null,arguments)};m.__getDrainReasonFromDrainFrame=function(){return(m.__getDrainReasonFromDrainFrame=m.asm.q).apply(null,arguments)};m.__getDGWFramePtr=function(){return(m.__getDGWFramePtr=m.asm.r).apply(null,arguments)};m.__getStreamIdFromStreamGroupFrame=function(){return(m.__getStreamIdFromStreamGroupFrame=m.asm.s).apply(null,arguments)};m.__getEncodedParamsFromEstablishStreamFrame=function(){return(m.__getEncodedParamsFromEstablishStreamFrame=m.asm.t).apply(null,arguments)};m.__getEncodedParamsSizeFromEstablishStreamFrame=function(){return(m.__getEncodedParamsSizeFromEstablishStreamFrame=m.asm.u).apply(null,arguments)};m.__getDataFromGroupedStreamDataFrame=function(){return(m.__getDataFromGroupedStreamDataFrame=m.asm.v).apply(null,arguments)};m.__getDataSizeFromGroupedStreamDataFrame=function(){return(m.__getDataSizeFromGroupedStreamDataFrame=m.asm.w).apply(null,arguments)};m.__getAckIdFromGroupedStreamDataFrame=function(){return(m.__getAckIdFromGroupedStreamDataFrame=m.asm.x).apply(null,arguments)};m.__getRequiresAckFromGroupedStreamDataFrame=function(){return(m.__getRequiresAckFromGroupedStreamDataFrame=m.asm.y).apply(null,arguments)};m.__getAckIdFromGroupedStreamAckFrame=function(){return(m.__getAckIdFromGroupedStreamAckFrame=m.asm.z).apply(null,arguments)};var ia;V=function l(){ia||ja(),ia||(V=l)};function ja(l){l||v;if(T>0)return;O();if(T>0)return;function n(){if(ia)return;ia=!0;m.calledRun=!0;if(F)return;P();o(m);m.onRuntimeInitialized&&m.onRuntimeInitialized();Q()}m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),n()},1)):n()}m.run=ja;if(m.preInit){typeof m.preInit=="function"&&(m.preInit=[m.preInit]);while(m.preInit.length>0)m.preInit.pop()()}ja();return m.ready}}();typeof q==="object"&&typeof p==="object"?p.exports=r:typeof define==="function"&&define.amd?define([],function(){return r}):typeof q==="object"&&(q.Module=r)}),null);
__d("DGWUtils",["Base64","DGWConstants","DGWCppBridge","DGWLoggingContext","Random","URI"],(function(a,b,c,d,e,f,g){"use strict";var h,i=4;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=d("Random").random()*16|0;a=a==="x"?b:b&3|8;return a.toString(16)})}function j(a){var b=new TextDecoder();b=b.decode(a);a=c("Base64").encode(b);b=a.replace(/\+/gi,"-").replace(/\//gi,"_").replace(/=/gi,"");return b}var k=null,l=null;function m(){l==null&&(l=Promise.resolve().then(function(){return c("DGWCppBridge")()}).then(function(a){k=a}));return l}b=function(){function a(){}a.initialize=async function(){return m()};a.constructConnectUrl=function(a){var b,e,f=a.appId,g=a.appVersion,i=a.authType,k=a.deviceId,l=a.dgwVersion,m=a.fbId,n=a.tier,o=a.loggingId,p=a.headers,q=a.endpoint,r=a.serviceId,s=a.regionHint,t=a.establishStreamFrame,u=a.trafficTracing;a=a.authToken;var v=(b={},b[(e=d("DGWConstants")).HEADER_CONSTANTS.HEADER_APPID]=f,b[e.HEADER_CONSTANTS.HEADER_APPVERSION]=g,b[e.HEADER_CONSTANTS.HEADER_AUTHTYPE]=i,b[e.HEADER_CONSTANTS.HEADER_DGW_VERSION]=""+l,b[e.HEADER_CONSTANTS.HEADER_UUID]=m,b[e.HEADER_CONSTANTS.HEADER_TARGET_TIER]=n,b);t!==void 0&&(v[d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64]=j(t));o!==void 0&&(v[d("DGWConstants").HEADER_CONSTANTS.HEADER_LOGGING_ID]=o);s!==void 0&&(v[d("DGWConstants").HEADER_CONSTANTS.HEADER_REGIONHINT]=s);k!==void 0&&(v[d("DGWConstants").HEADER_CONSTANTS.HEADER_DEVICE_ID]=k);u!==void 0&&(v[d("DGWConstants").HEADER_CONSTANTS.TRAFFIC_TRACING]="debug:"+u);a!==void 0&&(v[d("DGWConstants").HEADER_CONSTANTS.HEADER_AUTHTOKEN]=a);Object.keys(p).forEach(function(a){var b=d("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+a;Object.prototype.hasOwnProperty.call(v,b)||(v[b]=p[a])});f=new(h||(h=c("URI")))(q);f.setQueryData(v);f.setPath(f.getPath()+"/"+r);f.toString().length>2e3&&(delete v[d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64],f.setQueryData(v));return f.toStringRawQuery()};return a}();e=function(){function a(a,b,c){this.$1=null,this.$2=a,this.$3=b,this.$4=c}a.initialize=async function(){return m()};var b=a.prototype;b.malloc=function(a){try{a=k.__malloc(a);if(a===0){var b;(b=this.$2)==null||b.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","malloc returned 0");return-1}return a}catch(a){(b=this.$2)==null||b.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"wasm malloc failure","exception during malloc",a.toString());return-1}};b.free=function(a){k.__free(a)};b.append=function(a){if(this.$1==null){this.$1=a;return}var b=this.$1.length,c=new Uint8Array(b+a.length);c.set(this.$1,0);c.set(a,b);this.$1=c};b.processData=function(){var a=this;if(this.$1==null)return;var b=this.$1.length,c=this.malloc(b);if(c===-1)return;var e=k.HEAPU8.subarray(c,c+b);if(this.$1)for(var f=0;f<e.length;++f)e[f]=this.$1[f];f=this.malloc(i*4);if(f===-1)return;e=f;var g=e+i,h=g+i,j=h+i;b=k.__DgwCodecDecode(c,b,e,g,h,j);this.free(c);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){this.free(f);(h=this.$2)==null||h.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Codec Decode Failure","Failed to decode Frame(s). Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b));return}c=k.HEAPU32.subarray(j/i,j/i+1)[0];if(this.$1==null){this.free(f);return}h=this.$1.length-c;if(this.$1&&this.$1.length>h){this.$1=new Uint8Array(((b=this.$1)==null?void 0:b.subarray(h))||[])}else this.$1=null;j=k.HEAPU32.subarray(g/i,g/i+1)[0];var l=k.HEAPU32.subarray(e/i,e/i+1)[0],m=[];c=function(){var b=k.__getDGWFramePtr(l,n),c=k.__getFrameType(b);switch(c){case d("DGWConstants").DgwFrameType.DgwFrameType_Drain:c=k.__getDrainReasonFromDrainFrame(b);var e=d("DGWConstants").drainReasonToDrainReasonString(c);(c=a.$2)==null||c.logEvent(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Drain Frame from server","DrainReason: "+e);m.push(function(){var b;return(b=a.$3)==null?void 0:b.receivedDrainSignal(e)});break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EstabStream:var f=k.__getStreamIdFromStreamGroupFrame(b);c=k.__getEncodedParamsFromEstablishStreamFrame(b);var g=new Uint8Array(k.HEAPU8.subarray(c,c+k.__getEncodedParamsSizeFromEstablishStreamFrame(b)));a.free(c);m.push(function(){var b;return(b=a.$3)==null?void 0:b.onGroupedStreamEstablishStreamReceived(f,g)});break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Data:var h=k.__getStreamIdFromStreamGroupFrame(b);c=k.__getDataFromGroupedStreamDataFrame(b);var i=new Uint8Array(k.HEAPU8.subarray(c,c+k.__getDataSizeFromGroupedStreamDataFrame(b)));a.free(c);var j=k.__getRequiresAckFromGroupedStreamDataFrame(b)?k.__getAckIdFromGroupedStreamDataFrame(b):null;m.push(function(){var b;return(b=a.$3)==null?void 0:b.onGroupedStreamDataReceived(h,i,j)});break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_Ack:var o=k.__getStreamIdFromStreamGroupFrame(b),p=k.__getAckIdFromGroupedStreamAckFrame(b);m.push(function(){var b;return(b=a.$3)==null?void 0:b.onGroupedStreamAckReceived(o,p)});break;case d("DGWConstants").DgwFrameType.DgwFrameType_StreamGroup_EndOfData:var q=k.__getStreamIdFromStreamGroupFrame(b);m.push(function(){var b;return(b=a.$3)==null?void 0:b.onGroupedStreamEndOfDataReceived(q)});break;case d("DGWConstants").DgwFrameType.DgwFrameType_Ping:m.push(function(){var b;return(b=a.$3)==null?void 0:b.onPingReceived()});break;case d("DGWConstants").DgwFrameType.DgwFrameType_Pong:m.push(function(){var b;return(b=a.$3)==null?void 0:b.onPongReceived()});break;default:break}a.free(b)};for(var n=0;n<j;++n)c();this.free(f);for(b=0;b<m.length;b++)m[b]()};b.encodeData=function(a,b,c,e){var f=this.malloc(a.length);if(f===-1)return null;var g=k.HEAPU8.subarray(f,f+a.length);for(var h=0;h<g.length;++h)g[h]=a[h];a=this.malloc(i*2);h=a;var j=a+i;e=k.__DgwCodecEncodeStreamGroup_Data(e,f,g.length,b,c,h,j);this.free(f);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(g=this.$2)==null||g.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Data Frame encode failure","Failed to decode DGW Data Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}b=k.HEAPU32.subarray(h/i,h/i+1)[0];c=k.HEAPU32.subarray(j/i,j/i+1)[0];f=new Uint8Array(k.HEAPU8.subarray(b,b+c));this.free(b);this.free(a);return f};b.encodeAck=function(a,b){var c=this.malloc(i*2);if(c===-1)return null;var e=c,f=c+i;b=k.__DgwCodecEncodeStreamGroup_Ack(b,a,e,f);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(a=this.$2)==null||a.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"ACK Frame encode failure","Failed to encode ACK Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b));return null}a=k.HEAPU32.subarray(e/i,e/i+1)[0];b=k.HEAPU32.subarray(f/i,f/i+1)[0];e=new Uint8Array(k.HEAPU8.subarray(a,a+b));this.free(a);this.free(c);return e};b.encodeDrain=function(a){var b=this.malloc(i*2);if(b===-1)return null;var c=b,e=b+i;a=k.__DgwCodecEncodeDrain(a,c,e);if(a!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null||f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Drain Frame encode failure","Failed to encode Drain Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(a));return null}f=k.HEAPU32.subarray(c/i,c/i+1)[0];a=k.HEAPU32.subarray(e/i,e/i+1)[0];c=new Uint8Array(k.HEAPU8.subarray(f,f+a));this.free(f);this.free(b);return c};b.encodeEstablishStream=function(a,b){var c=this.malloc(b.length);if(c===-1)return null;var e=k.HEAPU8.subarray(c,c+b.length);for(var f=0;f<b.length;++f)e[f]=b[f];e=this.malloc(i*2);f=e;var g=e+i;b=k.__DgwCodecEncodeStreamGroup_EstabStream(a,c,b.length,f,g);this.free(c);if(b!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){(c=this.$2)==null||c.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EstablishStream Frame encode failure","Failed to encode EstablishStream Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(b)+" for StreamId "+a);return null}c=k.HEAPU32.subarray(f/i,f/i+1)[0];b=k.HEAPU32.subarray(g/i,g/i+1)[0];a=new Uint8Array(k.HEAPU8.subarray(c,c+b));this.free(c);this.free(e);return a};b.encodeEndOfData=function(a){var b=this.malloc(i*2);if(b===-1)return null;var c=b,e=b+i;a=k.__DgwCodecEncodeStreamGroup_EndOfData(a,c,e);if(a!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null||f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"EndOfData Frame encode failure","Failed to encode EndOfData Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(a));return null}f=k.HEAPU32.subarray(c/i,c/i+1)[0];a=k.HEAPU32.subarray(e/i,e/i+1)[0];c=new Uint8Array(k.HEAPU8.subarray(f,f+a));this.free(f);this.free(b);return c};b.encodePing=function(){var a=this.malloc(i*2);if(a===-1)return null;var b=a,c=a+i,e=k.__DgwCodecEncodePing(b,c);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null||f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Ping Frame encode failure","Failed to encode Ping Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}f=k.HEAPU32.subarray(b/i,b/i+1)[0];e=k.HEAPU32.subarray(c/i,c/i+1)[0];b=new Uint8Array(k.HEAPU8.subarray(f,f+e));this.free(f);this.free(a);return b};b.encodePong=function(){if(this.$5!=null)return this.$5;var a=this.malloc(i*2);if(a===-1)return null;var b=a,c=a+i,e=k.__DgwCodecEncodePong(b,c);if(e!==d("DGWConstants").DgwCodecReturnCode.DgwCodecReturnCode_Success){var f;(f=this.$2)==null||f.logError(d("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Pong Frame encode failure","Failed to encode Pong Frame. Received error code "+d("DGWConstants").DgwCodecReturnCodeToString(e));return null}f=k.HEAPU32.subarray(b/i,b/i+1)[0];e=k.HEAPU32.subarray(c/i,c/i+1)[0];b=new Uint8Array(k.HEAPU8.subarray(f,f+e));this.free(f);this.free(a);this.$5=b;return b};return a}();g.uuidv4=a;g.Uint8ArrayToBase64UrlStr=j;g.DGWUtils=b;g.DGWCodec=e}),98);
__d("DGWExponentialBackoff",[],(function(a,b,c,d,e,f){"use strict";var g={maxRetries:5,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},h=function(a){function b(b,c){b=a.call(this,b)||this;b.errors=c;return b}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));async function a(a,b){b===void 0&&(b=g);try{return await i(a,b)}catch(a){throw a.errors[a.errors.length-1]}}async function i(a,b){var c=0,d=[],e=b.baseRetryInterval,f=b.backoffFactor;while(c<=b.maxRetries){try{var g=await a();return g}catch(a){d.push(a)}await j(e*Math.pow(f,c));++c}throw new h("Max call count exceeded",d)}async function j(a){await new Promise(function(b){return window.setTimeout(b,a)})}f.callWithExponentialBackoff=a}),66);
__d("DGWGlobalLogger",["gkx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){var a=this;this.tabID=c("uuidv4")();this.isTabClosed=!1;this.otherTabs=new Map();this.thisTab={realtime:0,lightspeed:0};this.broadcastChannel=this.$1("DGWGlobalLogger");this.broadcastChannel.onmessage=function(b){b=JSON.parse(String(b.data));var c=!a.otherTabs.has(b.key);b.event==="DELETE"?a.otherTabs["delete"](b.key):b.event==="UPDATE"&&b.value!=null&&(a.otherTabs.set(b.key,b.value),c&&a.$2())}}var b=a.prototype;b.$1=function(a){if(window.BroadcastChannel!=null)return new BroadcastChannel(a);else return{onmessage:function(a){},postMessage:function(a){}}};b.streamRequested=function(a){switch(a){case"realtime":this.thisTab.realtime++;break;case"lightspeed":this.thisTab.lightspeed++;break}this.$2()};b.streamClosed=function(a){switch(a){case"realtime":this.thisTab.realtime=Math.max(0,this.thisTab.realtime-1);break;case"lightspeed":this.thisTab.lightspeed=Math.max(0,this.thisTab.lightspeed-1);break}this.$2()};b.tabClosed=function(){if(this.isTabClosed)return;this.isTabClosed=!0;var a={key:this.tabID,event:"DELETE"};this.broadcastChannel.postMessage(JSON.stringify(a))};b.getGlobalState=function(){var a={realtime:this.thisTab.realtime,lightspeed:this.thisTab.lightspeed};this.otherTabs.forEach(function(b){a.realtime+=b.realtime,a.lightspeed+=b.lightspeed});return a};b.$2=function(){var a={key:this.tabID,event:"UPDATE",value:this.thisTab};this.broadcastChannel.postMessage(JSON.stringify(a))};return a}();var h=c("gkx")("4337")?new a():{streamRequested:function(){},streamClosed:function(){},tabClosed:function(){},getGlobalState:function(){return{realtime:-1,lightspeed:-1}}};b=function(){return h};g.getInstance=b}),98);
__d("DGWPinger",["DGWLoggingContext"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c){this.$1=a,this.$4=b,this.$5=c,this.$3=!1}var b=a.prototype;b.$6=function(){var a=this;if(this.$3){var b;(b=d("DGWLoggingContext")).DGWLoggingContext.bumpODSKey(b.DGWLoggingComponent.PINGER,"timeout_fired.reset");this.$3=!1;this.$4();b.DGWLoggingContext.bumpODSKey(b.DGWLoggingComponent.PINGER,"timeout.newtimeout");this.$2=window.setTimeout(function(){a.$6()},this.$1)}else d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"timeout_fired.disconnect"),this.$5()};b.reset=function(){var a=this;this.$3=!0;this.$2&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset"),window.clearTimeout(this.$2),this.$2=null);this.$1>0&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"reset.newtimeout"),this.$2=window.setTimeout(function(){a.$6()},this.$1))};b.cancel=function(){this.$2&&(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.PINGER,"canceled"),window.clearTimeout(this.$2),this.$2=null)};return a}();g.DGWPinger=a}),98);
__d("DGWStreamGroupCallbacks",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum")({TRANSPORT_SERVER_INTERNAL_ERROR:0,TRANSPORT_ABNORMAL_CLOSURE:1,TRANSPORT_GOING_AWAY:2,TRANSPORT_UNKNOWN_ERROR:3,TRANSPORT_KEEPALIVE_TIMEOUT:4,TRANSPORT_UNAUTHORIZED:5,TRANSPORT_REJECTED:6,TRANSPORT_BAD_REQUEST:7,TRANSPORT_DGW_SERVER_ERROR:8,TRANSPORT_NORMAL_CLOSURE:9});function a(a){switch(a){case g.TRANSPORT_UNAUTHORIZED:return!1;default:return!0}}c=function(){function a(){}var b=a.prototype;b.onStreamGroupError=function(){};b.onStreamGroupMustDrain=function(){};b.onStreamGroupTransportClose=function(){};return a}();f.DGWStreamGroupError=g;f.isRetryableError=a;f.NoOpDGWStreamGroupCallbacks=c}),66);
__d("DGWTransportEvents",["DGWLoggingContext","NetworkStatus"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$3=a}var b=a.prototype;b.transportEstablished=function(a){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"open",a),this.$2=Date.now(),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_success")};b.transportPingSent=function(a){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Ping Frame Sent",a,!0)};b.transportPongReceived=function(a){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Pong Frame Received",a,!0)};b.transportEstablishmentPending=function(){this.$1=Date.now(),this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transportPending",null,!0),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_pending")};b.transportClosed=function(a,b,c){this.$4=Date.now(),a?(this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_graceful"),this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed gracefully",null,!0)):(this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"transport_close_with_error"),this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Transport closed abnormally",b,c))};b.transportEstablishmentFailure=function(a){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"WebSocket transport establishment failure","WebSocket close code: "+a.code+" reason: "+a.reason+" wasClean: "+String(a.wasClean)),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_group_establishment_failure")};b.streamEstablishmentTimeout=function(a,b,e){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment timeout",a,"streamId:"+b+", onLine:"+String(c("NetworkStatus").isOnline()),!1,e),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_timeout")};b.streamEstablishmentPending=function(a,b){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment pending","streamId:"+a,!0,b),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_pending")};b.streamEstablishmentSuccess=function(a,b){this.$3.logEvent(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Grouped Stream establishment success","streamId:"+a,!0,b),this.$3.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"stream_establishment_success")};b.transportError=function(a,b,c){this.$3.logError(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,a,b,c)};b.receivedFrameForInactiveStream=function(a,b,c){this.$3.logWarn(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Frame received for inactive stream","frameType: "+a+", streamID: "+b,c)};b.ranOutOfStreamIds=function(a){this.$3.logWarn(d("DGWLoggingContext").DGWLoggingComponent.WEBSOCKET_TRANSPORT_COMPONENT,"Hit max StreamId limit","Hit max StreamId limit",a)};return a}();g.DGWTransportEvents=a}),98);
__d("DGWWebSocketTransport",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=new WebSocket(a);a.binaryType="arraybuffer";a.onopen=function(){};a.onclose=function(){};a.onerror=function(){};return a}f.getWebSocketConnection=a}),66);
__d("DGWStreamEvents",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c){this.$4=new Map(),this.$5=new Map(),this.$6=a,this.$1=b,c!=null&&(this.$8="streamId:"+c+"::")}var b=a.prototype;b.dataSent=function(a,b,c){var d=b?"sendWithAckRequested":"sendWithoutAckRequested";this.$6.logEvent(this.$1,d,((d=this.$8)!=null?d:"")+"sendId:"+c+", payloadSize:"+a,!0);this.$4.set(c,{ackRequested:b,payloadSize:a,sendTimestamp:Date.now()})};b.ackReceived=function(a){var b;this.$6.logEvent(this.$1,"AckReceived",((b=this.$8)!=null?b:"")+"sendId:"+a,!0);this.$6.bumpODSKey(this.$1,"ack_received");b=this.$4.get(a);b!=null&&(b.ackReceivedTimestamp=Date.now())};b.ackSent=function(a){var b;this.$6.bumpODSKey(this.$1,"ack_sent");this.$6.logEvent(this.$1,"ACK sent",((b=this.$8)!=null?b:"")+"ackId:"+a,!0)};b.drainSent=function(a){var b;this.$6.logEvent(this.$1,"Drain sent",((b=this.$8)!=null?b:"")+"drainReason: "+a)};b.dataReceived=function(a,b,c){var d;this.$6.bumpODSKey(this.$1,"data_received");this.$6.logEvent(this.$1,"Data received",((d=this.$8)!=null?d:"")+"sendId:"+(c!=null?c:"null")+", ackRequested:"+b.toString()+", payloadSize:"+a,!0);c!=null&&this.$5.set(c,{ackRequested:b,payloadSize:a,receiveTimestamp:Date.now()})};b.endOfDataReceived=function(){this.$6.bumpODSKey(this.$1,"end_of_data_received"),this.$6.logEvent(this.$1,"EndOfDataReceived",this.$8,!0)};b.endOfDataSent=function(){this.$6.bumpODSKey(this.$1,"end_of_data_sent"),this.$6.logEvent(this.$1,"EndOfDataSent",this.$8,!0)};b.streamClosed=function(a,b){this.$7=Date.now();var c=this.$9();if(a){this.$6.bumpODSKey(this.$1,"stream_closed_gracefully");this.$6.logEvent(this.$1,"Stream closed gracefully",""+((a=this.$8)!=null?a:"")+c)}else{this.$6.bumpODSKey(this.$1,"stream_closed_with_error");this.$6.logError(this.$1,"Stream closed abnormally",b,""+((a=this.$8)!=null?a:"")+c)}};b.connectionEstablishmentFailure=function(a){this.$6.logEvent(this.$1,"WebSocket connection establishment failure","WebSocket close code: "+a)};b.streamEstablishmentFailure=function(a,b){this.$6.logError(this.$1,"Failed to establish DGW Stream","Last seen error: "+a.toString(),""+((a=this.$8)!=null?a:"")+b);this.$6.bumpODSKey(this.$1,"stream_establishment_failure")};b.error=function(a,b){b={msg:b,state:this.$9()};this.$6.logError(this.$1,a,JSON.stringify(b),this.$8)};b.$9=function(){var a={currentNetworkCondition:window.navigator&&window.navigator.onLine===!0,establishRequestTimestamp:this.$2,establishedTimestamp:this.$3,streamClosedTimestamp:this.$7,sendHistory:JSON.stringify(Array.from(this.$4.entries())),receiveHistory:JSON.stringify(Array.from(this.$5.entries()))};return JSON.stringify(a)};return a}();f.DGWStreamEvents=a}),66);
__d("GroupedStream",["DGWAckManager","DGWConstants","DGWLoggingContext","DGWStream","DGWStreamEvents","QuickPerformanceLogger","Random","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(701242292,"2919");a=function(){function a(a,b,e,f,g,j,k){this.$1=a,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=b,this.$7=e,this.$8=f,this.$2=j,this.$9=g,this.$10=new(d("DGWAckManager").DGWAckManager)(this.$9),this.$12=new(d("DGWStreamEvents").DGWStreamEvents)(this.$9,d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,this.$1),this.$11=0,this.$13=k,this.$14=Date.now()+(Math.round(d("Random").random()*1e4)+1e4),(h||(h=c("QuickPerformanceLogger"))).markerStart(i,this.$14)}var b=a.prototype;b.send=async function(a,b){var c=this.$11++%d("DGWConstants").MAX_ACK_ID;a=this.$15(a,!0,c);if(!this.$16(a,!0,c))return!1;a=await this.$10.waitForAck(c,b!=null?b:d("DGWConstants").DEFAULT_ACK_TIMEOUT_MS);return a};b.sendFrame=async function(a,b,c){var e=this.$11++%d("DGWConstants").MAX_ACK_ID;b=this.$15(b,!0,e);if(b==null)return!1;var f=new Uint8Array(a.length+b.length);f.set(a);f.set(b,a.length);if(!this.$16(f,!0,e))return!1;b=await this.$10.waitForAck(e,c!=null?c:d("DGWConstants").DEFAULT_ACK_TIMEOUT_MS);this.__markerPoint(b?"ack_recevied":"ack_timeout");if(!b){this.__endMarker(3);return Promise.reject(d("DGWStream").StreamError.ACK_TIMEOUT)}return b};b.sendAndForget=function(a){a=this.$15(a,!1,0);return this.$16(a,!1,0)};b.sendFrameAndForget=function(a,b){b=this.$15(b,!1,0);if(b==null)return!1;var c=new Uint8Array(a.length+b.length);c.set(a);c.set(b,a.length);return this.$16(c,!1,0)};b.close=function(){var a=this.$2.encodeEndOfData(this.$1);if(a==null){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode EndOfData","streamId: "+this.$1);return}a=this.$8.send(a);if(!a){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send EndOfData","streamId: "+this.$1+". StreamGroupTransport not open during send");return}this.$12.endOfDataSent();this.$5=!0;this.$4&&this.$17()};b.loggingContext=function(){return this.$9};b.__sendDrain=function(a){var b=d("DGWConstants").drainReasonToDrainReasonString(a);if(this.$5)return!1;a=this.$2.encodeDrain(a);if(a==null)return!1;this.$12.drainSent(b);b=this.$8.send(a);return b};b.__transportCloseHook=function(a){this.$13(),this.$10.clearPendingAcks(),a?(this.$12.error("Received StreamError","StreamErrorType: "+a),this.$6.onError(a)):this.$5&&this.$4?this.$17():(this.$12.streamClosed(!1,"Stream closed: ClosedLocally: "+this.$5.toString()+", EndOfDataReceived: "+this.$4.toString()),this.$6.onError(d("DGWStream").StreamError.PREMATURE_CLOSE))};b.$17=function(){this.$13(),this.$12.streamClosed(!0,"Graceful close"),this.$6.onClose(this)};b.__dataReceivedHook=function(a,b){this.$12.dataReceived(a.length,b!=null,b),b!=null&&this.$18(b),this.$6.onDataReceived(a)};b.__ackReceivedHook=function(a){this.$12.ackReceived(a),this.$10.handleAckReceived(a)};b.__drainReceivedHook=function(a){this.$3===!1&&(this.$6.onStreamMustDrain(this,a),this.$3=!0)};b.__endOfDataHook=function(){this.$12.endOfDataReceived(),this.$4=!0,this.$5?this.$17():this.$6.onServerHasFinishedSendingData(this)};b.__markerPoint=function(a){var b=this.$14;(h||(h=c("QuickPerformanceLogger"))).markerPoint(i,a,{instanceKey:b})};b.__markerAnnotate=function(a){var b=this.$14;(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,a,{instanceKey:b})};b.__endMarker=function(a){(h||(h=c("QuickPerformanceLogger"))).markerEnd(i,a,this.$14)};b.$15=function(a,b,c){return this.$2.encodeData(a,b,c,this.$1)};b.$16=function(a,b,c){this.__markerPoint("send_data_start");if(this.$5){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","Stream closed locally");return!1}if(a==null)return!1;var e=this.$8.send(a);if(!e){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send data","ClosedLocally: "+this.$5.toString());return!1}this.__markerPoint("send_data_end");this.$12.dataSent(a.length,b,c);return!0};b.$18=function(a){var b=this.$2.encodeAck(a,this.$1);if(b==null){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to encode ACK","ackId: "+a);return!1}b=this.$8.send(b);if(!b){this.$9.logError(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"Failed to send ACK","ackId: "+a);return!1}this.$12.ackSent(a);return!0};return a}();g.GroupedStream=a}),98);
__d("StreamIdGenerator",["err"],(function(a,b,c,d,e,f,g){"use strict";var h=65535;a=function(){function a(){this.$1=new Set(),this.$2=0}var b=a.prototype;b.getNextStreamId=function(){var a;if(!this.streamIdAvailable())throw c("err")("Max number of stream IDs reached");if(this.$2<=h)return this.$2++;a=(a=this.$1.values().next().value)!=null?a:0;this.$1["delete"](a);return a};b.putBackStreamId=function(a){this.$1.add(a)};b.streamIdAvailable=function(){return this.$1.size>0||this.$2<=h};return a}();g.MAX_STREAM_ID=h;g.StreamIdGeneratorImpl=a}),98);
__d("StreamGroupWebSocketTransport",["DGWConstants","DGWExponentialBackoff","DGWGlobalLogger","DGWLoggingContext","DGWPinger","DGWStream","DGWStreamGroupCallbacks","DGWTransportEvents","DGWUtils","DGWWebSocketTransport","GroupedStream","QuickPerformanceLogger","Random","Run","StreamIdGenerator","err","qex","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(701238781,"3037"),j=(a=c("qex")._("2101"))!=null?a:20,k=(b=c("qex")._("2102"))!=null?b:3e4,l=(e=c("qex")._("2103"))!=null?e:!1,m=function(a,b,c,e,f){var g=this;this.groupedStream=a;this.$1=window.setTimeout(function(){c(d("DGWStream").StreamError.ESTABLISHMENT_TIMEOUT)},e);this.handleEstablishFrameReceived=function(){window.clearTimeout(g.$1),b(g.groupedStream)};this.abortStream=function(a){f(),c(a)}};f=function(){function a(b,e,f,g,j,k,l,m){var n=this;this.$18=-1;this.$15=j;this.$17=this.__getStreamIdGenerator();this.$5=new Map();this.$6=new Map();this.$7=g.keepAliveMs;this.$8=!1;this.$9=!1;this.$3=!0;this.$4=!1;this.$21=!1;this.$22=!1;this.$13=f;this.$11=new TextEncoder();this.$12=new TextDecoder();this.$14=g;j={onDataReceived:function(){},handleAckReceived:function(){},receivedDrainSignal:function(a){n.$9||(n.$9=!0,n.$15(),n.$13.transportClosed(!0,""),n.$14.streamGroupCallbacks.onStreamGroupMustDrain(a),n.$5.forEach(function(b){b.__drainReceivedHook(a)}),n.onClose(d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE))},onGroupedStreamDataReceived:function(a,b,c){if(n.$5.has(a)){var d=n.$5.get(a);d==null||d.__dataReceivedHook(b,c)}else n.$13.receivedFrameForInactiveStream("Data",a,"sendAckID: "+(c!=null?c:"null"))},onGroupedStreamAckReceived:function(a,b){if(n.$5.has(a)){var c=n.$5.get(a);c==null||c.__ackReceivedHook(b)}else n.$13.receivedFrameForInactiveStream("ACK",a,"ackId: "+(b!=null?b:"null"))},onGroupedStreamEndOfDataReceived:function(a){if(n.$5.has(a)){var b=n.$5.get(a);b==null||b.__endOfDataHook()}else n.$13.receivedFrameForInactiveStream("EndOfData",a)},onGroupedStreamEstablishStreamReceived:function(a,b){if(n.$6.has(a)){var c=n.$6.get(a);n.$6.delete(a);b=JSON.parse(n.$12.decode(b));(b.code===void 0||b.code!==200)&&(c==null||c.abortStream(d("DGWStream").StreamError.ABNORMAL_CLOSURE));c==null||c.handleEstablishFrameReceived()}else n.$13.receivedFrameForInactiveStream("EstablishStream",a,"EstablishStream received for non-inflight stream")},onPingReceived:function(){var a=n.$2.encodePing();if(a==null)return;n.send(a)},onPongReceived:function(){n.$3=!1,n.$22||(n.$22=!0,n.__markerPoint("auth_success")),n.$13.transportPongReceived("readyState:"+n.$1.readyState+", bufferedAmount:"+n.$1.bufferedAmount)}};this.$2=new(d("DGWUtils").DGWCodec)(k,j,g.dgwVersion);this.$20=Date.now()+(Math.round(d("Random").random()*1e4)+1e4);this.$23=d("DGWGlobalLogger").getInstance();d("Run").onUnload(function(){n.$23.tabClosed()});if(g.enableFirstStreamOnWsHandshake){if(l===void 0)throw c("err")("Missing grouped stream options");if(m===void 0)throw c("err")("Missing grouped stream callbacks");var o=this.$17.getNextStreamId();f=this.createEstablishStreamFrame(o,l);k=d("DGWUtils").DGWUtils.constructConnectUrl({appId:g.appId,appVersion:g.appVersion,authType:g.authType,deviceId:(k=g.deviceId)!=null?k:void 0,dgwVersion:g.dgwVersion,fbId:g.fbId,tier:g.tier,loggingId:(j=g.loggingId)!=null?j:void 0,headers:a.__prefixAppHeaders(g.headers),endpoint:g.connectEndpoint,serviceId:g.serviceId,regionHint:(k=g.regionHint)!=null?k:void 0,establishStreamFrame:f,authToken:(j=g.authToken)!=null?j:void 0});this.$1=e(k);if(!k.includes(d("DGWConstants").HEADER_CONSTANTS.HEADER_ESTABLISH_STREAM_FRAME_BASE64))return;f=new(d("DGWLoggingContext").DGWLoggingContext)(this.$14.dgwVersion,l.loggingId,this.$14.serviceId,this.$14.fbId,this.$14.loggingId,l.disableFalcoLogging);j=this.__createGroupedStream(o,m,l,f);this.$16=this.waitForEstablishStream(o,j,l,function(a){n.$5.set(o,a)},function(){n.$17.putBackStreamId(o)})}else this.$1=e(b);this.$23.streamRequested(g.serviceId);(h||(h=c("QuickPerformanceLogger"))).markerStart(i,this.$20);this.__markerAnnotate({string:{serviceId:this.$14.serviceId,streamGroupId:this.$14.loggingId}})}var b=a.prototype;b.send=function(a){try{this.$1.send(a);return!0}catch(a){this.$13.transportError("Failed to send over transport","readyState: "+this.$1.readyState,a.toString());return!1}};b.close=function(){this.onClose()};b.onClose=function(a){var b;this.$23.streamClosed(this.$14.serviceId);this.__markerPoint("abort");this.__markerAnnotate({int:{abort_code:a!=null?a:0}});this.$8=!0;(b=this.$10)==null||b.cancel();this.$1.close(a)};b.abort=function(a,b,c,d,e){if(this.$8)return;this.$23.streamClosed(this.$14.serviceId);this.$8=!0;this.$13.transportClosed(!1,d,e);this.$5.forEach(function(a){a.__transportCloseHook(b)});this.$6.forEach(function(a){a.abortStream(b)});this.$14.streamGroupCallbacks.onStreamGroupError(a);this.$5.clear();this.$6.clear();this.$15();this.onClose(c)};a.getTransportWithInitialStream=async function(b,c,e,f,g,h){await d("DGWUtils").DGWCodec.initialize();var i=new(d("DGWTransportEvents").DGWTransportEvents)(f);i.transportEstablishmentPending();var j=function(){return a.$24("",e,i,g,f,b,c)};try{j=await d("DGWExponentialBackoff").callWithExponentialBackoff(j,h);h=j.$16!=null?j.$16:j.establishGroupedStream(c,b,new(d("DGWLoggingContext").DGWLoggingContext)(e.dgwVersion,b.loggingId,e.serviceId,e.fbId,e.loggingId,b.disableFalcoLogging));return{transport:j,streamPromise:h}}catch(a){throw a}};a.getTransport_DEPRECATED=async function(b,c,e,f,g){await d("DGWUtils").DGWCodec.initialize();var h=new(d("DGWTransportEvents").DGWTransportEvents)(e);h.transportEstablishmentPending();var i=function(){return a.$24(b,c,h,f,e)};try{return await d("DGWExponentialBackoff").callWithExponentialBackoff(i,g)}catch(a){throw a}};b.establishGroupedStream=async function(a,b,d,e,f,g){var h=this;f===void 0&&(f=!0);var i=this.getStreamId(),j=this.createEstablishStreamFrame(i,b);a=this.__createGroupedStream(i,a,b,d);a.__markerAnnotate({string:{serviceId:this.$14.serviceId,streamGroupId:this.$14.loggingId,streamId:b.streamTraceId}});g!=null&&a.__markerAnnotate(g);d=this.waitForEstablishStream(i,a,b,function(a){h.$5.set(i,a)},function(){h.$17.putBackStreamId(i)});if(e!=null){a.__markerPoint("send_payload_start");a.__markerAnnotate({int:{establishStreamPayloadSize:e.byteLength}});g=f?await a.sendFrame(j,e,k):a.sendFrameAndForget(j,e);if(!g){a.__endMarker(3);return Promise.reject("Failed to send data when establishing stream")}a.__markerPoint("send_payload_end");a.__endMarker(2);return Promise.resolve(a)}a.__markerPoint("send_establish_stream_start");if(!this.send(j)){a.__endMarker(3);throw c("err")("Websocket connection closed before stream established")}a.__markerPoint("send_establish_stream_end");b=await d;a.__endMarker(2);return b};a.__prefixAppHeaders=function(a){return Object.keys(a).reduce(function(b,c){b[""+d("DGWConstants").HEADER_CONSTANTS.APPHEADER_PREFIX+c]=a[c];return b},{})};b.waitForEstablishStream=async function(a,b,c,d,e){var f=this;this.$13.streamEstablishmentPending(a,c.loggingId);try{var g=await new Promise(function(c,d){f.$6.set(a,new m(b,c,d,3e4,function(){f.streamEndCallback(a)}))});d(b);this.$13.streamEstablishmentSuccess(a,c.loggingId);return g}catch(b){e();this.$13.streamEstablishmentTimeout("Stream establishment timeout. readyState: "+this.$1.readyState,a,c.loggingId);throw b}};a.$24=async function(b,c,e,f,g,h,i){var j=new a(b,d("DGWWebSocketTransport").getWebSocketConnection,e,c,f,g,h,i);j.$1.onmessage=a.$25(j);j.$1.onopen=function(){j.__markerPoint("onopen"),e.transportEstablished(b),j.$10!=null&&j.$10.cancel(),j.$7!=null&&(j.$10=new(d("DGWPinger").DGWPinger)(j.$7,function(){j.$26()},function(){j.abort(d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_KEEPALIVE_TIMEOUT,d("DGWStream").StreamError.KEEPALIVE_TIMEOUT,d("DGWConstants").WebsocketCloseCodes.KEEPALIVE_TIMEOUT,"Aborting transport because of keepalive timeout","readyState:"+j.$1.readyState+", bufferedAmount:"+j.$1.bufferedAmount)}))};j.$1.onerror=function(){j.__markerPoint("onerror"),j.$13.transportError("onerror","readyState: "+j.$1.readyState)};j.$1.onclose=a.$27(j);c=await a.getTransportPromise(j);return c};a.getTransportPromise=async function(a){var b=await new Promise(function(b,c){var e=a.$1.onerror,f=a.$1.onmessage,g=a.$1.onclose;a.$19=window.setTimeout(function(){a.$15(),a.$13.transportClosed(!1,"TIMEOUT"),a.__markerPoint("connect_timeout"),a.close(),c(d("DGWStream").StreamError.TRANSPORT_ESTABLISHMENT_TIMEOUT)},j*1e3);a.$1.onerror=function(){a.$19!=null&&(window.clearTimeout(a.$19),a.$19=null),e(),l||c(d("DGWStream").StreamError.ESTABLISHMENT_ERROR)};a.$1.onclose=function(b){a.$19!=null&&(window.clearTimeout(a.$19),a.$19=null),g(b),b.code===d("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED?c(d("DGWStream").StreamError.UNAUTHORIZED):c(b.code+":"+b.reason)};a.$1.onmessage=function(c){f(c),a.$19!=null&&!a.$3&&(window.clearTimeout(a.$19),a.$19=null,a.__markerPoint("connect_success"),b(a))}});return b};a.$25=function(a){return function(b){var c;a.$21||(a.$21=!0,a.__markerPoint("onmessage"));(c=a.$10)==null||c.reset();if(!(b.data instanceof ArrayBuffer)){a.$13.transportError("Incorrect Data Protocol","Received "+typeof b.data+" instead of ArrayBuffer");return}a.$2.append(new Uint8Array(b.data));a.$2.processData()}};a.$27=function(a){return function(b){var c=a.$23.getGlobalState();a.__markerPoint("onclose");a.__markerAnnotate({string:{reason:b.reason},int:{code:b.code,realtimeWebSockets:c.realtime,lightspeedWebSockets:c.lightspeed}});a.__endMarker(b.code===d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE?2:3);(c=a.$10)==null||c.cancel();if(a.$8===!0||a.$4)return;a.$23.streamClosed(a.$14.serviceId);a.$8=!0;if(a.$3===!0){a.$13.transportEstablishmentFailure(b);a.$5.clear();a.$15();return}a.$15();a.$3=!0;if(b.code!==d("DGWConstants").WebsocketCloseCodes.GRACEFUL_CLOSE){a.$13.transportClosed(!1,"Websocket connection failure with code: "+b.code+" reason: "+b.reason+" wasClean: "+String(b.wasClean));c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR;var e=d("DGWStream").StreamError.UNKNOWN_ERROR;switch(b.code){case d("DGWConstants").WebsocketCloseCodes.NORMAL_CLOSURE:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_NORMAL_CLOSURE;e=d("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case d("DGWConstants").WebsocketCloseCodes.ABNORMAL_CLOSURE:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_ABNORMAL_CLOSURE;e=d("DGWStream").StreamError.ABNORMAL_CLOSURE;break;case d("DGWConstants").WebsocketCloseCodes.SERVER_INTERNAL_ERROR:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR;e=d("DGWStream").StreamError.SERVER_INTERNAL_ERROR;break;case d("DGWConstants").WebsocketCloseCodes.GOING_AWAY:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_GOING_AWAY;e=d("DGWStream").StreamError.GOING_AWAY;break;case d("DGWConstants").WebsocketCloseCodes.UNAUTHORIZED:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNAUTHORIZED;e=d("DGWStream").StreamError.UNAUTHORIZED;break;case d("DGWConstants").WebsocketCloseCodes.REJECTED:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_REJECTED;e=d("DGWStream").StreamError.REJECTED;break;case d("DGWConstants").WebsocketCloseCodes.BAD_REQUEST:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_BAD_REQUEST;e=d("DGWStream").StreamError.BAD_REQUEST;break;case d("DGWConstants").WebsocketCloseCodes.DGW_SERVER_ERROR:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_SERVER_INTERNAL_ERROR;e=d("DGWStream").StreamError.DGW_SERVER_ERROR;c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_DGW_SERVER_ERROR;break;default:c=d("DGWStreamGroupCallbacks").DGWStreamGroupError.TRANSPORT_UNKNOWN_ERROR;e=d("DGWStream").StreamError.UNKNOWN_ERROR;break}a.$14.streamGroupCallbacks.onStreamGroupError(c);a.$5.forEach(function(a){a.__transportCloseHook(e)});a.$6.forEach(function(a){a.abortStream(e)})}else a.$13.transportClosed(!0,""),a.$14.streamGroupCallbacks.onStreamGroupTransportClose(),a.$5.forEach(function(a){a.__transportCloseHook()}),a.$6.forEach(function(a){a.abortStream(d("DGWStream").StreamError.TRANSPORT_CLOSED_BEFORE_STREAM_INIT)});a.$5.clear();a.$6.clear()}};b.$26=function(){var a=this.$2.encodePing();if(a==null)throw c("err")("Failed to encode Ping Frame");var b=this.send(a);this.$18=this.$1.bufferedAmount;this.$13.transportPingSent("readyState:"+this.$1.readyState+", bufferedAmount:"+this.$18+", payloadSize:"+(a==null?void 0:a.byteLength)+", sent:"+String(b))};b.isClosedLocally=function(){return this.$3||this.$8||this.$4};b.streamEndCallback=function(a){this.$5.delete(a),this.$6.delete(a),this.$17.putBackStreamId(a)};b.canCreateGroupedStream=function(){return this.$17.streamIdAvailable()};b.createEstablishStreamFrame=function(b,e){var f=a.__prefixAppHeaders(e.groupedStreamHeaders);e.streamTraceId!=null&&(f[d("DGWConstants").HEADER_CONSTANTS.HEADER_STREAM_TRACE_ID]=e.streamTraceId);e=this.$2.encodeEstablishStream(b,new Uint8Array(this.$11.encode(JSON.stringify(f))));if(e==null){this.$17.putBackStreamId(b);throw c("err")("Failed to encode EstablishStreamFrame")}return e};b.getStreamId=function(){try{return this.$17.getNextStreamId()}catch(a){this.$13.ranOutOfStreamIds("inFlightGroupedStreamSize: "+this.$6.size+" groupedStreamSize: "+this.$5.size);throw a}};b.__createGroupedStream=function(a,b,c,e){var f=this;return new(d("GroupedStream").GroupedStream)(a,b,c,this,e,this.$2,function(){f.streamEndCallback(a)})};b.__getStreamIdGenerator=function(){return new(d("StreamIdGenerator").StreamIdGeneratorImpl)()};b.__markerPoint=function(a){var b=this.$20;(h||(h=c("QuickPerformanceLogger"))).markerPoint(i,a,{instanceKey:b})};b.__markerAnnotate=function(a){var b=this.$20;(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,a,{instanceKey:b})};b.__endMarker=function(a){(h||(h=c("QuickPerformanceLogger"))).markerEnd(i,a,this.$20)};return a}();g.StreamGroupWebSocketTransport=f}),98);
__d("StreamGroup",["DGWConstants","DGWLoggingContext","DGWUtils","StreamGroupWebSocketTransport","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h={maxRetries:c("justknobx")._("2595"),baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)};a=function(){function a(a,b,c,e,f,g,h,i,j){this.$2=j;this.$1=j.getNewStreamGroupId();j=(j=h.overrideUrl)!=null?j:f;this.$5=null;this.$3={appId:a,appVersion:b,authType:(f=h.authType)!=null?f:c,deviceId:h.deviceId,dgwVersion:e,headers:h.streamGroupAppHeaders,tier:(a=h.serviceTier)!=null?a:d("DGWConstants").DEFAULT_SERVICE_TIER,connectEndpoint:j,fbId:g,loggingId:h.loggingId,serviceId:h.serviceId,streamGroupCallbacks:i,keepAliveMs:h.keepAliveMs,regionHint:h.regionHint,enableFirstStreamOnWsHandshake:!1,authToken:h.authToken};this.$4=h;this.streamGroupLoggingContext=new(d("DGWLoggingContext").DGWLoggingContext)(this.$3.dgwVersion,null,this.$3.serviceId,this.$3.fbId,this.$4.loggingId,!1,(b=h.verboseLoggingEnabled)!=null?b:!1);this.$6=d("DGWUtils").DGWUtils.constructConnectUrl({appId:this.$3.appId,appVersion:this.$3.appVersion,authType:this.$3.authType,deviceId:(f=this.$3.deviceId)!=null?f:void 0,dgwVersion:this.$3.dgwVersion,fbId:this.$3.fbId,headers:babelHelpers.extends({},this.$3.headers),loggingId:(c=this.$3.loggingId)!=null?c:void 0,tier:this.$3.tier,serviceId:this.$3.serviceId,endpoint:this.$3.connectEndpoint,regionHint:(e=this.$3.regionHint)!=null?e:void 0,trafficTracing:(a=this.$4.trafficTracing)!=null?a:void 0,authToken:(j=this.$4.authToken)!=null?j:void 0})}var b=a.prototype;b.initTransport=async function(){var b=this,a={maxRetries:0,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)};this.$5=this.$5||d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){b.$2.removeStreamGroupAndTransport(b.$1)},a);var c;try{c=await this.$5,this.$5=null}catch(a){this.$5=null;throw a}this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,c);return c};b.establishStream=async function(a,b,c,e,f){var g=this;if(this.$2.containsStreamGroup(this.$1)===!1){this.streamGroupLoggingContext.logEvent(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"createTransportWhenEstablishStream");if(!this.$3.enableFirstStreamOnWsHandshake){this.$5=this.$5||d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransport_DEPRECATED(this.$6,this.$3,this.streamGroupLoggingContext,function(){g.$2.removeStreamGroupAndTransport(g.$1)},h);var i;try{i=await this.$5,this.$5=null}catch(a){this.$5=null;throw a}this.$2.containsStreamGroup(this.$1)||this.$2.setStreamGroupAndTransport(this.$1,i)}else{var j=await d("StreamGroupWebSocketTransport").StreamGroupWebSocketTransport.getTransportWithInitialStream(a,b,this.$3,this.streamGroupLoggingContext,function(){g.$2.removeStreamGroupAndTransport(g.$1)},h);this.$2.setStreamGroupAndTransport(this.$1,j.transport);return j.streamPromise}}return this.establishStreamWithTransport(a,b,c,e,f)};b.establishStreamWithTransport=async function(a,b,c,e,f){var g=a.loggingId;this.streamGroupLoggingContext.logEvent(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Establishing Grouped Stream","initialData:"+String(c!=null),!0,g);g=await this.$2.getStreamGroupTransport(this.$1).establishGroupedStream(b,a,new(d("DGWLoggingContext").DGWLoggingContext)(this.$3.dgwVersion,g,this.$3.serviceId,this.$3.fbId,this.$3.loggingId,a.disableFalcoLogging,(b=a.verboseLoggingEnabled)!=null?b:!1),c,e,f);return g};b.canCreateGroupedStream=function(){var a=!0;if(this.$2.containsStreamGroup(this.$1)!==!1){var b=this.$2.getStreamGroupTransport(this.$1);a=b.canCreateGroupedStream()}d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,a?"can_create":"cannot_create");return a};b.close=function(){var a=this.$2.getStreamGroupTransport(this.$1);a.close()};return a}();g.StreamGroup=a}),98);
__d("StreamGroupRegistry",["Random","err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=new Map(),this.$2=new Set()}var b=a.prototype;b.setStreamGroupAndTransport=function(a,b){this.$1.set(a,b)};b.containsStreamGroup=function(a){return this.$1.has(a)};b.removeStreamGroupAndTransport=function(a){this.$1["delete"](a)};b.getStreamGroupTransport=function(a){a=this.$1.get(a);if(a==null)throw c("err")("No stream group transport");return a};b.getNewStreamGroupId=function(){var a=d("Random").uint32();while(this.$2.has(a))a=d("Random").uint32();this.$2.add(a);return a};return a}();g.StreamGroupRegistry=a}),98);
__d("RawDGWClient",["CurrentUser","DGWAuth","DGWLoggingContext","DGWStream","StreamGroup","StreamGroupRegistry","isFastRefreshEnabledForCurrentDomain"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.appId,c=a.appVersion,e=a.authType,f=a.dgwVersion,g=a.endpoint;a=a.fbId;this.$1=b;this.$2=c;this.$3=e;this.$4=f;this.$5=g;this.$6=a;this.$7=new(d("StreamGroupRegistry").StreamGroupRegistry)()}var b=a.prototype;b.createStreamGroup=function(a,b){var c;this.handleUserChecks((c=b.authType)!=null?c:this.$3);return new(d("StreamGroup").StreamGroup)(this.$1,this.$2,this.$3,this.$4,this.$5,this.$6,b,a,this.$7)};b.handleUserChecks=function(a){if(!c("CurrentUser").isLoggedInNow()&&d("DGWAuth").fromDGWAuthToString(a)!=="GUEST"&&!c("isFastRefreshEnabledForCurrentDomain")()){d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.RAW_CLIENT,"unauthenticated");throw d("DGWStream").StreamError.UNAUTHENTICATED}};return a}();g.RawDGWClient=a}),98);
__d("DGWClient",["DGWAuth","DGWEnvUtil","DGWWebConfig","RawDGWClient","err"],(function(a,b,c,d,e,f,g){"use strict";var h=new(d("RawDGWClient").RawDGWClient)({appId:c("DGWWebConfig").appId,appVersion:c("DGWWebConfig").appVersion,authType:d("DGWAuth").fromStringToDGWAuth(c("DGWEnvUtil").getDGWAuthType()),dgwVersion:c("DGWEnvUtil").getDGWVersion(),endpoint:c("DGWEnvUtil").getDGWEndpoint(),fbId:c("DGWWebConfig").fbId});function a(){if(c("DGWEnvUtil").isDGWEnvCompatible())return h;else throw c("err")("unsupported_environment_retry_with_mqtt")}g["default"]=a}),98);
__d("DGWRequestStreamUtils",["Base64","WebDriverConfig","cr:3024","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,d,e,f){var g={};for(a of Object.entries(a)){var h=a[0],i=a[1];typeof i=="string"?g["XRSS-"+h]=i:typeof i=="number"?g["XRSN-"+h]=i.toString():typeof i=="boolean"?g["XRSB-"+h]=i.toString():typeof i=="object"&&i!=null&&(g["XRSO-"+h]=c("Base64").encode(JSON.stringify(i)))}d&&(g["xrs-body"]="true");e!=null&&e.length>0&&(g["xrs-instrumentation"]=c("Base64").encode(e));g["XRS-Accept-Ack"]="RSAck";f!=null&&f.ackTimeoutSec!=null&&(g["XRS-SRAck-Timeout"]=f.ackTimeoutSec.toString());g["XRSS-http_referer"]=window.location.href;if(c("WebDriverConfig").isTestRunning&&c("gkx")("20919")){h=b("cr:3024")==null?void 0:b("cr:3024").get();h!=null&&(g["XRSB-is_test"]="true",g["XRSS-original_request_id"]=h)}return g}function h(a){return Object.keys(a).reduce(function(b,c){(typeof a[c]==="string"||typeof a[c]==="boolean"||typeof a[c]==="number"||typeof a[c]==="object")&&(b[c]=a[c]);return b},{})}function d(a){if(a.response&&a.response.instrumentation_data!=null&&a.response.instrumentation_data.length>0)try{a=JSON.parse(new TextDecoder("utf-8").decode(a.response.instrumentation_data));return{auxId:a.auxId,dfTraceId:(a=a.dataFlowTracingData)==null?void 0:a.traceId}}catch(a){}return null}function e(a,b){var c=a.headers;a=a.body;b.kill_body===!0&&(a=null);b.new_body!=null&&(a=b.new_body);if(b.new_headers!=null)try{c=h(JSON.parse(b.new_headers))}catch(a){}if(b.patch_headers!=null)try{c=babelHelpers["extends"]({},c,h(JSON.parse(b.patch_headers)))}catch(a){}return{headers:c,body:a}}g.convertHeaders=a;g.cleanHeaders=h;g.getInstrumentationDataFieldsFromPayload=d;g.transformContextWithRewriteDelta=e}),98);
__d("DGWStreamHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d,e){this.$2=a,this.$3=b,this.$4=c,this.$5=d,this.$6=e,this.$1=!0}var b=a.prototype;b.onClose=function(a){if(!this.$1)return;this.$2(a)};b.onDataReceived=function(a){if(!this.$1)return;this.$3(a)};b.onError=function(a){if(!this.$1)return;this.$4(a)};b.onStreamMustDrain=function(a,b){if(!this.$1)return;this.$5(a,b)};b.onServerHasFinishedSendingData=function(a){if(!this.$1)return;this.$6(a)};b.stop=function(){this.$1=!1};b.isStopped=function(){return!this.$1};return a}();f["default"]=a}),66);
__d("InflightAmends",["Deferred","err"],(function(a,b,c,d,e,f,g){"use strict";var h="inflight_amends_timeout",i="inflight_amends_duplicate_id";a=function(){function a(a,b,c){this.$1=a,this.$3=b,this.$4=c,this.$2=new Map()}var b=a.prototype;b.add=function(a){var b=this;if(this.$2.has(a))throw c("err")(i);var d=new(c("Deferred"))(),e=Date.now(),f=setTimeout(function(){b.$2.has(a)&&b.reject(a,c("err")(h))},this.$1);this.$2.set(a,{id:a,deferred:d,createdTimestampMs:e,timeoutId:f});return d.getPromise()};b.getPromise=function(a){return(a=this.$5(a))==null?void 0:a.deferred.getPromise()};b.resolve=function(a,b){a=this.$5(a);a&&(a.deferred.resolve==null||a.deferred.resolve(b),this.$3(a.id,Date.now()-a.createdTimestampMs),this.$6(a))};b.reject=function(a,b){a=this.$5(a);a&&(a.deferred.reject==null||a.deferred.reject(b),this.$4(a.id,b),this.$6(a))};b.rejectAll=function(a){for(var b of this.$2.entries()){var c=b[0];b[1];this.reject(c,a)}};b.getSize=function(){return this.$2.size};b.getAllPromises=function(){var a=[];for(var b of this.$2.values())a.push(b.deferred.getPromise());return a};b.$6=function(a){clearTimeout(a.timeoutId),this.$2["delete"](a.id)};b.$5=function(a){return this.$2.get(a)};return a}();g["default"]=a}),98);
__d("RequestStreamCloseReason",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["UserIntention","StartStreamFailure","StreamError","RemoteTermination","ServerDataEnd","ServerDrain","ReestablishError","ClientError"]);f.RequestStreamCloseReason=a}),66);
__d("RequestStreamCommonRequestStreamCommonSerializers",["RequestStreamCommonRequestStreamCommonTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{expected_existing_headers:"",patch_headers_if_match:""}}function e(){return{bytes:Uint8Array.of()}}function f(){return{message:""}}function i(){return{reason:d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)}}function j(){return{}}function k(){return{stream_id:"0",last_sequencer:0,amendment_count:0,last_status:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)}}function l(){return{caller_timestamp_ms:"0"}}function m(){return{original_ping_timestamp_ms:"0"}}function n(){return{}}function o(a,b){b.writeStructBegin("ResponseRewriteRequest"),a.new_headers!=null&&(b.writeFieldBegin({fname:"new_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeString(a.new_headers),b.writeFieldEnd()),a.new_body!=null&&(b.writeFieldBegin({fname:"new_body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.new_body),b.writeFieldEnd()),a.patch_headers!=null&&(b.writeFieldBegin({fname:"patch_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.patch_headers),b.writeFieldEnd()),a.kill_body!=null&&(b.writeFieldBegin({fname:"kill_body",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:4}),b.writeBool(a.kill_body),b.writeFieldEnd()),a.temporary!=null&&(b.writeFieldBegin({fname:"temporary",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:5}),b.writeBool(a.temporary),b.writeFieldEnd()),a.conditional_patch_headers!=null&&(b.writeFieldBegin({fname:"conditional_patch_headers",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6}),p(a.conditional_patch_headers,b),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function p(a,b){b.writeStructBegin("ResponseRewriteConditionalPatchHeaders");b.writeFieldBegin({fname:"expected_existing_headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.expected_existing_headers!=null)b.writeString(a.expected_existing_headers);else{var d="";b.writeString(d)}b.writeFieldEnd();b.writeFieldBegin({fname:"patch_headers_if_match",ftype:h.STRING,fid:2});if(a.patch_headers_if_match!=null)b.writeString(a.patch_headers_if_match);else{d="";b.writeString(d)}b.writeFieldEnd();a.patch_headers_otherwise!=null&&(b.writeFieldBegin({fname:"patch_headers_otherwise",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeString(a.patch_headers_otherwise),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function q(a,b){b.writeStructBegin("ResponseData");b.writeFieldBegin({fname:"bytes",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.bytes!=null)b.writeBinary(a.bytes);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.metadata!=null&&(b.writeFieldBegin({fname:"metadata",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.metadata),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function r(a,b){b.writeStructBegin("LogMessage");b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.message!=null)b.writeString(a.message);else{a="";b.writeString(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function s(a,b){b.writeStructBegin("Termination");b.writeFieldBegin({fname:"reason",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});if(a.reason!=null){var e;b.writeI32((e=a.reason)!=null?e:0)}else{e=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.message!=null&&(b.writeFieldBegin({fname:"message",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeString(a.message),b.writeFieldEnd());a.retry_delay_ms!=null&&(b.writeFieldBegin({fname:"retry_delay_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:3}),b.writeI64(c("jsbi").BigInt(a.retry_delay_ms)),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function t(a,b){b.writeStructBegin("AmendStreamAck"),a.amendment_id!=null&&(b.writeFieldBegin({fname:"amendment_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.amendment_id)),b.writeFieldEnd()),a.accepted!=null&&(b.writeFieldBegin({fname:"accepted",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:2}),b.writeBool(a.accepted),b.writeFieldEnd()),a.result!=null&&(b.writeFieldBegin({fname:"result",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.result),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function u(a,b){b.writeStructBegin("StreamCheck");b.writeFieldBegin({fname:"stream_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.stream_id!=null)b.writeI64(c("jsbi").BigInt(a.stream_id));else{var e="0";b.writeI64(c("jsbi").BigInt(e))}b.writeFieldEnd();b.writeFieldBegin({fname:"last_sequencer",ftype:h.I32,fid:2});if(a.last_sequencer!=null)b.writeI32(a.last_sequencer);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"amendment_count",ftype:h.I32,fid:4});if(a.amendment_count!=null)b.writeI32(a.amendment_count);else{e=0;b.writeI32(e)}b.writeFieldEnd();b.writeFieldBegin({fname:"last_status",ftype:h.I32,fid:3});if(a.last_status!=null){b.writeI32((e=a.last_status)!=null?e:0)}else{a=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0);b.writeI32(a!=null?a:0)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function v(a,b){b.writeStructBegin("Ping");b.writeFieldBegin({fname:"caller_timestamp_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.caller_timestamp_ms!=null)b.writeI64(c("jsbi").BigInt(a.caller_timestamp_ms));else{var d="0";b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();if(a.streams_to_check!=null){b.writeFieldBegin({fname:"streams_to_check",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.STRUCT,size:a.streams_to_check.length});for(d of a.streams_to_check)u(d,b);b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function w(a,b){b.writeStructBegin("Pong");b.writeFieldBegin({fname:"original_ping_timestamp_ms",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1});if(a.original_ping_timestamp_ms!=null)b.writeI64(c("jsbi").BigInt(a.original_ping_timestamp_ms));else{var d="0";b.writeI64(c("jsbi").BigInt(d))}b.writeFieldEnd();if(a.stream_ids_missing!=null){b.writeFieldBegin({fname:"stream_ids_missing",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});b.writeListBegin({etype:h.I64,size:a.stream_ids_missing.length});for(d of a.stream_ids_missing)b.writeI64(c("jsbi").BigInt(d));b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_behind!=null){b.writeFieldBegin({fname:"stream_ids_behind",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:3});b.writeListBegin({etype:h.I64,size:a.stream_ids_behind.length});for(d of a.stream_ids_behind)b.writeI64(c("jsbi").BigInt(d));b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_with_lost_amendments!=null){b.writeFieldBegin({fname:"stream_ids_with_lost_amendments",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:4});b.writeListBegin({etype:h.I64,size:a.stream_ids_with_lost_amendments.length});for(d of a.stream_ids_with_lost_amendments)b.writeI64(c("jsbi").BigInt(d));b.writeListEnd();b.writeFieldEnd()}if(a.stream_ids_with_wrong_status!=null){b.writeFieldBegin({fname:"stream_ids_with_wrong_status",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:5});b.writeListBegin({etype:h.I64,size:a.stream_ids_with_wrong_status.length});for(d of a.stream_ids_with_wrong_status)b.writeI64(c("jsbi").BigInt(d));b.writeListEnd();b.writeFieldEnd()}b.writeFieldStop();b.writeStructEnd()}function x(a,b){b.writeStructBegin("StreamResponseDelta");if(a.flow_status!=null){var d;b.writeFieldBegin({fname:"flow_status",ftype:(h||(h=c("ThriftTypes"))).I32,fid:1});b.writeI32((d=a.flow_status)!=null?d:0);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.log!=null){b.writeFieldBegin({fname:"log",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});r(a.log,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.rewrite!=null){b.writeFieldBegin({fname:"rewrite",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});o(a.rewrite,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.data!=null){b.writeFieldBegin({fname:"data",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});q(a.data,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.termination!=null){b.writeFieldBegin({fname:"termination",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});s(a.termination,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.amend_ack!=null){b.writeFieldBegin({fname:"amend_ack",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});t(a.amend_ack,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function y(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.new_headers=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.new_body=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers=a.readString():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).BOOL?b.kill_body=a.readBool():a.skip(e);break;case 5:e===(h||(h=c("ThriftTypes"))).BOOL?b.temporary=a.readBool():a.skip(e);break;case 6:e===(h||(h=c("ThriftTypes"))).STRUCT?b.conditional_patch_headers=z(a):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function z(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.expected_existing_headers=a.readString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers_if_match=a.readString():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.patch_headers_otherwise=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.expected_existing_headers===void 0&&(b.expected_existing_headers="");b.patch_headers_if_match===void 0&&(b.patch_headers_if_match="");return b}function A(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.bytes=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.metadata=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.bytes===void 0&&(b.bytes=Uint8Array.of());return b}function B(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.message===void 0&&(b.message="");return b}function C(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I32?b.reason=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(a.readI32()):a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).STRING?b.message=a.readString():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I64?b.retry_delay_ms=a.readI64().toString():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.reason===void 0&&(b.reason=d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0));return b}function D(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).BOOL?b.accepted=a.readBool():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).STRING?b.result=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function E(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.stream_id=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.last_sequencer=a.readI32():a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).I32?b.amendment_count=a.readI32():a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.last_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()):a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.stream_id===void 0&&(b.stream_id="0");b.last_sequencer===void 0&&(b.last_sequencer=0);b.amendment_count===void 0&&(b.amendment_count=0);b.last_status===void 0&&(b.last_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0));return b}function F(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.caller_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.streams_to_check=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=E(a);b.streams_to_check.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.caller_timestamp_ms===void 0&&(b.caller_timestamp_ms="0");return b}function G(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.original_ping_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_missing=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();b.stream_ids_missing.push(g)}}else a.skip(e);break;case 3:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_behind=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readI64().toString();b.stream_ids_behind.push(d)}}else a.skip(e);break;case 4:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_with_lost_amendments=[];d=a.readListBegin();for(f=0;f<d.size;f++){g=a.readI64().toString();b.stream_ids_with_lost_amendments.push(g)}}else a.skip(e);break;case 5:if(e===(h||(h=c("ThriftTypes"))).LIST){b.stream_ids_with_wrong_status=[];g=a.readListBegin();for(f=0;f<g.size;f++){d=a.readI64().toString();b.stream_ids_with_wrong_status.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.original_ping_timestamp_ms===void 0&&(b.original_ping_timestamp_ms="0");return b}function H(a){var b,e={};a.readStructBegin();while(!0){var f=a.readFieldBegin(),g=f.ftype;f=f.fid;if(g===(h||(h=c("ThriftTypes"))).STOP)break;switch(f){case 1:if(g===(h||(h=c("ThriftTypes"))).I32)if(b==null)e.flow_status=d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()),b="flow_status";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: flow_status, previous deserialized field: "+b);else a.skip(g);break;case 2:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.log=B(a),b="log";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: log, previous deserialized field: "+b);else a.skip(g);break;case 3:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.rewrite=y(a),b="rewrite";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: rewrite, previous deserialized field: "+b);else a.skip(g);break;case 4:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.data=A(a),b="data";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: data, previous deserialized field: "+b);else a.skip(g);break;case 5:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.termination=C(a),b="termination";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: termination, previous deserialized field: "+b);else a.skip(g);break;case 6:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.amend_ack=D(a),b="amend_ack";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: amend_ack, previous deserialized field: "+b);else a.skip(g);break;default:a.skip(g)}a.readFieldEnd()}a.readStructEnd();return e}g.ResponseRewriteRequest$DefaultConstructor=a;g.ResponseRewriteConditionalPatchHeaders$DefaultConstructor=b;g.ResponseData$DefaultConstructor=e;g.LogMessage$DefaultConstructor=f;g.Termination$DefaultConstructor=i;g.AmendStreamAck$DefaultConstructor=j;g.StreamCheck$DefaultConstructor=k;g.Ping$DefaultConstructor=l;g.Pong$DefaultConstructor=m;g.StreamResponseDelta$DefaultConstructor=n;g.serializeResponseRewriteRequest=o;g.serializeResponseRewriteConditionalPatchHeaders=p;g.serializeResponseData=q;g.serializeLogMessage=r;g.serializeTermination=s;g.serializeAmendStreamAck=t;g.serializeStreamCheck=u;g.serializePing=v;g.serializePong=w;g.serializeStreamResponseDelta=x;g.deserializeResponseRewriteRequest=y;g.deserializeResponseRewriteConditionalPatchHeaders=z;g.deserializeResponseData=A;g.deserializeLogMessage=B;g.deserializeTermination=C;g.deserializeAmendStreamAck=D;g.deserializeStreamCheck=E;g.deserializePing=F;g.deserializePong=G;g.deserializeStreamResponseDelta=H}),98);
__d("RequestStreamSingleChannelSingleChannelRequestStreamTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Ignored:100,Success:200,Queued:250,UnknownStream:400,HandledUnknownResult:450,Failure:500});c=b("$InternalEnum")({Request_headers:"request_headers",Request_body:"request_body",Amend:"amend",Ack:"ack",Response:"response",Ping:"ping",Pong:"pong"});e.exports={Ack:a,Payload$Types:c}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers",["RequestStreamCommonRequestStreamCommonSerializers","RequestStreamCommonRequestStreamCommonTypes","RequestStreamSingleChannelSingleChannelRequestStreamTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return{}}function b(){return{body:Uint8Array.of()}}function e(){return{amendment:Uint8Array.of()}}function f(){return{ack:d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)}}function i(){return{delta:[]}}function j(){return{}}function k(a,b){b.writeStructBegin("RequestStreamHeaders"),a.headers!=null&&(b.writeFieldBegin({fname:"headers",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1}),b.writeBinary(a.headers),b.writeFieldEnd()),a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd()),b.writeFieldStop(),b.writeStructEnd()}function l(a,b){b.writeStructBegin("RequestStreamBody");b.writeFieldBegin({fname:"body",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:1});if(a.body!=null)b.writeBinary(a.body);else{a=Uint8Array.of();b.writeBinary(a)}b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd()}function m(a,b){b.writeStructBegin("AmendStream");a.amendment_id!=null&&(b.writeFieldBegin({fname:"amendment_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.amendment_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"amendment",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:2});if(a.amendment!=null)b.writeBinary(a.amendment);else{var d=Uint8Array.of();b.writeBinary(d)}b.writeFieldEnd();a.is_query!=null&&(b.writeFieldBegin({fname:"is_query",ftype:(h||(h=c("ThriftTypes"))).BOOL,fid:3}),b.writeBool(a.is_query),b.writeFieldEnd());a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function n(a,b){b.writeStructBegin("StreamResponseAck");a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.response_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"ack",ftype:(h||(h=c("ThriftTypes"))).I32,fid:2});if(a.ack!=null){var e;b.writeI32((e=a.ack)!=null?e:0)}else{e=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0);b.writeI32(e!=null?e:0)}b.writeFieldEnd();a.query_result!=null&&(b.writeFieldBegin({fname:"query_result",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:3}),b.writeBinary(a.query_result),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function o(a,b){b.writeStructBegin("StreamResponse");a.response_id!=null&&(b.writeFieldBegin({fname:"response_id",ftype:(h||(h=c("ThriftTypes"))).I64,fid:1}),b.writeI64(c("jsbi").BigInt(a.response_id)),b.writeFieldEnd());b.writeFieldBegin({fname:"delta",ftype:(h||(h=c("ThriftTypes"))).LIST,fid:2});if(a.delta!=null){b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:a.delta.length});for(var e of a.delta)d("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(e,b);b.writeListEnd()}else{e=[];b.writeListBegin({etype:(h||(h=c("ThriftTypes"))).STRUCT,size:e.length});for(e of e)d("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(e,b);b.writeListEnd()}b.writeFieldEnd();if(a.ack_level!=null){b.writeFieldBegin({fname:"ack_level",ftype:(h||(h=c("ThriftTypes"))).I32,fid:3});b.writeI32((e=a.ack_level)!=null?e:0);b.writeFieldEnd()}a.query_request!=null&&(b.writeFieldBegin({fname:"query_request",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:4}),b.writeBinary(a.query_request),b.writeFieldEnd());a.instrumentation_data!=null&&(b.writeFieldBegin({fname:"instrumentation_data",ftype:(h||(h=c("ThriftTypes"))).STRING,fid:5}),b.writeBinary(a.instrumentation_data),b.writeFieldEnd());b.writeFieldStop();b.writeStructEnd()}function p(a,b){b.writeStructBegin("Payload");if(a.request_headers!=null){b.writeFieldBegin({fname:"request_headers",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:1});k(a.request_headers,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.request_body!=null){b.writeFieldBegin({fname:"request_body",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:2});l(a.request_body,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.amend!=null){b.writeFieldBegin({fname:"amend",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:3});m(a.amend,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ack!=null){b.writeFieldBegin({fname:"ack",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:4});n(a.ack,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.response!=null){b.writeFieldBegin({fname:"response",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:5});o(a.response,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.ping!=null){b.writeFieldBegin({fname:"ping",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:6});d("RequestStreamCommonRequestStreamCommonSerializers").serializePing(a.ping,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}if(a.pong!=null){b.writeFieldBegin({fname:"pong",ftype:(h||(h=c("ThriftTypes"))).STRUCT,fid:7});d("RequestStreamCommonRequestStreamCommonSerializers").serializePong(a.pong,b);b.writeFieldEnd();b.writeFieldStop();b.writeStructEnd();return}b.writeFieldStop();b.writeStructEnd()}function q(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.headers=a.readBinary():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return b}function r(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).STRING?b.body=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.body===void 0&&(b.body=Uint8Array.of());return b}function s(a){var b={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===(h||(h=c("ThriftTypes"))).STOP)break;switch(d){case 1:e===(h||(h=c("ThriftTypes"))).I64?b.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===(h||(h=c("ThriftTypes"))).STRING?b.amendment=a.readBinary():a.skip(e);break;case 3:e===(h||(h=c("ThriftTypes"))).BOOL?b.is_query=a.readBool():a.skip(e);break;case 4:e===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();b.amendment===void 0&&(b.amendment=Uint8Array.of());return b}function t(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.response_id=a.readI64().toString():a.skip(f);break;case 2:f===(h||(h=c("ThriftTypes"))).I32?b.ack=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(a.readI32()):a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).STRING?b.query_result=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.ack===void 0&&(b.ack=d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0));return b}function u(a){var b={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===(h||(h=c("ThriftTypes"))).STOP)break;switch(e){case 1:f===(h||(h=c("ThriftTypes"))).I64?b.response_id=a.readI64().toString():a.skip(f);break;case 2:if(f===(h||(h=c("ThriftTypes"))).LIST){b.delta=[];e=a.readListBegin();for(var g=0;g<e.size;g++){var i=d("RequestStreamCommonRequestStreamCommonSerializers").deserializeStreamResponseDelta(a);b.delta.push(i)}}else a.skip(f);break;case 3:f===(h||(h=c("ThriftTypes"))).I32?b.ack_level=d("RequestStreamCommonRequestStreamCommonTypes").AckLevel.cast(a.readI32()):a.skip(f);break;case 4:f===(h||(h=c("ThriftTypes"))).STRING?b.query_request=a.readBinary():a.skip(f);break;case 5:f===(h||(h=c("ThriftTypes"))).STRING?b.instrumentation_data=a.readBinary():a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();b.delta===void 0&&(b.delta=[]);return b}function v(a){var b,e={};a.readStructBegin();while(!0){var f=a.readFieldBegin(),g=f.ftype;f=f.fid;if(g===(h||(h=c("ThriftTypes"))).STOP)break;switch(f){case 1:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.request_headers=q(a),b="request_headers";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_headers, previous deserialized field: "+b);else a.skip(g);break;case 2:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.request_body=r(a),b="request_body";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_body, previous deserialized field: "+b);else a.skip(g);break;case 3:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.amend=s(a),b="amend";else throw new Error("more than one field have been deserialized in union type: Payload; current field: amend, previous deserialized field: "+b);else a.skip(g);break;case 4:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.ack=t(a),b="ack";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ack, previous deserialized field: "+b);else a.skip(g);break;case 5:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.response=u(a),b="response";else throw new Error("more than one field have been deserialized in union type: Payload; current field: response, previous deserialized field: "+b);else a.skip(g);break;case 6:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.ping=d("RequestStreamCommonRequestStreamCommonSerializers").deserializePing(a),b="ping";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ping, previous deserialized field: "+b);else a.skip(g);break;case 7:if(g===(h||(h=c("ThriftTypes"))).STRUCT)if(b==null)e.pong=d("RequestStreamCommonRequestStreamCommonSerializers").deserializePong(a),b="pong";else throw new Error("more than one field have been deserialized in union type: Payload; current field: pong, previous deserialized field: "+b);else a.skip(g);break;default:a.skip(g)}a.readFieldEnd()}a.readStructEnd();return e}g.RequestStreamHeaders$DefaultConstructor=a;g.RequestStreamBody$DefaultConstructor=b;g.AmendStream$DefaultConstructor=e;g.StreamResponseAck$DefaultConstructor=f;g.StreamResponse$DefaultConstructor=i;g.Payload$DefaultConstructor=j;g.serializeRequestStreamHeaders=k;g.serializeRequestStreamBody=l;g.serializeAmendStream=m;g.serializeStreamResponseAck=n;g.serializeStreamResponse=o;g.serializePayload=p;g.deserializeRequestStreamHeaders=q;g.deserializeRequestStreamBody=r;g.deserializeAmendStream=s;g.deserializeStreamResponseAck=t;g.deserializeStreamResponse=u;g.deserializePayload=v}),98);
__d("RequestStreamState",["RequestStreamCommonRequestStreamCommonTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){switch(b){case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:if(a.seenAccepted)return a;return a.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started?a:{flowStatus:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted,seenAccepted:!0};default:if(!a.seenAccepted||a.flowStatus===b)return a;else return{flowStatus:b,seenAccepted:!0}}}g.getNextState=a}),98);
__d("StreamRetryState",[],(function(a,b,c,d,e,f){"use strict";var g=1e3,h=2*60*1e3;a=function(){function a(){this.$1=0}var b=a.prototype;b.resetErrorAndRetryCount=function(){this.$1=0};b.onRetry=function(){this.$1+=1};b.getRetryCount=function(){return this.$1};b.getBackoffDelayMs=function(){if(this.$1<=1)return 0;if(this.$1===2)return g*Math.random();var a=g*Math.pow(2,this.$1-3),b=a*Math.random();a=a+b;return Math.min(a,h)};return a}();f["default"]=a}),66);
__d("DGWRequestStreamRef",["CompactSerializerPolyfill","DGWRequestStreamUtils","DGWStream","DGWStreamHandler","InflightAmends","ODS","RequestStreamCloseReason","RequestStreamCommonRequestStreamCommonTypes","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2ELogger","RequestStreamE2ESampling","RequestStreamSingleChannelSingleChannelRequestStreamSerializers","RequestStreamSingleChannelSingleChannelRequestStreamTypes","RequestStreamState","RequestStreamTransport","RtiWebRequestStreamClient","StreamRetryState","err","gkx","justknobx","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i=4,j=0,k=1e3,l=2,m=c("gkx")("20915")?3e4:5e3,n="dgw_stream_send_ack_failure",o=(a=c("qex")._("2097"))!=null?a:!1,p=(b=c("qex")._("2100"))!=null?b:!1;function q(a){if(!a){a=c("err")(n);a.stack;throw a}}function r(a,b){if(a==null||a.length===0)return null;a=JSON.parse(a);a.auxId=b;return new TextEncoder().encode(JSON.stringify(a))}function s(a){var b={};a=a.delta;a.forEach(function(a){if(a.flow_status){b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Flow_status;switch(a.flow_status){case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:b.flow_status="Accepted";break;case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started:b.flow_status="Started";break;case d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped:b.flow_status="Stopped";break}}else a.log?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Log:a.rewrite?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Rewrite:a.data?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Data:a.termination?b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Termination:a.amend_ack&&(b.type=d("RequestStreamCommonRequestStreamCommonTypes").StreamResponseDelta$Types.Amend_ack)});return b}e=function(){function a(a,b,e,f,g,h){var j=this,k;this.$6=null;this.$7={};this.$10=!1;this.$15=new(c("StreamRetryState"))();this.$16=0;this.$17=0;this.$18=0;this.$21=0;var l=null;typeof b==="string"?l=new TextEncoder().encode(b):typeof b==="object"&&(l=b);this.$1={headers:a,body:l};this.$3=e;this.$4=f;this.$12=i;this.$9=!1;this.$14=!1;this.$20=h;l=f==null?void 0:f.serviceId;g!=null&&(this.$22()||(g.dgwStreamGroupLoggingId=this.$20.getStreamGroupLoggingId(l)),g.dgwCountPriorStreamsInGroup=this.$20.guessStreamGroupPriorStreamCount(l),g.transport="WEB_RS_STARGATE");this.$5=d("RequestStreamE2ESampling").validateInstrumentationData(a,g,f==null?void 0:f.requestLogContext,f==null?void 0:f.upsampleMultiplier);!this.$22()?this.$6=d("RequestStreamE2ELogger").createStreamLogger(a,this.$5,d("RequestStreamTransport").RequestStreamTransport.WEB_RS_STARGATE):this.$7.disableFalcoLogging=!0;(f==null?void 0:f.deviceId)!=null&&(this.$7.deviceId=f.deviceId);this.$6&&(this.$7.loggingId=this.$6.getRequestId());f&&f.overrideUrl!=null&&(this.$7.overrideUrl=f.overrideUrl);l!=null&&(this.$7.serviceId=l);this.$8={flowStatus:d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped,seenAccepted:!1};this.$19=new(c("InflightAmends"))(m,function(a,b){var d;(d=j.$6)==null||d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,c("RequestStreamE2EClientLoggerEvent").RECEIVED,babelHelpers.extends({},j.$23(),{latency:b.toString()}),a)},function(a,b){if(b.message!==n){var d;(d=j.$6)==null||d.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT_ACK,c("RequestStreamE2EClientLoggerEvent").FAILURE,babelHelpers.extends({},j.$23(),{reason:b.message}),a)}});(e=this.$6)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{data_size:(h=b==null||(k=b.length)==null?void 0:k.toString())!=null?h:"0"},"0","0")}var b=a.prototype;b.getInstrumentationData=function(){return this.$5};b.getE2EClientLogger=function(){return this.$6};b.amendWithAck=function(a){a=this.$24(a,!0);return a==null?Promise.resolve(!1):this.$19.getPromise(a)||Promise.resolve(!1)};b.amendWithoutAck=function(a){this.$24(a,!1)};b.cancel=function(){var a;(a=this.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").CANCEL,c("RequestStreamE2EClientLoggerEvent").RECEIVED);this.$9=!0;this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)};b.start=function(a){var b=this;a===void 0&&(a=!1);var e=String(this.$16++),f=Date.now();return this.$26(e).then(function(){var a;b.$14=!1;b.$21=0;var d=(Date.now()-f).toString();(a=b.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:d},e,String(b.$18))}).catch(function(f){f.stack;if(f.message===n&&b.$10)return;b.$14=!1;if(f!==d("DGWStream").StreamError.ESTABLISHMENT_ERROR){var g,h=f.message;f===d("DGWStream").StreamError.UNAUTHENTICATED?h="UNAUTHENTICATED":f===d("DGWStream").StreamError.UNAUTHORIZED&&(h="UNAUTHORIZED");(g=b.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:h},e,String(b.$18));b.$25(a?d("RequestStreamCloseReason").RequestStreamCloseReason.ReestablishError:d("RequestStreamCloseReason").RequestStreamCloseReason.StartStreamFailure,h,!0);if(f===d("DGWStream").StreamError.UNAUTHENTICATED||f===d("DGWStream").StreamError.UNAUTHORIZED)return;throw f}else{(g=b.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:(h=f.message)!=null?h:f},e,String(b.$18));b.$15.onRetry();var i=c("gkx")("20916")?b.$15.getBackoffDelayMs():k*Math.pow(l,b.$21);return new Promise(function(a){return window.setTimeout(a,i)}).then(function(){b.$21++;b.$18++;return b.start()})}})};b.getFlowStatus=function(){return this.$8.flowStatus};b.shouldTerminateOrRetry=function(a,b,e,f){var g=this;if(this.$14)return;var h=b;this.$12||(h="cannot retry for error: "+b+" because of hit max retry limitation");if(a!==d("RequestStreamCloseReason").RequestStreamCloseReason.ClientError){(b=this.$6)==null||b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:h},null,String(this.$18))}b=e&&(c("gkx")("20916")||this.$12);this.$25(a,h,!b);if(b){var i=c("gkx")("20916")?Math.max(f!=null?f:0,this.$15.getBackoffDelayMs()):f!=null?f:j;this.$14=!0;return new Promise(function(a){return window.setTimeout(a,i)}).then(function(){return g.$27()}).catch(function(a){})}};b.$28=function(){return this.$11!=null};b.$24=function(a,b){var e,f=this,g=typeof a==="string"?new TextEncoder().encode(a):a,h=String(this.$17++);(e=this.$6)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").RECEIVED,{},h);e=r(this.$5,h);g={amend:{amendment:g,instrumentation_data:e}};b&&g.amend&&(g.amend.amendment_id=h);e=d("CompactSerializerPolyfill").serialize(g,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);var i=Date.now();if(this.$29()&&this.$11!=null){var j;b&&this.$19.add(h);this.$11.send(e).then(function(a){var b;q(a);a=(Date.now()-i).toString();(b=f.$6)==null||b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").PUBACK,{latency:a},h)}).catch(function(a){var b;(b=f.$6)==null||b.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:a.message},h);f.$19.reject(h,a)});(g=this.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").SENT,{data_size:(b=a==null||(j=a.length)==null?void 0:j.toString())!=null?b:"0"},h);return h}else{(e=this.$6)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").AMENDMENT,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},h)}};b.$26=async function(a){var b=this;if(!this.$9){var e=this.$2||this.$1;try{var f=this.$30();this.$13=f;var g=e.headers.graphiql_sandbox,h=babelHelpers.extends({},e.headers,this.$31());g!=null&&(h=babelHelpers.extends({},h,{www_sandbox:g,distillery_sandbox:g+":8086"}));g=d("DGWRequestStreamUtils").convertHeaders(h,e.body!=null,this.$5);this.$11=await this.$20.establishStream(g,f,this.$7)}catch(a){if(a===d("DGWStream").StreamError.ESTABLISHMENT_ERROR)throw a;if(d("DGWStream").StreamError.isValid(a)&&!d("DGWStream").isRetryableError(a))throw a;else if(d("DGWStream").StreamError.isValid(a)&&d("DGWStream").isRetryableError(a)){this.$32(a);return}throw a}if(this.$9){this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0);return}h=new Uint8Array([]);if(e.body!=null){g={request_body:{body:e.body}};h=d("CompactSerializerPolyfill").serialize(g,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload)}if(!this.$11)throw new Error("dgwstream_is_null");f=this.$11.send(h).then(function(a){q(a),b.$9&&b.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.UserIntention,"user cancel the stream",!0)});(e=this.$6)==null||e.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").SENT,{},a,String(this.$18));this.$12=i;return f}else throw new Error("stream_already_canceled")};b.$29=function(){return this.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started||this.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted};b.$25=function(a,b,c){var e;this.$11&&a!==d("RequestStreamCloseReason").RequestStreamCloseReason.StreamError&&a!==d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination&&this.$11.close();(e=this.$13)==null||e.stop();this.$11=null;this.$10=!0;this.$33(d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped)&&this.$3.onFlowStatus(d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped);c&&!this.$9&&this.$3.onTermination("terminate stream because "+a+" with msg : "+b)};b.$33=function(a){var b=this.$8;this.$8=d("RequestStreamState").getNextState(b,a);return b!==this.$8};b.$27=function(){this.$12--;this.$18++;this.$15.onRetry();return this.start(!0)};b.$34=function(a){var b=this;a=d("CompactSerializerPolyfill").deserialize(a,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(a.response){var e=d("DGWRequestStreamUtils").getInstrumentationDataFieldsFromPayload(a),f=e==null?void 0:e.auxId;e=e==null?void 0:e.dfTraceId;if(!this.$28()){var g;(g=this.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"response_received_after_close"},f,String(this.$18),e);return}(g=this.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").RECEIVED,s(a.response),f,String(this.$18),e);g=a.response.delta;g.forEach(function(a){if(a.data)b.$15.resetErrorAndRetryCount(),c("justknobx")._("4109")?b.$3.onData(new TextDecoder("utf-8").decode(a.data.bytes)):b.$8.flowStatus===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started?b.$3.onData(new TextDecoder("utf-8").decode(a.data.bytes)):(h||(h=d("ODS"))).bumpEntityKey(110,"RequestStream","data_before_started_"+(b.$22()?"falco":"graphql"));else if(a.flow_status){var e=a.flow_status;e===d("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&b.$15.resetErrorAndRetryCount();b.$33(e)&&b.$3.onFlowStatus(e)}else if(a.termination){e=(e=a.termination.message)!=null?e:"unknown termination msg";b.$2=null;b.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,e,a.termination.reason===d("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.TryAgain,a.termination.retry_delay_ms!=null?parseInt(a.termination.retry_delay_ms,10):null)}else if(a.log)b.$3.onLog(a.log.message);else if(a.amend_ack){e=a.amend_ack.amendment_id;if(e!=null){var f=a.amend_ack.accepted||!1;b.$19.resolve(e,f)}}else if(a.rewrite){e=d("DGWRequestStreamUtils").transformContextWithRewriteDelta(b.$1,a.rewrite);a.rewrite.temporary===!0?b.$2=e:b.$1=e}});(g=this.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").SENT,s(a.response),f,String(this.$18),e);a.response.ack_level===d("RequestStreamCommonRequestStreamCommonTypes").AckLevel.Device&&a.response.response_id!=null&&this.$35(a.response.response_id,f)}else{(g=this.$6)==null||g.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"unexpected_payload_type"},null,String(this.$18))}};b.$35=function(a,b){a={ack:{response_id:a,ack:d("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.Success}};a=d("CompactSerializerPolyfill").serialize(a,d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload);if(this.$11!=null){this.$11.send(a);(a=this.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,c("RequestStreamE2EClientLoggerEvent").SENT,{},b,String(this.$18))}else{(a=this.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE_ACK,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"not_started"},b,String(this.$18))}};b.$22=function(){return this.$1.headers.method==="Falco"};b.$30=function(){return new(c("DGWStreamHandler"))(this.$36.bind(this),this.$37.bind(this),this.$32.bind(this),this.$38.bind(this),this.$39.bind(this))};b.$39=function(a){(a=this.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Has FinishedSendingData"},null,String(this.$18));this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.ServerDataEnd,"Client receive OnServerHasFinishedSendingData and Server will not send more data",!0)};b.$36=function(a){(a=this.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:"OnClose: Server Close Connection"},null,String(this.$18));this.$25(d("RequestStreamCloseReason").RequestStreamCloseReason.RemoteTermination,"Client receive OnClose and Server will not send more data",!0)};b.$37=function(a){try{this.$34(a)}catch(b){(a=this.$6)==null||a.logE2EEvent(c("RequestStreamE2EClientLoggerMessageType").RESPONSE,c("RequestStreamE2EClientLoggerEvent").FAILURE,{reason:b.message},null,String(this.$18));this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.ClientError,b.message,!1)}};b.$32=function(a){var b="",c=d("DGWStream").isRetryableError(a);b="StreamError: Received "+a;a=o?this.$12>0:c;c=p?k*l:void 0;this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.StreamError,b,a,c)};b.$38=function(a,b){this.shouldTerminateOrRetry(d("RequestStreamCloseReason").RequestStreamCloseReason.ServerDrain,b,!0)};b.$31=function(){return c("RtiWebRequestStreamClient").overrideHeaders};b.$23=function(){var a={};c("gkx")("20918")&&(a.pending_amendments_size=this.$19.getSize().toString());return a};return a}();g.default=e}),98);
__d("DGWStreamGroupHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c){this.$1=a,this.$2=b,this.$3=c}var b=a.prototype;b.onStreamGroupError=function(a){this.$1(a)};b.onStreamGroupMustDrain=function(a){this.$2(a)};b.onStreamGroupTransportClose=function(){this.$3()};return a}();f["default"]=a}),66);
__d("DGWStreamFactory",["DGWClient","DGWStreamGroupHandler","Promise","gkx","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i="realtime",j=1e4,k=null;a=function(){function a(){this.$1={}}a.get=function(){k==null&&(k=new a());return k};var d=a.prototype;d.$2=function(a){var b;this.$1=(b={},b[a]={dgwStreamGroup:null,multiStreamGroupLoggingId:null,multiStreamGroupPriorStreamCountGuess:0},b)};d.getStreamGroupLoggingId=function(a){a===void 0&&(a=null);return(a=this.$1[a!=null?a:i])==null?void 0:a.multiStreamGroupLoggingId};d.guessStreamGroupPriorStreamCount=function(a){a===void 0&&(a=null);return((a=this.$1[a!=null?a:i])==null?void 0:a.multiStreamGroupPriorStreamCountGuess)||0};d.establishStream=function(a,d,e){var f,g=this,k=e.serviceId==null?i:e.serviceId;f=(f=this.$1[k])==null?void 0:f.dgwStreamGroup;if(f==null||!f.canCreateGroupedStream()){var l={deviceId:e.deviceId,serviceId:k,disableFalcoLogging:e.disableFalcoLogging,streamGroupAppHeaders:{"stream-group":"group1"},authToken:e.authToken};e.overrideUrl!=null&&(l.overrideUrl=e.overrideUrl);l.keepAliveMs=j;c("gkx")("20920")&&(l.loggingId=c("uuidv4")());try{f=c("DGWClient")().createStreamGroup(new(c("DGWStreamGroupHandler"))(function(){g.$2(k)},function(){g.$2(k)},function(){g.$2(k)}),l),this.$1[k]={dgwStreamGroup:f,multiStreamGroupLoggingId:l.loggingId,multiStreamGroupPriorStreamCountGuess:0}}catch(a){return(h||(h=b("Promise"))).reject(a)}}this.$1[k].multiStreamGroupPriorStreamCountGuess++;return f.establishStream({loggingId:e.loggingId,disableFalcoLogging:e.disableFalcoLogging,groupedStreamHeaders:a},d)};return a}();g["default"]=a}),98);
__d("DGWRequestStreamClient",["DGWRequestStreamRef","DGWStreamFactory","Promise","cr:2046346"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$1=a!=null?a:c("DGWStreamFactory").get()}var d=a.prototype;d.createStream=function(a,d,e,f,g){b("cr:2046346")!=null&&b("cr:2046346").startPulsarTest();return(h||(h=b("Promise"))).resolve(new(c("DGWRequestStreamRef"))(a,d,f,g,e,this.$1))};return a}();g["default"]=a}),98);
__d("DelightsTextTriggerPostTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1497");b=d("FalcoLoggerInternal").create("delights_text_trigger_post_tapped",a);e=b;g["default"]=e}),98);
__d("WhatsappDeeplinkClickedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2");b=d("FalcoLoggerInternal").create("whatsapp_deeplink_clicked",a);e=b;g["default"]=e}),98);
__d("WhatsappDeeplinkRenderedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("20");b=d("FalcoLoggerInternal").create("whatsapp_deeplink_rendered",a);e=b;g["default"]=e}),98);
__d("cometComposerQPLLogger",["QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.type){case"COMPOSER_ENTRY":break;case"COMPOSER_FEATURE_INTENT":break;case"COMPOSER_POST":break;case"COMPOSER_POST_MUTATION_START":break;case"COMPOSER_POST_SUCCESS":h(a.fields);break;case"COMPOSER_POST_FAILURE":i(a.fields);break;case"COMPOSER_POST_CANCEL":j(a.fields);break;case"COMPOSER_POST_TERMINAL":break;case"COMPOSER_POST_SERVER_CONTENT_RENDERED":break;case"COMPOSER_PUBLISH_FLOW_OPTIMISTIC_PROCESS":break;default:break}}function h(a){a=(a=a.payload)==null?void 0:a.qplEvent;if(a!=null)switch(a){case c("qpl")._(37631558,"4977"):c("QPLUserFlow").addPoint(c("qpl")._(37631558,"4977"),"composer_post_success");c("QPLUserFlow").endSuccess(c("qpl")._(37631558,"4977"));break;default:break}}function i(a){var b;b=(b=a.payload)==null?void 0:b.qplEvent;if(b!=null){a=a.errorDescription!=null?a.errorDescription:"";switch(b){case c("qpl")._(37631558,"4977"):c("QPLUserFlow").endFailure(c("qpl")._(37631558,"4977"),"composer_post_cancel",{debugInfo:a});break;default:break}}}function j(a){a=(a=a.payload)==null?void 0:a.qplEvent;if(a!=null)switch(a){case c("qpl")._(37631558,"4977"):c("QPLUserFlow").addPoint(c("qpl")._(37631558,"4977"),"composer_post_cancel");c("QPLUserFlow").endCancel(c("qpl")._(37631558,"4977"));break;default:break}}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("ArmadilloReceiveWriteDbSuccessFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5721");b=d("FalcoLoggerInternal").create("armadillo_receive_write_db_success",a);e=b;g["default"]=e}),98);
__d("EBGenerateMessageTags",["EncryptedBackupsUploadEntity","MSGDataclassTypes.flow"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.IMAGE:return d("MSGDataclassTypes.flow").MpsMessageTag.Photo;case d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.VIDEO:return d("MSGDataclassTypes.flow").MpsMessageTag.Video;case d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.GIF:return d("MSGDataclassTypes.flow").MpsMessageTag.Gif;case d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.PTT:return d("MSGDataclassTypes.flow").MpsMessageTag.Audio;case d("EncryptedBackupsUploadEntity").AttachmentContextMediaType.DOCUMENT:return d("MSGDataclassTypes.flow").MpsMessageTag.File;default:return null}}g.generateEBMessageTags=a}),98);
__d("EBGraphQLRestoreDefinition",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.toMpsMessageQueryForGraphQLQuery=a}),66);
__d("EBMinosDisableLabyrinth10Uploads",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("16675")}g.disableLabyrinth10Uploads=a}),98);
__d("EBgenerateMPSMessageQuery",["EBGraphQLRestoreDefinition"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return{__typename:"MPSMessageQuery",ctx:{__typename:"MPSQueryContext",caller:"HISTORY_RESTORE"},query:{__typename:"MPSMessagePointQuery",include_deleted:!1,otids:b,thread_id:a}}}function a(a,b){return d("EBGraphQLRestoreDefinition").toMpsMessageQueryForGraphQLQuery(JSON.stringify(h(a,b)))}g.generateMPSMessageQuery=h;g.generateMPSMessageQueryForGraphQLQuery=a}),98);
__d("EncryptedBackupsConvertToLegacyAttachmentContext",["MAWCastToMsgrServerMediaType","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=[];for(a of a){var c=d("MAWCastToMsgrServerMediaType").castMediaAttachmentTypeToServerMediaType(a.mediaType);c==null?d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["invalid "," media type for legacy attachment upload"])),a.mediaType):b.push({mediaObjectId:a.mediaObjectId,mediaType:c})}return b}g["default"]=a}),98);
__d("EncryptedBackupsResignCdnUrl",["MAWBridge","MAWConfig","MAWLoggerUtils","WAGetSafeQPLError","WAJids","WAPromiseDelays","WAResolvable","WAResultOrError","cr:10071"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function a(a){return i.get(a)}function c(a){var b=a.deliveryObjectId,c=a.logger,e=a.mediaDownloadFlow,f=a.mediaType,g=a.msgId,i=a.protocolMsgId;a=a.sortOrderMs;e.addPoint("resign_cdn_url_start");return j({deliveryObjectId:b,mediaDownloadFlow:{addAnnotations:function(a){e==null||e.addAnnotations(babelHelpers.extends({},a))},addPoint:function(a,b){e==null||e.addPoint(a,babelHelpers.extends({},b))}},mediaType:f,msgId:g,protocolMsgId:i,sortOrderMs:a}).then(function(a){if(!a.success){e.addPoint("resign_cdn_url_fail",{string:{resignCdnUrlFailReason:a.error}});return a}e==null||e.addPoint("resign_cdn_url_end");return a}).catch(function(a){c.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["resignCdnUrl runtime-error: ",""])),a);e.addPoint("resign_cdn_url_fail",{string:{resignCdnUrlFailReason:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a)}});return d("WAResultOrError").makeError("resign-cdn-url-runtime-error")})}async function j(a){var c=a.deliveryObjectId,e=a.mediaDownloadFlow,f=a.mediaType,g=a.msgId,h=a.protocolMsgId;a=a.sortOrderMs;if(b("cr:10071")!==null){e=await b("cr:10071").eblsResignCdnUrlWithGraphQL({chatJid:h.chat,deliveryObjectId:c,externalId:h.externalId,mediaDownloadFlow:e,mediaType:f,sortOrderMs:a});return!e.success?e:d("WAResultOrError").makeResult(e.value)}else{var j=d("MAWLoggerUtils").getInstanceKey();e=new(d("WAResolvable").Resolvable)();i.set(j,e);d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"ResignAttachmentCDNUrl",value:{deliveryObjectId:c,mediaType:f,messageId:h.externalId,msgId:g,productType:d("MAWConfig").getConfig().productTypeForEBAttachments,skipLegacyMediaDownloadFlow:!0,sortOrder:a,threadId:d("WAJids").threadIdForChatJid(h.chat),threadJid:h.chat,traceId:j}}]});return d("WAPromiseDelays").withTimeout(e.promise,15*60*1e3,function(){return d("WAResultOrError").makeError("resign-cdn-url-timeout")}).finally(function(){i.delete(j)})}}g.getRestoredCdnUrlResolvable=a;g.resignCdnUrl=c}),98);
__d("EncryptedBackupsUploadQueue",["EBMinosDisableLabyrinth10Uploads","EncryptedBackupsUploadEntity","MWEBODSEntityName.enum","MWEBODSUtils","PersistedQueueApi","Promise","QPLUserFlow","WAPersistedQueue","WATagsLogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("WATagsLogger").TAGS(["EbUploadQueue"]),l=null;function m(){return l==null?n():l}function n(){l!=null&&k.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["EB Upload Queue is already initialized"])));var a=d("WAPersistedQueue").initPersistedQueue("ebUploadQueue",d("PersistedQueueApi").persistedQueueApi());l=a;return a}function a(a){if(a.length===0||d("EBMinosDisableLabyrinth10Uploads").disableLabyrinth10Uploads())return(j||(j=b("Promise"))).resolve();d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_COUNTER,"upload.api.put",a.length);var e=m();return e.addAndCommit(a.map(d("EncryptedBackupsUploadEntity").asEBUploadEntity)).then(function(){a.forEach(function(a){(a==null?void 0:a.instanceKey)!=null&&c("QPLUserFlow").endSuccess(c("qpl")._(521477113,"2698"),{instanceKey:a.instanceKey})})})["catch"](function(a){k.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to write to ebUploadQueue ",""])),a);return(j||(j=b("Promise"))).reject(a)})}g.logger=k;g.ebUploadQueue=m;g.initEbUploadQueue=n;g.putMsgsToEbUpload=a}),98);
__d("LSEncryptedBackupsMessagesRangeQueryDirection",[],(function(a,b,c,d,e,f){a=Object.freeze({BEFORE:1,AFTER:2});f["default"]=a}),66);
__d("MAWAdminMsgHelpers",["MAWCreateParticipantAdminMsg","MAWExternalId","MAWRemoveParticipantAdminMsg","WAAckLevel","WAGlobals","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h="Facebook User";function a(a){return a==null||a===""?h:a}function b(a){return a!=null?d("WAJids").userIdFromJid(a):h}function c(a,b,c,e){return{ack:d("WAAckLevel").ACK.SENT,id:{author:d("WAJids").AUTHOR_SYSTEM,chat:a,externalId:d("MAWExternalId").generateExternalId()},msgContent:d("MAWCreateParticipantAdminMsg").createParticipantAdminMessage(c==="@me"?d("WAGlobals").getMyUserJid():c,b),serverTs:e,ts:e,type:"Admin"}}function e(a,b,c,e){return{ack:d("WAAckLevel").ACK.SENT,id:{author:d("WAJids").AUTHOR_SYSTEM,chat:a,externalId:d("MAWExternalId").generateExternalId()},msgContent:d("MAWRemoveParticipantAdminMsg").removeParticipantAdminMessage(c==="@me"?d("WAGlobals").getMyUserJid():c,b),serverTs:e,ts:e,type:"Admin"}}function f(a,b,c,e){var f,g=d("WAGlobals").getMyUserJid();c=c==="@me"?g:c;if(c===g)f={adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"currentUserPromotedParticipant"};else if(c==null)f=b===g?{adminMsgContent:[],adminType:"currentUserGotPromoted"}:{adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"participantGotPromoted"};else{c=d("WAJids").userIdFromJid(c);f=b===g?{adminMsgContent:[c],adminType:"participantPromotedYou"}:{adminMsgContent:[c,d("WAJids").userIdFromJid(b)],adminType:"participantPromotedParticipant"}}return{ack:d("WAAckLevel").ACK.SENT,id:{author:d("WAJids").AUTHOR_SYSTEM,chat:a,externalId:d("MAWExternalId").generateExternalId()},msgContent:f,serverTs:e,ts:e,type:"Admin"}}function i(a,b,c,e){var f,g=d("WAGlobals").getMyUserJid();c=c==="@me"?g:c;if(c===g)f=b===g?{adminMsgContent:[],adminType:"currentUserSelfDemoted"}:{adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"currentUserDemotedParticipant"};else if(c==null)f=b===g?{adminMsgContent:[],adminType:"currentUserGotDemoted"}:{adminMsgContent:[d("WAJids").userIdFromJid(b)],adminType:"participantGotDemoted"};else{var h=d("WAJids").userIdFromJid(c);f=b===g?{adminMsgContent:[h],adminType:"participantDemotedYou"}:{adminMsgContent:[h,d("WAJids").userIdFromJid(b)],adminType:c===b?"participantSelfDemoted":"participantDemotedParticipant"}}return{ack:d("WAAckLevel").ACK.SENT,id:{author:d("WAJids").AUTHOR_SYSTEM,chat:a,externalId:d("MAWExternalId").generateExternalId()},msgContent:f,serverTs:e,ts:e,type:"Admin"}}function j(a,b,c,e){var f=[],g=b.subject.content;if(g==null)return;b.subject.user===d("WAGlobals").getMyUserJid()?(b="currentUserNamedGroup",f.push(g)):c==null?(b="unkonwnUserNamedGroup",f.push(g)):(b="participantNamedGroup",f.push(c,g));return{ack:d("WAAckLevel").ACK.SENT,id:{author:d("WAJids").AUTHOR_SYSTEM,chat:a,externalId:d("MAWExternalId").generateExternalId()},msgContent:{adminMsgContent:f,adminType:b},serverTs:e,ts:e,type:"Admin"}}function k(a,b,c,e){var f,g=[];if(c===d("WAGlobals").getMyUserJid())switch(b){case"all_member_add":f="currentUserSetAddModeAllMembers";break;case"admin_add":f="currentUserSetAddModeAdminOnly";break}else if(c!=null){g.push(d("WAJids").userIdFromJid(c));switch(b){case"all_member_add":f="participantSetAddModeAllMembers";break;case"admin_add":f="participantSetAddModeAdminOnly";break}}else switch(b){case"all_member_add":f="serverSetAddModeAllMembers";break;case"admin_add":f="serverSetAddModeAdminOnly";break}if(f==null)return;return{ack:d("WAAckLevel").ACK.SENT,id:{author:d("WAJids").AUTHOR_SYSTEM,chat:a,externalId:d("MAWExternalId").generateExternalId()},msgContent:{adminMsgContent:g,adminType:f},serverTs:e,ts:e,type:"Admin"}}g.UNKNOWN_USER=h;g.maybeUnknownParticipantName=a;g.createAdminMsgContactId=b;g.createParticipantAddAdminMessage=c;g.createParticipantRemoveAdminMsg=e;g.createParticipantPromoteAdminMsg=f;g.createParticipantDemoteAdminMsg=i;g.createGroupNameChangeAdminMsg=j;g.createMemberAddModeChangeAdminMsg=k}),98);
__d("MAWCreateParticipantAdminMsg",["MAWAdminMsgHelpers","WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:"participantAddedYou"};case 2:return{adminMsgContent:[b,c],adminType:"participantAddedYouAndOneUser"};default:return{adminMsgContent:[b,a.toString()],adminType:"participantAddedYouAndMoreThanOneUsers"}}}function i(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:"currentUserAddedOneParticipant"};case 2:return{adminMsgContent:[b,c],adminType:"currentUserAddedTwoParticipant"};default:return{adminMsgContent:[b,a.toString()],adminType:"currentUserAddedMoreThanTwoParticipant"}}}function j(a,b,c,d){switch(a){case 1:return{adminMsgContent:[b,c],adminType:"participantAddedOneUser"};case 2:return{adminMsgContent:[b,c,d],adminType:"participantAddedTwoUser"}}return{adminMsgContent:[b,c,a.toString()],adminType:"participantAddedMoreThanTwoUser"}}function a(a,b,c,e){e=e==null?b.map(d("MAWAdminMsgHelpers").createAdminMsgContactId):e;var f=e[0];e=e[1];c=c==null?d("MAWAdminMsgHelpers").createAdminMsgContactId(a):d("MAWAdminMsgHelpers").maybeUnknownParticipantName(c);if(a===d("WAGlobals").getMyUserJid())return i(b.length,d("MAWAdminMsgHelpers").maybeUnknownParticipantName(f),d("MAWAdminMsgHelpers").maybeUnknownParticipantName(e));return b.includes(d("WAGlobals").getMyUserJid())?h(b.length,d("MAWAdminMsgHelpers").maybeUnknownParticipantName(c),d("MAWAdminMsgHelpers").maybeUnknownParticipantName(b[0]===d("WAGlobals").getMyUserJid()?e:f)):j(b.length,c,d("MAWAdminMsgHelpers").maybeUnknownParticipantName(f),d("MAWAdminMsgHelpers").maybeUnknownParticipantName(e))}g.createParticipantAdminMessage=a}),98);
__d("MAWRemoveParticipantAdminMsg",["MAWAdminMsgHelpers","WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){switch(a){case 1:return{adminMsgContent:[b],adminType:"participantRemovedYou"};case 2:return{adminMsgContent:[b,c],adminType:"participantRemovedYouAndOneUser"};default:return{adminMsgContent:[b,a.toString()],adminType:"participantRemovedYouAndMoreThanOneUsers"}}}function i(a,b,c,d){switch(a){case 1:return d?{adminMsgContent:[],adminType:"currentUserLeftGroup"}:{adminMsgContent:[b],adminType:"currentUserRemovedOneParticipant"};case 2:return{adminMsgContent:[b,c],adminType:"currentUserRemovedTwoParticipant"};default:return{adminMsgContent:[b,a.toString()],adminType:"currentUserRemovedMoreThanTwoParticipant"}}}function j(a,b,c,d,e){switch(a){case 1:return e?{adminMsgContent:[b],adminType:"participantLeftGroup"}:{adminMsgContent:[b,c],adminType:"participantRemovedOneUser"};case 2:return{adminMsgContent:[b,c,d],adminType:"participantRemovedTwoUser"}}return{adminMsgContent:[b,c,a.toString()],adminType:"participantRemovedMoreThanTwoUser"}}function a(a,b,c,e){e=e==null?b.map(d("MAWAdminMsgHelpers").createAdminMsgContactId):e;var f=e[0];e=e[1];c=c==null?d("MAWAdminMsgHelpers").createAdminMsgContactId(a):d("MAWAdminMsgHelpers").maybeUnknownParticipantName(c);if(a===d("WAGlobals").getMyUserJid())return i(b.length,d("MAWAdminMsgHelpers").maybeUnknownParticipantName(f),d("MAWAdminMsgHelpers").maybeUnknownParticipantName(e),b[0]===d("WAGlobals").getMyUserJid());return b.includes(d("WAGlobals").getMyUserJid())?h(b.length,c,d("MAWAdminMsgHelpers").maybeUnknownParticipantName(b[0]===d("WAGlobals").getMyUserJid()?e:f)):j(b.length,c,d("MAWAdminMsgHelpers").maybeUnknownParticipantName(f),d("MAWAdminMsgHelpers").maybeUnknownParticipantName(e),b[0]===a)}g.removeParticipantAdminMessage=a}),98);
__d("MAWAdminWriteUserDeviceMsgTxn",["MAWAckLevel","MAWAdminMsgHelpers","MAWDbMsgTxns","MAWDexieTable","MAWExternalId","MAWGetUserDeviceChangeAdminType","MAWLocalizationType","MAWLocalizationUtils","MAWMsgType","MAWUserJidWrapper","MAWWriteMsgTxns","WAJids","WATimeUtils","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";e={add:"add",remove:"remove",update:"update"};function a(a,b,e,f,g){return d("MAWDbMsgTxns").getIsThreadEmpty(a,e.jid).then(function(h){if(h)return d("MAWDexieTable").dexieResolve();h=b===d("MAWUserJidWrapper").getMyUserJid();var i=d("MAWGetUserDeviceChangeAdminType").getUserDeviceAdminType(f,h);h=h?[]:[d("WAJids").userIdFromJid(b)];h=d("MAWLocalizationUtils").buildUnstoredDbAdminMsg({adminMsgContent:h,adminType:i,version:1},e.jid,d("MAWExternalId").generateExternalId(),g);return d("MAWWriteMsgTxns").writeMsg(a,h,e).then(c("emptyFunction"))})}function b(a,b,e,f){var g=d("MAWAdminMsgHelpers").UNKNOWN_USER,h=b===d("MAWUserJidWrapper").getMyUserJid();h={ack:d("MAWAckLevel").ACK.received,altIndex:void 0,author:h?d("WAJids").AUTHOR_ME:b,externalId:d("MAWExternalId").generateExternalId(),msgContent:{adminType:d("MAWLocalizationType").LOCALIZATION_TYPE.ICDC_ALERT_ADMIN_MESSAGE,authorName:g},threadJid:e.jid,ts:f!=null?f:d("WATimeUtils").unixTime(),type:d("MAWMsgType").MSG_TYPE.ICDC_ALERT};return d("MAWWriteMsgTxns").writeMsg(a,h,e).then(c("emptyFunction"))}g.DeviceChange=e;g.writeUserDeviceAdminMsg=a;g.writeICDCAlert=b}),98);
__d("MAWCastToServerMediaType",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case"document":case"image":case"xma-image":case"video":case"ptt":case"gif":case"sticker":return a;default:return null}}function b(a){switch(a){case"image":case"video":case"gif":case"sticker":case"preview":return a;case"audio":return"ptt";case"xma":return"xma-image";case"file":return"document"}}f.castToServerMediaType=a;f.castMsgrServerMediaTypeToServerMediaType=b}),66);
__d("WAClearSignalStores",["MAWDexieTable","MAWTransactionMode","WADbTransactor"],(function(a,b,c,d,e,f,g){"use strict";a=d("WADbTransactor").makeSignalTransactor({tasks:d("MAWTransactionMode").READWRITE},"clearSignalStores",function(a){return function(){return d("MAWDexieTable").dexieAll([a.tasks.clear()]).then(function(){})}});g.clearSignalStores=a}),98);
__d("WAClearSignalStoresV2",["WASignalDB"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return d("WASignalDB").getDb().runInTransaction(["identity","contacts","meta","prekey","prekeyGeneration","senderKeySessions","session","signedPrekey","personalSenderKeyStatuses"],"readwrite",async function(a){await Promise.all([a.stores.identity.clear(),a.stores.contacts.clear(),a.stores.meta.clear(),a.stores.prekey.clear(),a.stores.prekeyGeneration.clear(),a.stores.senderKeySessions.clear(),a.stores.session.clear(),a.stores.signedPrekey.clear(),a.stores.personalSenderKeyStatuses.clear()])},d("WASignalDB").signalOp("clearSignalStores"))};g.clearSignalStores=a}),98);
__d("MAWClearSignalAndTempStores",["MAWDeleteOldLogsFromDisk","MAWJobActionsV2","MAWJobsIndexedDb","MAWLoggingSwitches","MAWTransactionMode","Promise","WAClearSignalStores","WAClearSignalStoresV2","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MAWJobsIndexedDb").makeJobsTransactor("jobs",d("MAWTransactionMode").READWRITE,"clearJob")(d("MAWJobActionsV2").clearJobs);a=function(){return(h||(h=b("Promise"))).all([d("MAWLoggingSwitches").removeLoggingFromBridge&&d("MAWDeleteOldLogsFromDisk").clearLogs(),d("WAClearSignalStores").clearSignalStores(),i(),d("WAClearSignalStoresV2").clearSignalStores()]).then(c("emptyFunction"))};g.clearSignalAndTempStores=a}),98);
__d("MAWDbAddDeviceChangeAlertsTxn",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.deviceChangeAlerts.add(b)}f.addDeviceChangeAlertsTxn=a}),66);
__d("MAWDbDeviceChangeAlerts",[],(function(a,b,c,d,e,f){"use strict";b="add";c="keyChange";d="remove";function a(a){return a}f.ADD=b;f.KEY_CHANGE=c;f.REMOVE=d;f.unsafeCoerceToDeviceChangeAlertsID=a}),66);
__d("WAFindMostRecentMediaEntry",["WAMediaUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=null;for(a of a){var c,e=a[0],f=a[1];f=d("WAMediaUtils").decodeMediaEntryData(f);(((c=b)==null?void 0:c[1].mediaKeyTimestamp)==null||f.mediaKeyTimestamp!=null&&f.mediaKeyTimestamp>((c=b)==null?void 0:c[1].mediaKeyTimestamp))&&(b=[e,f])}return b!=null?d("WAResultOrError").makeResult(b):d("WAResultOrError").makeError("no-media-entry")}g.findMostRecentMediaEntry=a}),98);
__d("MAWGetMostRescentDecodedMediaEntry",["MAWDbMediaTxns","MAWIndexedDb","MAWTransactionMode","MWFBLogger","WAFindMostRecentMediaEntry","WAHashUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MWFBLogger").MWMediaLogger().tags(["getMostRecentDecodedMediaEntry"]),j=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READONLY},"getMediaEntries",function(a){return function(b){return d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b).then(function(a){if(!a){i.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["No existing media entry found for plaintextHash ",". Returning new MsgMap."])),d("WAHashUtils").sanitisePlaintextHash(b));return d("WAResultOrError").makeError("no-media-by-plaintext-hash")}return d("WAResultOrError").makeResult(a.mediaEntries)})}});async function a(a){a=await j(a);if(a.success===!1)return a;a=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(a.value);return a.success===!1?a:d("WAResultOrError").makeResult(a.value[1])}g.getMediaEntries=j;g.getMostRecentDecodedMediaEntry=a}),98);
__d("MAWGetProtocolMsgIdAndSortOrderMsApi",["MAWIndexedDb","MAWTransactionMode","WAJids"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"getProtocolMsgIdAndSortOrderMs",function(a){return function(b){return a.messages.get({msgId:b}).then(function(a){if(a==null)return null;var b=a.sortOrderMs;if(b==null)return null;if(d("WAJids").isAuthorSystem(a.author))return null;a={author:a.author,chat:a.threadJid,externalId:a.externalId};return{protocolMsgId:a,sortOrderMs:b}})}});g.getProtocolMsgIdAndSortOrderMs=a}),98);
__d("MAWOptimisticUploadManager",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(){return g}function b(){g.clear()}f.getOptimisticUploadManager=a;f.clearOptimisticUploadManager=b}),66);
__d("MAWUpdateMediaEntryForMsgApi",["FBLogger","MAWCastToServerMediaType","MAWDbMediaTxns","MAWDbMsgTxns","MAWDexieTable","MAWIndexedDb","MAWMediaBackupTxns","MAWOptimisticUploadManager","MAWTransactionMode","WALogger","WAMediaUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READWRITE,mediaBackup:d("MAWTransactionMode").READWRITE,messages:d("MAWTransactionMode").READONLY},"updateMediaEntryForMsg",function(a){return function(b,e,f,g,j){var k=d("MAWCastToServerMediaType").castToServerMediaType(j);if(!k){c("FBLogger")("labyrinth_web","unsupported_media").mustfix("unsupported media type");throw c("FBLogger")("messenger_web").mustfixThrow("Media type unsupported: "+(j!=null?j:""))}return d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,e)]).then(function(b){var e=b[0],j=b[1];if(!j)throw c("FBLogger")("messenger_web").mustfixThrow("Message does not exist for the given protocolMsgId");if(!e)throw c("FBLogger")("messenger_web").mustfixThrow("Media does not exist for the given hashedPlaintextHash");if(!e.msgIds.includes(j.msgId)){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose([""," msgId does not exist within media entries"])),j.msgId);return}b=e.mediaEntries;var k=f();if(k==null){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Nothing to update if updatedMediaEntry is null"])));return}b=babelHelpers["extends"]({},e,{mediaEntries:b.set(j.msgId,k)});g!=null&&(b=babelHelpers["extends"]({},b,{objectId:d("WAMediaUtils").stringToDeliveryObjectId(g)}));return a.media.put(b).then(function(b){g!=null&&d("MAWMediaBackupTxns").linkMediaBackup(a,e.mediaId,j.msgId,d("WAMediaUtils").stringToDeliveryObjectId(g))})})}});a=function(a,b,c,d,e){k(a,c);return j(a,b,c,d,e)};function k(a,b){var c=d("MAWOptimisticUploadManager").getOptimisticUploadManager(),e=c.get(a);if(e==null)return;b=b();if(b==null)return;c.set(a,babelHelpers["extends"]({},e,{mediaEntry:b}))}g.updateMediaEntryForMsg=a;g.maybeUpdateOptimisticUploadMediaEntry=k}),98);
__d("MpsMediaEntryCache",["FBLogger","MpsMessageToBridgeWrapper","WAHashUtils","WALongInt","WAMediaUtils","WAProgressiveJpegGetScanLengths","WATimeUtils","getMediaTypeFromConsumerMessage"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a){var b,c=h.get(a.plainTextHash);((b=a.mediaKeyTimestamp)!=null?b:0)>=((b=c==null?void 0:c.mediaKeyTimestamp)!=null?b:0)&&h.set(a.plainTextHash,a)}function a(a){a=d("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromTopLevel(a);j(a);k(a)}function j(a){var b,c=a.deserialize();c=(c=c.encryptedTransportMessage())==null?void 0:c.consumerMessage();if(c==null)return;b=(b=(b=(b=(b=(b=c.audioMessage())==null?void 0:b.payload)!=null?b:(b=c.documentMessage())==null?void 0:b.payload)!=null?b:(b=c.imageMessage())==null?void 0:b.payload)!=null?b:(b=c.stickerMessage())==null?void 0:b.payload)!=null?b:(b=c.videoMessage())==null?void 0:b.payload;if(b==null)return;c=d("getMediaTypeFromConsumerMessage").getMediaTypeFromConsumerMessage(c.proto);l(b,c,a.getMsgId())}function k(a){var b;b=(b=a.deserialize().encryptedTransportMessage())==null?void 0:b.armadillo();var c=b==null?void 0:b.extendedContentMessage();if(c==null||b==null)return;var d="xma-image";c.previews().forEach(function(b){l(b,d,a.getMsgId())});b=c.headerImage();b!=null&&l(b,d,a.getMsgId());b=c.favicon();b!=null&&l(b,d,a.getMsgId())}function l(a,b,e){var f,g,h,j,k,l=a.ancillary;a=a.integral;if(l==null||a==null)return;f=(f=a.transport)==null||(f=f.integral)==null?void 0:f.directPath;g=(g=a.transport)==null||(g=g.integral)==null?void 0:g.mediaKeyTimestamp;g=g!=null?d("WATimeUtils").castLongIntToUnixTime(g):void 0;h=(h=a.transport)==null||(h=h.integral)==null?void 0:h.fileSha256;var m=h!=null?d("WAHashUtils").toPlaintextHash(h):void 0;if(f==null||h==null||m==null||b==null){c("FBLogger")("mps").warn("Missing media entry fields");return}var n=null,o=l.scanLengths;l=l.scansSidecar;l!=null&&o!=null&&(n={scanLengths:o.map(d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength),sidecar:l});o=void 0;l=(l=a.transport)==null||(l=l.ancillary)==null||(l=l.thumbnail)==null?void 0:l.downloadableThumbnail;if(l!=null){var p;o={directPath:l.directPath,fileEncSha256:l.fileEncSha256,fileSha256:l.fileSha256,mediaKey:l.mediaKey,mediaKeyTimestamp:d("WATimeUtils").castLongIntToUnixTime((p=l.mediaKeyTimestamp)!=null?p:0),objectId:l.objectId}}p=d("WAMediaUtils").rawDataToMediaEntry({directPath:f,downloadableThumbnail:o,fileEncSha256:(p=a.transport)==null||(p=p.integral)==null?void 0:p.fileEncSha256,filename:null,fileSha256:h,mediaKey:(l=a.transport)==null||(l=l.integral)==null?void 0:l.mediaKey,mediaKeyTimestamp:g,objectId:a==null||(j=a.transport)==null||(j=j.ancillary)==null?void 0:j.objectId,progressiveJpegDetails:n,serverMediaType:b,size:d("WALongInt").numberOrThrowIfTooLarge((f=a==null||(k=a.transport)==null||(k=k.ancillary)==null?void 0:k.fileLength)!=null?f:0)});i({mediaEntry:p,mediaKeyTimestamp:g,msgId:e,plainTextHash:m,serverMediaType:b,thumbnailHash:((h=o)==null?void 0:h.fileSha256)!=null?d("WAHashUtils").toPlaintextHash((l=o)==null?void 0:l.fileSha256):void 0})}function b(a){return h.get(a)}g.hydrateCache=a;g.getEntry=b}),98);
__d("WATypedArraysConcat",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){c===void 0&&(c=0);c=b.reduce(function(a,b){return a+b.length},c);var d=new a(c),e=0;b.forEach(function(a){d.set(a,e),e+=a.length});return d}f.concatTypedArrays=a}),66);
__d("WACryptoAesCbc",["WABinary","WACryptoDependencies","WATypedArraysCast","WATypedArraysConcat","err"],(function(a,b,c,d,e,f,g){"use strict";var h=16,i=1024,j=16;f=1024*1024;var k=h*f;f=function(){function a(a,b,c,e){this.$4=null;this.$6=!1;this.$1=a;this.$2=b;this.$3=c;var f={name:"AES-CBC",iv:e};this.$5=d("WACryptoDependencies").getCrypto().subtle.importKey("raw",c,"AES-CBC",!1,[b]).then(function(a){return{algo:f,key:a}})}var b=a.prototype;b.append=function(a){var b=this;this.$7("append");var c=this.$4;if(c){c.writeByteArray(a);if(c.size()>i){var e=c.size()%h;e=c.readByteArrayView(c.size()-e);c.size()||(this.$4=null)}else e=null}else if(a.length>i){c=a.length%h;!c?e=a:(this.$4=new(d("WABinary").Binary)(a),e=this.$4.readByteArrayView(a.length-c))}else this.$4=new(d("WABinary").Binary)(a),e=null;var f=e;f&&(this.$5=this.$5.then(function(a){var c=a.key;a=a.algo;if(b.$2==="encrypt")return d("WACryptoDependencies").getCrypto().subtle.encrypt(a,c,f).then(function(a){b.$1.writeByteArray(new Uint8Array(a,0,a.byteLength-h));return new Uint8Array(a,a.byteLength-2*h,h)});else{var e=f.slice(-h);return d("WACryptoDependencies").getCrypto().subtle.decrypt(a,c,f).then(function(a){b.$1.writeBuffer(a);return e})}}).then(function(a){var c={name:"AES-CBC",iv:a};return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",b.$3,"AES-CBC",!1,[b.$2]).then(function(a){return{algo:c,key:a}})}));return this.$5.then(function(){})};b.finalize=function(a){var b=this;this.$7("finalize");var c;if(this.$4){var e=this.$4;a&&e.writeByteArray(a);c=e.readByteArrayView();this.$4=null}else a&&(c=a);if(c){var f=c;return this.$5.then(function(a){var c=a.algo;a=a.key;if(b.$2==="encrypt")return d("WACryptoDependencies").getCrypto().subtle.encrypt(c,a,f);else return d("WACryptoDependencies").getCrypto().subtle.decrypt(c,a,f)}).then(function(a){b.$1.writeBuffer(a)})}else return this.$5.then(function(){})};b.$7=function(a){if(this.$6)throw c("err")("AesCbcStream."+a+" called after finalize")};return a}();function l(a){return{name:"AES-CBC",iv:d("WATypedArraysCast").castTypedArrays(Uint8Array,a)}}function m(a){return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["encrypt"])}function n(a){if(a)return d("WATypedArraysCast").castTypedArrays(Uint8Array,a);a=new Uint8Array(j);d("WACryptoDependencies").getCrypto().getRandomValues(a);return a}function o(a){a=a.byteLength;var b=h-a%h;return Number.isNaN(b)?a:a+b}function p(a,b,c){var e=l(b);return Promise.resolve(d("WACryptoDependencies").getCrypto().subtle.importKey("raw",d("WATypedArraysCast").castTypedArrays(Uint8Array,a),"AES-CBC",!1,["decrypt"])).then(function(a){return d("WACryptoDependencies").getCrypto().subtle.decrypt(e,a,c)})}function a(a,b){return Promise.resolve().then(function(){var c=b.slice(0,j),d=b.slice(j);return p(a,c,d)})}function b(a,b,c){return Promise.resolve().then(function(){var e=n(c),f=l(e);return Promise.resolve(m(a)).then(function(a){return d("WACryptoDependencies").getCrypto().subtle.encrypt(f,a,b)}).then(function(a){return d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[e,new Uint8Array(a)]).buffer})})}async function e(a,b,d,e){e===void 0&&(e=k);if(e%h!==0)throw c("err")("chunkSize must be a multiple of "+h+", "+e+" received");a=await m(a);b=new Uint8Array(b);var f=Math.ceil(b.byteLength/e);d=n(d);var g=new Uint8Array(o(b)+d.byteLength);g.set(d);for(var i=0,j=d,l;i<f;i++){var p=i===f-1,l=i*e;l=b.subarray(l,l+e);p=await q(p,l,j,a);l=p.encryptedChunk;p=p.nextIv;g.set(l,d.byteLength+i*e);j=p}return g.buffer}async function q(a,b,c,e){c=await d("WACryptoDependencies").getCrypto().subtle.encrypt(l(c),e,b).then(function(b){return a?new Uint8Array(b):new Uint8Array(b).subarray(0,-h)});e=c.slice(-h);return{encryptedChunk:c,nextIv:e}}g.AES_CBC_BLOCK_SIZE=h;g.AesCbcStream=f;g.importRawKey=m;g.getIv=n;g.aesCbcDecrypt=p;g.aesCbcDecryptSplit=a;g.aesCbcEncrypt=b;g.aesCbcEncryptWithChunking=e;g.aesCbcEncryptChunk=q}),98);
__d("WAConcurrentIterate",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){var d=[],e=[],f=0,g=async function(){while(f<a){var c=f;f++;e[c]=await b(c)}};c=Math.min(a,c);for(var h=0;h<c;h++)d.push(g());return Promise.all(d).then(function(){return e})}f.concurrentIterate=a}),66);
__d("WAMediaCryptoSidecar",["WAConcurrentIterate","WACryptoHmac","WAMediaUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a==="video"}var h=16,i=10,j=64*1024;function b(a,b,c){c===void 0&&(c=1);var e=b.buffer.byteLength;e=Math.ceil((e-h)/j);var f=new Uint8Array(i*e);return d("WAConcurrentIterate").concurrentIterate(e,function(c){var e=c*j,g=e+h+j;e=b.subarray(e,g);return d("WACryptoHmac").sign(a,e).then(function(a){a=new Uint8Array(a,0,i);f.set(a,c*i)})},c).then(function(){return d("WAMediaUtils").castToStreamingSidecar(f.buffer)})}g.shouldHaveStreamingSidecar=a;g.calculateStreamingSidecar=b}),98);
__d("WAMediaHkdfInfo",["err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"document":return"WhatsApp Document Keys";case"image":case"sticker":case"xma-image":return"WhatsApp Image Keys";case"video":case"gif":return"WhatsApp Video Keys";case"audio":case"ptt":return"WhatsApp Audio Keys";case"md-app-state":return"WhatsApp App State Keys";case"md-msg-hist":return"WhatsApp History Keys";default:throw c("err")("getMediaHkdfInfo: unexpected media type "+a)}}function b(){return"Messenger Preview Keys"}g.getMediaHkdfInfo=a;g.getPreviewMediaHkdfInfo=b}),98);
__d("WAMediaCrypto",["WABinary","WACryptoAesCbc","WACryptoDependencies","WACryptoHkdf","WACryptoHmac","WACryptoSha256","WACryptoUtils","WACustomError","WAHashUtils","WALogger","WAMediaCryptoSidecar","WAMediaHkdfInfo","WATagsLogger","WATypedArraysConcat","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("WATagsLogger").TAGS(["WAMediaCrypto"]),l=d("WACustomError").customError("HmacValidationError",!1),m=new Uint8Array([2,2]);function n(a,b){return d("WACryptoHkdf").extractAndExpand(new Uint8Array(a),b,112).then(function(a){return{iv:new Uint8Array(a,0,16),cipherKey:new Uint8Array(a,16,32),hmacKey:new Uint8Array(a,48,32),refKey:new Uint8Array(a,80,32)}})}function o(a,b){b=d("WAMediaHkdfInfo").getMediaHkdfInfo(b);return n(a,b)}function p(a){var b=d("WAMediaHkdfInfo").getPreviewMediaHkdfInfo();return n(a,b)}async function a(a){var b=new Map(),c=await p(a);b.set("preview",c);c=["document","image","video","audio","md-app-state","md-msg-hist"];await Promise.all(c.map(function(c){return o(a,c).then(function(a){b.set(c,a)})}));return b}function b(a){switch(a){case"image":case"video":return a;default:return null}}var q=16,r=16,s=10,t=64*1024;async function e(a,b,c,e,f){var g=new(d("WABinary").Binary)();g.ensureCapacity(r+e.byteLength+q+s);g.writeByteArray(b);a=new(d("WACryptoAesCbc").AesCbcStream)(g,"encrypt",a,b);b=0;var h=b+t;while(h<e.byteLength){var i=e.slice(b,h);await a.append(new Uint8Array(i));b=h;h+=t}i=await e.slice(b);await a.finalize(new Uint8Array(i));h=g.peek(function(a){return a.readByteArrayView()});e=await d("WACryptoHmac").encodeKeySha256(c);b=await d("WACryptoHmac").sign(e,h);g.writeByteArray(new Uint8Array(b,0,s));a=g.readByteArrayView();i=a.subarray(r);c=await Promise.all([d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",i),d("WAMediaCryptoSidecar").shouldHaveStreamingSidecar(f)?d("WAMediaCryptoSidecar").calculateStreamingSidecar(e,a):void 0]);b=c[0];g=c[1];return{ciphertext:i,ciphertextHash:b,sidecar:g,ivCiphertext:h,ivCiphertextHmac:a}}async function f(a,b,c){a=await d("WACryptoHmac").encodeKeySha256(a);b=d("WABinary").Binary.build(b,c).readByteArrayView();return d("WACryptoHmac").sign(a,b)}async function u(a,b,c,e,f){if(!(10<=f.length&&f.length<=32))throw new l("Bad hmac size "+f.length);var g=d("WABinary").Binary.build(b,c).readByteArrayView();e=await d("WACryptoHmac").hmacSha256(e,g).then(function(a){return new Uint8Array(a)});g=e.slice(0,f.length);if(!y(g,f))throw new l("hmacAndDecrypt hmac mismatch");e=await d("WACryptoAesCbc").aesCbcDecrypt(a,b,c);g=await d("WACryptoDependencies").getCrypto().subtle.digest("SHA-256",e);return{plaintextHash:d("WAHashUtils").toPlaintextHash(g),plaintext:e}}function v(a,b,c,e,f){if(!(10<=f.length&&f.length<=32))throw new l("Bad hmac size "+f.length);var g=d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[b,c]);return d("WACryptoHmac").hmacSha256(e,g,f.length).then(function(a){return new Uint8Array(a)}).then(function(a){if(!d("WACryptoUtils").uint8ArraysEqual(a,f))throw new l("hmacAndDecrypt hmac mismatch")}).then(function(){var a=c.byteLength%q===s;if(a===!0)return c.subarray(0,-10);else return c}).then(function(c){return w(a,b,c)})}function w(a,b,c){var e=c.subarray(-q);return d("WACryptoAesCbc").aesCbcEncrypt(a,m,e).then(function(a){return a.slice(r)}).then(function(a){return d("WABinary").Binary.build(c,a).readByteArrayView()}).then(function(c){return d("WACryptoAesCbc").aesCbcDecrypt(a,b,c)}).then(function(a){return new Uint8Array(a,0,a.byteLength-m.byteLength)}).then(function(a){return{plaintext:a,nextIv:e}})}async function x(a,b,e,f,g,l){g>l.scanLengths.length&&k.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["decryptPartialChunks targetScan greater length of scanLength array"])));g=Math.min(g,l.scanLengths.length);if(g<1){k.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unable to decrypt partial due to invalid target scan"])));throw c("err")("Unable to decrypt partial due to invalid target scan")}var m=new(d("WABinary").Binary)(),n=[];for(var o=0;o<g;o++)n.push(new Uint8Array(l.sidecar,o*10,10));o=0;b=b;var p=0;for(var q=0;q<g;q++){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Processing scan ",""])),q);var r=l.alignedScanLengths[q],s=o+r;s=e.subarray(o,s);s=await v(a,b,s,f,n[q]);var t=s.plaintext;s=s.nextIv;m.write(t);o+=r;b=s;p+=l.scanLengths[q]}t=m.readBuffer(p);r=await d("WACryptoSha256").sha256(t);return{plaintextHash:d("WAHashUtils").toPlaintextHash(r),plaintext:t}}function y(a,b){if(a.length!==b.length)return!1;var c=1,d=a.length;for(var e=0;e<d;e++)c&=a[e]===b[e]?1:0;return c!==0}g.HmacValidationError=l;g.DEFAULT_PADDING=m;g.computeMediaKeys=o;g.computeMediaKeysForPreview=p;g.deprecated_getAllCommonComputedMediaKeys=a;g.convertServerMediaTypeToPreviewMediaType=b;g.CBC_BLOCK_SIZE=q;g.IV_LENGTH=r;g.HMAC_LENGTH=s;g.encryptAndHmac=e;g.hmacCiphertext=f;g.hmacAndDecrypt=u;g.hmacAndDecryptPartial=v;g.decryptPartialChunks=x}),98);
__d("WAAlignChunkLengthsToMultipleOfAesBlockSize",[],(function(a,b,c,d,e,f){"use strict";function g(a){return parseInt((a+15)/16,10)*16}function a(a,b){var c=[],d=0,e=0,f=0;for(var h=0;h<a.length;++h){d+=a[h];if(h===a.length-1&&b!=null&&b>0){d>e?c.push(b-e):(c.pop(),c.push(b-f));break}else if(d>e){var i=g(d-e);f=e;c.push(i);e+=i}}return c}f.alignChunkSizeToMultipleAesBlockSize=g;f.alignChunkLengthsToMultipleOfAesBlockSize=a}),66);
__d("WAProgressiveJpegAlignScanLengths",["WAAlignChunkLengthsToMultipleOfAesBlockSize"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.scanLengths;a=a.totalEncryptedBytes;return d("WAAlignChunkLengthsToMultipleOfAesBlockSize").alignChunkLengthsToMultipleOfAesBlockSize(b.map(function(a){return a}),a).map(function(a){return a})}function b(a){return a}g.progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize=a;g.toProgressiveJpegAlignedScanLength=b}),98);
__d("WAProgressiveJpegGetPJpegDetails",["WAMediaCrypto","WAProgressiveJpegAlignScanLengths","WAProgressiveJpegGetScanLengths","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=d("WATagsLogger").TAGS(["WAProgressiveJpegDetails"]);function a(a){var b=a.progressiveJpegDetails;a=a.ciphertextLength;return babelHelpers.extends({},b,{alignedScanLengths:d("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize({scanLengths:b.scanLengths,totalEncryptedBytes:a})})}async function b(a,b,c){var e=b.byteLength-d("WAMediaCrypto").IV_LENGTH;a=d("WAProgressiveJpegGetScanLengths").getProgressiveJpegScanLengths(a);e=d("WAProgressiveJpegAlignScanLengths").progressiveJpegAlignChunkLengthsToMultipleOfAesBlockSize({scanLengths:a,totalEncryptedBytes:e});e=await m(e,b,c);return{scanLengths:a,sidecar:e}}async function m(a,b,c){var e=new Uint8Array(a.length*10),f=0,g=0,h=b.slice(0,16);b=b.slice(16);for(var i=0;i<a.length;i++){var j=a[i];g=f+j;j=b.subarray(f,g);var k=(await d("WAMediaCrypto").hmacCiphertext(c,h,j)).slice(0,10);e.set(new Uint8Array(k),i*10);h=j.slice(j.length-16,j.length);f=g}return e.buffer}function n(a){if(a.sidecar.byteLength%d("WAMediaCrypto").HMAC_LENGTH!==0){l.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg sidecar has an invalid length"])));return d("WAResultOrError").makeError("pjpeg-check-sidecar-invalid-length")}if(a.scanLengths.length>0&&a.sidecar.byteLength===0){l.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg sidecar is missing"])));return d("WAResultOrError").makeError("pjpeg-check-no-sidecar")}if(a.scanLengths.length===0)return d("WAResultOrError").makeResult(!1);if(a.scanLengths.length*d("WAMediaCrypto").HMAC_LENGTH!==a.sidecar.byteLength){l.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg sidecar size mismatch"])));return d("WAResultOrError").makeError("pjpeg-check-scan-length-mismatch")}if(a.scanLengths.length<3){l.WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Progressive Jpeg has too few scans"])));return d("WAResultOrError").makeError("pjpeg-too-few-scans")}return d("WAResultOrError").makeResult(!0)}function c(a,b){var c=0;if(b===0)return 0;for(var d=0;d<b;d++){var e=a[d];e!=null&&(c+=e)}return c}function e(a){a=a.progressiveJpegDetails;if(a==null)return d("WAResultOrError").makeResult(null);var b=n(a);if(b.success===!1)return b;return b.value===!0?d("WAResultOrError").makeResult({scanLengths:a.scanLengths,sidecar:a.sidecar}):d("WAResultOrError").makeResult(null)}g.getExtendedProgressiveJpegDetails=a;g.getProgressiveJpegDetails=b;g.isValidProgressiveJpegDetails=n;g.getTotalByteSizeForScan=c;g.maybeGetProgressiveJpegDetailsUsingMediaEntry=e}),98);
__d("WADownloadDownloadablePreview",["WADownloadMedia","WAGlobals","WAMediaCrypto","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAStartMediaDownloadQplFlow"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o=d("WADownloadMedia").mediaDownloadLogger.TAGS(["DownloadDownloadablePreview"]);async function a(a,b,c,e,f,g,p){var q=g.handleMediaPreviewBeforeDownload;g=g.handleMediaPreviewDownloadFailed;var r=e.downloadableThumbnail,s=r==null?void 0:r.directPath,t=s!=null,u=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(e);o.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["thumbnail_available: ",""])),t);if(r==null||s==null){o.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["No downloadableThumbnail. Skipping..."])));return d("WAResultOrError").makeError("preview-not-supported")}o.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["DownloadableThumbnail exists. Attempting to download."])));t=r.fileEncSha256;var v=r.fileSha256,w=r.mediaKey;r=r.objectId;a=d("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({protocolMsgId:a,downloadEntry:f,msgType:null,triggerUIView:p,isPreview:!0});a.addAnnotations({bool:{duplicateDirectPath:s===e.directPath,isMediaFallbackToAlternativeHmacSaltsEnabled:d("WAGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled(),isProgressiveJpeg:u.success===!0,hasObjectId:r!=null},string:{mediaType:"preview",fullSizeMediaType:e.serverMediaType}});a.addPoint("wa_protocol_media_download_start");if(s==null||t==null||v==null||w==null){o.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - mediaEntryData "," is incomplete for media preview"])),e);a.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"preview-incomplete-media-entry"}});return d("WAResultOrError").makeError("media-entry-invalid")}f=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(c);if(f==null){o.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type ",""])),c);a.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"preview-unsupported-type"}});return d("WAResultOrError").makeError("request-error")}await q(b);p=await d("WADownloadMedia").downloadMediaImpl({downloadFlow:a,mediaTypeDetails:{messageType:f,type:"preview"},directPath:s,fileEncSha256:t,fileSha256:v,mediaKey:w});if(p.success===!1){o.WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["failed to download media. Reason: ",""])),p.error);void g(b,p.error);a.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:p.error}});return p}else{o.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["finished downloading"])));a.addPoint("wa_protocol_media_download_end");a.endSuccess();return d("WAResultOrError").makeResult(p.value)}}g.maybeDownloadDownloadablePreview=a}),98);
__d("WADecryptMedia",["WAGlobals","WAMediaCrypto","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o=d("WATagsLogger").TAGS(["WADecryptMedia"]);async function p(a,b,c,e){o.WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Encountered enc-hash-mismatch - looking for a potential working hmac salt"])));c=c.type==="preview"?"preview":c.mediaType;e=await d("WAMediaCrypto").deprecated_getAllCommonComputedMediaKeys(e);for(e of e){var f=e[0],g=e[1];try{if(f===c)continue;o.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Trying "," as an alternative hmac salt."])),f);g=d("WAResultOrError").makeResult(await d("WAMediaCrypto").hmacAndDecrypt(g.cipherKey,g.iv,a,g.hmacKey,b));g={hmacAndDecryptResult:g,alternativeHmacSaltUsed:f};o.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Found a working hmac salt using ","."])),f);return g}catch(a){o.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose([""," is not a working hmac salt."])),f);continue}}return{hmacAndDecryptResult:d("WAResultOrError").makeError("enc-hash-mismatch")}}async function a(a){var b=a.ciphertextHmac,c=a.mediaKey,e=a.mediaTypeDetails;a=a.plaintextHash;o.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Using default plaintext verifier"])));var f=b.byteLength-d("WAMediaCrypto").HMAC_LENGTH,g=new Uint8Array(b,f),h=new Uint8Array(b,0,f);e.type==="preview"?b=d("WAMediaCrypto").computeMediaKeysForPreview(c):b=d("WAMediaCrypto").computeMediaKeys(c,e.mediaType);f=null;b=await b.then(function(a){var b=a.iv,c=a.cipherKey;a=a.hmacKey;return d("WAMediaCrypto").hmacAndDecrypt(c,b,h,a,g)}).then(d("WAResultOrError").makeResult).catch(function(a){o.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""])),a);if(a instanceof d("WAMediaCrypto").HmacValidationError)return d("WAResultOrError").makeError("enc-hash-mismatch");else return d("WAResultOrError").makeError("decryption-error")});if(d("WAGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled()===!0&&b.success===!1&&b.error==="enc-hash-mismatch"){e=await p(h,g,e,c);b=e.hmacAndDecryptResult;f=e.alternativeHmacSaltUsed}if(!b.success)return b;c=b.value;e=c.plaintext;b=c.plaintextHash;if(a!==b)return d("WAResultOrError").makeError("hash-mismatch");o.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Success"])));return d("WAResultOrError").makeResult({plaintext:e,alternativeHmacSaltUsed:f})}g.decryptMedia=a}),98);
__d("WAArrayUtils",[],(function(a,b,c,d,e,f){"use strict";function g(a){return a}function a(a,b){var c=a.pop();b<a.length&&(a[b]=c)}function* b(a,b){for(var c=0;c<a.length;c+=b)yield a.slice(c,c+b)}function c(a,b){return h(a,b,g)}function h(a,b,c){var d=new Map();for(a of a){var e,f=b(a);e=(e=d.get(f))!=null?e:[];e.push(c(a));d.set(f,e)}return d}f.removeIndexWithoutPreservingOrder=a;f.peekEvery=b;f.groupBy=c;f.groupByAndMap=h}),66);
__d("WAErrors",["WACustomError"],(function(a,b,c,d,e,f,g){"use strict";b=(a=d("WACustomError")).customError("BufferTooLarge",!1);c=a.customError("Disconnected",!1);e=a.customError("Offline",!1,c);f=a.customError("MaxRetries",!1);d=a.customError("Aborted",!1);g.BufferTooLargeError=b;g.Disconnected=c;g.Offline=e;g.MaxRetries=f;g.Aborted=d}),98);
__d("WANotifyConnectionChangeFactory",[],(function(a,b,c,d,e,f){"use strict";var g=15e3;function a(a,b,c){c===void 0&&(c=g);var d={timeoutID:null,connectionStatus:"disconnected",optimismLevel:"optimist"},e=function(){var a=d.optimismLevel,e=d.connectionStatus;a==="optimist"?d.timeoutID=setTimeout(function(){d.optimismLevel="realist",b(e)},c):b(e)};return function(c){d.connectionStatus=c,c==="disconnected"?e():c==="in_handshake"?e():(c,d.timeoutID!=null&&(clearTimeout(d.timeoutID),d.timeoutID=null),b(c)),a(c)}}f.notifyConnectionChangeFactory=a}),66);
__d("WAPromiseRetryLoop",["Promise","WALogger","WAPromiseBackoffs","WAPromiseDelays","WAResolvable","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p;a=function(){function a(a){var b=this;this.$2=new(d("WAResolvable").Resolvable)();this.$3=null;this.$4=null;this.$5=0;this.$6=new(d("WAResolvable").Resolvable)();this.endWithValue=function(a){b.$5++,b.$2.resolve(a)};this.$1=a}var e=a.prototype;e.resetTimeoutAfter=function(a){this.$4=Date.now()+a};e.cancelReset=function(){this.$4=null};e.reset=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""])),this.$1.name);this.$5++;this.$6.resolve();this.$7()};e.start=function(){if(this.$2.resolveWasCalled())return;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: starting ",""])),this.$1.name);this.$5!==0&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop was called several times. You may have race conditions"])));this.$5++;this.$6.resolve();this.$7()};e.pauseOnNextIteration=function(){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: pause requested on next iteration"]))),this.$6.resolve(),this.$6=new(d("WAResolvable").Resolvable)()};e.unpause=function(){this.$6.resolveWasCalled()||d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: loop unpaused"]))),this.$6.resolve()};e.$7=function(){var a=this,c=this.$1,e=this.$5,f=d("WAPromiseBackoffs").createTimer(this.$1.timer);f();var g=function(){if(a.$1.isPauseEnabled!==!0)return(p||(p=b("Promise"))).resolve();a.$6.resolveWasCalled()||d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: loop paused - waiting for unpause"])));return a.$6.promise},h=function(){if(a.$2.resolveWasCalled())return;if(e!==a.$5)return;var b=Date.now();a.$3=c.code(a.endWithValue).then(function(){if(a.$2.resolveWasCalled())return;var e=c.resetDelay;(e!==void 0&&Date.now()>=b+e||a.$4!=null&&a.$4<=Date.now())&&(d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: resetting ",""])),c.name),f=d("WAPromiseBackoffs").createTimer(a.$1.timer));a.$4=null;e=f();d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["PromiseRetryLoop: retrying "," in ","ms"])),c.name,e);return d("WAPromiseDelays").delayMs(e).then(g).then(h)});return a.$3};this.$3=(p||(p=b("Promise"))).resolve().then(h)};e.promise=function(){var a=this;if(this.$2.resolveWasCalled())return this.$2.promise;return!this.$3?(p||(p=b("Promise"))).reject(c("err")("PromiseRetryLoop "+this.$1.name+" had promise() called before start()")):(p||(p=b("Promise"))).race([this.$2.promise,this.$3.then(function(){return a.$2.promise})])};return a}();g.PromiseRetryLoop=a}),98);
__d("WASmaxInPingsEnums",["WAJids"],(function(a,b,c,d,e,f,g){a={validators:[d("WAJids").validateDomainJid,d("WAJids").validateUserJid],typeName:"DomainJid|UserJid"};g.DOMAINJID_USERJID=a}),98);
__d("WAWapJid",["$InternalEnum","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h={JID:0,JID_U:1,JID_AD:1,JID_FB:3,JID_INTEROP:4},i=b("$InternalEnum")({WHATSAPP:0,LID:1,HOSTED:128,HOSTED_LID:129});a=function(){function a(a){this.$1=a}a.createAD=function(b,c,d){return new a({type:h.JID_AD,user:b,device:d==null?0:d,agent:c==null?0:c,domainType:i.WHATSAPP})};a.createJidU=function(b,c,d){return new a({type:h.JID_U,user:b,device:d==null?0:d,domainType:c==null?i.WHATSAPP:c})};a.createFbJid=function(b,c){c=c==null?0:c;return new a({type:h.JID_FB,user:b,device:c})};a.createInteropJid=function(b,c,d){c=c==null?0:c;return new a({type:h.JID_INTEROP,user:b,device:c,integrator:d})};a.create=function(b,c){return new a({type:h.JID,user:b,server:c})};var b=a.prototype;b.toString=function(){if(this.$1.type===h.JID_AD||this.$1.type===h.JID_U){var a=this.$1,b=a.user,c=a.device;a=a.domainType;var e;a===i.WHATSAPP?e=d("WAJids").WA_USER_JID_SUFFIX:a===i.HOSTED?e=d("WAJids").HOSTED_SUFFIX:a===i.HOSTED_LID?e=d("WAJids").HOSTED_LID_SUFFIX:e=d("WAJids").LID_SUFFIX;return c===0?b+"@"+e:b+":"+c+"@"+e}else if(this.$1.type===h.JID_FB){a=this.$1;b=a.user;c=a.device;e=d("WAJids").MSGR_USER_JID_SUFFIX;return b+":"+c+"@"+e}else if(this.$1.type===h.JID_INTEROP){a=this.$1;b=a.user;c=a.device;e=a.integrator;a=d("WAJids").INTEROP_USER_JID_SUFFIX;return e+"-"+b+":"+c+"@"+a}else{this.$1.type;e=this.$1;b=e.user;c=e.server;return b!=null?b+"@"+c:c}};b.getInnerJid=function(){return this.$1};return a}();g.WAP_JID_SUBTYPE=h;g.DomainType=i;g.WapJid=a}),98);
__d("WASmaxParseUtils",["WABase64","WABinary","WACryptoUtils","WADeepEquals","WAHasProperty","WAResultOrError","WAStanzaUtils","WAWapJid"],(function(a,b,c,d,e,f,g){"use strict";var h=d("WAResultOrError").makeResult();function a(a,b){return a.tag!==b?I(a,"to be <"+b+">"):h}function i(a,b){return!J(a,b)?I(a,'to have attribute "'+b+'"'):K(a,a.attrs[b])}function j(a,b,c,e){var f=i(a,b);if(!f.success)return f;c=c(f.value);return c!=null?d("WAResultOrError").makeResult(c):I(a,'to have "'+b+'"={'+e+'}, but instead has "'+f.value+'"')}function k(a,b,c){var e=C(a);if(!e.success)return e;b=b(e.value);return b!=null?d("WAResultOrError").makeResult(b):I(a,"to have "+c+' content, but instead has "'+e.value+'"')}function b(a,b,c){var d=i(a,b);if(!d.success)return d;else if(d.value!==c)return I(a,'to have "'+b+'"="'+c+'", but instead has "'+d.value+'"');return h}function e(a,b){return j(a,b,d("WAStanzaUtils").toStanzaId,"stanzaID")}function f(a,b){return j(a,b,d("WAStanzaUtils").validateCallId,"callID")}function l(a,b){return j(a,b,L,"integer")}function m(a,b,c,e){var f=l(a,b);if(!f.success)return f;f=f.value;if(c!==void 0&&f<c)return I(a,'to have "'+b+'"={at least '+c+"} but has value "+f);else if(e!==void 0&&f>e)return I(a,'to have "'+b+'"={at most '+e+"} but has value "+f);return d("WAResultOrError").makeResult(f)}function n(a){var b=a.content;return b instanceof Uint8Array?I(a,"to have children"):d("WAResultOrError").makeResult(b)}function o(a,b){var c=n(a);if(!c.success)return c;c=c.value;if(c==null)return h;var e=null;for(var f=0;f<c.length;f++){var g=c[f];if(g.tag===b){if(e!=null)return I(a,"to have 1 child <"+b+">, but found more than 1");e=g}}return d("WAResultOrError").makeResult(e)}function p(a,b,c){a=o(a,b);if(!a.success)return a;return a.value==null?h:c(a.value)}function q(a,b,c){c=p(a,b,c);if(!c.success)return c;c=c.value;return c==null?I(a,"to have 1 child <"+b+">, but found 0"):d("WAResultOrError").makeResult(c)}function r(a,b){var c=o(a,b);if(!c.success)return c;return c.value==null?I(a,"to have 1 child <"+b+">, but found 0"):d("WAResultOrError").makeResult(c.value)}function s(a,b,c,e,f){a=M(a,b,c,e);if(!a.success)return a;b=[];for(c=0;c<a.value.length;c++){e=f(a.value[c]);if(!e.success)return e;b.push(e.value)}return d("WAResultOrError").makeResult(b)}function t(a,b,c,e,f){a=M(a,b,c,e);if(!a.success)return a;b=a.value.length;for(c=0;c<b;c++){e=f(a.value[c]);if(!e.success)return e}return d("WAResultOrError").makeResult(b)}function u(a,b,c){b=s(a,b,0,Infinity,c);if(!b.success)return b;for(c=0;c<b.value.length;c++)if(!d("WADeepEquals").deepEqual(b.value[0],b.value[c]))return I(a,"to have homogeneous children, but found two children that are not equal");return b}function v(a,b,c){a=u(a,b,c);return!a.success?a:d("WAResultOrError").makeResult(a.value.length)}function w(a,b,c,d,e){return J(b,c)?a(b,c,d,e):h}function x(a,b,c,e){if(e==null)return h;a=w(a,b,c);if(!a.success)return a;if(a.value===e)return d("WAResultOrError").makeResult(e);return a.value==null?h:I(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function y(a,b,c,e){a=a(b,c);if(!a.success)return a;return a.value===e?d("WAResultOrError").makeResult(e):I(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function z(a,b,c){a=a(b);if(!a.success)return a;return a.value===c?d("WAResultOrError").makeResult(c):I(b,'to have content "'+c+'", but instead has "'+a.value+'"')}function A(a,b,c){var e=i(a,b);if(!e.success)return e;var f=c[e.value];if(f!=null)return d("WAResultOrError").makeResult(f);f=Object.values(c).join("|");return I(a,'to have "'+b+'"={'+f+'}, but instead has "'+e.value+'"')}function B(a,b){var c=C(a);if(!c.success)return c;var e=b[c.value];if(e!=null)return d("WAResultOrError").makeResult(e);e=Object.values(b).join("|");return I(a,'to have content "'+e+'", but instead has "'+c.value+'"')}function C(a){var b=D(a);if(!b.success)return b;else try{b=new(d("WABinary").Binary)(b.value);b=b.readString(b.size());return d("WAResultOrError").makeResult(b)}catch(b){return I(a,"to have string content, but run into decoding error: "+b.message)}}function D(a){var b=a.content;if(b==null)return I(a,"to have content");else if(Array.isArray(b))return I(a,"to have content, but has children instead");else return d("WAResultOrError").makeResult(b)}function E(a,b){var c=D(a);if(!c.success)return c;return d("WACryptoUtils").uint8ArraysEqual(c.value,b)?d("WAResultOrError").makeResult(b):I(a,'to have content ":binary:'+d("WABase64").encodeB64(b)+'", but instead has ":binary:'+d("WABase64").encodeB64(c.value)+'"')}function F(a,b,c){var e=a.content;if(e==null)if(b===void 0||b<1)return d("WAResultOrError").makeResult(new Uint8Array([]));else return I(a,"to have content");else if(Array.isArray(e))return I(a,"to have content, but has children instead");else{var f=e.length;if(b!==void 0&&f<b)return I(a,"to have binary content at least "+b+" bytes but has "+f+" bytes");else if(c!==void 0&&f>c)return I(a,"to have binary content at most "+c+" bytes but has "+f+" bytes");return d("WAResultOrError").makeResult(e)}}function G(a){return k(a,L,"integer")}function H(a){return a}function I(a,b){return d("WAResultOrError").makeError("expected <"+a.tag+">: "+b)}function J(a,b){return c("WAHasProperty")(a.attrs,b)}function K(a,b){if(b instanceof d("WAWapJid").WapJid)return d("WAResultOrError").makeResult(b.toString());return typeof b==="string"?d("WAResultOrError").makeResult(b):I(a,"decodeAsString: attribute is "+typeof b+" not a string: "+String(b))}function L(a){a=parseInt(a,10);return Number.isNaN(a)?null:a}function M(a,b,c,e){var f=n(a);if(!f.success)return f;f=f.value;if(f==null)if(c!==0)return I(a,"to have at least "+c+" <"+b+"> children, but found 0");else return d("WAResultOrError").makeResult([]);var g=[];for(var h=0;h<f.length;h++){var i=f[h];i.tag===b&&g.push(i)}i=g.length;if(i<c)return I(a,"to have at least "+c+" <"+b+"> children, but found "+i);else if(i>e)return I(a,"to have at most "+e+" <"+b+"> children, but found "+i);return d("WAResultOrError").makeResult(g)}var N={};function O(a,b,c){var d=b.map(function(a,b){return a+": "+c[b].error});return I(a,["to match any of following mixins: "+b.join(", ")+", but all mixins failed."].concat(d).join(" "))}g.voidSuccess=h;g.assertTag=a;g.attrString=i;g.attrValidate=j;g.contentValidate=k;g.assertAttr=b;g.attrStanzaId=e;g.attrCallId=f;g.attrInt=l;g.attrIntRange=m;g.maybeChildren=n;g.optionalChild=o;g.optionalChildWithTag=p;g.childWithTag=q;g.flattenedChildWithTag=r;g.mapChildrenWithTag=s;g.countChildrenWithTag=t;g.mapHomogeneousChildrenWithTag=u;g.countHomogeneousChildrenWithTag=v;g.optional=w;g.optionalLiteral=x;g.literal=y;g.literalContent=z;g.attrStringEnum=A;g.contentStringEnum=B;g.contentString=C;g.contentBytes=D;g.contentLiteralBytes=E;g.contentBytesRange=F;g.contentInt=G;g.identity=H;g.errorMessage=I;g.emptyObject=N;g.errorMixinDisjunction=O}),98);
__d("WASmaxParseJid",["WAJids","WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateUserJid,"UserJid")}function b(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateLidUserJid,"LidUserJid")}function c(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateDeviceJid,"DeviceJid")}function e(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateGroupJid,"GroupJid")}function f(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateCallJid,"CallJid")}function h(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateDomainJid,"DomainJid")}function i(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateBroadcastJid,"BroadcastJid")}function j(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateStatusJid,"StatusJid")}function k(a,b){return d("WASmaxParseUtils").attrValidate(a,b,d("WAJids").validateNewsletterJid,"NewsletterJid")}function l(a,b,c){var e=d("WASmaxParseUtils").attrString(a,b);if(!e.success)return e;var f=c.validators;c=c.typeName;for(var g=0;g<f.length;g++){var h=f[g](e.value);if(h!=null)return d("WAResultOrError").makeResult(h)}return d("WASmaxParseUtils").errorMessage(a,'to have "'+b+'"={'+c+'}, but instead has "'+e.value+'"')}function m(a,b,c,e){a=a(b,c);if(!a.success)return a;return a.value===e?a:d("WASmaxParseUtils").errorMessage(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}function n(a,b,c,e){a=d("WASmaxParseUtils").optional(a,b,c);if(!a.success)return a;return a.value==null||a.value===e?a:d("WASmaxParseUtils").errorMessage(b,'to have "'+c+'"={'+e+'}, but instead has "'+a.value+'"')}g.attrUserJid=a;g.attrLidUserJid=b;g.attrDeviceJid=c;g.attrGroupJid=e;g.attrCallJid=f;g.attrDomainJid=h;g.attrBroadcastJid=i;g.attrStatusJid=j;g.attrNewsletterJid=k;g.attrJidEnum=l;g.literalJid=m;g.optionalLiteralJid=n}),98);
__d("WASmaxParseReference",["WAHasProperty","WAResultOrError","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c,d,e){b=j(b,c);if(!b.success)return l(b);a=a(b.value,c[c.length-1],d,e);return!a.success?l(a):a}function a(a,b,c,e,f){return k(b,c)?h(a,b,c,e,f):d("WASmaxParseUtils").voidSuccess}function i(a,b){return h(d("WASmaxParseUtils").attrString,a,b)}function b(a,b){return k(a,b)?i(a,b):d("WASmaxParseUtils").voidSuccess}function e(a,b){a=j(a,b);if(!a.success)return l(a);b=d("WASmaxParseUtils").contentString(a.value);return!b.success?l(b):b}function j(a,b){var c=b.length;a=a;for(var e=0;e<c-1;e++){var f=b[e];f=d("WASmaxParseUtils").flattenedChildWithTag(a,f);if(!f.success)return f;a=f.value}return d("WAResultOrError").makeResult(a)}function k(a,b){a=j(a,b);return a.success&&c("WAHasProperty")(a.value.attrs,b[b.length-1])}function l(a){return d("WAResultOrError").makeError("in the reference, "+a.error)}g.attrFromReference=h;g.optionalAttrFromReference=a;g.attrStringFromReference=i;g.optionalAttrStringFromReference=b;g.contentStringFromReference=e}),98);
__d("WASmaxInPingsClientResponseServerResponse",["WAResultOrError","WASmaxInPingsEnums","WASmaxParseJid","WASmaxParseReference","WASmaxParseUtils"],(function(a,b,c,d,e,f,g){function a(a,b){var c=d("WASmaxParseUtils").assertTag(a,"iq");if(!c.success)return c;c=d("WASmaxParseJid").attrJidEnum(a,"from",d("WASmaxInPingsEnums").DOMAINJID_USERJID);if(!c.success)return c;var e=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"type","result");if(!e.success)return e;b=d("WASmaxParseReference").attrStringFromReference(b,["id"]);if(!b.success)return b;b=d("WASmaxParseUtils").literal(d("WASmaxParseUtils").attrString,a,"id",b.value);if(!b.success)return b;b=d("WASmaxParseUtils").attrInt(a,"t");return!b.success?b:d("WAResultOrError").makeResult({from:c.value,type:e.value,t:b.value})}g.parseClientResponseServerResponse=a}),98);
__d("WAWapDict",[],(function(a,b,c,d,e,f){"use strict";a=3;b=["xmlstreamstart","xmlstreamend","s.whatsapp.net","type","participant","from","receipt","id","notification","disappearing_mode","status","jid","broadcast","user","devices","device_hash","to","offline","message","result","class","xmlns","duration","notify","iq","t","ack","g.us","enc","urn:xmpp:whatsapp:push","presence","config_value","picture","verified_name","config_code","key-index-list","contact","mediatype","routing_info","edge_routing","get","read","urn:xmpp:ping","fallback_hostname","0","chatstate","business_hours_config","unavailable","download_buckets","skmsg","verified_level","composing","handshake","device-list","media","text","fallback_ip4","media_conn","device","creation","location","config","item","fallback_ip6","count","w:profile:picture","image","business","2","hostname","call-creator","display_name","relaylatency","platform","abprops","success","msg","offline_preview","prop","key-index","v","day_of_week","pkmsg","version","1","ping","w:p","download","video","set","specific_hours","props","primary","unknown","hash","commerce_experience","last","subscribe","max_buckets","call","profile","member_since_text","close_time","call-id","sticker","mode","participants","value","query","profile_options","open_time","code","list","host","ts","contacts","upload","lid","preview","update","usync","w:stats","delivery","auth_ttl","context","fail","cart_enabled","appdata","category","atn","direct_connection","decrypt-fail","relay_id","mmg-fallback.whatsapp.net","target","available","name","last_id","mmg.whatsapp.net","categories","401","is_new","index","tctoken","ip4","token_id","latency","recipient","edit","ip6","add","thumbnail-document","26","paused","true","identity","stream:error","key","sidelist","background","audio","3","thumbnail-image","biz-cover-photo","cat","gcm","thumbnail-video","error","auth","deny","serial","in","registration","thumbnail-link","remove","00","gif","thumbnail-gif","tag","capability","multicast","item-not-found","description","business_hours","config_expo_key","md-app-state","expiration","fallback","ttl","300","md-msg-hist","device_orientation","out","w:m","open_24h","side_list","token","inactive","01","document","te2","played","encrypt","msgr","hide","direct_path","12","state","not-authorized","url","terminate","signature","status-revoke-delay","02","te","linked_accounts","trusted_contact","timezone","ptt","kyc-id","privacy_token","readreceipts","appointment_only","address","expected_ts","privacy","7","android","interactive","device-identity","enabled","attribute_padding","1080","03","screen_height"];c=["read-self","active","fbns","protocol","reaction","screen_width","heartbeat","deviceid","2:47DEQpj8","uploadfieldstat","voip_settings","retry","priority","longitude","conflict","false","ig_professional","replaced","preaccept","cover_photo","uncompressed","encopt","ppic","04","passive","status-revoke-drop","keygen","540","offer","rate","opus","latitude","w:gp2","ver","4","business_profile","medium","sender","prev_v_id","email","website","invited","sign_credential","05","transport","skey","reason","peer_abtest_bucket","America/Sao_Paulo","appid","refresh","100","06","404","101","104","107","102","109","103","member_add_mode","105","transaction-id","110","106","outgoing","108","111","tokens","followers","ig_handle","self_pid","tue","dec","thu","joinable","peer_pid","mon","features","wed","peer_device_presence","pn","delete","07","fri","audio_duration","admin","connected","delta","rcat","disable","collection","08","480","sat","phash","all","invite","accept","critical_unblock_low","group_update","signed_credential","blinded_credential","eph_setting","net","09","background_location","refresh_id","Asia/Kolkata","privacy_mode_ts","account_sync","voip_payload_type","service_areas","acs_public_key","v_id","0a","fallback_class","relay","actual_actors","metadata","w:biz","5","connected-limit","notice","0b","host_storage","fb_page","subject","privatestats","invis","groupadd","010","note.m4r","uuid","0c","8000","sun","372","1020","stage","1200","720","canonical","fb","011","video_duration","0d","1140","superadmin","012","Opening.m4r","keystore_attestation","dleq_proof","013","timestamp","ab_key","w:sync:app:state","0e","vertical","600","p_v_id","6","likes","014","500","1260","creator","0f","rte","destination","group","group_info","syncd_anti_tampering_fatal_exception_enabled","015","dl_bw","Asia/Jakarta","vp8/h.264","online","1320","fb:multiway","10","timeout","016","nse_retry","urn:xmpp:whatsapp:dirty","017","a_v_id","web_shops_chat_header_button_enabled","nse_call","inactive-upgrade","none","web","groups","2250","mms_hot_content_timespan_in_seconds","contact_blacklist","nse_read","suspended_group_deletion_notification","binary_version","018","https://www.whatsapp.com/otp/copy/","reg_push","shops_hide_catalog_attachment_entrypoint","server_sync",".","ephemeral_messages_allowed_values","019","mms_vcache_aggregation_enabled","iphone","America/Argentina/Buenos_Aires","01a","mms_vcard_autodownload_size_kb","nse_ver","shops_header_dropdown_menu_item","dhash","catalog_status","communities_mvp_new_iqs_serverprop","blocklist","default","11","ephemeral_messages_enabled","01b","original_dimensions","8","mms4_media_retry_notification_encryption_enabled","mms4_server_error_receipt_encryption_enabled","original_image_url","sync","multiway","420","companion_enc_static","shops_profile_drawer_entrypoint","01c","vcard_as_document_size_kb","status_video_max_duration","request_image_url","01d","regular_high","s_t","abt","share_ext_min_preliminary_image_quality","01e","32","syncd_key_rotation_enabled","data_namespace","md_downgrade_read_receipts2","patch","polltype","ephemeral_messages_setting","userrate","15","partial_pjpeg_bw_threshold","played-self","catalog_exists","01f","mute_v2"];d=["reject","dirty","announcement","020","13","9","status_video_max_bitrate","fb:thrift_iq","offline_batch","022","full","ctwa_first_business_reply_logging","h.264","smax_id","group_description_length","https://www.whatsapp.com/otp/code","status_image_max_edge","smb_upsell_business_profile_enabled","021","web_upgrade_to_md_modal","14","023","s_o","smaller_video_thumbs_status_enabled","media_max_autodownload","960","blocking_status","peer_msg","joinable_group_call_client_version","group_call_video_maximization_enabled","return_snapshot","high","America/Mexico_City","entry_point_block_logging_enabled","pop","024","1050","16","1380","one_tap_calling_in_group_chat_size","regular_low","inline_joinable_education_enabled","hq_image_max_edge","locked","America/Bogota","smb_biztools_deeplink_enabled","status_image_quality","1088","025","payments_upi_intent_transaction_limit","voip","w:g2","027","md_pin_chat_enabled","026","multi_scan_pjpeg_download_enabled","shops_product_grid","transaction_id","ctwa_context_enabled","20","fna","hq_image_quality","alt_jpeg_doc_detection_quality","group_call_max_participants","pkey","America/Belem","image_max_kbytes","web_cart_v1_1_order_message_changes_enabled","ctwa_context_enterprise_enabled","urn:xmpp:whatsapp:account","840","Asia/Kuala_Lumpur","max_participants","video_remux_after_repair_enabled","stella_addressbook_restriction_type","660","900","780","context_menu_ios13_enabled","mute-state","ref","payments_request_messages","029","frskmsg","vcard_max_size_kb","sample_buffer_gif_player_enabled","match_last_seen","510","4983","video_max_bitrate","028","w:comms:chat","17","frequently_forwarded_max","groups_privacy_blacklist","Asia/Karachi","02a","web_download_document_thumb_mms_enabled","02b","hist_sync","biz_block_reasons_version","1024","18","web_is_direct_connection_for_plm_transparent","view_once_write","file_max_size","paid_convo_id","online_privacy_setting","video_max_edge","view_once_read","enhanced_storage_management","multi_scan_pjpeg_encoding_enabled","ctwa_context_forward_enabled","video_transcode_downgrade_enable","template_doc_mime_types","hq_image_bw_threshold","30","body","u_aud_limit_sil_restarts_ctrl","other","participating","w:biz:directory","1110","vp8","4018","meta","doc_detection_image_max_edge","image_quality","1170","02c","smb_upsell_chat_banner_enabled","key_expiry_time_second","pid","stella_interop_enabled","19","linked_device_max_count","md_device_sync_enabled","02d","02e","360","enhanced_block_enabled","ephemeral_icon_in_forwarding","paid_convo_status","gif_provider","project_name","server-error","canonical_url_validation_enabled","wallpapers_v2","syncd_clear_chat_delete_chat_enabled","medianotify","02f","shops_required_tos_version","vote","reset_skey_on_id_change","030","image_max_edge","multicast_limit_global","ul_bw","21","25","5000","poll","570","22","031","1280","WhatsApp","032","bloks_shops_enabled","50","upload_host_switching_enabled","web_ctwa_context_compose_enabled","ptt_forwarded_features_enabled","unblocked","partial_pjpeg_enabled","fbid:devices","height","ephemeral_group_query_ts","group_join_permissions","order","033","alt_jpeg_status_quality","migrate","popular-bank","win_uwp_deprecation_killswitch_enabled","web_download_status_thumb_mms_enabled","blocking","url_text","035","web_forwarding_limit_to_groups","1600","val","1000","syncd_msg_date_enabled","bank-ref-id","max_subject","payments_web_enabled","web_upload_document_thumb_mms_enabled","size","request","ephemeral","24","receipt_agg","ptt_remember_play_position","sampling_weight","enc_rekey","mute_always","037","034","23","036","action","click_to_chat_qr_enabled","width","disabled","038","md_blocklist_v2","played_self_enabled","web_buttons_message_enabled","flow_id","clear","450","fbid:thread","bloks_session_state","America/Lima","attachment_picker_refresh","download_host_switching_enabled","1792","u_aud_limit_sil_restarts_test2","custom_urls","device_fanout","optimistic_upload","2000","key_cipher_suite","web_smb_upsell_in_biz_profile_enabled","e","039","siri_post_status_shortcut","pair-device","lg","lc","stream_attribution_url","model","mspjpeg_phash_gen","catalog_send_all","new_multi_vcards_ui","share_biz_vcard_enabled","-","clean","200","md_blocklist_v2_server","03b","03a","web_md_migration_experience","ptt_conversation_waveform","u_aud_limit_sil_restarts_test1"];e=["64","ptt_playback_speed_enabled","web_product_list_message_enabled","paid_convo_ts","27","manufacturer","psp-routing","grp_uii_cleanup","ptt_draft_enabled","03c","business_initiated","web_catalog_products_onoff","web_upload_link_thumb_mms_enabled","03e","mediaretry","35","hfm_string_changes","28","America/Fortaleza","max_keys","md_mhfs_days","streaming_upload_chunk_size","5541","040","03d","2675","03f","...","512","mute","48","041","alt_jpeg_quality","60","042","md_smb_quick_reply","5183","c","1343","40","1230","043","044","mms_cat_v1_forward_hot_override_enabled","user_notice","ptt_waveform_send","047","Asia/Calcutta","250","md_privacy_v2","31","29","128","md_messaging_enabled","046","crypto","690","045","enc_iv","75","failure","ptt_oot_playback","AIzaSyDR5yfaG7OG8sMTUj8kfQEb8T9pN8BM6Lk","w","048","2201","web_large_files_ui","Asia/Makassar","812","status_collapse_muted","1334","257","2HP4dm","049","patches","1290","43cY6T","America/Caracas","web_sticker_maker","campaign","ptt_pausable_enabled","33","42","attestation","biz","04b","query_linked","s","125","04a","810","availability","1411","responsiveness_v2_m1","catalog_not_created","34","America/Santiago","1465","enc_p","04d","status_info","04f","key_version","..","04c","04e","md_group_notification","1598","1215","web_cart_enabled","37","630","1920","2394","-1","vcard","38","elapsed","36","828","peer","pricing_category","1245","invalid","stella_ios_enabled","2687","45","1528","39","u_is_redial_audio_1104_ctrl","1025","1455","58","2524","2603","054","bsp_system_message_enabled","web_pip_redesign","051","verify_apps","1974","1272","1322","1755","052","70","050","1063","1135","1361","80","1096","1828","1851","1251","1921","key_config_id","1254","1566","1252","2525","critical_block","1669","max_available","w:auth:backup:token","product","2530","870","1022","participant_uuid","web_cart_on_off","1255","1432","1867","41","1415","1440","240","1204","1608","1690","1846","1483","1687","1749","69","url_number","053","1325","1040","365","59","Asia/Riyadh","1177","test_recommended","057","1612","43","1061","1518","1635","055","1034","1375","750","1430","event_code","1682","503","55","865","78","1309","1365","44","America/Guayaquil","535","LIMITED","1377","1613","1420","1599","1822","05a","1681","password","1111","1214","1376","1478","47","1082","4282","Europe/Istanbul","1307","46","058","1124","256","rate-overlimit","retail","u_a_socket_err_fix_succ_test","1292","1370","1388","520","861","psa","regular","1181","1766","05b","1183","1213","1304","1537"];var g=["1724","profile_picture","1071","1314","1605","407","990","1710","746","pricing_model","056","059","061","1119","6027","65","877","1607","05d","917","seen","1516","49","470","973","1037","1350","1394","1480","1796","keys","794","1536","1594","2378","1333","1524","1825","116","309","52","808","827","909","495","1660","361","957","google","1357","1565","1967","996","1775","586","736","1052","1670","bank","177","1416","2194","2222","1454","1839","1275","53","997","1629","6028","smba","1378","1410","05c","1849","727","create","1559","536","1106","1310","1944","670","1297","1316","1762","en","1148","1295","1551","1853","1890","1208","1784","7200","05f","178","1283","1332","381","643","1056","1238","2024","2387","179","981","1547","1705","05e","290","903","1069","1285","2436","062","251","560","582","719","56","1700","2321","325","448","613","777","791","51","488","902","Asia/Almaty","is_hidden","1398","1527","1893","1999","2367","2642","237","busy","065","067","233","590","993","1511","54","723","860","363","487","522","605","995","1321","1691","1865","2447","2462","NON_TRANSACTIONAL","433","871","432","1004","1207","2032","2050","2379","2446","279","636","703","904","248","370","691","700","1068","1655","2334","060","063","364","533","534","567","1191","1210","1473","1827","069","701","2531","514","prev_dhash","064","496","790","1046","1139","1505","1521","1108","207","544","637","final","1173","1293","1694","1939","1951","1993","2353","2515","504","601","857","modify","spam_request","p_121_aa_1101_test4","866","1427","1502","1638","1744","2153","068","382","725","1704","1864","1990","2003","Asia/Dubai","508","531","1387","1474","1632","2307","2386","819","2014","066","387","1468","1706","2186","2261","471","728","1147","1372","1961"],h=[c,d,e,g];f.DICT_VERSION=a;f.SINGLE_BYTE_TOKEN=b;f.DICTIONARY_0_TOKEN=c;f.DICTIONARY_1_TOKEN=d;f.DICTIONARY_2_TOKEN=e;f.DICTIONARY_3_TOKEN=g;f.DICTIONARIES=h}),66);
__d("WAXmlFormatter",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns:/g,"~::~xmlns:").replace(/\s*xmlns=/g,"~::~xmlns=").split("~::~");var b=a.length,c=!1,d=0,e="",f=0,h=["\n"];for(f=0;f<100;f++)h.push(h[f]+"    ");var i=function(b,a){var c=/^<[\w:\-.,]+/.exec(b[a-1]);b=/^<\/[\w:\-.,]+/.exec(b[a]);return c!=null&&b!=null&&c[0]===b[0]};for(f=0;f<b;f++)a[f].search(/<!/)>-1?(e+=h[d]+a[f],c=!0,(a[f].search(/-->/)>-1||a[f].search(/\]>/)>-1||a[f].search(/!DOCTYPE/)>-1)&&(c=!1)):a[f].search(/-->/)>-1||a[f].search(/\]>/)>-1?(e+=a[f],c=!1):i(a,f)?(e+=a[f],c||d--):a[f].search(/<\w/)>-1&&a[f].search(/<\//)===-1&&a[f].search(/\/>/)===-1?(a[f]=g(a[f]),e=c?e+=a[f]:e+=h[d++]+a[f]):a[f].search(/<\w/)>-1&&a[f].search(/<\//)>-1?e=c?e+=a[f]:e+=h[d]+a[f]:a[f].search(/<\//)>-1?e=c?e+=a[f]:e+=h[d===0?d:--d]+a[f]:a[f].search(/\/>/)>-1?e=c?e+=a[f]:e+=h[d]+a[f]:a[f].search(/<\?/)>-1?e+=h[d]+a[f]:a[f].search(/xmlns:/)>-1||a[f].search(/xmlns=/)>-1?e+=h[d]+a[f]:e+=a[f];return e[0]==="\n"?e.slice(1):e}function g(a){var b=a.match(/(<query.*>|<result>)(\{.*\})/);if(b===null)return a;try{var c=b[1];b=JSON.stringify(JSON.parse(b[2]),null,2);return c+"\n"+b}catch(b){return a+"[Error formatting JSON]"}}f["default"]=a}),66);
__d("WAXmlNode",["WAHex"],(function(a,b,c,d,e,f,g){"use strict";var h={};a=function(){function a(a,b,c){b===void 0&&(b=h),c===void 0&&(c=null),this.tag=a,this.attrs=b,this.content=c}var b=a.prototype;b.toString=function(){var a="<"+this.tag;a+=i(this.attrs);var b=this.content;Array.isArray(b)?a+=">"+b.map(String).join("")+"</"+this.tag+">":b instanceof Uint8Array?a+=">"+j(b)+"</"+this.tag+">":b!=null?a+=">"+String(b)+"</"+this.tag+">":a+=" />";return a};return a}();function i(a){var b=Object.keys(a),c="";for(var d=0;d<b.length;d++){var e=b[d];c+=" "+e+'="'+a[e].toString()+'"'}return c}function j(a){var b;a.length===0?b="<!-- empty binary -->":a.length<50?b=d("WAHex").bytesToDebugString(a):b="<!-- "+a.length+" bytes -->";return b}g.XmlNode=a;g.attrsToString=i;g.uint8ArrayToDebugString=j}),98);
__d("WAWap",["WAAssertUnreachable","WABinary","WACryptoDependencies","WAJids","WALogger","WALongInt","WATextEncoding","WAWapDict","WAWapJid","WAXmlFormatter","WAXmlNode","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=(k=d("WAJids")).MSGR_USER_DOMAIN.replace("@",""),aa=k.WA_USER_DOMAIN.replace("@",""),m=k.LID_DOMAIN.replace("@",""),n=k.INTEROP_DOMAIN.replace("@",""),o=k.HOSTED_DOMAIN.replace("@",""),p=2,ba=128,q=0,r=236,s=237,t=238,u=239,ca=[r,s,t,u],v=245,w=246,x=247,y=248,z=249,A=250,B=251,C=252,D=253,E=254,F=255,da=["0","1","2","3","4","5","6","7","8","9","-",".","\ufffd","\ufffd","\ufffd","\ufffd"],ea=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],G="",fa=1,H={sentinel:"DROP_ATTR"},I=(s=d("WAWapJid")).WapJid.create(null,"g.us"),J=s.WapJid.create(null,k.WA_SERVER_JID_SUFFIX);t=s.WapJid.create("status","broadcast");var K=s.WapJid.create(null,"newsletter");k=s.WapJid.create(null,"hosted");var ga=s.WapJid.create(null,"hosted.lid"),L=s.WapJid.create(null,"call"),M={},N=!1;function a(){N=!0}var ha=d("WATextEncoding").newTextEncoder(),O=function(){function a(a,b,c){b===void 0&&(b=M),c===void 0&&(c=null),this.tag=a,this.attrs=b,this.content=c}var b=a.prototype;b.toString=function(){var a="<"+this.tag;a+=d("WAXmlNode").attrsToString(this.attrs);var b=this.content;Array.isArray(b)?a+=">"+b.map(String).join("")+"</"+this.tag+">":b?a+=">"+d("WAXmlNode").uint8ArrayToDebugString(b)+"</"+this.tag+">":a+=" />";N&&(a=c("WAXmlFormatter")(a));return a};return a}();function b(a,b,e){var f=null;if(b&&b.children!=null)throw c("err")('Children should not be passed via props (see eslint check "react/no-children-props")');if(Array.isArray(e))f=e.filter(Boolean);else if(typeof e==="string")f=d("WABinary").Binary.build(e).readByteArrayView();else if(e instanceof ArrayBuffer)f=new Uint8Array(e);else if(e instanceof Uint8Array)f=e;else{var g=[];for(var h=2;h<arguments.length;h++){var i=arguments[h];i&&g.push(i)}f=g}Array.isArray(f)&&f.length===0&&(f=null);var j={};if(b){var k=b;Object.keys(k).forEach(function(b){if(["__self","__source"].includes(b))return;var d=k[b];if(d==null)throw c("err")("Attr "+b+" in <"+a+"> is null");if(d===H)return;j[b]=d})}return new O(a,j,f)}s=b;function e(a){return a instanceof d("WAWapJid").WapJid?a.toString():a}function P(a){var b=a.content;Array.isArray(b)?b=b.map(P):typeof b==="string"&&(b=d("WABinary").Binary.build(b).readByteArrayView());return new O(a.tag,a.attrs||M,b)}function f(a){a=a instanceof O?a:P(a);var b=new(d("WABinary").Binary)();Q(a,b);a=0;b=b.readByteArrayView();var c=new Uint8Array(1+b.length);c[0]=a;c.set(b,1);return c}function Q(a,b){if(a==null)b.writeUint8(q);else if(a instanceof O)R(a,b);else if(a instanceof d("WAWapJid").WapJid)ia(a,b);else if(typeof a==="string")V(a,b);else if(a instanceof Uint8Array)ka(a,b);else{a;b=typeof a;throw c("err")("Invalid payload type "+b)}}function ia(a,b){a=a.getInnerJid();if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_U){var c=a.user,e=a.device,f=a.domainType;b.writeUint8(x);b.writeUint8(f);b.writeUint8(e);Q(c,b)}else if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_FB){f=a.user;e=a.device;b.writeUint8(w);Q(f,b);b.writeUint16(e);Q(l,b)}else if(a.type===d("WAWapJid").WAP_JID_SUBTYPE.JID_INTEROP){c=a.user;f=a.device;e=a.integrator;b.writeUint8(v);Q(c,b);b.writeUint16(f);b.writeUint16(e)}else{c=a.user;f=a.server;b.writeUint8(A);c!=null?Q(c,b):b.writeUint8(q);Q(f,b)}}function R(a,b){if(a.tag===void 0){b.writeUint8(y);b.writeUint8(q);return}var c=1;a.attrs&&(c+=Object.keys(a.attrs).length*2);a.content&&c++;c<256?(b.writeUint8(y),b.writeUint8(c)):c<65536&&(b.writeUint8(z),b.writeUint16(c));Q(a.tag,b);a.attrs&&Object.keys(a.attrs).forEach(function(c){V(c,b),Q(a.attrs[c],b)});c=a.content;if(Array.isArray(c)){c.length<256?(b.writeUint8(y),b.writeUint8(c.length)):c.length<65536&&(b.writeUint8(z),b.writeUint16(c.length));for(var d=0;d<c.length;d++)R(c[d],b)}else c&&Q(c,b)}var S,T;function U(a){var b=new Map();for(var c=0;c<a.length;c++)b.set(a[c],c);return b}function V(a,b){if(a===""){b.writeUint8(C);b.writeUint8(0);return}S==null&&(S=U(d("WAWapDict").SINGLE_BYTE_TOKEN));var c=S.get(a);if(c!=null){b.writeUint8(c+1);return}if(T==null){T=[];for(c=0;c<d("WAWapDict").DICTIONARIES.length;++c)T.push(U(d("WAWapDict").DICTIONARIES[c]))}for(c=0;c<T.length;++c){var e=T[c].get(a);if(e!=null){b.writeUint8(ca[c]);b.writeUint8(e);return}}e=d("WABinary").numUtf8Bytes(a);if(e<128){c=/[^0-9.-]+?/;var f=/[^0-9A-F]+?/;if(!c.exec(a)){ja(a,F,b);return}else if(!f.exec(a)){ja(a,B,b);return}}la(e,b);b.writeString(a)}function ja(a,b,d){var e=a.length%2===1;d.writeUint8(b);var f=Math.ceil(a.length/2);e&&(f|=ba);d.writeUint8(f);e=0;for(f=0;f<a.length;f++){var g=a.charCodeAt(f),h=null;48<=g&&g<=57?h=g-48:b===F?g===45?h=10:g===46&&(h=11):b===B&&(65<=g&&g<=70&&(h=g-55));if(h==null)throw c("err")("Cannot nibble encode "+g);else f%2===0?(e=h<<4,f===a.length-1&&(e|=15,d.writeUint8(e))):(e|=h,d.writeUint8(e))}}function ka(a,b){la(a.length,b),b.writeByteArray(a)}function la(a,b){if(a<256)b.writeUint8(C),b.writeUint8(a);else if(a<1048576)b.writeUint8(D),b.writeUint8(a>>>16&255),b.writeUint8(a>>>8&255),b.writeUint8(a&255);else if(a<4294967296)b.writeUint8(E),b.writeUint32(a);else throw c("err")("Binary with length "+a+" is too big for WAP protocol")}function ma(a,b){a=new(d("WABinary").Binary)(a);var c=a.readUint8();c=c&p;if(c){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Decoding compressed stanza"])));return b(a.readByteArrayView()).then(function(a){return X(new(d("WABinary").Binary)(a))})}return Promise.resolve(X(a))}function na(a){a=new(d("WABinary").Binary)(a);var b=a.readUint8();b=b&p;if(b)throw c("err")("Cannot pass compressed stanza to decodeStanzaDebug");return X(a)}function W(a,b){var e=a.readUint8();if(e===q)return null;if(e===y)return oa(a,a.readUint8());if(e===z)return oa(a,a.readUint16());if(e===C){var f=a.readUint8();return Z(a,f,b)}if(e===D){f=a.readUint8();var g=a.readUint8(),h=a.readUint8();f=((f&15)<<16)+(g<<8)+h;return Z(a,f,b)}if(e===E){g=a.readUint32();return Z(a,g,b)}if(e===A)return qa(a);if(e===w)return ra(a);if(e===v)return sa(a);if(e===x)return ta(a);if(e===F){h=a.readUint8();f=h>>>7;g=h&127;return ua(a,da,f,g)}if(e===B){b=a.readUint8();h=b>>>7;f=b&127;return ua(a,ea,h,f)}if(e<=0||e>=240)throw c("err")("Unable to decode WAP buffer");if(e>=r&&e<=u){g=e-r;b=d("WAWapDict").DICTIONARIES[g];if(b===void 0)throw c("err")("Missing WAP dictionary "+g);h=a.readUint8();f=b[h];if(f===void 0)throw c("err")("Invalid value index "+h+" in dict "+g);return f}a=d("WAWapDict").SINGLE_BYTE_TOKEN[e-1];if(a===void 0)throw c("err")("Undefined token with index "+e);return a}function oa(a,b){var c=[];for(var d=0;d<b;d++)c.push(X(a));return c}function X(a){var b=a.readUint8(),e;if(b===y)e=a.readUint8();else if(b===z)e=a.readUint16();else throw c("err")("Failed to decode node since type byte "+String(b)+" is invalid");b=void 0;var f=null;if(e===0)throw c("err")("Failed to decode node, list cannot be empty");var g=Y(a);e-=1;while(e>1){b||(b={});var h=Y(a),i=W(a,!0);b[h]=i;e-=2}e===1&&(f=W(a,!1),f instanceof d("WAWapJid").WapJid&&(f=String(f)),typeof f==="string"&&(f=ha.encode(f)));return new O(g,b,f)}function Y(a){a=W(a,!0);if(typeof a!=="string"){d("WALogger").DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["decodeString got invalid value: ",", string expected"])),String(a));throw c("err")("WAWap:decodeString got invalid value, string expected")}return a}function pa(a){a=W(a,!0);if(a!=null&&typeof a!=="string"){d("WALogger").DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["decodeNullableString got invalid value: ",", string expected"])),String(a));throw c("err")("WAWap:decodeNullableString got invalid value, string expected")}return a}function qa(a){var b=pa(a);a=Y(a);return d("WAWapJid").WapJid.create(b,a)}function ra(a){var b=Y(a),c=a.readUint16();Y(a);return d("WAWapJid").WapJid.createFbJid(b,c)}function sa(a){var b=Y(a),c=a.readUint16(),e=a.readUint16();Y(a);return d("WAWapJid").WapJid.createInteropJid(b,c,e)}function ta(a){var b=null,e=a.readUint8();if(e===0)b=d("WAWapJid").DomainType.WHATSAPP;else if(e===1)b=d("WAWapJid").DomainType.LID;else if((1&e)===0&&(128&e)!==0)b=d("WAWapJid").DomainType.HOSTED;else if(e===129)b=d("WAWapJid").DomainType.HOSTED_LID;else throw c("err")("decodeJidU - Invalid domain type encoding "+e);e=a.readUint8();a=Y(a);return d("WAWapJid").WapJid.createJidU(a,b,e)}function Z(a,b,c){c===void 0&&(c=!1);if(c)return a.readString(b);else return a.readByteArrayView(b)}function ua(a,b,c,d){d=new Array(d*2-c);for(var e=0;e<d.length-1;e+=2){var f=a.readUint8();d[e]=b[f>>>4];d[e+1]=b[f&15]}if(c){f=a.readUint8();d[d.length-1]=b[f>>>4]}return d.join("")}function va(){if(!G){var a=new Uint16Array(2);d("WACryptoDependencies").getCrypto().getRandomValues(a);G=String(a[0])+"."+String(a[1])+"-"}return""+G+fa++}function wa(a){switch(a.type){case"group":return a.groupJid;case"status":return d("WAJids").STATUS_JID;case"device":return a.deviceJid;case"newsletter":return a.newsletterJid;case"hosted":return a.hostedDeviceJid;case"hostedLid":return a.hostedLidDeviceJid;default:a.type;return a.broadcastJid}}function xa(a){switch(a.type){case"group":return a.author;case"status":return a.author;case"broadcast":return a.author;default:a.type;return null}}function ya(a){return a.type==="status"||a.type==="group"||a.type==="broadcast"?$(a.author):H}function za(a){return $(wa(a))}function $(a){var b=d("WAJids").validateDomainJid(a);if(b!=null)return Aa(b);b=a.split("@");a=b[0];b=b[1];var e=null;if((b===aa||b===l||b===n||b===m||b===o||b===d("WAJids").HOSTED_LID_SUFFIX)&&a.indexOf(":")!==-1){var f=a.split(":");a=f[0];f=f[1];e=parseInt(f,10)}if(b===n){f=a.split("-");var g=f[0];f=f[1];return d("WAWapJid").WapJid.createInteropJid(f,e,parseInt(g,10))}else if(b===l)return d("WAWapJid").WapJid.createFbJid(a,e);f=null;if(b===m)f=d("WAWapJid").DomainType.LID;else if(b===o){if(e!==99)throw c("err")("wid unexpected deviceId");f=d("WAWapJid").DomainType.HOSTED}else if(b===d("WAJids").HOSTED_LID_SUFFIX){if(e!==99)throw c("err")("lid invalid deviceId");f=d("WAWapJid").DomainType.HOSTED_LID}else f=d("WAWapJid").DomainType.WHATSAPP;return e!=null&&e!==0?d("WAWapJid").WapJid.createJidU(a,f,e):d("WAWapJid").WapJid.create(a,b)}function Aa(a){if(a==="s.whatsapp.net")return J;else if(a==="g.us")return I;else if(a==="newsletter")return K;else if(a==="call")return L;else return c("WAAssertUnreachable")(a)}function Ba(a){return $(a)}function Ca(a){return $(a)}function Da(a){return $(a)}function Ea(a){return $(a)}function Fa(a){return $(a)}function Ga(a){return $(a)}function Ha(a){if(a.jidType==="phoneDevice")return $(a.deviceJid);else if(a.jidType==="msgrDevice")return $(a.deviceJid);else if(a.jidType==="lidDevice")return $(a.deviceJid);else if(a.jidType==="phoneUser")return $(a.userJid);else if(a.jidType==="msgrUser")return $(a.userJid);else if(a.jidType==="lidUser")return $(a.userJid);else if(a.jidType==="group")return $(a.groupJid);else if(a.jidType==="status")return $(a.statusJid);else if(a.jidType==="call")return $(a.callJid);else if(a.jidType==="interopDevice")return $(a.deviceJid);else if(a.jidType==="interopUser")return $(a.userJid);else if(a.jidType==="newsletter")return $(a.newsletterJid);else if(a.jidType==="hosted")return $(a.hostedDeviceJid);else if(a.jidType==="hostedLid")return $(a.hostedLidDeviceJid);else if(a.jidType==="bot")return $(a.botJid);else{a.jidType;return $(a.broadcastJid)}}function Ia(a){return a}function Ja(a){return a.toString()}function Ka(a){return a}function La(a){return a}function Ma(a){return a==null?H:a}function Na(a){return a.toString()}function Oa(a){return d("WALongInt").longIntToDecimalString(a)}function Pa(a,b){b===void 0&&(b=4);a=a;var c=new Uint8Array(b);for(b=b-1;b>=0;b--)c[b]=a&255,a>>>=8;return c}g.DROP_ATTR=H;g.G_US=I;g.S_WHATSAPP_NET=J;g.STATUS_BROADCAST=t;g.NEWSLETTER=K;g.HOSTED=k;g.HOSTED_LID=ga;g.CALL=L;g.enableXMLFormat=a;g.WapNode=O;g.makeWapNode=b;g.wap=s;g.decodeAsString=e;g.makeStanza=P;g.encodeStanza=f;g.decodeStanza=ma;g.decodeStanzaDebug=na;g.generateId=va;g.extractToJid=wa;g.extractParticipantJid=xa;g.PARTICIPANT_JID=ya;g.TO_JID=za;g.JID=$;g.DOMAIN_JID=Aa;g.USER_JID=Ba;g.DEVICE_JID=Ca;g.GROUP_JID=Da;g.BROADCAST_JID=Ea;g.CALL_JID=Fa;g.NEWSLETTER_JID=Ga;g.TO_WAP_JID=Ha;g.STANZA_ID=Ia;g.SMAX_ID=Ja;g.CUSTOM_STRING=Ka;g.CALL_ID=La;g.MAYBE_CUSTOM_STRING=Ma;g.INT=Na;g.LONG_INT=Oa;g.BIG_ENDIAN_CONTENT=Pa}),98);
__d("WASmaxJsx",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";g.smax=d("WAWap").wap}),98);
__d("WASmaxMixins",["WAArrayBufferUtils","WAWapJid"],(function(a,b,c,d,e,f,g){"use strict";var h="smax$any";function i(a,b){j(a,b);k(a,b);b.content instanceof Uint8Array?m(a,b.content):b.content!=null&&n(a,b.content);return a}function a(a,b,c,d){return c!=null?a(b,c,d):b}function j(a,b){a=a.tag;b=b.tag;if(b===h)return;if(a!==b)throw new Error("tag mismatch: "+a+" != "+b)}function k(a,b){var c=a.attrs,d=b.attrs;Object.keys(d).forEach(function(a){var b=d[a],e=c[a];if(b!=null&&e!=null){if(l(b,e))return;throw new Error("conflict for key: "+a)}c[a]=b})}function l(a,b){if(typeof a==="string"&&typeof b==="string")return a===b;return a instanceof d("WAWapJid").WapJid&&b instanceof d("WAWapJid").WapJid?a.toString()===b.toString():!1}function m(a,b){var c=a.content;if(c instanceof Uint8Array){if(!d("WAArrayBufferUtils").uint8ArraysEqualUNSAFE(c,b))throw new Error("elementValue mismatch: bytes dose not equal");return}if(c!=null)throw new Error("elementValue mismatch: destination has children");a.content=b}function n(a,b){var c=a.content;if(c instanceof Uint8Array)throw new Error("children mismatch: destination has element value");if(c==null||c.length===0){a.content=b;return}if(!o(c,b))throw new Error("children mismatch: child counts are not compatible");var d=[],e=Array.from(c);b.forEach(function(a){var b=e.findIndex(function(b){return b.tag===a.tag});if(b===-1)d.push(a);else{b=e.splice(b,1);b=i(b[0],a);d.push(b)}});e.forEach(function(a){return d.push(a)});a.content=d}function o(a,b){b=p(b);a=p(a);var c=Object.keys(b);for(var d=0;d<c.length;d++){var e=c[d],f=b[e];e=a[e];if(f!=null&&e!=null&&f!==e)return!1}return!0}function p(a){return a.reduce(function(a,b){b=b.tag;var c=a[b];a[b]=c==null?1:c+1;return a},{})}g.mergeStanzas=i;g.optionalMerge=a}),98);
__d("WASmaxOutPingsClientWellFormedToMixin",["WASmaxJsx","WASmaxMixins","WAWap"],(function(a,b,c,d,e,f,g){function h(){var a=d("WASmaxJsx").smax("iq",{to:d("WAWap").S_WHATSAPP_NET});return a}function a(a){var b=h();return d("WASmaxMixins").mergeStanzas(a,b)}g.mergeClientWellFormedToMixin=a}),98);
__d("WASmaxOutPingsClientRequest",["WASmaxJsx","WASmaxOutPingsClientWellFormedToMixin","WAWap"],(function(a,b,c,d,e,f,g){function a(){var a=d("WASmaxOutPingsClientWellFormedToMixin").mergeClientWellFormedToMixin(d("WASmaxJsx").smax("iq",{id:d("WAWap").generateId(),type:"get",xmlns:"w:p"}));return a}g.makeClientRequest=a}),98);
__d("WAComms",["WAArrayUtils","WAErrors","WALogger","WANotifyConnectionChangeFactory","WAPromiseRetryLoop","WAResolvable","WAShiftTimer","WASmaxInPingsClientResponseServerResponse","WASmaxOutPingsClientRequest","WASmaxParseUtils","WATimeUtils","WAWap","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=null,P=null,Q=1,R=0,S=function(){function a(a,b,c){var e=this;this.nextSocketId=1;this.pendingIqs=new Map();this.ackHandlers=[];this.pendingSmaxStanzas=new Map();this.$2=new(d("WAResolvable").Resolvable)();this.socketAbortController=null;this.activePing=null;this.$3=new Set();this.socketId=R;this.socket=null;this.softCloseSocket=null;this.handleStanza=function(a,b,c){var f=d("WASmaxParseUtils").attrString(a,"id");if(f.success&&a.tag!=="receipt"){f=f.value;var g=e.pendingSmaxStanzas.get(f);if(g){e.pendingSmaxStanzas.delete(f);g.resolve(a);e.maybeScheduleHealthCheck();return"NO_ACK"}}f=$(a);if(f!=null){g=e.pendingIqs.get(f);g?(e.pendingIqs.delete(f),g.resolve(a),e.maybeScheduleHealthCheck()):(d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq with id ",""])),f),d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handleIq no handler for iq"]))))}else if(a.tag==="ack")e.handleAck(a);else return a.tag==="failure"&&e.config.shouldBlockReceivingUntilSuccess?e.$1(a,b,c):e.$2.promise.then(function(){return e.$1(a,b,c)});return"NO_ACK"};this.healthCheckTimer=new(d("WAShiftTimer").ShiftTimer)(function(){if(!e.socketId)return;void e.sendPing()});this.deadSocketTimer=new(d("WAShiftTimer").ShiftTimer)(function(a){if(a!==e.socketId)return;d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," expired"])),a);e.softCloseSocket&&e.softCloseSocket()});this.sendPing=async function(){var a=Z("sendPing");if(!a.socketId){d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[comms] sendPing when socket dead"])));return!1}if(a.activePing&&a.activePing.socketId===a.socketId){d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[comms] sendPing ping still pending"])));return!1}a.activePing&&a.activePing.handler.resolve();var b=d("WASmaxOutPingsClientRequest").makeClientRequest(),c=b.attrs.id;if(typeof c!=="string"){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[comms] No stanzaId in ping request stanza"])));return!1}var e=new(d("WAResolvable").Resolvable)();a.activePing={socketId:a.socketId,stanzaId:c,handler:e};void a.callStanza(b);c=await e.promise;if(c){e=d("WASmaxInPingsClientResponseServerResponse").parseClientResponseServerResponse(c,b);if(e.success){c=d("WATimeUtils").castToUnixTime(e.value.t);b=Math.round(Date.now()/1e3-c);a.config.handlers.onClockSkewUpdate==null||a.config.handlers.onClockSkewUpdate(b);return!0}}return!1};this.$1=a;this.onConnectionChange=d("WANotifyConnectionChangeFactory").notifyConnectionChangeFactory((a=b.handlers.onConnectionChange)!=null?a:function(){},(a=b.handlers.onOptimisticConnectionChange)!=null?a:function(){});this.gzipInflate=c;this.config=b;this.socketLoop=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"MainSocketLoop",code:W,timer:(a=b.socketReconnectBackoffAlgo)!=null?a:{jitter:.1,max:b.maxSocketLoopWaitTime,algo:{type:"fibonacci",first:1e4,second:1e4},relativeDelay:!0},resetDelay:3e4,isPauseEnabled:b.isPauseEnabled===!0})}var b=a.prototype;b.filterPending=function(a){var b=[];function c(c){a(c)&&b.push(c)}this.pendingIqs.forEach(c);this.ackHandlers.forEach(c);this.pendingSmaxStanzas.forEach(c);return b};b.sendPendingStanza=function(a){a.cleanup==null||a.cleanup(),a.cleanup=void 0,void this.callStanza(a.stanza)};b.maybeSendPendingStanza=function(a){if(a.attempt>=this.config.maxRetries){var b,c;(b=(c=this.config.handlers).onDropStanza)==null||b.call(c,a);a.cleanup==null||a.cleanup();a.cleanup=void 0;this.removeHandler(a,"max-retries")}else if(this.socket){a.attempt+=1;this.sendPendingStanza(a);return}else d("WALogger").LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will resend stanza when socket opens"])))};b.callStanzaAsync=async function(a,b){a=await this.callStanza(a,b);return a};b.callStanza=function(a,b){a=this.castStanza(a,b);this.deadSocketTimer.onOrBefore(this.config.deadSocketTime,this.socketId);this.healthCheckTimer.cancel();return a};b.castStanzaAsync=async function(a){a=await this.castStanza(a);return a};b.castStanza=function(a,b){var c=this;try{var e,f;e=(e=(f=this.config.handlers).onBeforeCastStanzaForE2E)==null?void 0:e.call(f,a,b);if(e!=null){d("WALogger").DEV_XMPP(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched:\n",". We return mock response directly."],["Dropping stanza since onBeforeCastStanza matched:\\n",". We return mock response directly."])),a);d("WALogger").DEV_XMPP(p||(p=babelHelpers.taggedTemplateLiteralLoose(["--- Receive (via SMAX+E2E) ---\n",""],["--- Receive (via SMAX+E2E) ---\\n",""])),e);d("WALogger").ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Dropping stanza since onBeforeCastStanza matched. We return mock response directly."])));if(Array.isArray(e))return Promise.all(e.map(function(a){return Promise.resolve(c.handleStanza(a,c.socketId,R))}));else{this.handleStanza(e,this.socketId,R);return Promise.resolve()}}}catch(a){d("WALogger").DEV_XMPP(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Error in onBeforeCastStanza, we consumed and continue with normal stanza sending to the server:\n",""],["Error in onBeforeCastStanza, we consumed and continue with normal stanza sending to the server:\\n",""])),a)}f=this.socketOrThrow("castStanza");try{d("WALogger").DEV_XMPP(s||(s=babelHelpers.taggedTemplateLiteralLoose(["--- Sending ---\n",""],["--- Sending ---\\n",""])),a);return f.sendFrame(d("WAWap").encodeStanza(a)).then(function(){c.config.handlers.onCastStanza==null||c.config.handlers.onCastStanza(a,b)}).catch(function(a){d("WALogger").ERROR(t||(t=babelHelpers.taggedTemplateLiteralLoose(["castStanza async error ",""])),a).devConsole(a);if(a instanceof d("WAErrors").BufferTooLargeError)return Promise.reject(a)})}catch(a){d("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["castStanza error ",""])),a).devConsole(a)}return Promise.resolve()};b.socketOrThrow=function(a){var b=this.socket;if(b)return b;throw c("err")("Comms."+a+" called while no socket")};b.startHandlingRequests=function(){d("WALogger").LOG(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Comms.startHandlingRequests"])));this.$2.resolve();return this.$2.promise.then(function(){})};b.parseAndHandleStanza=function(a,b){var c=this;a===this.socketId&&(this.deadSocketTimer.cancel(),P&&(P.resolve(),P=null));var e=d("WAWap").decodeStanza(b,this.gzipInflate).catch(function(a){d("WALogger").ERROR(w||(w=babelHelpers.taggedTemplateLiteralLoose(["Failure parsing stanza!"]))).devConsole(b);throw a}).then(function(e){d("WALogger").DEV_XMPP(x||(x=babelHelpers.taggedTemplateLiteralLoose(["--- Receiving ---\n",""],["--- Receiving ---\\n",""])),e);c.config.handlers.onHandleStanza==null||c.config.handlers.onHandleStanza(e,a,b.byteLength);var f=c.activePing;if(f&&f.socketId===a&&f.stanzaId===$(e)){c.activePing=null;f.handler.resolve(e);c.maybeScheduleHealthCheck();return"NO_ACK"}return c.handleStanza(e,a,b.byteLength)}).then(function(b){if(a!==c.socketId)return;if(b==="CLOSE_SOCKET"){d("WALogger").LOG(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[comms] job response is CLOSE_SOCKET"])));var e=c.socket;e&&e.close()}else b==="NO_ACK"||void c.castStanza(b);return"NO_ACK"});this.$3.add(e);e.finally(function(){return void c.$3.delete(e)})};b.handleAck=function(a){var b=this.ackHandlers,c=-1,e=null;while(!e&&++c<b.length)e=b[c].parseAndTest(a);if(e){var f=b[c];d("WAArrayUtils").removeIndexWithoutPreservingOrder(b,c);(c=(b=this.config.handlers).onHandleAck)==null||c.call(b,a);f.resolve(e);this.maybeScheduleHealthCheck()}else d("WALogger").WARN(z||(z=babelHelpers.taggedTemplateLiteralLoose(["handleAck: unrecognized ",""])),a)};b.removeHandler=function(a,b){b===void 0&&(b="disconnect");if(a.type==="iq"||a.type==="smax"){var c=a.stanza.attrs.id;if(!c||typeof c!=="string")return;if(a.type==="iq"&&!this.pendingIqs.delete(c)||a.type==="smax"&&!this.pendingSmaxStanzas.delete(c))return}else{a.type;c=this.ackHandlers.indexOf(a);if(c===-1)return;d("WAArrayUtils").removeIndexWithoutPreservingOrder(this.ackHandlers,c)}b==="disconnect"?a.resolve(Promise.reject(new(d("WAErrors").Disconnected)())):b==="abort"?a.resolve(Promise.reject(new(d("WAErrors").Aborted)())):a.resolve(Promise.reject(new(d("WAErrors").MaxRetries)()))};b.maybeScheduleHealthCheck=function(){if(this.healthCheckTimer.isScheduled())return;if(this.activePing||this.ackHandlers.length||this.pendingIqs.size||this.pendingSmaxStanzas.size)return;var a=this.config.healthCheckInterval;a=Math.ceil(a*1e3*(1+Math.random()));this.healthCheckTimer.onOrBefore(a)};return a}();function a(){return O}function b(a,b,c,d){d===void 0&&(d=!0);if(O)return;O=new S(a,b,c);d&&setTimeout(U,0)}function e(){var a=Z("stopComms");a.socketLoop.endWithValue();a.socket&&X();O=null}function f(){var a=Z("closeSocketAndPreventRetry");a.socketLoop.endWithValue();a.socket&&(d("WALogger").LOG(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocketAndPreventRetry called"]))),X())}function T(){var a=Z("closeSocketAndPause");a.socketLoop.pauseOnNextIteration();a.socket&&(d("WALogger").LOG(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocketAndPause called"]))),X())}function aa(){var a=Z("closeSocketAndResume");a.socketLoop.unpause();a.socket&&(d("WALogger").LOG(C||(C=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocketAndResume called"]))),X())}function U(){Z("openSocketLoop").socketLoop.start()}function ba(){d("WALogger").LOG(D||(D=babelHelpers.taggedTemplateLiteralLoose(["[comms] maybeResetSocketLoop"]))),V()||Z("maybeResetSocketLoop").socketLoop.reset()}function ca(){Z("forceResetSocketLoop").socketLoop.reset()}function da(){var a,b=Z("socketAbortController");(a=b.socketAbortController)==null||a.abort();b.softCloseSocket==null||b.softCloseSocket()}function V(){var a;return!!((a=O)!=null&&a.socket)}function W(){var a=Z("socketLoopIteration"),b=a.nextSocketId++;d("WALogger").LOG(E||(E=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," opening"])),b);var c=function(){a.onConnectionChange("in_handshake")};a.config.handlers.onSocketLoopIteration==null||a.config.handlers.onSocketLoopIteration(a.socketAbortController);typeof AbortController==="function"&&(a.socketAbortController=new AbortController());return a.config.openChatSocket(c,(c=a.socketAbortController)==null?void 0:c.signal).then(function(c){if(c.success){var e=c.value;a.config.handlers.onSocketOpen==null||a.config.handlers.onSocketOpen();var f=new(d("WAResolvable").Resolvable)();d("WALogger").LOG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," opened"])),b);a.socketId=b;a.socket=e;a.softCloseSocket=function(){a.softCloseSocket=null,a.socket&&a.config.shouldCloseStaleSocket&&(X(),a.socket=null),f.resolve()};a.socketLoop.resetTimeoutAfter(1e4);a.deadSocketTimer.cancel();a.maybeScheduleHealthCheck();e.setOnFrame(function(c){return a.parseAndHandleStanza(b,c)});e.setOnClose(function(){d("WALogger").LOG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," closed"])),b);a.activePing&&b===a.activePing.socketId&&(a.activePing.handler.resolve(),a.activePing=null);a.filterPending(function(a){return a.attachedToSocketId===b}).forEach(function(b){return void a.removeHandler(b)});if(b!==a.socketId)return;a.socketId=R;a.socket=null;a.onConnectionChange("disconnected");a.config.handlers.onDisconnect==null||a.config.handlers.onDisconnect();f.resolve()});a.onConnectionChange("connected");a.config.handlers.onConnect==null||a.config.handlers.onConnect();a.filterPending(function(a){return!a.attachedToSocketId}).sort(function(a,b){return a.orderedId-b.orderedId}).forEach(function(b){switch(b.type){case"smax":case"iq":a.maybeSendPendingStanza(b);break;case"ack":void a.callStanza(b.stanza);break;default:b.type;break}});return f.promise}else{e=c.error;switch(e){case"max-hunters":d("WALogger").WARN(H||(H=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration socket closed while in noise handshake using treasureHunt strategy"])));break;case"disconnected":d("WALogger").WARN(I||(I=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration socket disconnected while in noise handshake"])));break;default:e;return}}}).catch(function(a){a instanceof d("WAErrors").Disconnected?d("WALogger").LOG(J||(J=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration socket closed while in noise handshake"]))):d("WALogger").ERROR(K||(K=babelHelpers.taggedTemplateLiteralLoose(["[comms] socketLoopIteration failed ",""])),a).devConsole(a)})}function X(){var a=Z("closeSocket");a.socket&&(d("WALogger").LOG(L||(L=babelHelpers.taggedTemplateLiteralLoose(["[comms] Socket "," closed"])),a.socketId),d("WALogger").LOG(M||(M=babelHelpers.taggedTemplateLiteralLoose(["[comms] closeSocket called"]))),a.socket.close())}function ea(){Z("onStreamErrorReceived").socketLoop.cancelReset()}function fa(){void Z("waitForConnection").sendPing();P||(P=new(d("WAResolvable").Resolvable)());return P.promise}function ga(a,b){var c=Z("castStanza");c.socket?void c.castStanza(a,b):d("WALogger").LOG(N||(N=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket"])))}function ha(a){var b=Z("castStanza");return b.socketId===a}function Y(a,b,e,f,g){e===void 0&&(e=0);g===void 0&&(g="iq");return new Promise(function(h){var i=Z("sendIq"),j=a.attrs.id;if(!j||typeof j!=="string")throw c("err")("[comms] sendIq given iq without id: "+String(a));var k=i.socketId;if(b&&!k){h(Promise.reject(new(d("WAErrors").Offline)()));return}var l=function(a){a===void 0&&(a="disconnect");var b=g==="iq"?i.pendingIqs.get(j):i.pendingSmaxStanzas.get(j);if(!b){h(Promise.reject(c("err")("[comms] _sendIq unexisting stanza to be cancelled: "+j)));return}i.removeHandler(b,a)},m=null;if(e>0){var n=setTimeout(l,e*1e3);m=function(){clearTimeout(n)}}if(f!=null)if(f.aborted){h(Promise.reject(new(d("WAErrors").Disconnected)()));return}else{var o=function(){l("abort")};f.addEventListener("abort",o);m=function(){f.removeEventListener("abort",o)}}k={resolve:h,stanza:a,attachedToSocketId:b?k:R,orderedId:Q++,attempt:0,cleanup:m};if(g==="iq"){m=babelHelpers.extends({type:g},k);i.pendingIqs.set(j,m);i.config.handlers.onSendIq==null||i.config.handlers.onSendIq(a);i.maybeSendPendingStanza(m)}else{g;m=babelHelpers.extends({type:g},k);i.pendingSmaxStanzas.set(j,m);i.maybeSendPendingStanza(m)}})}function ia(a,b){var c,d;c=(c=b==null?void 0:b.withoutRetry)!=null?c:!1;d=(d=b==null?void 0:b.timeoutSeconds)!=null?d:0;b=(b=b==null?void 0:b.signal)!=null?b:null;return Y(a,c,d,b,"smax")}function ja(){var a=Z("sendPing");return a.sendPing()}function ka(){return Z("startHandlingRequests").startHandlingRequests()}function la(){O&&O.deadSocketTimer.cancel()}function Z(a){if(O)return O;throw c("err")("[comms] "+a+" called before startComms")}function $(a){if(a.tag==="iq"){var b=a.attrs.type;if(b==="result"||b==="error")return d("WAWap").decodeAsString(a.attrs.id)||null}return null}function ma(){return Q++}function na(){O=null,P=new(d("WAResolvable").Resolvable)(),Q=1}g.DEFAULT_SOCKET_ID=R;g.getComms=a;g.startComms=b;g.stopComms=e;g.closeSocketAndPreventRetry=f;g.closeSocketAndPause=T;g.closeSocketAndResume=aa;g.openSocketLoop=U;g.maybeResetSocketLoop=ba;g.forceResetSocketLoop=ca;g.forceAbortSocketConnection=da;g.isSocketConnected=V;g.socketLoopIteration=W;g.closeSocket=X;g.onStreamErrorReceived=ea;g.waitForConnection=fa;g.castSmaxStanza=ga;g.isActiveSocket=ha;g._sendIq=Y;g.sendSmaxStanza=ia;g.sendPing=ja;g.startHandlingRequests=ka;g.cancelDeadSocketTimer=la;g.singletonOrThrowIfUninitialized=Z;g.getAndIncrementNextOrderedId=ma;g.resetStateForTests=na}),98);
__d("WADecimalStringMod",["WALogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){if(!/^\d+$/.test(a)){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(['"','" is not a valid decimal string'])),a);throw c("err")("decimalStringMod is given an invalid decimal string")}var e=a.length;if(e<16||e===16&&a<="9007199254740991")return Number(a)%b;if(e>20||e===20&&a>"18446744073709551615"){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(['"','" is over 64 bits'])),a);throw c("err")("decimalStringMod is given value over 64 bits")}e=0;for(var f=0;f<a.length;f++){var g=Number(a[f]);e=(e*10+g)%b}return e}g.decimalStringMod=a}),98);
__d("WACreateGetVcaEnabledBucket",["WAArrayBufferUtils","WADecimalStringMod","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return function(){return b==null?null:d("WAArrayBufferUtils").arrayBufferMod(a,b)+100}}function b(a,b){return function(){if(b==null)return null;var c=a.split("/");c=c[c.length-1];c=c.split("_")[1];if(!/^\d+$/.test(c))return null;if(c==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["mediaRouteSelection: can't get fbId from mediaDirectPath"])));return null}else return d("WADecimalStringMod").decimalStringMod(c,b)+100}}g.createGetVcaEnabledBucket=a;g.msgrCreateGetVcaEnabledBucket=b}),98);
__d("WAExtractNcHotTimestamp",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(a==null)return null;a=h(a);if(a.has("_nc_hot")){a=parseInt(a.get("_nc_hot"),10);return Number.isInteger(a)?d("WATimeUtils").castToUnixTime(a):null}else return null}function h(a){a=a.split("?");return new URLSearchParams(a.length===2?a[1]:"")}g.extractNcHotTimestamp=a}),98);
__d("WAParsableWapNode",["WABinary","WAJids","WALogger","WALongInt","WAParsableXmlNode","WASignalKeys","WATimeUtils","WAWap","WAWapJid","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){function b(b,c){var d;d=a.call(this,"XmppParsingFailure: "+b+": "+c)||this;d.name="XmppParsingFailure";d.parser=b;d.reason=c;return d}babelHelpers.inheritsLoose(b,a);var c=b.prototype;c.toString=function(){return"XmppParsingFailure: "+this.parser+": "+this.reason};return b}(babelHelpers.wrapNativeSuper(Error));a=function(a){function b(b,c){return a.call(this,b,c)||this}babelHelpers.inheritsLoose(b,a);var e=b.prototype;e.assertFromServer=function(){var a=this.attrString("from");a!==d("WAJids").WA_SERVER_JID_SUFFIX&&this["throw"]('to have "from"="s.whatsapp.net", but instead has "'+a+'"')};e.attrUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.botJid!=null)return c.botJid;else if(c.userJid==null)return this["throw"]('to have "'+a+'"={UserJid}, but instead has "'+b+'"');return c.userJid};e.attrPhoneUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="phoneUser"?c.userJid:this["throw"]('to have "'+a+'"={PhoneUserJid}, but instead has "'+b+'"')};e.attrLidUserJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="lidUser"?c.userJid:this["throw"]('to have "'+a+'"={LidUserJid}, but instead has "'+b+'"')};e.maybeAttrUserJid=function(a){return this.hasAttr(a)?this.attrUserJid(a):null};e.maybeAttrPhoneUserJid=function(a){return this.hasAttr(a)?this.attrPhoneUserJid(a):null};e.maybeAttrLidUserJid=function(a){return this.hasAttr(a)?this.attrLidUserJid(a):null};e.attrGroupJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.groupJid==null?this["throw"]('to have "'+a+'"={GroupJid}, but instead has "'+b+'"'):c.groupJid};e.maybeAttrGroupJid=function(a){return this.hasAttr(a)?this.attrGroupJid(a):null};e.attrChatJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.userJid!=null)return c.userJid;return c.groupJid!=null?c.groupJid:this["throw"]('to have "'+a+'"={ChatJid}, but instead has "'+b+'"')};e.attrPhoneChatJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="phoneUser")return c.userJid;else if(c.jidType==="group")return c.groupJid;else return this["throw"]('to have "'+a+'"={ChatJid}, but instead has "'+b+'"')};e.attrDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.deviceJid!=null)return c.deviceJid;if(c.userJid!=null)return d("WAJids").defaultDeviceJidForUser(c.userJid);if(c.hostedDeviceJid!=null)return c.hostedDeviceJid;if(c.hostedLidDeviceJid!=null)return c.hostedLidDeviceJid;return c.botJid!=null?c.botJid:this["throw"]('to have "'+a+'"={DeviceJid}, but instead has "'+b+'"')};e.attrPhoneDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="phoneDevice")return c.deviceJid;return c.jidType==="phoneUser"?d("WAJids").defaultPhoneDeviceJidForUser(c.userJid):this["throw"]('to have "'+a+'"={PhoneDeviceJid}, but instead has "'+b+'"')};e.attrLidDeviceJid=function(a){var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);if(c.jidType==="lidDevice")return c.deviceJid;return c.jidType==="lidUser"?d("WAJids").defaultLidDeviceJidForLidUserJid(c.userJid):this["throw"]('to have "'+a+'"={LidDeviceJid}, but instead has "'+b+'"')};e.attrDeviceId=function(a){a=this.attrInt(a);return d("WAJids").interpretAsDeviceId(a)};e.attrFromJidChat=function(){var a=this.attrJidWithType();switch(a.jidType){case"msgrUser":var b=a.userJid,e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"interopUser":b=a.userJid;e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneUser":b=a.userJid;e=d("WAJids").defaultDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"lidUser":b=a.userJid;e=d("WAJids").defaultLidDeviceJidForLidUserJid(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"msgrDevice":e=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"interopDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"lidDevice":e=a.deviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"group":b=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return b==null?this["throw"]("expected to have participant JID for group"):{type:"group",chat:a.groupJid,groupJid:a.groupJid,author:b};case"broadcast":e=this.hasAttr("participant")?this.attrDeviceJid("participant"):null;return e==null?this["throw"]("expected to have participant JID for group"):{type:"broadcast",broadcastJid:a.broadcastJid,chat:d("WAJids").extractUserJid(e),author:e};case"hosted":b=a.hostedDeviceJid;return{type:"device",chat:d("WAJids").extractUserJid(b),deviceJid:b,author:b};case"hostedLid":e=a.hostedLidDeviceJid;return{type:"device",chat:d("WAJids").extractUserJid(e),deviceJid:e,author:e};case"call":d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""])),a.callJid);throw c("err")("ParsableWapNode: attrFromJid() does not support CallJid");default:a.jidType;return this["throw"]("attrFromJidChat should not be used with jid of type "+a.jidType)}};e.attrFromJidPhoneChat=function(){var a=this.attrJidWithType();switch(a.jidType){case"phoneUser":var b=a.userJid,e=d("WAJids").defaultPhoneDeviceJidForUser(b);return{type:"device",chat:b,deviceJid:e,author:e};case"phoneDevice":b=a.deviceJid;return{type:"device",chat:d("WAJids").extractPhoneUserJid(b),deviceJid:b,author:b};case"group":e=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return e==null?this["throw"]("expected to have participant JID for group"):{type:"group",chat:a.groupJid,groupJid:a.groupJid,author:e};case"broadcast":b=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return b==null?this["throw"]("expected to have participant JID for group"):{type:"broadcast",broadcastJid:a.broadcastJid,chat:d("WAJids").extractPhoneUserJid(b),author:b};case"call":d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["ParsableWapNode: attrFromJid() is called with ",""])),a.callJid);throw c("err")("ParsableWapNode: attrFromJid() does not support CallJid");default:a.jidType;return this["throw"]("attrFromJidChat should not be used with jid of type "+a.jidType)}};e.attrFromPhoneJid=function(){var a=this.attrJidWithType();if(a.jidType==="status"){a=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return a==null?this["throw"]("to have participant for status msg"):{type:"status",author:a}}else return this.attrFromJidPhoneChat()};e.attrFromJid=function(){var a=this.attrJidWithType();if(a.jidType==="status"){var b=this.hasAttr("participant")?this.attrPhoneDeviceJid("participant"):null;return b==null?this["throw"]("to have participant for status msg"):{type:"status",author:b}}if(a.jidType==="newsletter")return{type:"newsletter",newsletterJid:a.newsletterJid};if(a.jidType==="hosted")return{type:"hosted",hostedDeviceJid:a.hostedDeviceJid};return a.jidType==="hostedLid"?{type:"hostedLid",hostedLidDeviceJid:a.hostedLidDeviceJid}:this.attrFromJidChat()};e.attrJidWithType=function(a){a===void 0&&(a="from");var b=this.attrString(a),c=d("WAJids").interpretAndValidateJid(b);return c.jidType==="unknown"?this["throw"]('to have "'+a+'"={Jid}, but instead has "'+b+'"'):c};e.attrWapJid=function(a){a===void 0&&(a="from");a=this.attrString(a);var b=d("WAJids").interpretAndValidateJid(a);return b.jidType==="unknown"?d("WAWapJid").WapJid.create(null,a):d("WAWap").JID(d("WAJids").extractFromJid(b))};e.attrLongInt=function(a){a=this.attrString(a);return d("WALongInt").decimalStringToLongInt(a)};e.attrTime=function(a){return d("WATimeUtils").castToUnixTime(this.attrInt(a))};e.attrFutureTime=function(a){a=this.attrInt(a);return d("WATimeUtils").futureUnixTime(a)};e.contentString=function(){if(this.hasChildren())return this["throw"]("to have string content, but has children instead");else if(this.hasContent()){var a=new(d("WABinary").Binary)(this.contentBytes());return a.readString(a.size())}else return this["throw"]("to have content")};e.decodeAsString=function(a){return d("WAWap").decodeAsString(a)};e.contentSerializedPubKey=function(){if(this.hasContent())return d("WASignalKeys").serializeIdentity(this.contentBytes());else return this["throw"]("to have content")};e.createParseError=function(a){return new j(this.name(),"expected <"+this.tag()+"> "+a)};e["throw"]=function(a){throw this.createParseError(a)};return b}(d("WAParsableXmlNode").ParsableXmlNode);g.XmppParsingFailure=j;g.ParsableWapNode=a}),98);
__d("WADeprecatedWapParser",["WAParsableWapNode","err"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.parse=function(a){a=new(d("WAParsableWapNode").ParsableWapNode)(this.$1,a);try{return{success:this.$2(a)}}catch(a){if(a instanceof d("WAParsableWapNode").XmppParsingFailure)return{error:a};else throw a}};b.parseOrThrow=function(a){a=this.parse(a);if(a.error)throw c("err")(String(a.error));return a.success};return a}();g["default"]=a}),98);
__d("WAAckParser",["WADeprecatedWapParser","WAJids"],(function(a,b,c,d,e,f,g){"use strict";b=new(c("WADeprecatedWapParser"))("ack",function(a){a.assertTag("ack");return{id:a.attrString("id"),ts:a.maybeAttrString("t"),"class":a.attrString("class"),type:a.maybeAttrString("type"),from:a.attrJidWithType(),participant:a.hasAttr("participant")?a.attrDeviceJid("participant"):null,recipient:a.hasAttr("recipient")?a.attrUserJid("recipient"):null}});function a(a,b){return a.id===b.id&&(b["class"]===void 0||a["class"]===b["class"])&&(b.type===void 0||a.type===b.type)&&(b.from===void 0||h(a.from,b.from))&&(b.participant===void 0||a.participant===b.participant)&&(b.recipient===void 0||a.recipient===b.recipient)&&(b.ts===void 0||a.ts===b.ts)}function h(a,b){if(d("WAJids").extractFromJid(a)===b)return!0;if(a.userJid!=null)return d("WAJids").defaultDeviceJidForUser(a.userJid)===b;if(a.deviceJid!=null){a=a.deviceJid;return d("WAJids").extractDeviceId(a)===0&&d("WAJids").extractUserJid(a)===b}return!1}g.AckParser=b;g.ackMatchesTemplate=a;g.fromJidsAreEqual=h}),98);
__d("WAParseIqResponse",["WAWap"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){var e=a.content;if(e&&Array.isArray(e)&&e[0]){e=e[0];if(e.tag==="error"){var f=e.attrs||{},g;c&&(typeof c==="function"?g=c(a):g=c.parseOrThrow(e));c=g;return{success:!1,errorCode:parseInt(f.code,10),errorText:d("WAWap").decodeAsString(f.text)||"",errorType:d("WAWap").decodeAsString(f.type)||"",errorBackoff:parseInt(f.backoff,10),toString:h,customError:c}}}if(typeof b==="function")return{success:!0,result:b(a)};else return{success:!0,result:b.parseOrThrow(a)}}function h(){return"IqError "+this.errorCode+": "+this.errorText}g.parseIqResponse=a}),98);
__d("WADeprecatedSendIq",["Promise","WAAckParser","WAArrayUtils","WAComms","WALogger","WAParseIqResponse"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){return d("WAComms")._sendIq(a,!1).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function c(a,b,c){return d("WAComms")._sendIq(a,!1).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b,c)})}function e(a,b,c){return d("WAComms")._sendIq(a,!1,c).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function f(a,b){return d("WAComms")._sendIq(a,!0).then(function(a){return d("WAParseIqResponse").parseIqResponse(a,b)})}function j(a,b){return k(a,b).then(function(){})}function k(a,c){return new(i||(i=b("Promise")))(function(e){var f=d("WAComms").singletonOrThrowIfUninitialized("deprecatedSendStanzaAndReturnAck"),g=function(a){var b=d("WAAckParser").AckParser.parse(a);return!b.error&&d("WAAckParser").ackMatchesTemplate(b.success,c)?a:null},j={type:"ack",parseAndTest:g,resolve:e,stanza:a,attachedToSocketId:d("WAComms").DEFAULT_SOCKET_ID,orderedId:d("WAComms").getAndIncrementNextOrderedId()};f.ackHandlers.push(j);if(!f.socket){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Comms has no open socket, will send stanza when socket opens"])));return}f.callStanza(a)["catch"](function(a){var c=f.ackHandlers.indexOf(j);if(c===-1)return;d("WAArrayUtils").removeIndexWithoutPreservingOrder(f.ackHandlers,c);j.resolve((i||(i=b("Promise"))).reject(a))})})}function l(a,b){d("WAComms").castSmaxStanza(a,b)}g.deprecatedSendIq=a;g.deprecatedSendIqErrorParser=c;g.deprecatedSendIqIfConnectedWithin=e;g.deprecatedSendIqWithoutRetry=f;g.deprecatedSendStanzaAndWaitForAck=j;g.deprecatedSendStanzaAndReturnAck=k;g.deprecatedCastStanza=l}),98);
__d("WAMediaConnParser",["WADeprecatedWapParser","WAServerMediaType"],(function(a,b,c,d,e,f,g){"use strict";a=new(c("WADeprecatedWapParser"))("mediaConnParser",function(a){a=a.child("media_conn");var b=j(a);return{hosts:b,authToken:a.attrString("auth"),authTokenExpiryTs:a.attrFutureTime("auth_ttl"),routesExpiryTs:a.attrFutureTime("ttl"),maxBuckets:a.attrInt("max_buckets"),maxManualRetry:(b=a.maybeAttrInt("max_manual_retry",0,4))!=null?b:3,maxAutoDownloadRetry:(b=a.maybeAttrInt("max_auto_download_retry",0,4))!=null?b:3}});function h(a){var b;return!a.hasAttr("fallback_hostname")?void 0:{domain:a.attrString("fallback_hostname"),"class":a.maybeAttrString("fallback_class"),ip4:(b=a.maybeAttrString("fallback_ip4"))!=null?b:void 0,ip6:(b=a.maybeAttrString("fallback_ip6"))!=null?b:void 0}}function i(a){var b;return{domain:a.attrString("hostname"),fallback:h(a),uploadable:k(a,"upload"),downloadable:k(a,"download"),isFallback:a.maybeAttrString("type")==="fallback",downloadBuckets:(b=(b=a.maybeChild("download_buckets"))==null?void 0:b.mapChildren(function(a){return parseInt(a.tag(),10)}))!=null?b:[],"class":a.maybeAttrString("class"),ip4:(b=a.maybeAttrString("ip4"))!=null?b:void 0,ip6:(b=a.maybeAttrString("ip6"))!=null?b:void 0}}function j(a){return a.mapChildrenWithTag("host",i)}function k(a,b){if(a.hasChild(b))return a.child(b).mapChildren(function(a){a=a.tag();return d("WAServerMediaType").castToServerMediaType(a)}).filter(Boolean);else return d("WAServerMediaType").SERVER_MEDIA}g.mediaConnParser=a}),98);
__d("WAGatherMediaInfo",["WADeprecatedSendIq","WAErrors","WALogger","WAMediaConnParser","WAPromiseManagement","WAPromiseRetryLoop","WAResultOrError","WAWap"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=507;b=d("WAPromiseManagement").cacheWhilePending(function(){return"gatherMediaInfo"},a);function a(){var a=new(d("WAPromiseRetryLoop").PromiseRetryLoop)({name:"gatherMediaInfo",timer:{jitter:.25,max:987e3,algo:{type:"fibonacci",first:6e3,second:12e3},relativeDelay:!0},code:o});a.start();return a.promise()}var n=60;function o(a){var b;b=(b=d("WAWap")).wap("iq",{id:b.generateId(),to:b.S_WHATSAPP_NET,type:"set",xmlns:"w:m"},b.wap("media_conn",null));return d("WADeprecatedSendIq").deprecatedSendIqIfConnectedWithin(b,d("WAMediaConnParser").mediaConnParser,n).then(function(b){if(!b.success){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo failure ",""])),b);if(b.errorCode===m){var c=b.errorBackoff;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," seconds backoff"])),c);a(d("WAResultOrError").makeError({type:"backoff",backoffMs:c*1e3}))}else b.errorCode<500&&(d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got client error: ",""])),b.errorCode),a(d("WAResultOrError").makeError({type:"client-error",code:b.errorCode,text:b.errorText})))}else d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo got "," hosts"])),b.result.hosts.length),a(d("WAResultOrError").makeResult(b.result))})["catch"](function(b){b instanceof d("WAErrors").Disconnected?a(d("WAResultOrError").makeError("disconnected")):d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["gatherMediaInfo error ",""])),b)})}g.gatherMediaInfo=b}),98);
__d("WAMediaRouteSelection",["WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=null,c=null,e=null,f=a.hosts,g=a.operation,h=a.mediaType;if(a.operation==="download"){var i=a.catHotTimespan,j=a.ncHot;a=a.getVcaEnabledBucket;var k=new Map();f.forEach(function(a){a.downloadBuckets.forEach(function(b){k.set(b,a)})});var l=k.get(0);i>0&&j!=null&&d("WATimeUtils").happenedWithin(d("WATimeUtils").castToUnixTime(j),i)?b=1:a&&(b=a());j=null;b!=null&&(j=k.get(b));(i=j)!=null&&i.downloadable.includes(h)?c=j:l!=null&&l.downloadable.includes(h)&&(c=l)}for(a=0;a<f.length;a++){i=f[a];g==="upload"&&i.uploadable.includes(h)?c==null?c=i:i.isFallback&&e==null&&(e=i):g==="download"&&i.downloadable.includes(h)&&(c==null?c=i:i.isFallback&&e==null&&(e=i));if(c!=null&&e!=null)break}return{selectedHost:c,fallbackHost:e,bucket:b}}g.mediaRouteSelection=a}),98);
__d("WAGetMediaRoute",["$InternalEnum","WACreateGetVcaEnabledBucket","WAExtractNcHotTimestamp","WAGatherMediaInfo","WAMediaRouteSelection","WAPromiseManagement","WAResultOrError","WATagsLogger","WATimeUtils","WAWaitForComms","WAWorkerGlobalScope"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p=d("WATagsLogger").TAGS(["GetMediaRoute"]),q=86400,r=b("$InternalEnum")({Fresh:"fresh",Cached:"cached",Stale:"stale"}),s=null,t=!1,u=null;async function a(a,b){b==null||b.addPoint("get_cached_or_fresh_media_access_start");var c=await y();b==null||b.addPoint("get_cached_or_fresh_media_access_end");if(!c.success){p.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to get mediaAccess: ",""])),c.error);b==null||b.addPoint("get_media_access_failed",{string:{mediaAccessStatus:c.error}});return c}b==null||b.addAnnotations({string:{mediaAccessStatus:c.value.state}});b=c.value.mediaAccess;c=b.authToken;var e=b.hosts;b=b.maxBuckets;e=a.operation==="upload"?d("WAMediaRouteSelection").mediaRouteSelection({operation:"upload",mediaType:a.serverMediaType,hosts:e}):d("WAMediaRouteSelection").mediaRouteSelection({operation:"download",mediaType:a.serverMediaType,hosts:e,catHotTimespan:q,ncHot:d("WAExtractNcHotTimestamp").extractNcHotTimestamp(a.directPath),getVcaEnabledBucket:d("WACreateGetVcaEnabledBucket").msgrCreateGetVcaEnabledBucket(a.directPath,b)});a=e.selectedHost;b=e.fallbackHost;e=e.bucket;if(a==null){p.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Error: no media host"])));return d("WAResultOrError").makeError("no-host")}return d("WAResultOrError").makeResult({authToken:c,selectedHost:a,fallbackHost:b,bucket:e})}function v(){var a=u;a!=null&&(d("WAWorkerGlobalScope").workerGlobalScope.clearTimeout(a),u=null)}function w(a){v();var b=Math.max(a.authTokenExpiryTs-d("WATimeUtils").unixTime(),0);if(b<=5*60)return;var c=d("WATimeUtils").pastUnixTime(5*60,a.authTokenExpiryTs);b=d("WATimeUtils").pastUnixTime(Math.floor(b*.2),a.authTokenExpiryTs);a=c<b?c:b;c=d("WATimeUtils").cappedMillisecondsUntil(a);b=Math.floor(Math.random()*d("WATimeUtils").MINUTE_MILLISECONDS);a=d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){p.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["AuthTTL approaching expiry, refreshing MediaAccess routes"]))),x().catch(function(a){p.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Error occurred during authTTL automatic refresh: ",""])),a)})},c+b);u=a}var x=d("WAPromiseManagement").cacheWhilePending(function(){return"all"},async function(){if(t){p.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, but we are still locked by backoff"])));return d("WAResultOrError").makeError("backoff")}await d("WAWaitForComms").waitForComms();p.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["mediaAccess has gone, gather a new one"])));v();var a=await d("WAGatherMediaInfo").gatherMediaInfo();if(a.success){s=a.value;w(a.value);return d("WAResultOrError").makeResult({mediaAccess:a.value,state:r.Fresh})}else{a=a.error;var b=a==="disconnected"?"disconnected":a.type;p.WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Can not get mediaAccess: ",""])),b);if(a==="disconnected"||a.type==="client-error")return d("WAResultOrError").makeError("disconnected");else{a.type;t=!0;d("WAWorkerGlobalScope").workerGlobalScope.setTimeout(function(){t=!1,x().catch(function(a){p.ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Error occurred on gather after backoff expiry: ",""])),a)})},a.backoffMs);return d("WAResultOrError").makeError("backoff")}}}),y=function(){var a=s;if(a==null)return x();if(d("WATimeUtils").isInFuture(a.routesExpiryTs))return Promise.resolve(d("WAResultOrError").makeResult({mediaAccess:a,state:r.Cached}));var b=x();return d("WATimeUtils").isInFuture(a.authTokenExpiryTs)?Promise.resolve(d("WAResultOrError").makeResult({mediaAccess:a,state:r.Stale})):b};function c(){s=null,t=!1,v()}g.getMediaRoute=a;g.getCachedOrFreshMediaAccess=y;g.clearCachedMediaAccessForTest=c}),98);
__d("WAMediaOperationsRetrier",["WALogger","WAPromiseBackoffs"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=4,k={algo:{type:"constant",delay:1e3},jitter:0};a=function(){function a(a,b,c){this.$1=a,this.routesInfo=b,this.$2=d("WAPromiseBackoffs").createPromiseTimer(k),this.$3=0,this.$4=!1,this.$5=c}var b=a.prototype;b.run=async function(a,b){while(this.$3<j){d("WALogger").DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Running retrier"])));await this.$2();var c=void 0;if(this.$3>0){var e;c=this.$3>=j-2&&!this.$4;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MediaOperationsRetrier:"," wait for internet, attempt = ",""])),this.$1,this.$3);await ((e=this.$5)==null?void 0:e.call(this))}else c=!1;e=this.routesInfo;if(!e)return null;var f=e.host;c&&e.fallbackHost&&(f=e.fallbackHost);c=await a(f,e.authToken,this.$3,b);if(c.success)return c.value;else++this.$3,this.$4=c.error.progressMade}return null};return a}();g.MAX_ATTEMPTS=j;g.BACKOFF_OPTIONS=k;g.MediaOperationsRetrier=a}),98);
__d("WACreateMediaDownloadRetrier",["WAComms","WAGetMediaRoute","WAMediaOperationsRetrier","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){var b=a.directPath,c=a.eventFlow,e=a.fileEncSha256;a=a.mediaTypeDetails;a=a.type==="regular"?a.mediaType:"preview";c==null||c.addPoint("get_media_route_start");a=await d("WAGetMediaRoute").getMediaRoute({operation:"download",serverMediaType:a,fileEncSha256:e,directPath:b},c);if(!a.success){c==null||c.addPoint("get_media_route_fail");return a}c==null||c.addPoint("get_media_route_end");e=a.value;b=e.selectedHost;c=e.fallbackHost;e=e.authToken;b=new(d("WAMediaOperationsRetrier").MediaOperationsRetrier)("download",{host:{domain:b.domain,class:b.class},fallbackHost:c&&{domain:c.domain,class:c.class},authToken:e,timeElapsed:null},d("WAComms").waitForConnection);return d("WAResultOrError").makeResult({retrier:b,mediaRouteDetails:a.value})}g.createMediaDownloadRetrier=a}),98);
__d("WAHttpDownloadMedia",["WAErrorMessage","WALogger","WAMediaQplHelper","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l="URL signature expired";async function a(a,b){b=b!=null?b:{};var c=b.mediaMetrics;b=b.abortSignal;c==null||c.addPoint("http_fetch_start");a=await self.fetch(a,{method:"GET",mode:"cors",cache:"no-store",signal:b}).then(function(a){c==null||c.addPoint("http_fetch_end");return d("WAResultOrError").makeResult(a)}).catch(function(a){var b=d("WAErrorMessage").maybeGetMessageFromError(a);c==null||c.addPoint("http_fetch_fail",{string:{httpFetchError:b}});d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to initiate fetch: ",", message: ",""])),a,b);return a.name==="AbortError"?d("WAResultOrError").makeError("http-fetch-aborted"):d("WAResultOrError").makeError("http-fetch-exception")});if(a.success===!1)return a;b=a.value;a=b.headers.get("content-length");var e=b.status;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""])),e);c==null||c.addAnnotations({string:{ciphertextMediaSizeBucket:a!=null?d("WAMediaQplHelper").convertIntegerSizeToStringBucket(Number(a)):null},int:{httpStatus:e}});switch(e){case 200:case 206:return d("WAResultOrError").makeResult(b);case 401:return d("WAResultOrError").makeError("access-expired");case 403:return b.text().then(function(a){return a===l?d("WAResultOrError").makeError("signature-expired"):d("WAResultOrError").makeError("access-expired")}).catch(function(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body: ",""])),a);return d("WAResultOrError").makeError("access-expired")});case 404:case 410:return d("WAResultOrError").makeError("media-not-found");case 408:return d("WAResultOrError").makeError("server-timeout");case 416:d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: can not resume from offset"])));return d("WAResultOrError").makeError("request-error");case 429:case 507:return d("WAResultOrError").makeError("download-throttled");default:return e>=400&&e<500?d("WAResultOrError").makeError("request-error"):d("WAResultOrError").makeError("unspecified-http-error")}}g.httpDownloadMedia=a}),98);
__d("WAHttpUtils",["err"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){if(!/^https:\/\/[-\w.]+\.\w+$/.test(a))throw c("err")('buildUrl given invalid host "'+a+'"');if(!b.startsWith("/"))throw c("err")('buildUrl given invalid path "'+b+'"');var e=d;d=""+a+b;if(!e)return d;a=Object.keys(e).map(function(a){var b=e[a];b instanceof ArrayBuffer&&(b=new Uint8Array(b));b=b instanceof Uint8Array?Array.prototype.slice.call(b).map(function(a){return"%"+a.toString(16)}).join(""):encodeURIComponent(b.toString());return encodeURIComponent(a)+"="+b});if(a.length>0){b=a.join("&");return d.includes("?")?d+"&"+b:d+"?"+b}else return d}g.buildUrl=a}),98);
__d("WAMediaUrl",["WABase64","WAGlobals","WAHttpUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=1;function a(a,b,c,e,f,g,i){var j=d("WAGlobals").getDependencies().mediaUploadRoot();c=d("WABase64").encodeB64UrlSafe(c);b=d("WABase64").encodeB64UrlSafe(b);f={auth:f,token:b};g&&(f.resume=h);i!=null&&i>0&&(f.bytestart=i);return d("WAHttpUtils").buildUrl("https://"+e,j+"/"+a+"/"+c,f)}function b(a,b,c,e,f,g,h){b=d("WABase64").encodeB64UrlSafe(b);b={hash:b,mode:e};f!=null&&(b._nc_cat=f);g!=null&&g>=0&&(b.bytestart=g);h!=null&&h>0&&(b.byteend=h);return d("WAHttpUtils").buildUrl("https://"+c,a,b)}g.RESUME_PARAM=h;g.buildUploadUrl=a;g.buildDownloadUrl=b}),98);
__d("WADownloadCiphertext",["WAAssertUnreachable","WABase64","WACreateMediaDownloadRetrier","WACryptoSha256","WACryptoUtils","WAHashUtils","WAHttpDownloadMedia","WALogger","WAMediaUrl","WAPromiseManagement","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n;async function a(a){var b=a.abortSignal,e=a.mediaTypeDetails,f=a.fileEncSha256,g=a.directPath,p=a.plaintextHash,q=a.eventFlow,r=a.fromBytes,s=a.toBytes;d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Start download ciphertext for hash: ",""])),d("WAHashUtils").sanitisePlaintextHash(p));q.addPoint("create_retrier_start");a=await d("WACreateMediaDownloadRetrier").createMediaDownloadRetrier({mediaTypeDetails:e,directPath:g,eventFlow:q,fileEncSha256:f});if(!a.success){q.addPoint("create_retrier_fail");return a}q.addPoint("create_retrier_end");e=a.value;a=e.retrier;var t=e.mediaRouteDetails;e=await a.run(function(a,c,e){c=a.domain;var h="http_download_media_"+e;a=d("WAMediaUrl").buildDownloadUrl(g,f,c,"manual",t.bucket,r,s);d("WALogger").DEV_XMPP(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Downloading ciphertext for hash : "," from ",". Attempt: ",""])),d("WAHashUtils").sanitisePlaintextHash(p),a,e);q.addPoint(h+"_start");return d("WAHttpDownloadMedia").httpDownloadMedia(a,{mediaMetrics:q,abortSignal:b,cachePolicy:e>0?"no-store":"force-cache"}).then(function(a){if(a.success)return a.value.arrayBuffer().then(function(a){q.addPoint(h+"_end");return d("WAResultOrError").makeResult(d("WAResultOrError").makeResult(a))}).catch(function(a){q.addPoint("response_array_buffer_error");q.addPoint(h+"_fail");d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["HttpDownloadMedia: fail to parse request body ",""])),a);return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("body-network-error"))});else{q.addPoint(h+"_fail");a=a.error;d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Download Media Error: ",""])),a);q.addPoint(a);switch(a){case"signature-expired":return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("signature-expired"));case"http-fetch-aborted":return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("http-fetch-aborted"));case"http-fetch-exception":case"server-timeout":case"unspecified-http-error":return d("WAResultOrError").makeError({progressMade:!0});default:return d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a))}}}).catch(function(a){q.addPoint(h+"_fail");d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["downloadCiphertext http download exception: ",""])),a);return d("WAResultOrError").makeError({progressMade:!1})})});if(e==null){d("WALogger").WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia given up"])));return d("WAResultOrError").makeError("max-attempts-exceeded")}if(e.success===!1){a=e.error;d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext failed: ",""])),a);switch(a){case"signature-expired":case"http-fetch-aborted":case"media-not-found":case"download-throttled":case"body-network-error":case"request-error":return d("WAResultOrError").makeError(a);case"access-expired":return d("WAResultOrError").makeError("disconnected");default:a;throw c("WAAssertUnreachable")(a)}}else{a=e.value;if(!o(r,s)&&!d("WACryptoUtils").arrayBuffersEqual(await d("WACryptoSha256").sha256(a),f))return d("WAResultOrError").makeError("ciphertext-hash-mismatch");q.addPoint("download_finish",{int:{byteLength:a.byteLength},bool:{isPartialDownload:o(r,s)}});return d("WAResultOrError").makeResult(a)}}b=d("WAPromiseManagement").cacheWhilePending(function(a){var b=a.fileEncSha256,c=a.fromBytes;a=a.toBytes;return d("WABase64").encodeB64UrlSafe(b)+"-"+(c!=null?c:"X")+"-"+(a!=null?a:"X")},a);function o(a,b){return a!=null&&a>0?!0:b!=null}g.cachedDownloadCiphertext=b}),98);
__d("WADownloadAndDecryptMedia",["WADecryptMedia","WADownloadCiphertext","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){var b=a.abortSignal,c=a.mediaTypeDetails,e=a.fileEncSha256,f=a.directPath,g=a.mediaKey,h=a.plaintextHash;a=a.eventFlow;b=await d("WADownloadCiphertext").cachedDownloadCiphertext({abortSignal:b,mediaTypeDetails:c,fileEncSha256:e,directPath:f,eventFlow:a,plaintextHash:h});if(b.success!==!0)return b;e=await d("WADecryptMedia").decryptMedia({mediaKey:g,mediaTypeDetails:c,plaintextHash:h,ciphertextHmac:b.value});if(e.success!==!0)return e;e.value.alternativeHmacSaltUsed!=null&&a.addAnnotations({string:{alternativeHmacSaltUsed:e.value.alternativeHmacSaltUsed}});return d("WAResultOrError").makeResult(e.value.plaintext)}g.downloadAndDecryptMedia=a}),98);
__d("WACreateMediaDecrypterStream",["WABinary","WAMediaCrypto","WAResultOrError","WATagsLogger","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o=d("WATagsLogger").TAGS(["WADecryptStream"]);function a(a,b,c,e,f){if(e.byteLength===0){o.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["expectedHmacs must have at least one element"])));return d("WAResultOrError").makeError("missing-expected-hmacs")}if(e.byteLength!==f.length*d("WAMediaCrypto").HMAC_LENGTH){o.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["expectedHmacs and ciphertextLengths must have the same length"])));return d("WAResultOrError").makeError("hmac-chiphertext-array-mismatch")}var g=p(e),m=b,n=new(d("WABinary").Binary)(),r=0,s=async function(b,e){n.writeByteArray(b);for(;r<g.length&&n.size()>=f[r];r++){b=n.readByteArrayView(f[r]);o.DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Processing scan "," of size ",""])),r,b.length);var h=r===f.length-1;try{b=await d("WAMediaCrypto").hmacAndDecryptPartial(a,m,b,c,g[r]);var i=b.plaintext;b=b.nextIv;h?void e.enqueue(q(i)):void e.enqueue(i);m=b}catch(a){o.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Unable to decrypt chunk. isLastChunk: "," error: ",""])),h,a),a instanceof d("WAMediaCrypto").HmacValidationError?e.error("enc-hash-mismatch"):e.error("decryption-error")}}};e=new TransformStream({transform:function(a,b){a=a;return s(a,b)},flush:function(a){n.size()>0&&o.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unexpected ciphertext in buffer following flush"])))}});return d("WAResultOrError").makeResult(e)}function p(a){var b=[];if(a.byteLength%d("WAMediaCrypto").HMAC_LENGTH!==0)throw c("err")("Sidecar length is not a multiple of hmac length");for(var e=0;e<a.byteLength;e+=d("WAMediaCrypto").HMAC_LENGTH){var f=new Uint8Array(a,e,d("WAMediaCrypto").HMAC_LENGTH);b.push(f)}return b}function q(a){if(a.length<d("WAMediaCrypto").CBC_BLOCK_SIZE){o.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Plaintext size is less than CBC_BLOCK_SIZE"])));return a}var b=a[a.length-1];if(b===0||b>d("WAMediaCrypto").CBC_BLOCK_SIZE){o.ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Invalid PKCS padding length"])));return a}return a.subarray(0,-b)}g.createDefaultDecryptStream=a}),98);
__d("WAMediaProgressiveJpegTransformStream",["WABinary"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.scanLengths,c=[];a=0;for(var e of b)a+=e,c.push(a);var f=new(d("WABinary").Binary)(),g=0,h=0;e=new TransformStream({transform:function(a,d){a=a;h+=a.byteLength;f.writeByteArray(a);for(;g<b.length&&c[g]<h;g++){a=f.readByteArrayView(b[g]);void d.enqueue(a)}},flush:function(a){void a.enqueue(f.readByteArrayView())}});return e}g.makeProgressiveJpegHandlerTransformStream=a}),98);
__d("WADownloadProgressiveJpegPlaintextStreamerWithoutRetry",["WACreateMediaDecrypterStream","WAHttpDownloadMedia","WAMediaCrypto","WAMediaProgressiveJpegTransformStream","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WATagsLogger").TAGS(["WADownloadProgressiveJpegPlaintextStreamer"]);function a(a){return a}async function b(a){var b=a.abortSignal,c=a.serverMediaType,e=a.downloadUrl,f=a.eventFlow,g=a.progressiveJpegDetails,k=a.mediaKey;a=a.cachePolicy;e=await d("WAHttpDownloadMedia").httpDownloadMedia(e,{mediaMetrics:f,abortSignal:b,cachePolicy:a});if(e.success!==!0)return e;f=e.value.body;if(f==null)return d("WAResultOrError").makeError("body-network-error");b=e.value.headers.get("Content-Length");if(b==null){j.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Content-Length header is missing"])));return d("WAResultOrError").makeError("missing-content-length-header")}a=Number(b);if(Number.isNaN(a)){j.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Content-Length header is not a number"])));return d("WAResultOrError").makeError("invalid-content-length-header")}e=d("WAProgressiveJpegGetPJpegDetails").getExtendedProgressiveJpegDetails({progressiveJpegDetails:g,ciphertextLength:a});b=await d("WAMediaCrypto").computeMediaKeys(k,c);g=d("WACreateMediaDecrypterStream").createDefaultDecryptStream(b.cipherKey,b.iv,b.hmacKey,e.sidecar,e.alignedScanLengths);if(g.success!==!0)return g;a=g.value;k=d("WAMediaProgressiveJpegTransformStream").makeProgressiveJpegHandlerTransformStream(e);c=f.pipeThrough(a).pipeThrough(k);return d("WAResultOrError").makeResult(c)}g.unsafeCastToDownloadAndDecryptPJpegStream=a;g.downloadProgressiveJpegPlaintextUsingStreamsWithoutRetry=b}),98);
__d("WADownloadProgressiveJpegPlaintextStreamer",["WAAssertUnreachable","WACreateMediaDownloadRetrier","WADownloadProgressiveJpegPlaintextStreamerWithoutRetry","WAMediaUrl","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("WATagsLogger").TAGS(["WADownloadProgressiveJpegPlaintextStreamer"]);async function a(a){var b=a.abortSignal,e=a.serverMediaType,f=a.fileEncSha256,g=a.directPath,j=a.eventFlow,k=a.progressiveJpegDetails,l=a.mediaKey;a=await d("WACreateMediaDownloadRetrier").createMediaDownloadRetrier({directPath:g,eventFlow:j,fileEncSha256:f,mediaTypeDetails:{type:"regular",mediaType:e}});if(!a.success)return a;a=a.value;var m=a.retrier;a=a.mediaRouteDetails;var n=a.bucket;a=await m.run(async function(a,h,i){h=a.domain;a=d("WAMediaUrl").buildDownloadUrl(g,f,h,"manual",n);h=await d("WADownloadProgressiveJpegPlaintextStreamerWithoutRetry").downloadProgressiveJpegPlaintextUsingStreamsWithoutRetry({abortSignal:b,downloadUrl:a,eventFlow:j,mediaKey:l,progressiveJpegDetails:k,serverMediaType:e,cachePolicy:i>0?"no-store":"force-cache"});if(h.success===!0)return d("WAResultOrError").makeResult(h);a=h.error;switch(a){case"http-fetch-exception":case"server-timeout":case"unspecified-http-error":case"invalid-content-length-header":case"missing-content-length-header":return d("WAResultOrError").makeError({progressMade:!0});case"access-expired":return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("disconnected"));case"body-network-error":return d("WAResultOrError").makeResult(d("WAResultOrError").makeError("request-error"));case"media-not-found":case"request-error":case"download-throttled":case"signature-expired":case"http-fetch-aborted":return d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a));case"missing-expected-hmacs":case"hmac-chiphertext-array-mismatch":return d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a));default:a;throw c("WAAssertUnreachable")(a)}});if(a==null){i.WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Download with stream given up"])));return d("WAResultOrError").makeError("max-attempts-exceeded")}return a}g.downloadProgressiveJpegPlaintextUsingStreams=a}),98);
__d("WAPrepareMediaDownload",["Promise","WAErrorMessage","WAGetAgeBucketForMediaKeyTimestamp","WAHashUtils","WAMediaQplHelper","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=typeof ((c=navigator.storage)==null?void 0:c.getDirectory)==="function",l=typeof self.caches==="object",m=0;function a(a){var c=a.mediaDownloadFlow,e=a.mediaEntry,f=a.logger;a=a.hash;var g=e.mediaKeyTimestamp,n=e.size,o=e.serverMediaType,p=e.downloadableThumbnail,q=e.directPath;g=d("WAGetAgeBucketForMediaKeyTimestamp").getAgeBucketForMediaKeyTimestamp(g);f.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start download ",". mediaKeyTimestampAgeBucket: ",", size: ",", serverMediaType: ",""])),d("WAHashUtils").sanitisePlaintextHash(a),g,n,o);e=(n=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(e).value)!=null?n:null;c.addPoint("wa_protocol_media_download_start",{string:{mediaType:o,mediaKeyTimestampAgeBucket:g,sanitisedMediaHash:d("WAHashUtils").sanitisePlaintextHash(a)},bool:{isOPFSSupported:k,isWebCacheSupported:l,duplicateDirectPath:(p==null?void 0:p.directPath)===q,hasDownloadableThumbnail:(p==null?void 0:p.directPath)!=null,isProgressiveJpeg:e!=null}});return{logDownloadResult:function(a){m++;c.addAnnotations({"int":{concurrentDownloadCount:m}});return a.then(function(a){if(a.success){var b=a.value.plaintext.byteLength;c.addPoint("wa_protocol_media_download_end",{string:{media_size:d("WAMediaQplHelper").convertIntegerSizeToStringBucket(b)}})}else c.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:a.error}});return a})["catch"](function(a){c.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"runtime-error"}});a=d("WAErrorMessage").maybeGetMessageFromError(a);f.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""])),a);return(j||(j=b("Promise"))).resolve(d("WAResultOrError").makeError("runtime-error"))})["finally"](function(){m--})}}}g.prepareMediaDownload=a}),98);
__d("WAProgressiveJpegAddJPEGTrailingTag",["WATypedArraysConcat"],(function(a,b,c,d,e,f,g){"use strict";var h=new Uint8Array([255,217]);function a(a){return d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[new Uint8Array(a),h]).buffer}g.JPEG_TRAILING_TAG=h;g.addJPEGTrailingTag=a}),98);
__d("WAStreamAsyncIterator",[],(function(a,b,c,d,e,f){"use strict";function a(a){return g.apply(this,arguments)}function g(){g=babelHelpers.wrapAsyncGenerator(function*(a){a=a.getReader();try{while(!0){var b=(yield babelHelpers.awaitAsyncGenerator(a.read())),c=b.done;b=b.value;if(c)return;yield b}}finally{a.releaseLock()}});return g.apply(this,arguments)}f.streamAsyncIterator=a}),66);
__d("WADownloadMedia",["WAByteArray","WACryptoSha256","WACryptoUtils","WADownloadAndDecryptMedia","WADownloadDownloadablePreview","WADownloadProgressiveJpegPlaintextStreamer","WADownloadProgressiveJpegPreview","WAErrorMessage","WAHashUtils","WAMediaCrypto","WAMediaUtils","WAPrepareMediaDownload","WAProgressiveJpegAddJPEGTrailingTag","WAProgressiveJpegGetPJpegDetails","WAPromiseManagement","WAResultOrError","WAStreamAsyncIterator","WATagsLogger","WATypedArraysConcat"],(function(a,b,c,d,e,f,g){"use strict";var h=["hash"],i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=d("WATagsLogger").TAGS(["MediaDownload"]);function a(a){var b=a.downloadMediaMetric,c=a.hash,e=a.mediaEntry,f=a.protocolMsgId,g=a.handleMediaPreviewDownload,h=a.handleMediaPreviewBeforeDownload;a=a.handleMediaPreviewDownloadFailed;var i=d("WAPrepareMediaDownload").prepareMediaDownload({mediaDownloadFlow:b,mediaEntry:e,hash:c,logger:w});i=i.logDownloadResult;return i(x({downloadMediaMetric:b,hash:c,mediaEntry:e,protocolMsgId:f,handleMediaPreviewDownload:g,handleMediaPreviewBeforeDownload:h,handleMediaPreviewDownloadFailed:a}))}b=async function(a){var b=a.downloadMediaMetric,c=a.hash,e=a.mediaEntry,f=a.protocolMsgId,g=a.handleMediaPreviewDownload,h=a.handleMediaPreviewBeforeDownload;a=a.handleMediaPreviewDownloadFailed;var n=d("WAMediaUtils").validateDecodedMediaEntryForDownload(e);if(!n.success){w.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["mediaEntry is incomplete. ",""])),n.error);return n}var o=n.value,p=o.directPath,q=o.fileEncSha256,r=o.fileSha256,s=o.mediaKey,t=o.serverMediaType;o=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(e);o.success===!1&&(w.WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to get ProgressiveJpeg details: ",""])),o.error),b.addPoint(o.error));o=o.success===!0?o.value:null;var u=function(a){if(a==null)return Promise.resolve();var b=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(t);if(b==null){w.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media: mediaPreview - unsupported preview media type ",""])),t);return Promise.resolve()}return g(c,a,b,f).then(function(){})};if(o!=null&&d("WAMediaUtils").isTransformStreamSupported()&&t==="image"){p=await B({directPath:p,downloadFlow:b,fileEncSha256:q,handleMediaPreviewBlob:u,hash:c,mediaKey:s,progressiveJpegDetails:o,serverMediaType:t,fileSha256:r,handleMediaPreviewBeforeDownload:h,handleMediaPreviewDownloadFailed:a});if(p.success)return d("WAResultOrError").makeResult({mimeType:d("WAMediaUtils").getMimeTypeFromServerMediaType(t),plaintext:p.value,serverMediaType:t});else{q=p.error;w.WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Media Streaming failed to download progressive jpeg. Reason: ",". PlaintextHash: ",""])),q,d("WAHashUtils").sanitisePlaintextHash(c));switch(q){case"signature-expired":case"request-error":w.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Skipping fallback for ",". PlaintextHash: ",""])),q,d("WAHashUtils").sanitisePlaintextHash(c));return d("WAResultOrError").makeError(q)}}}b==null||b.addPoint("fallback_to_non_streaming_download");s=A({hash:c,mediaEntry:e,progressiveJpegDetails:o,protocolMsgId:f,serverMediaType:t,handleMediaPreviewBeforeDownload:h,handleMediaPreviewDownloadFailed:a,downloadEntry:b.downloadEntry,triggerUIView:b.triggerUIView});void s.then(function(a){if(a.success===!1)return u(null);else return u(a.value)});return y({downloadMediaMetric:b,mediaEntry:n.value})};var x=d("WAPromiseManagement").cacheWhilePending(function(a){a=a.hash;return a},b),y=async function(a){var b=a.abortSignal,c=a.downloadMediaMetric;a=a.mediaEntry;var e=a.directPath,f=a.fileEncSha256,g=a.fileSha256,h=a.mediaKey;a=a.serverMediaType;b=await z({abortSignal:b,downloadFlow:c,mediaTypeDetails:{mediaType:a,type:"regular"},directPath:e,fileEncSha256:f,fileSha256:g,mediaKey:h});return b.success?d("WAResultOrError").makeResult({mimeType:d("WAMediaUtils").getMimeTypeFromServerMediaType(a),plaintext:b.value,serverMediaType:a}):b};c=d("WAPromiseManagement").cacheWhilePending(function(a){a=a.hash;return a},function(a){var b=a.hash;a=babelHelpers.objectWithoutPropertiesLoose(a,h);b=d("WAPrepareMediaDownload").prepareMediaDownload({hash:b,mediaDownloadFlow:a.downloadMediaMetric,mediaEntry:a.mediaEntry,logger:w});b=b.logDownloadResult;return b(y(a))});async function z(a){var b=a.abortSignal,c=a.downloadFlow,e=a.mediaTypeDetails,f=a.directPath,g=a.fileEncSha256,h=a.fileSha256;a=a.mediaKey;h=d("WAHashUtils").toPlaintextHash(h);b=await d("WADownloadAndDecryptMedia").downloadAndDecryptMedia({abortSignal:b,directPath:f,eventFlow:c,fileEncSha256:g,mediaKey:a,mediaTypeDetails:e,plaintextHash:h});if(b.success===!1){f=b.error;switch(f){case"signature-expired":case"media-not-found":return d("WAResultOrError").makeError(f);case"enc-hash-mismatch":w.ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["downloadMedia: enc-hash-mismatch"])));return d("WAResultOrError").makeError(f);default:f;return d("WAResultOrError").makeError(f)}}else{c=b.value;return d("WAResultOrError").makeResult(c)}}function A(a){var b=a.hash,c=a.mediaEntry,e=a.progressiveJpegDetails,f=a.protocolMsgId,g=a.serverMediaType,h=a.handleMediaPreviewBeforeDownload,i=a.handleMediaPreviewDownloadFailed,j=a.downloadEntry,k=a.triggerUIView;return e==null?d("WADownloadDownloadablePreview").maybeDownloadDownloadablePreview(f,b,g,c,j,{handleMediaPreviewBeforeDownload:h,handleMediaPreviewDownloadFailed:i},k):d("WADownloadProgressiveJpegPreview").maybeDownloadProgressiveJpegPreview({protocolMsgId:f,hash:b,serverMediaType:g,mediaEntry:c,progressiveJpegDetails:e,handleMediaPreviewBeforeDownload:h,handleMediaPreviewDownloadFailed:i,downloadEntry:j,triggerUIView:k}).then(function(a){return a.success!==!0?d("WADownloadDownloadablePreview").maybeDownloadDownloadablePreview(f,b,g,c,j,{handleMediaPreviewBeforeDownload:h,handleMediaPreviewDownloadFailed:i},k):a})}async function B(a){var b=a.directPath,c=a.downloadFlow,e=a.fileEncSha256,f=a.fileSha256,g=a.handleMediaPreviewBlob,h=a.hash,i=a.mediaKey,j=a.progressiveJpegDetails,k=a.serverMediaType,l=a.handleMediaPreviewBeforeDownload;a=a.handleMediaPreviewDownloadFailed;var m=w.TAGS(["MediaStreaming"]);m.LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Using Media Streaming to download ProgressiveJpeg. PlaintextHash: ",""])),d("WAHashUtils").sanitisePlaintextHash(h));c.addPoint("media_streaming_start");var n=d("WADownloadProgressiveJpegPreview").getPreviewTargetScan(j.scanLengths)-1;m.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Targeting scanIndex "," for preview. PlaintextHash: ",""])),n,d("WAHashUtils").sanitisePlaintextHash(h));c.addAnnotations({int:{scans:j.scanLengths.length}});void l(h);l=await d("WADownloadProgressiveJpegPlaintextStreamer").downloadProgressiveJpegPlaintextUsingStreams({directPath:b,eventFlow:c,fileEncSha256:e,mediaKey:i,progressiveJpegDetails:j,serverMediaType:k});if(l.success===!1){c.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:l.error}});void a(h,l.error);return l}c.addPoint("download_pjpeg_preview_start");b=[];e=0;try{i=!1;j=!1;var x;try{for(var y=babelHelpers.asyncIterator(d("WAStreamAsyncIterator").streamAsyncIterator(l.value)),k;i=!(k=await y.next()).done;i=!1){l=k.value;if(l==null)continue;m.LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Processing scan "," for plaintextHash ",""])),e,d("WAHashUtils").sanitisePlaintextHash(h));b.push(l);if(e===n){c.addPoint("media_streaming_preview_processed");m.LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Handling preview from scan "," for plaintextHash ",""])),e,d("WAHashUtils").sanitisePlaintextHash(h));k=d("WAByteArray").uint8ArrayToBuffer(d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(b,[d("WAProgressiveJpegAddJPEGTrailingTag").JPEG_TRAILING_TAG])));void g(k);c.addPoint("download_pjpeg_preview_end")}e++}}catch(a){j=!0,x=a}finally{try{i&&y.return!=null&&await y.return()}finally{if(j)throw x}}e<n&&(m.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["pjpeg stream ended before reaching previewTargetScanIndex for plaintextHash ",""])),d("WAHashUtils").sanitisePlaintextHash(h)),c.addPoint("download_pjpeg_preview_fail"));l=d("WAByteArray").uint8ArrayToBuffer(d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(b)));k=await d("WACryptoSha256").sha256(l);if(!d("WACryptoUtils").arrayBuffersEqual(f,k)){m.WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download failed due to plaintext hash mismatch. PlaintextHash: ",""])),d("WAHashUtils").sanitisePlaintextHash(h));c.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:"hash-mismatch"}});return d("WAResultOrError").makeError("hash-mismatch")}m.LOG(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download successful. PlaintextHash: ",""])),d("WAHashUtils").sanitisePlaintextHash(h));c.addPoint("media_streaming_end");return d("WAResultOrError").makeResult(l)}catch(b){m.ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Exception occurred during Media Streaming: Reason: ",""])),b);e<n&&(c.addPoint("download_pjpeg_preview_fail"),void a(h,d("WAErrorMessage").maybeGetMessageFromError(b)));c==null||c.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:d("WAErrorMessage").maybeGetMessageFromError(b)}});return d("WAResultOrError").makeError("stream-error")}}g.mediaDownloadLogger=w;g.downloadMedia=a;g.downloadFullMediaOnly=y;g.cachedDownloadFullMediaOnly=c;g.downloadMediaImpl=z}),98);
__d("WADownloadProgressiveJpegPlaintext",["WADownloadCiphertext","WAMediaCrypto","WAProgressiveJpegAddJPEGTrailingTag","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("WATagsLogger").TAGS(["DownloadProgressiveJpeg"]);async function a(a){var b=a.abortSignal,c=a.mediaTypeDetails,e=a.fileEncSha256,f=a.directPath,g=a.mediaKey,h=a.eventFlow,i=a.progressiveJpegDetails,j=a.targetScan,k=a.plaintextHash;a=a.size;i=d("WAProgressiveJpegGetPJpegDetails").getExtendedProgressiveJpegDetails({progressiveJpegDetails:i,ciphertextLength:m(a)});a=d("WAProgressiveJpegGetPJpegDetails").getTotalByteSizeForScan(i.alignedScanLengths,j);b=await d("WADownloadCiphertext").cachedDownloadCiphertext({abortSignal:b,mediaTypeDetails:c,fileEncSha256:e,directPath:f,fromBytes:0,toBytes:a-1,eventFlow:h,plaintextHash:k});return b.success!==!0?b:l(g,c,j,i,b.value)}async function l(a,b,c,e,f){k.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Using progressiveJpeg decryptAndVerify"])));var g=new Uint8Array(f);b.type==="preview"?f=d("WAMediaCrypto").computeMediaKeysForPreview(a):f=d("WAMediaCrypto").computeMediaKeys(a,b.mediaType);a=await f.then(function(a){var b=a.iv,f=a.cipherKey;a=a.hmacKey;return d("WAMediaCrypto").decryptPartialChunks(f,b,g,a,c,e)}).then(d("WAResultOrError").makeResult).catch(function(a){k.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Download Plaintext Error ",""])),a);if(a instanceof d("WAMediaCrypto").HmacValidationError)return d("WAResultOrError").makeError("enc-hash-mismatch");else return d("WAResultOrError").makeError("decryption-error")});if(!a.success)return a;k.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["ProgressiveJpeg download and decrypt successful. Partial: ",""])),c<e.scanLengths.length);b=d("WAProgressiveJpegAddJPEGTrailingTag").addJPEGTrailingTag(a.value.plaintext);return d("WAResultOrError").makeResult(b)}function m(a){if(a==null)return null;var b=d("WAMediaCrypto").CBC_BLOCK_SIZE-a%d("WAMediaCrypto").CBC_BLOCK_SIZE;return a+b+d("WAMediaCrypto").HMAC_LENGTH}g.downloadProgressiveJpegPlaintext=a}),98);
__d("WALoggerTag",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["CryptoManager","MediaPreview","PrekeyGenerateAndUpload","SignedPrekey","SignedPrekeyRotation","OneTimePrekey"]);c=a;f["default"]=c}),66);
__d("WAProgressiveJpegGetTargetScanLengthForBytes",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=0,d=0;for(var e=0;e<a.length;e++){d=e+1;c+=a[e];if(c>=b)break}return d}f.getTargetScanBasedOnByteSize=a}),66);
__d("WADownloadProgressiveJpegPreview",["WADownloadMedia","WADownloadProgressiveJpegPlaintext","WAGlobals","WALoggerTag","WAProgressiveJpegGetTargetScanLengthForBytes","WAResultOrError","WAStartMediaDownloadQplFlow"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("WADownloadMedia").mediaDownloadLogger.TAGS([c("WALoggerTag").MediaPreview]),k=3;async function a(a){var b=a.protocolMsgId,c=a.hash,e=a.serverMediaType,f=a.mediaEntry,g=a.progressiveJpegDetails,k=a.handleMediaPreviewBeforeDownload,m=a.handleMediaPreviewDownloadFailed,n=a.downloadEntry;a=a.triggerUIView;var o=f.directPath,p=f.fileEncSha256,q=f.mediaKey,r=f.size;if(o==null||p==null||q==null)return d("WAResultOrError").makeError("pjpeg-failed");b=d("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({protocolMsgId:b,downloadEntry:n,isPreview:!0,msgType:null,triggerUIView:a});b.addAnnotations({bool:{isMediaFallbackToAlternativeHmacSaltsEnabled:d("WAGlobals").getConfig().isMediaFallbackToAlternativeHmacSaltsEnabled(),isProgressiveJpeg:!0},string:{mediaType:"preview",fullSizeMediaType:f.serverMediaType},int:{mediaEntrySize:f.size}});j.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Starting progressiveJpeg preview download"])));b.addPoint("wa_protocol_media_download_start");n=d("WAGlobals").getConfig().pjpegPreviewAvoidLastScan()===!0?g.scanLengths.length-1:g.scanLengths.length;a=Math.min(l(g.scanLengths,r),n);await k(c);f=await d("WADownloadProgressiveJpegPlaintext").downloadProgressiveJpegPlaintext({directPath:o,eventFlow:b,fileEncSha256:p,mediaKey:q,mediaTypeDetails:{mediaType:e,type:"regular"},progressiveJpegDetails:g,plaintextHash:c,targetScan:a,size:r});if(!f.success){void m(c,f.error);b.endFail("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:f.error}});return d("WAResultOrError").makeError("pjpeg-failed")}n=f.value;j.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Finished progressiveJpeg preview download"])));b.addPoint("wa_protocol_media_download_end");b.endSuccess();return d("WAResultOrError").makeResult(n)}function l(a,b){var c=d("WAGlobals").getConfig().jpegThumbnailTargetByteSizeKB()*1024;c=d("WAProgressiveJpegGetTargetScanLengthForBytes").getTargetScanBasedOnByteSize(a,c);(b==null||b===0)&&(c=Math.min(c,a.length-1));c=Math.max(c,k);return c}function b(a){var b=a.abortSignal,c=a.hash,e=a.serverMediaType,f=a.mediaEntry,g=a.progressiveJpegDetails;a=a.mediaDownloadFlow;var h=f.directPath,i=f.fileEncSha256,j=f.mediaKey;f=f.size;var k=d("WAGlobals").getConfig().pjpegPreviewAvoidLastScan()===!0?g.scanLengths.length-1:g.scanLengths.length;k=Math.min(l(g.scanLengths,f),k);return d("WADownloadProgressiveJpegPlaintext").downloadProgressiveJpegPlaintext({abortSignal:b,directPath:h,fileEncSha256:i,mediaKey:j,mediaTypeDetails:{mediaType:e,type:"regular"},progressiveJpegDetails:g,plaintextHash:c,targetScan:k,size:f,eventFlow:a})}g.maybeDownloadProgressiveJpegPreview=a;g.getPreviewTargetScan=l;g.maybeDownloadProgressiveJpegPreviewV2=b}),98);
__d("WAPreloadWamediaUtilsWasm",["WAMediaUtilsWasmUrl","WAWasmModuleCache"],(function(a,b,c,d,e,f,g){"use strict";a=function(){void d("WAWasmModuleCache").loadWasmModule(d("WAMediaUtilsWasmUrl").WAMediaUtilsWasmUrl)};g.preloadWamediaUtilsWasm=a}),98);
__d("WAPreloadWebpCheckWasm",["WAWasmModuleCache","bx"],(function(a,b,c,d,e,f,g){"use strict";var h=c("bx").getURL(c("bx")("6946"));a=function(){void d("WAWasmModuleCache").loadWasmModule(h)};g.preloadWebpCheckWasm=a}),98);
__d("WAPrewarmMediaValidate",["WAGetKaleidoscopeWasm","WALogger","WAPreloadWamediaUtilsWasm","WAPreloadWebpCheckWasm","getErrorSafe","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){if(c("gkx")("3272")){d("WAGetKaleidoscopeWasm").getKaleidoscopeWasm()["catch"](function(a){a=c("getErrorSafe")(a);d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["prewarm Kaleidoscop wasm failed with error: ",""])),a.message)});return}if(a==null){d("WALogger").WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["prewarmMediaValidate: serverMediaType is null"])));return}(a==="sticker"||a==="image")&&d("WAPreloadWebpCheckWasm").preloadWebpCheckWasm();(a==="video"||a==="audio")&&d("WAPreloadWamediaUtilsWasm").preloadWamediaUtilsWasm()}g.prewarmMediaValidate=a}),98);
__d("WAMediaManagerPrepareMediaDownload",["Promise","WAErrorMessage","WAGetAgeBucketForMediaKeyTimestamp","WAHashUtils","WAMediaQplHelper","WAPrewarmMediaValidate","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=0;function a(a){var c=a.hash,e=a.logger,f=a.mediaDownloadFlow;a=a.mediaEntry;var g=a.directPath,l=a.downloadableThumbnail,m=a.mediaKeyTimestamp,n=a.serverMediaType,o=a.size;d("WAPrewarmMediaValidate").prewarmMediaValidate(n);m=d("WAGetAgeBucketForMediaKeyTimestamp").getAgeBucketForMediaKeyTimestamp(m);e.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start download ",". entry: "," mediaKeyTimestampAgeBucket: ",", size: ",", serverMediaType: ",""])),d("WAHashUtils").sanitisePlaintextHash(c),f.downloadEntry,m,o,n);o=(c=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a).value)!=null?c:null;f.addPoint("wa_protocol_media_download_start",{bool:{duplicateDirectPath:(l==null?void 0:l.directPath)===g,hasDownloadableThumbnail:(l==null?void 0:l.directPath)!=null,isProgressiveJpeg:o!=null},string:{mediaKeyTimestampAgeBucket:m,mediaType:n}});return{logDownloadResult:function(a){k++;f.addAnnotations({"int":{concurrentDownloadCount:k}});return a.then(function(a){if(a.success){var b=a.value.validatedResult.validatedPlaintext.byteLength;f.addPoint("wa_protocol_media_download_end",{string:{media_size:d("WAMediaQplHelper").convertIntegerSizeToStringBucket(b)}})}else f.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:a.error}});return a})["catch"](function(a){f.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"runtime-error"}});var c=d("WAErrorMessage").maybeGetMessageFromError(a);e.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""])),c);return(j||(j=b("Promise"))).resolve(d("WAResultOrError").DEPRECATED_makeError("runtime-error",a))})["finally"](function(){k--})}}}g.mediaManagerPrepareMediaDownload=a}),98);
__d("WADownloadFullSizeOnlyTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","WADownloadMedia","WAFindMostRecentMediaEntry","WAIsMediaExpiredError","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAResultOrError","WAValidateMedia","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;async function a(a){var b=a.abortSignal,c=a.dbCallbacks,e=a.fullSizePlaintextHash,f=a.logger,g=a.mediaDownloadFlow;g.addPoint("get_media_entries_start");a=await c.getMediaEntries(e);if(!a.success){g.addPoint("get_media_entries_fail");return{fullsizePromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry"))}}a=a.value;g.addPoint("get_media_entries_end");var h=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(a);if(!h.success)return{fullsizePromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry"))};h=h.value;var i=h[0];h=h[1];h=d("WAMediaUtils").validateDecodedMediaEntryForDownload(h);if(!h.success)return{fullsizePromise:Promise.resolve(h)};h=h.value;e=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:e,logger:f,mediaDownloadFlow:g,mediaEntry:h});e=e.logDownloadResult;b=k({abortSignal:b,dbCallbacks:c,logger:f,mediaDownloadFlow:g,mediaEntries:a,msgIdOfRecentMediaEntry:i,recentMediaEntry:h}).then(async function(a){if(!a.success)return a;var b=await d("WAValidateMedia").validateMedia(a.value.plaintext,g);return!b.success?b:d("WAResultOrError").makeResult({serverMediaType:a.value.serverMediaType,unvalidatedMimeType:a.value.mimeType,validatedResult:b.value})});return{fullsizePromise:e(b)}}async function k(a){var b=a.abortSignal,e=a.dbCallbacks,f=a.logger,g=a.mediaDownloadFlow;a.mediaEntries;var k=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var l=c("MAWEBSwitch").isEnabled()&&c("gkx")("23960");l&&g.addPoint("forcing_eb_download");l=l?d("WAResultOrError").makeError("signature-expired"):await d("WADownloadMedia").downloadFullMediaOnly({abortSignal:b,downloadMediaMetric:g,mediaEntry:a});if(l.success)return l;if(!d("WAIsMediaExpiredError").isMediaExpiredError(l.error)||!c("MAWEBSwitch").isEnabled())return l;e=await e.getProtocolMsgIdAndSortOrderMs(k);if(e==null)return d("WAResultOrError").makeError("missing-sort-order-ms-for-restore");var m=e.protocolMsgId;e=e.sortOrderMs;a=a;k=k;var n=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(a.serverMediaType);if(n==null||a.objectId==null){f.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""])),l.error);return l}l=await d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:a.objectId,logger:f,mediaDownloadFlow:g,mediaType:n,msgId:k,protocolMsgId:m,sortOrderMs:e});if(!l.success){f.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and restore failed: ",""])),l.error);return l}n=await d("WADownloadMedia").downloadFullMediaOnly({abortSignal:b,downloadMediaMetric:babelHelpers.extends({},g,{addPoint:function(a,b){g.addPoint("second_"+a,b)}}),mediaEntry:babelHelpers.extends({},a,{directPath:l.value})});if(!n.success){f.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media after restore CDN URL: ",""])),n.error);return n}return d("WAResultOrError").makeResult(n.value)}g.startDownloadFullSizeTask=a;g.downloadOrRestoreFullSize=k}),98);
__d("WADownloadMediaPreviewV2",["WADownloadMedia","WADownloadProgressiveJpegPreview","WAMediaCrypto","WAMediaUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a){var b=a.abortSignal,c=a.hash,e=a.mediaEntry,f=a.progressiveJpegDetails,g=a.mediaDownloadFlow;a=a.logger;var i=e.serverMediaType,j=d("WAMediaUtils").getMimeTypeFromServerMediaType(i);c=f==null?d("WAResultOrError").makeError("jpeg-stream-not-supported"):await d("WADownloadProgressiveJpegPreview").maybeDownloadProgressiveJpegPreviewV2({abortSignal:b,hash:c,serverMediaType:i,mediaEntry:e,progressiveJpegDetails:f,mediaDownloadFlow:g});if(c.success===!0)return d("WAResultOrError").makeResult({plaintext:c.value,mimeType:j,serverMediaType:i});g.addPoint("fallback_to_downloadable_thumbnail");f=e.downloadableThumbnail;if((f==null?void 0:f.directPath)==null)return d("WAResultOrError").makeError("media-not-found");c=d("WAMediaUtils").validateDownloadableThumbnailForDownload(f);if(c.success===!1){a.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["preview mediaEntry is incomplete: ",""])),c.error);return d("WAResultOrError").makeError(c.error[0])}e=c.value;f=e.directPath;a=e.fileEncSha256;c=e.fileSha256;e=e.mediaKey;var k=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(i);if(k==null)return d("WAResultOrError").makeError("request-error");b=await d("WADownloadMedia").downloadMediaImpl({abortSignal:b,downloadFlow:g,mediaTypeDetails:{messageType:k,type:"preview"},directPath:f,fileEncSha256:a,fileSha256:c,mediaKey:e});return b.success===!1?b:d("WAResultOrError").makeResult({plaintext:b.value,mimeType:j,serverMediaType:i})}g.downloadMediaPreview=a}),98);
__d("WAIsPreviewSupported",["$InternalEnum","WAProgressiveJpegGetPJpegDetails"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["NO","YES"]),i=b("$InternalEnum").Mirrored(["NO","YES","DuplicatedWithFullSize"]);function a(a){var b=a.serverMediaType;switch(b){case"image":var c,e;c=(c=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a).value)!=null?c:null;c=c!=null?h.YES:h.NO;if(((e=a.downloadableThumbnail)==null?void 0:e.directPath)==null)return[c,i.NO];a.downloadableThumbnail.directPath;e=a.downloadableThumbnail.directPath===a.directPath?i.DuplicatedWithFullSize:i.YES;return[c,e];case"video":if(((c=a.downloadableThumbnail)==null?void 0:c.directPath)==null)return[h.NO,i.NO];a.downloadableThumbnail.directPath;e=a.downloadableThumbnail.directPath===a.directPath?i.NO:i.YES;return[h.NO,e];case"sticker":case"ptt":case"audio":case"document":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"template":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"novi-video":case"novi-image":case"payment-bg-image":case"product":case"product-catalog-image":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-thumbnail-link":case"newsletter-video":case"sticker-pack":case"thumbnail-sticker-pack":case"music-artwork":return[h.NO,i.NO];default:b;return[h.NO,i.NO]}}g.PjpegPreviewSupport=h;g.DownloadablePreviewSupport=i;g.checkPreviewSupport=a}),98);
__d("WADownloadPreviewOnlyTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","WADownloadMediaPreviewV2","WAFindMostRecentMediaEntry","WAIsMediaExpiredError","WAIsPreviewSupported","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAValidateMedia","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;async function a(a){var b=a.abortSignal,c=a.dbCallbacks,e=a.fullSizePlaintextHash,f=a.logger,g=a.mediaDownloadFlow;g.addPoint("get_media_entries_start");a=await c.getMediaEntries(e);if(!a.success){g.addPoint("get_media_entries_fail");return{previewPromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry"))}}g.addPoint("get_media_entries_end");var h=a.value;h=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(h);if(!h.success)return{previewPromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry"))};h=h.value;var i=h[0];h=h[1];h=d("WAMediaUtils").validateDecodedMediaEntryForDownload(h);if(!h.success)return{previewPromise:Promise.resolve(h)};h=h.value;var j=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:e,logger:f,mediaDownloadFlow:g,mediaEntry:h});j=j.logDownloadResult;var l=d("WAIsPreviewSupported").checkPreviewSupport(h),m=l[0];l=l[1];if(m===d("WAIsPreviewSupported").PjpegPreviewSupport.NO&&l===d("WAIsPreviewSupported").DownloadablePreviewSupport.NO)return{previewPromise:Promise.resolve(d("WAResultOrError").makeError("preview-not-supported"))};m=k({abortSignal:b,dbCallbacks:c,fullSizePlaintextHash:e,logger:f,mediaDownloadFlow:g,mediaEntries:a.value,msgIdOfRecentMediaEntry:i,recentMediaEntry:h}).then(async function(a){if(!a.success)return a;var b=await d("WAValidateMedia").validateMedia(a.value.plaintext,g);return!b.success?b:d("WAResultOrError").makeResult({serverMediaType:a.value.serverMediaType,unvalidatedMimeType:a.value.mimeType,validatedResult:b.value})});return{previewPromise:j(m)}}async function k(a){var b=a.abortSignal,e=a.dbCallbacks,f=a.fullSizePlaintextHash,g=a.logger,k=a.mediaDownloadFlow;a.mediaEntries;var l=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var m=c("MAWEBSwitch").isEnabled()&&c("gkx")("23960");m&&k.addPoint("forcing_eb_download");var n=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a);n=n.success===!0?n.value:null;b={abortSignal:b,hash:f,logger:g,mediaDownloadFlow:k,progressiveJpegDetails:n,updateMediaEntryForMsg:e.updateMediaEntryForMsg};k.addPoint("download_preview_start");f=m?d("WAResultOrError").makeError("signature-expired"):await d("WADownloadMediaPreviewV2").downloadMediaPreview(babelHelpers.extends({},b,{mediaEntry:a}));if(f.success){k.addPoint("download_preview_end");return d("WAResultOrError").makeResult({mimeType:f.value.mimeType,plaintext:f.value.plaintext,serverMediaType:f.value.serverMediaType})}k.addPoint("download_preview_fail");if(!d("WAIsMediaExpiredError").isMediaExpiredError(f.error)||!c("MAWEBSwitch").isEnabled()||c("gkx")("1327")!==!0)return f;n=await e.getProtocolMsgIdAndSortOrderMs(l);if(n==null)return d("WAResultOrError").makeError("missing-sort-order-ms-for-restore");m=n.protocolMsgId;e=n.sortOrderMs;n=a;a=l;l=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(n.serverMediaType);if(l==null||((l=n.downloadableThumbnail)==null?void 0:l.objectId)==null){g.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""])),f.error);return f}l=await d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:n.downloadableThumbnail.objectId,logger:g,mediaDownloadFlow:k,mediaType:"preview",msgId:a,protocolMsgId:m,sortOrderMs:e});if(!l.success){g.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and restore failed: ",""])),l.error);return l}k.addPoint("second_download_preview_start");f=await d("WADownloadMediaPreviewV2").downloadMediaPreview(babelHelpers.extends({},b,{mediaDownloadFlow:babelHelpers.extends({},k,{addPoint:function(a,b){k.addPoint("second_"+a,b)}}),mediaEntry:babelHelpers.extends({},n,{directPath:l.value,fbid:void 0,objectId:null})}));if(!f.success){g.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media after restore CDN URL: ",""])),f.error);k.addPoint("second_download_preview_fail");return f}k.addPoint("second_download_preview_end");return d("WAResultOrError").makeResult({mimeType:f.value.mimeType,plaintext:f.value.plaintext,serverMediaType:f.value.serverMediaType})}g.startDownloadPreviewTask=a;g.downloadOrRestorePreviewOnly=k}),98);
__d("WADownloadProgressiveJpegUsingMediaStreaming",["WAByteArray","WACryptoSha256","WACryptoUtils","WADownloadProgressiveJpegPlaintextStreamer","WADownloadProgressiveJpegPreview","WAErrorMessage","WAMediaUtils","WAProgressiveJpegAddJPEGTrailingTag","WAResolvable","WAResultOrError","WAStreamAsyncIterator","WATypedArraysConcat"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o;async function a(a){var b=a.abortSignal,c=a.directPath,e=a.downloadFlow,f=a.fileEncSha256,g=a.fileSha256,m=a.logger,n=a.mediaKey,o=a.progressiveJpegDetails,q=a.serverMediaType,r=m.TAGS(["MediaStreaming"]);r.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Using Media Streaming to download ProgressiveJpeg."])));e.addPoint("create_pjpeg_stream_start");a=await d("WADownloadProgressiveJpegPlaintextStreamer").downloadProgressiveJpegPlaintextUsingStreams({abortSignal:b,directPath:c,eventFlow:e,fileEncSha256:f,mediaKey:n,progressiveJpegDetails:o,serverMediaType:q}).catch(function(a){r.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["create DownloadAndDecryptPJpegStream unexpected runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)});if(a.success===!1){e.addPoint("create_pjpeg_stream_fail");return a}e.addPoint("create_pjpeg_stream_end");var s=new(d("WAResolvable").Resolvable)();m=!1;b=p({downloadFlow:e,fileSha256:g,mediaStreamingLogger:r,previewResolvable:s,progressiveJpegDetails:o,progressiveJpegDownloadStream:a.value,serverMediaType:q}).then(function(a){m=!0;r.DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["handleProgressiveJpegDownloadStream completed"])));return a}).catch(function(a){m=!0;r.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["handleProgressiveJpegDownloadStream unexpected runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));s.reject(a);return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)});var t=d("WAMediaUtils").getMimeTypeFromServerMediaType(q);function u(a){return a.success===!1?a:d("WAResultOrError").makeResult({mimeType:t,plaintext:a.value,serverMediaType:q})}c=b.then(u);f=s.promise.then(u);n=await s.promise;n.success===!0&&m===!0&&r.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["fullsizeResolvable is settled before previewResolvable"])));if(n.success===!0)return d("WAResultOrError").makeResult({fullsizePromise:c,previewPromise:f});e=await b;n.success;if(e.success===!0)return d("WAResultOrError").makeResult({fullsizePromise:c,previewPromise:f});e.success;return e}async function p(a){var b=a.downloadFlow,c=a.fileSha256,e=a.mediaStreamingLogger,f=a.previewResolvable,g=a.progressiveJpegDetails;a=a.progressiveJpegDownloadStream;b.addPoint("download_pjpeg_preview_start");var h=0;g=d("WADownloadProgressiveJpegPreview").getPreviewTargetScan(g.scanLengths)-1;try{var i=[],j=!1,k=!1,l;try{for(var p=babelHelpers.asyncIterator(d("WAStreamAsyncIterator").streamAsyncIterator(a)),a;j=!(a=await p.next()).done;j=!1){a=a.value;if(a==null)continue;i.push(a);if(h===g){b.addPoint("media_streaming_preview_processed");a=d("WAByteArray").uint8ArrayToBuffer(d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(i,[d("WAProgressiveJpegAddJPEGTrailingTag").JPEG_TRAILING_TAG])));f.resolve(d("WAResultOrError").makeResult(a));b.addPoint("download_pjpeg_preview_end")}h++}}catch(a){k=!0,l=a}finally{try{j&&p.return!=null&&await p.return()}finally{if(k)throw l}}f.isSettled===!1&&(e.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["pjpeg stream ended before reaching previewTargetScanIndex"]))),f.resolve(d("WAResultOrError").makeError("runtime-error")),b.addPoint("download_pjpeg_preview_fail"));a=d("WAByteArray").uint8ArrayToBuffer(d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(i)));h=await d("WACryptoSha256").sha256(a);if(!d("WACryptoUtils").arrayBuffersEqual(c,h)){e.WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download failed due to plaintext hash mismatch."])));return d("WAResultOrError").makeError("hash-mismatch")}return d("WAResultOrError").makeResult(a)}catch(a){e.ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Exception occurred during Media Streaming: Reason: ",""])),a);f.isSettled===!1&&(f.resolve(d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)),b.addPoint("download_pjpeg_preview_fail"));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)}}g.downloadProgresiveJpegUsingMediaStreaming=a}),98);
__d("WADownloadFullSizeAndPreviewTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","UserAgent","WADownloadFullSizeOnlyTask","WADownloadPreviewOnlyTask","WADownloadProgressiveJpegUsingMediaStreaming","WAErrorMessage","WAFindMostRecentMediaEntry","WAHashUtils","WAIsMediaExpiredError","WAIsPreviewSupported","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAStartMediaDownloadQplFlow","WAValidateMedia","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r;async function a(a){var b=a.abortSignal,c=a.dbCallbacks,e=a.fullSizePlaintextHash,f=a.logger;a=a.mediaDownloadFlow;a.addPoint("get_media_entries_start");var g=await c.getMediaEntries(e);if(!g.success){a.addPoint("get_media_entries_fail");return{fullsizePromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry")),previewPromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry"))}}a.addPoint("get_media_entries_end");g=g.value;var k=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(g);if(!k.success)return{fullsizePromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry")),previewPromise:Promise.resolve(d("WAResultOrError").makeError("missing-media-entry"))};k=k.value;var l=k[0];k=k[1];k=d("WAMediaUtils").validateDecodedMediaEntryForDownload(k);if(!k.success){f.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["invalid mediaEntry for download: ",""])),k.error);return{fullsizePromise:Promise.resolve(k),previewPromise:Promise.resolve(k)}}return t({abortSignal:b,dbCallbacks:c,fullSizePlaintextHash:e,logger:f,mediaDownloadFlow:a,mediaEntries:g,msgIdOfRecentMediaEntry:l,recentMediaEntry:k.value}).then(function(a){f.DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["outter promise: ",""])),a.success===!0?"success":a.error);if(!a.success){f.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["outter promise failed: ",""])),a.error);return{fullsizePromise:Promise.resolve(a),previewPromise:Promise.resolve(a)}}return a.value})}async function s(a,b){a=await a;if(!a.success)return Promise.resolve(a);b=await d("WAValidateMedia").validateMedia(a.value.plaintext,b);return!b.success?b:d("WAResultOrError").makeResult({serverMediaType:a.value.serverMediaType,unvalidatedMimeType:a.value.mimeType,validatedResult:b.value})}async function t(a){var b=a.abortSignal,c=a.dbCallbacks,e=a.fullSizePlaintextHash,f=a.logger,g=a.mediaDownloadFlow,h=a.mediaEntries,i=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var j=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:e,logger:f,mediaDownloadFlow:g,mediaEntry:a});j=j.logDownloadResult;var l={abortSignal:b,dbCallbacks:c,logger:f,mediaDownloadFlow:g,mediaEntries:h,msgIdOfRecentMediaEntry:i,recentMediaEntry:a};b=await u(babelHelpers.extends({},l,{fullSizePlaintextHash:e}));if(b.success){c=b.value;h=c.fullsizePromise;i=c.previewPromise;a=h.then(function(a){if(a.success)return a;g.addPoint("fallback_to_non_streaming_download",{string:{streaming_fallback_reason:a.error}});return d("WADownloadFullSizeOnlyTask").downloadOrRestoreFullSize(l)});return d("WAResultOrError").makeResult({fullsizePromise:j(s(a,g)),previewPromise:s(i,g)})}c=x(b.error);if(!c.shouldFallback)return d("WAResultOrError").makeError(c.error);g.addPoint("fallback_to_non_streaming_download",{string:{streaming_fallback_reason:c.error}});f.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["fallback to non-streaming download"])));h=s(d("WADownloadFullSizeOnlyTask").downloadOrRestoreFullSize(l),g);a=v(babelHelpers.extends({},l,{fullSizePlaintextHash:e,fullsizePromise:h}));return d("WAResultOrError").makeResult({fullsizePromise:j(h),previewPromise:a})}async function u(a){var b,e=a.abortSignal,f=a.dbCallbacks,g=a.logger,h=a.mediaDownloadFlow;a.mediaEntries;var i=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var j=c("MAWEBSwitch").isEnabled()&&c("gkx")("23960");j&&h.addPoint("forcing_eb_download");var k=a.directPath,q=a.fileEncSha256,r=a.fileSha256,s=a.mediaKey,t=a.serverMediaType;b=(b=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a).value)!=null?b:null;if(b==null||a.serverMediaType!=="image"||!d("WAMediaUtils").isTransformStreamSupported()||c("UserAgent").isBrowser("Safari < 18")||c("UserAgent").isBrowser("Mobile Safari < 18")){a.serverMediaType==="image"&&b==null&&(g.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["skip pjpeg streaming because pjpeg metadata is null"]))),g.DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["media entry: ",""])),a));return d("WAResultOrError").makeError("jpeg-stream-not-supported")}h.addPoint("media_streaming_start");j=j?d("WAResultOrError").makeError("signature-expired"):await d("WADownloadProgressiveJpegUsingMediaStreaming").downloadProgresiveJpegUsingMediaStreaming({abortSignal:e,directPath:k,downloadFlow:h,fileEncSha256:q,fileSha256:r,logger:g,mediaKey:s,progressiveJpegDetails:b,serverMediaType:t}).catch(function(a){g.ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["downloadProgresiveJpegUsingMediaStreaming unexpected runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)});if(j.success){h.addPoint("media_streaming_end");return j}if(!d("WAIsMediaExpiredError").isMediaExpiredError(j.error)||!c("MAWEBSwitch").isEnabled()){w(h,j);return j}k=await f.getProtocolMsgIdAndSortOrderMs(i);if(k==null)return d("WAResultOrError").makeError("missing-sort-order-ms-for-restore");q=k.protocolMsgId;r=k.sortOrderMs;s=a;t=i;f=s.fileEncSha256;k=s.fileSha256;a=s.mediaKey;i=s.serverMediaType;var u=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(i);if(u==null||s.objectId==null){g.ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""])),j.error);return j}j=await d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:s.objectId,logger:g,mediaDownloadFlow:h,mediaType:u,msgId:t,protocolMsgId:q,sortOrderMs:r});if(!j.success)return j;h.addPoint("second_media_streaming_start");s=await d("WADownloadProgressiveJpegUsingMediaStreaming").downloadProgresiveJpegUsingMediaStreaming({abortSignal:e,directPath:j.value,downloadFlow:babelHelpers.extends({},h,{addPoint:function(a,b){h.addPoint("second_"+a,b)}}),fileEncSha256:f,fileSha256:k,logger:g,mediaKey:a,progressiveJpegDetails:b,serverMediaType:i}).catch(function(a){g.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["downloadProgresiveJpegUsingMediaStreaming unexpected runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)});if(s.success){h.addPoint("second_media_streaming_end");return s}else{w(h,s);return s}}function v(a){var b=a.abortSignal,c=a.dbCallbacks,e=a.fullSizePlaintextHash,f=a.fullsizePromise,g=a.logger,h=a.mediaDownloadFlow,i=a.mediaEntries,j=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var k=a.serverMediaType,l=d("WAIsPreviewSupported").checkPreviewSupport(a),m=l[0];l=l[1];if(m===d("WAIsPreviewSupported").PjpegPreviewSupport.NO&&l===d("WAIsPreviewSupported").DownloadablePreviewSupport.NO){g.LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["preview not supported"])));return Promise.resolve(d("WAResultOrError").makeError("preview-not-supported"))}if(l===d("WAIsPreviewSupported").DownloadablePreviewSupport.DuplicatedWithFullSize){g.LOG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["preview duplicated with fullsize"])));return f}var n=d("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({downloadEntry:h.downloadEntry,isPreview:!0,msgType:null,protocolMsgId:null,triggerUIView:null});m=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:e,logger:g,mediaDownloadFlow:n,mediaEntry:a});l=m.logDownloadResult;n.addAnnotations({bool:{isMediaManager:!0},string:{downloadKind:"fullsizeAndPreview",fullSizeMediaType:k,mediaType:"preview",sanitisedMediaHash:d("WAHashUtils").sanitisePlaintextHash(e)}});f=d("WADownloadPreviewOnlyTask").downloadOrRestorePreviewOnly({abortSignal:b,dbCallbacks:c,fullSizePlaintextHash:e,logger:g,mediaDownloadFlow:n,mediaEntries:i,msgIdOfRecentMediaEntry:j,recentMediaEntry:a});return l(s(f,n)).then(function(a){a.success?n.endSuccess():n.endFail(a.error,{string:{failReason:a.error}});return a}).catch(function(a){n.endFail("runtime-error",{string:{failReason:d("WAErrorMessage").maybeGetMessageFromError(a)}});return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})}function w(a,b){a.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:b.payload!=null?d("WAErrorMessage").maybeGetMessageFromError(b.payload):b.error}})}function x(a){switch(a){case"runtime-error":case"jpeg-stream-not-supported":return{error:a,shouldFallback:!0};case"missing-expected-hmacs":case"hmac-chiphertext-array-mismatch":return{error:a,shouldFallback:!0};case"missing-media-entry":case"missing-media-entry-for-restore":case"missing-sort-order-ms-for-restore":case"preview-not-supported":return{error:a,shouldFallback:!1};case"direct-path-undefined":case"direct-path-corrupted":case"direct-path-empty":case"create-payload-failed":case"resign-cdn-url-request-error":case"resign-cdn-url-runtime-error":case"resign-cdn-url-timeout":case"resign-cdn-url-gql-error":return{error:a,shouldFallback:!1};case"invalid-media":case"invalid-webp":case"invalid-mp4":return{error:a,shouldFallback:!1};case"decryption-error":case"enc-hash-mismatch":case"hash-mismatch":case"ciphertext-hash-mismatch":return{error:a,shouldFallback:!0};case"access-expired":case"disconnected":case"backoff":case"body-network-error":case"http-fetch-exception":case"http-fetch-aborted":case"no-host":case"server-timeout":case"unspecified-http-error":case"media-not-found":case"download-throttled":case"request-error":case"max-attempts-exceeded":case"signature-expired":case"media-entry-invalid":return{error:a,shouldFallback:!1};case"media-entry-invalid-direct-path":case"media-entry-invalid-file-enc-sha256":case"media-entry-invalid-file-sha256":case"media-entry-invalid-media-key":case"media-entry-invalid-server-media-type":return{error:a,shouldFallback:!1}}}g.startDownloadFullSizeAndPreviewTask=a}),98);
__d("WAMediaManagerLogger",["WAHashUtils","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=d("WATagsLogger").TAGS(["MediaManager"]);function a(a){var b=a.downloadKind;a=a.fullSizePlaintextHash;a=h.TAGS(["download","hash:"+d("WAHashUtils").sanitisePlaintextHash(a),b]);return a}function b(a){var b=a.plaintextHash;a=a.uploadKind;b=h.TAGS(["upload","hash:"+d("WAHashUtils").sanitisePlaintextHash(b),a]);return b}g.baseLogger=h;g.createDownloadLogger=a;g.createUploadLogger=b}),98);
__d("WAIsMediaDownloadRemovePersistedJobEnable",["gkx","memoize"],(function(a,b,c,d,e,f,g){"use strict";a=c("memoize")(function(){return c("gkx")("12064")});g.isMediaDownloadRemovePersistedJobEnable=a}),98);
__d("WAMediaManagerWorkerScheduler",["WAIsMediaDownloadRemovePersistedJobEnable","WorkerScheduler"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){h==null&&(h=d("WorkerScheduler").makeScheduler("MediaManager",{concurrency:16,maxConcurrency:32,maxThrottleMs:d("WAIsMediaDownloadRemovePersistedJobEnable").isMediaDownloadRemovePersistedJobEnable()?60*1e3:30*1e3,timeToStuckMs:d("WAIsMediaDownloadRemovePersistedJobEnable").isMediaDownloadRemovePersistedJobEnable()?180*1e3:60*1e3}));return h}g.mediaManagerWorkerScheduler=a}),98);
__d("WACreateRetrier",["WAComms","WAGetMediaRoute","WAMediaOperationsRetrier","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){a=await d("WAGetMediaRoute").getMediaRoute({operation:"upload",serverMediaType:a},b);if(!a.success)return a;b=a.value;a=b.selectedHost;var c=b.fallbackHost;b=b.authToken;a=new(d("WAMediaOperationsRetrier").MediaOperationsRetrier)("upload",{host:{domain:a.domain,class:a.class},fallbackHost:c&&{domain:c.domain,class:c.class},authToken:b,timeElapsed:null},d("WAComms").waitForConnection);return d("WAResultOrError").makeResult(a)}g.createUploadRetrier=a}),98);
__d("WAHttpRegularUploadMedia",["WADirectPath","WALogger","WAResultOrError","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;async function a(a,b){var e;try{e=await fetch(a,{method:"POST",mode:"cors",cache:"no-store",headers:{"Content-Type":"text/plain"},body:new Blob([b])})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to initiate fetch ",""])),a);throw a}a=e;b=a.status;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Fetch Media HTTP status ",""])),b);switch(b){case 200:return e.json().then(function(a){if(!Object.prototype.hasOwnProperty.call(a,"direct_path"))throw c("err")("direct_path not available in wa upload http response");if(typeof a.direct_path!=="string")throw c("err")('directPath: "'+a.direct_path+'" is not a string');if(a.object_id&&typeof a.object_id!=="string")throw c("err")('objectId: "'+a.object_id+'" is not a string');if(a.handle&&typeof a.handle!=="string")throw c("err")('handle: "'+a.handle+'" is not a string');a={directPath:d("WADirectPath").unsafeCastToDirectPath(a.direct_path),objectId:a.object_id,handle:a.handle};return d("WAResultOrError").makeResult(a)}).catch(function(a){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["HttpRegularUploadMedia: fail to parse request body ",""])),a);return d("WAResultOrError").makeError("body-network-error")});case 408:return d("WAResultOrError").makeError("server-timeout");case 413:return d("WAResultOrError").makeError("payload-too-large");case 415:return d("WAResultOrError").makeError("invalid-media");case 429:case 507:return d("WAResultOrError").makeError("upload-throttled");default:return b>=400&&b<500?d("WAResultOrError").makeError("request-error"):d("WAResultOrError").makeError("unspecified-http-error")}}g.httpRegularUploadMedia=a}),98);
__d("WAHttpResumeCheck",["WADirectPath","WALogger","WAMediaUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m;async function a(a){var b;try{b=await fetch(a,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"text/plain"}})}catch(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to initiate fetch ",""])),a);throw a}a=b;a=a.status;d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: response status ",""])),a);switch(a){case 200:return b.json().then(function(a){var b=a.resume,c=a.direct_path;a=a.object_id;if(b==="complete"){if(c==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: direct_path is missing"])));return d("WAResultOrError").makeResult({type:"media-not-found"})}if(a==null){d("WALogger").ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: object_id is missing"])));return d("WAResultOrError").makeResult({type:"media-not-found"})}return d("WAResultOrError").makeResult({type:"media-found",directPath:d("WADirectPath").unsafeCastToDirectPath(c),objectId:d("WAMediaUtils").stringToDeliveryObjectId(a)})}c=parseInt(b,10);if(c===0)return d("WAResultOrError").makeResult({type:"media-not-found"});if(Number.isNaN(c)){d("WALogger").ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: resume is NaN: ",""])),b);return d("WAResultOrError").makeResult({type:"media-not-found"})}return d("WAResultOrError").makeResult({type:"media-partial-found",resumeFromBytes:c})}).catch(function(a){d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["HttpResumeCheck: fail to parse request body ",""])),a);return d("WAResultOrError").makeError("body-network-error")});case 404:return d("WAResultOrError").makeResult({type:"media-not-found"});case 408:return d("WAResultOrError").makeError("server-timeout");case 429:case 507:return d("WAResultOrError").makeError("upload-throttled");default:return a>=400&&a<500?d("WAResultOrError").makeError("request-error"):d("WAResultOrError").makeError("unspecified-http-error")}}g.httpResumeCheck=a}),98);
__d("WAEncryptAndUploadPlaintext",["WABase64","WAErrorMessage","WAGlobals","WAHttpRegularUploadMedia","WAHttpResumeCheck","WALogger","WAMediaCrypto","WAMediaUrl","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o;async function a(a){var b=a.serverMediaType,c=a.plaintextHash,e=a.plaintext,f=a.mediaKey,g=a.mediaKeyTimestamp,p=a.uploadToken,q=a.size,r=a.uploadRetrier,s=a.updateMediaEntry,t=a.mediaUploadFlow,u=a.filename,v=a.fromOffset,w=v===void 0?0:v;v=a.getDownloadableThumbnailForMedia;t.addPoint("encrypt_and_upload_plaintext_start");t.addPoint("compute_media_keys_start");a=b==="preview"?await d("WAMediaCrypto").computeMediaKeysForPreview(f):await d("WAMediaCrypto").computeMediaKeys(f,b);var x=a.iv,y=a.cipherKey;a=a.hmacKey;t.addPoint("compute_media_keys_end");t.addPoint("encrypt_and_hmac_start");y=await d("WAMediaCrypto").encryptAndHmac(y,x,a,e,b);var z=y.ciphertext,A=y.ciphertextHash;x=y.sidecar;y=y.ivCiphertextHmac;t.addPoint("encrypt_and_hmac_end");var B=null;if(b==="image"){t.addPoint("get_progressive_jpeg_details_start");e=await d("WAProgressiveJpegGetPJpegDetails").getProgressiveJpegDetails(new Uint8Array(e),y,a);y=d("WAProgressiveJpegGetPJpegDetails").isValidProgressiveJpegDetails(e);y.success===!1?(d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: Created invalid progressiveJpeg details during encrypt and upload: ",""])),y.error),t.addPoint(y.error)):y.value===!0&&d("WAGlobals").getConfig().isProgressiveJpegSendEnabled()&&(d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: Found valid progressiveJpeg details. Adding to media entry."]))),B=e,t.addPoint("get_progressive_jpeg_details_end"))}a={fileSha256:d("WABase64").decodeB64UrlSafe(c),fileEncSha256:A,mediaKey:f,mediaKeyTimestamp:g,serverMediaType:b,uploadToken:p,sidecar:x,filename:u,progressiveJpegDetails:B,size:q,lastDownloadAttemptTimestamp:void 0,directPath:void 0};var C;t.addPoint("update_media_entry_start");await s(a);t.addPoint("update_media_entry_end");y=await r.run(async function(a,c,e){a=a.domain;var f=w;if(e>0){t.addPoint("network_retry",{int:{network_retry_attempt:e}});try{t.addPoint("resume_check_start");var g=d("WAMediaUrl").buildUploadUrl(b,p,A,a,c,!0);g=await d("WAHttpResumeCheck").httpResumeCheck(g);if(g.success){t.addPoint("resume_check_end");var h=g.value;if(h.type==="media-found"){t.addAnnotations({bool:{existingMediaFound:!0}});return d("WAResultOrError").makeResult(d("WAResultOrError").makeResult({directPath:h.directPath,objectId:null,handle:null}))}h.type==="media-partial-found"&&(f=h.resumeFromBytes)}t.addPoint("resume_check_fail",{string:{resume_check_error:g.error}})}catch(a){t.addPoint("resume_check_fail",{string:{resume_check_error:d("WAErrorMessage").maybeGetMessageFromError(a)}}),d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: error during retrier ",""])),a)}}f>0&&f<z.byteLength?(t.addAnnotations({int:{fromOffset:f},bool:{continuedFromOffset:!0}}),C=z.subarray(f)):C=z;h=d("WAMediaUrl").buildUploadUrl(b,p,A,a,c,!1,f);d("WALogger").LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: start upload media to ",""])),h);t.addPoint("http_upload_start");return d("WAHttpRegularUploadMedia").httpRegularUploadMedia(h,C).then(function(a){if(a.success){t.addPoint("http_upload_end",{int:{byteLength:C.byteLength,attempt:e}});return d("WAResultOrError").makeResult(a)}else{a=a.error;t.addPoint("http_upload_fail",{string:{http_upload_error:a}});d("WALogger").LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""])),a);switch(a){case"server-timeout":case"unspecified-http-error":return d("WAResultOrError").makeError({progressMade:!0});default:return d("WAResultOrError").makeResult(d("WAResultOrError").makeError(a))}}}).catch(function(a){a=d("WAErrorMessage").maybeGetMessageFromError(a);t.addPoint("http_upload_fail",{string:{http_upload_error:a}});d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext error: ",""])),a);return d("WAResultOrError").makeError({progressMade:!1})})});if(y==null){d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext given up"])));return d("WAResultOrError").makeError("max-attempts-exceeded")}if(y.success===!1)return y;e=y.value;f=e.directPath;g=e.objectId;x=e.handle;try{t.addPoint("persist_downloadable_thumbnail_start");u=await v(c);a=babelHelpers.extends({},a,{directPath:f,downloadableThumbnail:u,handle:x,objectId:g});await s(a);t.addPoint("persist_downloadable_thumbnail_end")}catch(a){t.addPoint("persist_downloadable_thumbnail_fail",{string:{persist_downloadable_thumbnail_error:d("WAErrorMessage").maybeGetMessageFromError(a)}})}d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["encryptAndUploadPlaintext: upload success "," ",""])),{directPath:f},{objectId:g});t.addPoint("encrypt_and_upload_plaintext_end");return d("WAResultOrError").makeResult(a)}g.encryptAndUploadPlaintext=a}),98);
__d("WAUploadMediaQuick",["WACreateRetrier","WAEncryptAndUploadPlaintext","WAMediaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a){var b=a.mediaUploadFlow,c=a.plaintext,e=a.plaintextHash,f=a.serverMediaType;a=a.logger;a.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start uploadMediaQuick"])));b.addPoint("create_upload_retrier_start");a=await d("WACreateRetrier").createUploadRetrier(f,b);if(!a.success){b.addPoint("create_upload_retrier_fail");return a}b.addPoint("create_upload_retrier_end");b.addPoint("create_media_key_start");var g=d("WAMediaUtils").createMediaKey(),i=d("WAMediaUtils").createUploadToken(),j=d("WATimeUtils").unixTime();b.addPoint("create_media_key_end");g=await d("WAEncryptAndUploadPlaintext").encryptAndUploadPlaintext({size:0,filename:"",mediaKey:g,mediaKeyTimestamp:j,serverMediaType:f,mediaUploadFlow:b,plaintext:c,plaintextHash:e,updateMediaEntry:function(){return Promise.resolve()},uploadRetrier:a.value,uploadToken:i,getDownloadableThumbnailForMedia:function(){return Promise.resolve()}});return g}g.uploadMediaQuick=a}),98);
__d("mapWorkerSchedulerTask",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return babelHelpers["extends"]({},a,{promise:a.promise.then(b),run:function(){return a.run().then(b)}})}f.mapWorkerSchedulerTask=a}),66);
__d("WAMediaManager",["$InternalEnum","WADownloadFullSizeAndPreviewTask","WADownloadFullSizeOnlyTask","WADownloadPreviewOnlyTask","WAErrorMessage","WAHashUtils","WAMediaManagerCache","WAMediaManagerLogger","WAMediaManagerWorkerScheduler","WAResultOrError","WATimeUtils","WAUploadMediaQuick","WorkerScheduler","justknobx","mapWorkerSchedulerTask"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u=b("$InternalEnum").Mirrored(["HIGH","MEDIUM","LOW"]);function a(a){var b=a.dbCallbacks,e=d("WAMediaManagerWorkerScheduler").mediaManagerWorkerScheduler(),f=d("WAMediaManagerCache").createMediaDownloadCache(),g=function(a){var c=d("WAMediaManagerLogger").createDownloadLogger({downloadKind:"fullsize",fullSizePlaintextHash:a.fullSizePlaintextHash}),g=f.getFullsize(a);c.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["",""])),g.type);if(g.type==="cache-hit")return g.cache;var k=new AbortController(),l=e.task({fn:function(){return d("WADownloadFullSizeOnlyTask").startDownloadFullSizeTask({abortSignal:k.signal,dbCallbacks:b,fullSizePlaintextHash:a.fullSizePlaintextHash,logger:c,mediaDownloadFlow:a.mediaDownloadFlow})},name:"media-manager-download-fullsize-only",priority:v(a.priority)}),m=l.run();g.setCache(a.fullSizePlaintextHash,k,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(l,function(a){return a.fullsizePromise}));return m.then(function(a){return a.fullsizePromise})["catch"](function(a){c.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(j||(j=babelHelpers.taggedTemplateLiteralLoose(["end"])))})},u=function(a){var c=d("WAMediaManagerLogger").createDownloadLogger({downloadKind:"preview",fullSizePlaintextHash:a.fullSizePlaintextHash}),g=f.getPreview(a);c.DEV(k||(k=babelHelpers.taggedTemplateLiteralLoose(["",""])),g.type);if(g.type==="cache-hit")return g.cache;var h=new AbortController(),i=e.task({fn:function(){return d("WADownloadPreviewOnlyTask").startDownloadPreviewTask({abortSignal:h.signal,dbCallbacks:b,fullSizePlaintextHash:a.fullSizePlaintextHash,logger:c,mediaDownloadFlow:a.mediaDownloadFlow})},name:"media-manager-download-preview-only",priority:v(a.priority)});g.setCache(a.fullSizePlaintextHash,h,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(i,function(a){return a.previewPromise}));g=i.run();return g.then(function(a){return a.previewPromise})["catch"](function(a){c.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(m||(m=babelHelpers.taggedTemplateLiteralLoose(["end"])))})};a=function(a){var c=d("WAMediaManagerLogger").createDownloadLogger({downloadKind:"fullsizeAndPreview",fullSizePlaintextHash:a.fullSizePlaintextHash}),h=f.getFullsizeAndPreview(a),i=h.fullsizeCacheResult;h=h.previewCacheResult;c.DEV(n||(n=babelHelpers.taggedTemplateLiteralLoose(["fullsize: ",", preview: ",""])),i.type,h.type);if(i.type==="cache-hit"&&h.type==="cache-hit")return{fullsizePromise:i.cache,previewPromise:h.cache};if(h.type==="cache-hit"){var j=g(a);return{fullsizePromise:j,previewPromise:h.cache}}if(i.type==="cache-hit"){j=u(a);return{fullsizePromise:i.cache,previewPromise:j}}i.type;h.type;var k=new AbortController();j=e.task({fn:function(){return d("WADownloadFullSizeAndPreviewTask").startDownloadFullSizeAndPreviewTask({abortSignal:k.signal,dbCallbacks:b,fullSizePlaintextHash:a.fullSizePlaintextHash,logger:c,mediaDownloadFlow:a.mediaDownloadFlow})},name:"media-manager-download-fullsize-and-preview",priority:v(a.priority)});i.setCache(a.fullSizePlaintextHash,k,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(j,function(a){return a.fullsizePromise}));h.setCache(a.fullSizePlaintextHash,k,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(j,function(a){return a.previewPromise}));i=j.run();return{fullsizePromise:i.then(function(a){return a.fullsizePromise})["catch"](function(a){c.ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["fullsizePromise runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(p||(p=babelHelpers.taggedTemplateLiteralLoose(["fullsize end"])))}),previewPromise:i.then(function(a){return a.previewPromise})["catch"](function(a){c.ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["previewPromise runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(r||(r=babelHelpers.taggedTemplateLiteralLoose(["preview end"])))})}};var w=z(),x=w.isInMemoryMediaUploadCache;w=function(a){var b=d("WAMediaManagerLogger").createUploadLogger({plaintextHash:a.plaintextHash,uploadKind:"fullsize"});if(c("justknobx")._("4810")){var e=x({chatJid:a.chatJid,plaintextHash:a.plaintextHash});a.mediaUploadFlow.addAnnotations({bool:{is_cross_thread_dedupe_candidate:e==="cross-thread",is_in_thread_dedupe_candidate:e==="in-thread"}})}return d("WAUploadMediaQuick").uploadMediaQuick({logger:b,mediaUploadFlow:a.mediaUploadFlow,plaintext:a.plaintext,plaintextHash:a.plaintextHash,serverMediaType:a.serverMediaType})["catch"](function(a){b.ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").makeError("runtime-error")})["finally"](function(){b.DEV(t||(t=babelHelpers.taggedTemplateLiteralLoose(["upload end"])))})};return{clearCache:f.clearCache,dequeueDownload:f.cancelTask,enqueueDownloadFullSize:y("fullsize",g),enqueueDownloadFullSizeAndPreview:y("fullsizeAndPreview",a),enqueueDownloadPreview:y("preview",u),enqueueUploadFullSize:w}}function v(a){switch(a){case u.HIGH:return d("WorkerScheduler").BLOCKING_PRIORITY;case u.MEDIUM:return d("WorkerScheduler").REGULAR_PRIORITY;case u.LOW:return d("WorkerScheduler").BACKGROUND_PRIORITY}}var w=typeof ((e=navigator.storage)==null?void 0:e.getDirectory)==="function",x=typeof self.caches==="object";function y(a,b){return function(c){var e=c.fullSizePlaintextHash,f=c.mediaDownloadFlow;try{f.addPoint("enqueue_start",{bool:{isMediaManager:!0,isOPFSSupported:w,isWebCacheSupported:x},string:{downloadKind:a,sanitisedMediaHash:d("WAHashUtils").sanitisePlaintextHash(e)}});e=b(c);f.addPoint("enqueue_end");return e}catch(a){f.addPoint("enqueue_fail");throw a}}}function z(){var a=new Map();return{isInMemoryMediaUploadCache:function(b){var c=b.chatJid;b=b.plaintextHash;var e=a.get(b);if(e==null){a.set(b,{chatJids:new Set([c]),ttl:d("WATimeUtils").futureUnixTime(2*d("WATimeUtils").DAY_SECONDS)});return"no-cache"}var f=e.chatJids;e=e.ttl;if(d("WATimeUtils").isInFuture(e)){e=f.has(c);f.add(c);return e?"in-thread":"cross-thread"}a.set(b,{chatJids:new Set([c]),ttl:d("WATimeUtils").futureUnixTime(2*d("WATimeUtils").DAY_SECONDS)});return"no-cache"}}}g.MediaTaskPriority=u;g.createMediaManager=a;g.toWorkerSchedulerPriority=v}),98);
__d("WAMediaManagerCache",["WAHashUtils","WAMediaManager","WAMediaManagerLogger","WAPromiseDelays"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=1e3*30;function a(){var a=new Map(),b=new Map(),c=function(a,c,e,f){b.set(a,{abortController:c,mediaDownloadFlow:e,task:f}),f.promise.then(function(a){a=a.success;return a?d("WAPromiseDelays").delayMs(k):void 0})["finally"](function(){b["delete"](a)})},e=function(b,c,e,f){a.set(b,{abortController:c,mediaDownloadFlow:e,task:f}),f.promise.then(function(a){a=a.success;return a?d("WAPromiseDelays").delayMs(k):void 0})["finally"](function(){a["delete"](b)})};return{cancelTask:function(c){var e=d("WAMediaManagerLogger").baseLogger.TAGS(["hash:"+d("WAHashUtils").sanitisePlaintextHash(c),"cancelTask"]);e.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start"])));var f=[b,a];for(f of f){var g=f.get(c);if(g!=null){var k=g.task.cancel();g.mediaDownloadFlow.addPoint("cancel_download_triggered");k===!1?(g.abortController.abort(),g.mediaDownloadFlow.addPoint("http_abort_cancel"),e.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["http abort cancel"])))):(g.mediaDownloadFlow.addPoint("worker_task_cancel_cancel"),e.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["worker task cancel"]))));f["delete"](c)}}},clearCache:function(){a.clear(),b.clear()},getFullsize:function(a){var e=b.get(a.fullSizePlaintextHash);if(e!=null){l(a.mediaDownloadFlow,"hit","fullsize");e.task.promote(d("WAMediaManager").toWorkerSchedulerPriority(a.priority));return{cache:e.task.promise,type:"cache-hit"}}l(a.mediaDownloadFlow,"miss","fullsize");return{setCache:c,type:"cache-miss"}},getFullsizeAndPreview:function(f){var g=d("WAMediaManager").toWorkerSchedulerPriority(f.priority),h=b.get(f.fullSizePlaintextHash),i=a.get(f.fullSizePlaintextHash);if(h!=null&&i!=null){l(f.mediaDownloadFlow,"hit","fullsize-and-preview");h.task.promote(g);i.task.promote(g);return{fullsizeCacheResult:{cache:h.task.promise,type:"cache-hit"},previewCacheResult:{cache:i.task.promise,type:"cache-hit"}}}if(h!=null){l(f.mediaDownloadFlow,"hit","fullsize");h.task.promote(g);return{fullsizeCacheResult:{cache:h.task.promise,type:"cache-hit"},previewCacheResult:{setCache:e,type:"cache-miss"}}}if(i!=null){l(f.mediaDownloadFlow,"hit","preview");i.task.promote(g);return{fullsizeCacheResult:{setCache:c,type:"cache-miss"},previewCacheResult:{cache:i.task.promise,type:"cache-hit"}}}l(f.mediaDownloadFlow,"miss","fullsize-and-preview");return{fullsizeCacheResult:{setCache:c,type:"cache-miss"},previewCacheResult:{setCache:e,type:"cache-miss"}}},getPreview:function(b){var c=a.get(b.fullSizePlaintextHash);if(c!=null){l(b.mediaDownloadFlow,"hit","preview");c.task.promote(d("WAMediaManager").toWorkerSchedulerPriority(b.priority));return{cache:c.task.promise,type:"cache-hit"}}l(b.mediaDownloadFlow,"miss","preview");return{setCache:e,type:"cache-miss"}}}}function l(a,b,c){a.addAnnotations({string:{media_manager_cache_result:b,media_manager_cache_type:c}})}g.DOWNLOAD_TASK_CACHE_TTL_MS=k;g.createMediaDownloadCache=a}),98);
__d("MpsMediaManager",["MAWDbChunkTxns","MAWIndexedDb","MAWTransactionMode","MpsMediaEntryCache","MpsMessageToBridgeWrapper","MpsToBridgeMessageId","WAJids","WAMediaManager","WAMediaUtils","WAStanzaUtils","WAValidateMedia","WebMps","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){return d("WAMediaManager").createMediaManager({dbCallbacks:{getMediaEntries:function(a){a=d("MpsMediaEntryCache").getEntry(a);return a!=null?Promise.resolve({success:!0,value:new Map([[a.msgId,a.mediaEntry]])}):Promise.resolve({error:"no-media-by-plaintext-hash",success:!1})},getProtocolMsgIdAndSortOrderMs:async function(a){a=d("MpsToBridgeMessageId").bridgeMsgIdToMps(a);var b=a.messageId;a=a.threadId;b=await d("WebMps").mps().loadMessage({config:{shouldFetchSupplementals:!1,shouldFetchTags:!1,strategy:"local-only"},debug:{purpose:"mps_media_manager"},messageId:b,threadId:a});if(!b.value)return;a=d("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromTopLevel(b.value.toplevelProtobuf);b=a.getAuthor();if(d("WAJids").isAuthorSystem(b))return;return{protocolMsgId:{author:b,chat:a.getChatJid(),externalId:d("WAStanzaUtils").toStanzaId(a.getExternalId())},sortOrderMs:a.message.timestampMs}},updateMediaEntryForMsg:function(){return Promise.resolve()}}})},i=d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READWRITE},"storeChunk",function(a){return function(b,e,f){return d("MAWDbChunkTxns").getOrCreateMediaChunkWithPlaintextHash(a,b,e,f).then(c("emptyFunction"))}});async function j(a,b,c){if(a==null)return;a=await d("WAValidateMedia").validateMedia(a.blobData,b);if(a.value==null)return;return{success:!0,value:{serverMediaType:c,unvalidatedMimeType:d("WAMediaUtils").getMimeTypeFromServerMediaType(c),validatedResult:a.value}}}a=function(){var a=h(),b={clearCache:a.clearCache,dequeueDownload:a.dequeueDownload,enqueueDownloadFullSize:async function(b){var c=d("MpsMediaEntryCache").getEntry(b.fullSizePlaintextHash);if(!c)return{error:"missing-media-entry",success:!1};var e=await d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY},"mpsEnqueueDownloadFullSize",function(a){return function(){return d("MAWDbChunkTxns").maybeGetChunkByPlaintextHash(a,b.fullSizePlaintextHash)}})().then(function(a){return j(a,b.mediaDownloadFlow,c.serverMediaType)});if(e!=null)return e;e=await a.enqueueDownloadFullSize(b);if(e.success===!0){var f;await i(b.fullSizePlaintextHash,e.value.validatedResult.validatedPlaintext,(f=e.value.validatedResult.mimeType)!=null?f:e.value.unvalidatedMimeType)}return e},enqueueDownloadFullSizeAndPreview:function(a){return{fullsizePromise:b.enqueueDownloadFullSize(a),previewPromise:b.enqueueDownloadPreview(a)}},enqueueDownloadPreview:async function(b){var c=d("MpsMediaEntryCache").getEntry(b.fullSizePlaintextHash),e=c==null?void 0:c.thumbnailHash;if(c==null)return{error:"missing-media-entry",success:!1};else if(e==null)return{error:"preview-not-supported",success:!1};var f=await d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY},"mpsEnqueueDownloadPreview",function(a){return function(){return d("MAWDbChunkTxns").maybeGetChunkByPlaintextHash(a,e)}})().then(function(a){return j(a,b.mediaDownloadFlow,c.serverMediaType)});if(f!=null)return f;f=await a.enqueueDownloadPreview(b);if(f.success===!0){var g;await i(e,f.value.validatedResult.validatedPlaintext,(g=f.value.validatedResult.mimeType)!=null?g:f.value.unvalidatedMimeType)}return f},enqueueUploadFullSize:function(){return a.enqueueUploadFullSize.apply(a,arguments)}};return b};g.storeChunk=i;g.getMpsMediaManager=a}),98);
__d("MAWMediaManager",["MAWGetMostRescentDecodedMediaEntry","MAWGetProtocolMsgIdAndSortOrderMsApi","MAWMpsGating","MAWUpdateMediaEntryForMsgApi","MpsMediaManager","WAMediaManager"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(){if(h==null){if(d("MAWMpsGating").isFullMpsEnabled()){var a=d("MpsMediaManager").getMpsMediaManager();h=a;return a}a=d("WAMediaManager").createMediaManager({dbCallbacks:{getMediaEntries:d("MAWGetMostRescentDecodedMediaEntry").getMediaEntries,getProtocolMsgIdAndSortOrderMs:d("MAWGetProtocolMsgIdAndSortOrderMsApi").getProtocolMsgIdAndSortOrderMs,updateMediaEntryForMsg:d("MAWUpdateMediaEntryForMsgApi").updateMediaEntryForMsg}});h=a;return a}return h}g.getMawMediaManager=a}),98);
__d("MAWUpdateClientRestoreStatusOperationType",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;f.upsertClientRestoreStatus=a;f.markCompleteClientRestoreStatus=b}),66);
__d("WAFrankingNode",["Promise","WAFranking","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,c,e){if(c==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Franking key is missing"])));return(j||(j=b("Promise"))).resolve(null)}if(e!=null&&e!==0){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Can't handle franking version ",""])),e);return(j||(j=b("Promise"))).resolve(null)}return d("WAFranking").genFrankingTag(c,a)}g.genFrankingTagFromMessageApplicationEncode=a}),98);
__d("WAGenReportingMeta",["WAByteArray","WAFranking","WAFrankingNode","WAGlobals"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b,c){if(d("WAGlobals").getConfig().isFrankingEnabled()){var e=await d("WAFrankingNode").genFrankingTagFromMessageApplicationEncode(a,b,c);return{frankingKey:b,frankingTag:e,frankingVersion:d("WAFranking").getFrankingVersion(c),reportingContent:d("WAByteArray").uint8ArrayToBuffer(a),reportingTag:null}}else return{frankingKey:b,frankingTag:null,frankingVersion:d("WAFranking").getFrankingVersion(c),reportingContent:null,reportingTag:null}}g.genReportingMeta=a}),98);
__d("WAPushSafeTypes",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f.unsafeNotNullable=a}),66);